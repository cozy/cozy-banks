!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1765)}([function(module,exports,__webpack_require__){module.exports=__webpack_require__(277)},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0,exports.default=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var obj,_defineProperty=__webpack_require__(343),_defineProperty2=(obj=_defineProperty)&&obj.__esModule?obj:{default:obj};exports.default=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),(0,_defineProperty2.default)(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}()},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var obj,_assign=__webpack_require__(339),_assign2=(obj=_assign)&&obj.__esModule?obj:{default:obj};exports.default=_assign2.default||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}},function(module,exports){function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}module.exports=function(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)})}}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(633),__esModule:!0}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var obj,_typeof2=__webpack_require__(96),_typeof3=(obj=_typeof2)&&obj.__esModule?obj:{default:obj};exports.default=function(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!==(void 0===call?"undefined":(0,_typeof3.default)(call))&&"function"!=typeof call?self:call}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _setPrototypeOf2=_interopRequireDefault(__webpack_require__(646)),_create2=_interopRequireDefault(__webpack_require__(650)),_typeof3=_interopRequireDefault(__webpack_require__(96));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+(void 0===superClass?"undefined":(0,_typeof3.default)(superClass)));subClass.prototype=(0,_create2.default)(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(_setPrototypeOf2.default?(0,_setPrototypeOf2.default)(subClass,superClass):subClass.__proto__=superClass)}},function(module,exports){module.exports=require("util")},function(module,exports){var core=module.exports={version:"2.6.9"};"number"==typeof __e&&(__e=core)},function(module,exports,__webpack_require__){var baseGet=__webpack_require__(154);module.exports=function(object,path,defaultValue){var result=null==object?void 0:baseGet(object,path);return void 0===result?defaultValue:result}},function(module,exports){module.exports=require("stream")},function(module,exports){var isArray=Array.isArray;module.exports=isArray},function(module,exports,__webpack_require__){module.exports=__webpack_require__(277)},function(module,exports,__webpack_require__){var global=__webpack_require__(19),core=__webpack_require__(9),ctx=__webpack_require__(51),hide=__webpack_require__(64),has=__webpack_require__(81),$export=function(type,name,source){var key,own,out,IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,IS_WRAP=type&$export.W,exports=IS_GLOBAL?core:core[name]||(core[name]={}),expProto=exports.prototype,target=IS_GLOBAL?global:IS_STATIC?global[name]:(global[name]||{}).prototype;for(key in IS_GLOBAL&&(source=name),source)(own=!IS_FORCED&&target&&void 0!==target[key])&&has(exports,key)||(out=own?target[key]:source[key],exports[key]=IS_GLOBAL&&"function"!=typeof target[key]?source[key]:IS_BIND&&own?ctx(out,global):IS_WRAP&&target[key]==out?function(C){var F=function(a,b,c){if(this instanceof C){switch(arguments.length){case 0:return new C;case 1:return new C(a);case 2:return new C(a,b)}return new C(a,b,c)}return C.apply(this,arguments)};return F.prototype=C.prototype,F}(out):IS_PROTO&&"function"==typeof out?ctx(Function.call,out):out,IS_PROTO&&((exports.virtual||(exports.virtual={}))[key]=out,type&$export.R&&expProto&&!expProto[key]&&hide(expProto,key,out)))};$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128,module.exports=$export},function(module,exports,__webpack_require__){"use strict";var key,buffer=__webpack_require__(60),Buffer=buffer.Buffer,safer={};for(key in buffer)buffer.hasOwnProperty(key)&&"SlowBuffer"!==key&&"Buffer"!==key&&(safer[key]=buffer[key]);var Safer=safer.Buffer={};for(key in Buffer)Buffer.hasOwnProperty(key)&&"allocUnsafe"!==key&&"allocUnsafeSlow"!==key&&(Safer[key]=Buffer[key]);if(safer.Buffer.prototype=Buffer.prototype,Safer.from&&Safer.from!==Uint8Array.from||(Safer.from=function(value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof value);if(value&&void 0===value.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value);return Buffer(value,encodingOrOffset,length)}),Safer.alloc||(Safer.alloc=function(size,fill,encoding){if("number"!=typeof size)throw new TypeError('The "size" argument must be of type number. Received type '+typeof size);if(size<0||size>=2*(1<<30))throw new RangeError('The value "'+size+'" is invalid for option "size"');var buf=Buffer(size);return fill&&0!==fill.length?"string"==typeof encoding?buf.fill(fill,encoding):buf.fill(fill):buf.fill(0),buf}),!safer.kStringMaxLength)try{safer.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}safer.constants||(safer.constants={MAX_LENGTH:safer.kMaxLength},safer.kStringMaxLength&&(safer.constants.MAX_STRING_LENGTH=safer.kStringMaxLength)),module.exports=safer},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var obj,_promise=__webpack_require__(67),_promise2=(obj=_promise)&&obj.__esModule?obj:{default:obj};exports.default=function(fn){return function(){var gen=fn.apply(this,arguments);return new _promise2.default(function(resolve,reject){return function step(key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}if(!info.done)return _promise2.default.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)});resolve(value)}("next")})}}},function(module,exports,__webpack_require__){var defineProperty=__webpack_require__(251);module.exports=function(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))),ownKeys.forEach(function(key){defineProperty(target,key,source[key])})}return target}},function(module,exports,__webpack_require__){var baseMatches=__webpack_require__(538),baseMatchesProperty=__webpack_require__(548),identity=__webpack_require__(99),isArray=__webpack_require__(12),property=__webpack_require__(551);module.exports=function(value){return"function"==typeof value?value:null==value?identity:"object"==typeof value?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}},function(module,exports){var global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global)},function(module,exports,__webpack_require__){var store=__webpack_require__(222)("wks"),uid=__webpack_require__(158),Symbol=__webpack_require__(19).Symbol,USE_SYMBOL="function"==typeof Symbol;(module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:uid)("Symbol."+name))}).store=store},function(module,exports){module.exports=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}},,function(module,exports){module.exports=require("url")},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(80)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(module){module.exports=JSON.parse('{"0":"uncategorized","100":"potentialTransfer","200":"check","300":"atm","200100":"incomeCat","200110":"activityIncome","200120":"replacementIncome","200130":"interests","200140":"dividends","200150":"donationsReceived","200160":"allocations","200170":"rentalIncome","200180":"additionalIncome","200190":"retirement","400100":"dailyLife","400110":"supermarket","400111":"tobaccoPress","400112":"shoppingECommerce","400120":"consumerLoan","400130":"dressing","400140":"pets","400150":"telecom","400160":"snaksAndworkMeals","400170":"charity","400180":"giftsOffered","400190":"personalCare","400200":"transportation","400205":"vehiculePurchase","400210":"vehiculeLoan","400220":"vehiculeRental","400230":"vehiculeInsurance","400240":"vehiculeMaintenance","400250":"vehiculeGas","400260":"privateParking","400270":"parkingAndToll","400280":"publicTransportation","400290":"taxi","400300":"services","400310":"post","400320":"legalCounsel","400330":"homeAssistance","400340":"bankFees","400350":"financialAdvisor","400400":"kids","400410":"kidsAllowance","400420":"schoolRestaurant","400430":"childCare","400440":"schoolInsurance","400450":"toysAndGifts","400460":"pensionPaid","400470":"kidsActivities","400500":"tax","400510":"incomeTax","400520":"socialTax","400530":"wealthTax","400540":"realEstateTax","400600":"health","400610":"healthExpenses","400620":"healthInsurance","400700":"activities","400710":"activityFees","400720":"activityEquipments","400730":"activityLessons","400740":"electronicsAndMultimedia","400750":"booksMoviesMusic","400760":"hobbyAndPassion","400800":"goingOutAndTravel","400810":"restaurantsAndBars","400820":"goingOutEntertainment","400830":"goingOutCulture","400840":"travel","400850":"journey","400900":"educationAndTraining","400910":"tuition","400920":"eduBooksAndSupplies","400930":"studentLoan","400940":"eduLessons","401000":"homeAndRealEstate","401010":"realEstateLoan","401020":"rent","401030":"homeCharges","401040":"homeInsurance","401050":"homeImprovement","401060":"homeHardware","401070":"water","401080":"power","600100":"excludeFromBudgetCat","600110":"internalTransfer","600120":"creditCardPayment","600130":"loanCredit","600140":"professionalExpenses","600150":"investmentBuySell","600160":"friendBorrowing","600170":"savings"}')},function(module,exports){module.exports=function(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)}},,,function(module,exports){module.exports=function(value){return null!=value&&"object"==typeof value}},function(module,exports){function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}module.exports=function(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}},function(module,exports,__webpack_require__){var freeGlobal=__webpack_require__(281),freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();module.exports=root},function(module,exports){module.exports=function(it){return"object"==typeof it?null!==it:"function"==typeof it}},function(module,exports,__webpack_require__){const omit=__webpack_require__(110),pick=__webpack_require__(169),size=__webpack_require__(268),omitBy=__webpack_require__(434),isUndefined=__webpack_require__(394),fromPairs=__webpack_require__(93),pickBy=__webpack_require__(136),flatMap=__webpack_require__(403),groupBy=__webpack_require__(42),sortBy=__webpack_require__(83),get=__webpack_require__(10),{parallelMap:parallelMap}=__webpack_require__(664),CozyClient=__webpack_require__(390).default,log=__webpack_require__(34).namespace("Document"),querystring=__webpack_require__(190),DATABASE_DOES_NOT_EXIST="Database does not exist.";const indexes={},userAttributes=["shortLabel"];function sanitizeKey(key){return key.startsWith("\\")?key.slice(1):key}const withoutUndefined=x=>omitBy(x,isUndefined),flagForDeletion=x=>Object.assign({},x,{_deleted:!0}),newestDocumentComparisonFunc=doc=>{const d=(doc=>{const d=doc.cozyMetadata&&doc.cozyMetadata.updatedAt;return d?new Date(d):null})(doc);return d?-d:0};class Document{static registerClient(client){if(this.cozyClient)throw console.warn("Document already has been registered, this is not possible to re-register as the client is shared globally between all classes. This is to prevent concurrency bugs."),new Error("Document cannot be re-registered to a client.");this.cozyClient=client}static copyWithClient(client){const BaseClass=this;class ExtendedClass extends BaseClass{}return ExtendedClass.cozyClient=null,ExtendedClass.registerClient(client),ExtendedClass}static usesCozyClient(){return this.cozyClient instanceof CozyClient}static getIndex(doctype,fields){if(this.usesCozyClient())throw new Error("This method is not implemented yet with CozyClient");return this.getIndexViaOldClient(doctype,fields)}static getIndexViaOldClient(doctype,fields){const key=`${doctype}:${fields.slice().join(",")}`;return indexes[key]||(indexes[key]=this.cozyClient.data.defineIndex(doctype,fields).then(index=>(indexes[key]=index,index))),Promise.resolve(indexes[key])}static addCozyMetadata(attributes){return attributes.cozyMetadata||(attributes.cozyMetadata={}),attributes.cozyMetadata.updatedAt=new Date,!attributes.cozyMetadata.createdByApp&&this.createdByApp&&(attributes.cozyMetadata.createdByApp=this.createdByApp),this.createdByApp&&function(cozyMetadata,appSlug){cozyMetadata.updatedByApps||(cozyMetadata.updatedByApps=[]);const now=new Date;for(const appInfo of cozyMetadata.updatedByApps)if(appInfo.slug===appSlug)return void(appInfo.date=now);cozyMetadata.updatedByApps.push({slug:appSlug,date:now})}(attributes.cozyMetadata,this.createdByApp),attributes}static async get(id){if(!this.usesCozyClient())throw new Error("This method is not implemented with cozy-client-js");if(!this.doctype)throw new Error("doctype is not defined");return(await this.cozyClient.collection(this.doctype).get(id)).data}static async createOrUpdate(attributes,options={}){return this.usesCozyClient()?this.createOrUpdateViaNewClient(attributes,options):this.createOrUpdateViaOldClient(attributes,options)}static applyUpdateIfDifferent(doc,update){if(!this.checkAttributes||function(o1,o2){if(0===Object.keys(o1).length)return!0;for(let key in o1)if(o1[key]!==o2[key])return!0;return!1}(pick(doc,this.checkAttributes),pick(update,this.checkAttributes))){return delete update.dateImport,this.addCozyMetadata({...doc,...update})}return log("debug",`[updateIfDifferent] No need to update ${update._id} because its \`checkedAttributes\` (${this.checkAttributes}) didn't change.`),doc}static getHandleDuplicateStrategy(name){if(Document.duplicateHandlingStrategies[name])return Document.duplicateHandlingStrategies[name];throw new Error(`${name} is not a know duplication handling strategy. Known strategies are ${Object.keys(Document.duplicateHandlingStrategies)}`)}static async handleDuplicates(strategyNameOrFn,duplicates,selector){const strategyFn="string"==typeof(strategyNameOrFn=strategyNameOrFn||this.defaultDuplicateHandling)?this.getHandleDuplicateStrategy(strategyNameOrFn):strategyNameOrFn;return await strategyFn.call(this,duplicates,selector)}static async createOrUpdateViaNewClient(attributes,options){const selector=fromPairs(this.idAttributes.map(idAttribute=>[idAttribute,get(attributes,sanitizeKey(idAttribute))]));let results=[];const compactedSelector=withoutUndefined(selector);if(size(compactedSelector)===this.idAttributes.length&&(results=await this.queryAll(selector)),0===results.length)return this.create(this.addCozyMetadata(attributes));{(results=sortBy(results,newestDocumentComparisonFunc)).length>1&&await this.handleDuplicates(options.handleDuplicates,results,selector);const doc=results[0],update=omit(attributes,userAttributes),updatedDoc=this.applyUpdateIfDifferent(doc,update);return updatedDoc!==doc?this.cozyClient.save(updatedDoc):updatedDoc}}static async createOrUpdateViaOldClient(attributes,options){const selector=fromPairs(this.idAttributes.map(idAttribute=>[idAttribute,get(attributes,sanitizeKey(idAttribute))]));let results=[];const compactedSelector=withoutUndefined(selector);if(size(compactedSelector)===this.idAttributes.length){const index=await this.getIndex(this.doctype,this.idAttributes);results=await this.cozyClient.data.query(index,{selector:selector})}if(0===results.length)return this.cozyClient.data.create(this.doctype,this.addCozyMetadata(attributes));{(results=sortBy(results,newestDocumentComparisonFunc)).length>1&&await this.handleDuplicates(options.handleDuplicates,results,selector);const doc=results[0],update=omit(attributes,userAttributes),updatedDoc=this.applyUpdateIfDifferent(doc,update);return updatedDoc!==doc?this.cozyClient.data.updateAttributes(this.doctype,updatedDoc._id,updatedDoc):doc}}static create(attributes){return this.usesCozyClient()?this.createViaNewClient(attributes):this.createViaOldClient(attributes)}static createViaNewClient(attributes){return this.cozyClient.create(this.doctype,attributes)}static createViaOldClient(attributes){return this.cozyClient.data.create(this.doctype,attributes)}static bulkSave(documents,optionsOrConcurrency,logProgressOrNothing){(logProgressOrNothing||"object"!=typeof optionsOrConcurrency)&&log("warn","Second argument of bulkSave is now an object, please use bulkSave(documents, { logProgress, concurrency })");const options={};return"number"==typeof optionsOrConcurrency&&(options.concurrency=optionsOrConcurrency),"function"==typeof logProgressOrNothing&&(options.logProgress=logProgressOrNothing),"object"==typeof optionsOrConcurrency&&Object.assign(options,optionsOrConcurrency),this._bulkSave(documents,options)}static _bulkSave(documents,options={}){const{concurrency:concurrency=30,logProgress:logProgress,...createOrUpdateOptions}=options;return parallelMap(documents,doc=>(logProgress&&logProgress(doc),this.createOrUpdate(doc,createOrUpdateOptions)),concurrency)}static query(index,options){if(this.usesCozyClient())throw new Error("This method is not implemented yet with CozyClient");return this.queryViaOldClient(index,options)}static queryViaOldClient(index,options){return this.cozyClient.data.query(index,options)}static async fetchAll(){const stackClient=this.usesCozyClient()?this.cozyClient.stackClient:this.cozyClient;try{return(await stackClient.fetchJSON("GET",`/data/${this.doctype}/_all_docs?include_docs=true`)).rows.filter(x=>0!==x.id.indexOf("_design")&&x.doc).map(x=>x.doc)}catch(e){return e&&e.response&&e.response.status&&e.response.status,[]}}static async updateAll(docs){const stackClient=this.usesCozyClient()?this.cozyClient.stackClient:this.cozyClient;if(!docs||!docs.length)return Promise.resolve([]);try{return await stackClient.fetchJSON("POST",`/data/${this.doctype}/_bulk_docs`,{docs:docs})}catch(e){if(e.reason&&e.reason.reason&&e.reason.reason==DATABASE_DOES_NOT_EXIST){const firstDoc=await this.create(docs[0]),resp=await this.updateAll(docs.slice(1));return resp.unshift({ok:!0,id:firstDoc._id,rev:firstDoc._rev}),resp}throw e}}static async deleteAll(docs){return this.updateAll(docs.map(flagForDeletion))}static findDuplicates(docs){const idAttributes=this.idAttributes,groups=pickBy(groupBy(docs,doc=>idAttributes.map(idAttrPath=>get(doc,idAttrPath)).join("#$$$$#")),group=>group.length>1);return flatMap(groups,group=>group.slice(1))}static async deleteDuplicates(priorityFn){let allDocs=await this.fetchAll();priorityFn&&(allDocs=sortBy(allDocs,priorityFn));const duplicates=this.findDuplicates(allDocs);return this.deleteAll(duplicates)}static async fetchChanges(since,options={}){const stackClient=this.usesCozyClient()?this.cozyClient.stackClient:this.cozyClient,queryParams={since:since,include_docs:"true"};options.params&&Object.assign(queryParams,options.params);const result=await stackClient.fetchJSON("GET",`/data/${this.doctype}/_changes?${querystring.stringify(queryParams)}`),newLastSeq=result.last_seq;let docs=result.results.map(x=>x.doc).filter(Boolean);return options.includeDesign||(docs=docs.filter(doc=>0!==doc._id.indexOf("_design"))),options.includeDeleted||(docs=docs.filter(doc=>!doc._deleted)),{newLastSeq:newLastSeq,documents:docs}}static async queryAll(selector,index){return this.usesCozyClient()?this.queryAllViaNewClient(selector):this.queryAllViaOldClient(selector,index)}static async queryAllViaNewClient(selector){if(!selector)return this.fetchAll();const result=[],query=this.cozyClient.find(this.doctype).where(selector);let resp={next:!0};for(;resp&&resp.next;)resp=await this.cozyClient.query(query.offset(result.length)),result.push(...resp.data);return result}static async queryAllViaOldClient(selector,index){if(!selector)return await this.fetchAll();index||(index=await this.cozyClient.data.defineIndex(this.doctype,Object.keys(selector)));const result=[];let resp={next:!0};for(;resp&&resp.next;)resp=await this.cozyClient.data.query(index,{selector:selector,wholeResponse:!0,skip:result.length}),result.push(...resp.docs);return result}static async getAll(ids){const stackClient=this.usesCozyClient()?this.cozyClient.stackClient:this.cozyClient;let resp;try{resp=await stackClient.fetchJSON("POST",`/data/${this.doctype}/_all_docs?include_docs=true`,{keys:ids})}catch(error){if(error.message.match(/not_found/))return[];throw error}return resp.rows.filter(row=>row.doc).map(row=>row.doc)}}Document.defaultDuplicateHandling="throw",Document.duplicateHandlingStrategies={throw:function(duplicates,selector){throw new Error("Create or update with selectors that returns more than 1 result\n"+JSON.stringify(selector)+"\n"+JSON.stringify(duplicates))},remove:async function(duplicates){const docsToRemove=duplicates.slice(1);docsToRemove.length>0&&(log("warn",`Cleaning duplicates for doctype ${this.doctype} (kept: ${duplicates[0]._id}, removed: ${docsToRemove.map(x=>x._id)})`),await this.deleteAll(docsToRemove))}},module.exports=Document},function(module,exports,__webpack_require__){const{filterLevel:filterLevel,filterSecrets:filterSecrets}=__webpack_require__(614),Secret=__webpack_require__(328),{LOG_LEVEL:LOG_LEVEL}=process.env;let level=LOG_LEVEL||"debug";const format=__webpack_require__(615),filters=[filterLevel,filterSecrets],filterOut=function(){for(const filter of filters)if(!1===filter.apply(null,arguments))return!0;return!1};function log(type,message,label,namespace){filterOut(level,type,message,label,namespace)||console.log(format(type,message,label,namespace))}log.addFilter=function(filter){return filters.push(filter)},log.setLevel=function(lvl){level=lvl};["debug","info","warn","error","ok","critical"].forEach(level=>{log[level]=function(message,label,namespace){return log(level,message,label,namespace)}}),module.exports=log,log.setNoRetry=obj=>(obj?obj.no_retry=!0:obj={no_retry:!0},obj.no_retry),log.Secret=Secret,log.namespace=function(namespace){return function(type,message,label,ns=namespace){log(type,message,label,ns)}}},function(module,exports){module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}},function(module,exports,__webpack_require__){var getTimezoneOffsetInMilliseconds=__webpack_require__(587),isDate=__webpack_require__(422),MILLISECONDS_IN_HOUR=36e5,MILLISECONDS_IN_MINUTE=6e4,DEFAULT_ADDITIONAL_DIGITS=2,parseTokenDateTimeDelimeter=/[T ]/,parseTokenPlainTime=/:/,parseTokenYY=/^(\d{2})$/,parseTokensYYY=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],parseTokenYYYY=/^(\d{4})/,parseTokensYYYYY=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],parseTokenMM=/^-(\d{2})$/,parseTokenDDD=/^-?(\d{3})$/,parseTokenMMDD=/^-?(\d{2})-?(\d{2})$/,parseTokenWww=/^-?W(\d{2})$/,parseTokenWwwD=/^-?W(\d{2})-?(\d{1})$/,parseTokenHH=/^(\d{2}([.,]\d*)?)$/,parseTokenHHMM=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,parseTokenHHMMSS=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,parseTokenTimezone=/([Z+-].*)$/,parseTokenTimezoneZ=/^(Z)$/,parseTokenTimezoneHH=/^([+-])(\d{2})$/,parseTokenTimezoneHHMM=/^([+-])(\d{2}):?(\d{2})$/;function dayOfISOYear(isoYear,week,day){week=week||0,day=day||0;var date=new Date(0);date.setUTCFullYear(isoYear,0,4);var diff=7*week+day+1-(date.getUTCDay()||7);return date.setUTCDate(date.getUTCDate()+diff),date}module.exports=function(argument,dirtyOptions){if(isDate(argument))return new Date(argument.getTime());if("string"!=typeof argument)return new Date(argument);var additionalDigits=(dirtyOptions||{}).additionalDigits;additionalDigits=null==additionalDigits?DEFAULT_ADDITIONAL_DIGITS:Number(additionalDigits);var dateStrings=function(dateString){var timeString,dateStrings={},array=dateString.split(parseTokenDateTimeDelimeter);if(parseTokenPlainTime.test(array[0])?(dateStrings.date=null,timeString=array[0]):(dateStrings.date=array[0],timeString=array[1]),timeString){var token=parseTokenTimezone.exec(timeString);token?(dateStrings.time=timeString.replace(token[1],""),dateStrings.timezone=token[1]):dateStrings.time=timeString}return dateStrings}(argument),parseYearResult=function(dateString,additionalDigits){var token,parseTokenYYY=parseTokensYYY[additionalDigits],parseTokenYYYYY=parseTokensYYYYY[additionalDigits];if(token=parseTokenYYYY.exec(dateString)||parseTokenYYYYY.exec(dateString)){var yearString=token[1];return{year:parseInt(yearString,10),restDateString:dateString.slice(yearString.length)}}if(token=parseTokenYY.exec(dateString)||parseTokenYYY.exec(dateString)){var centuryString=token[1];return{year:100*parseInt(centuryString,10),restDateString:dateString.slice(centuryString.length)}}return{year:null}}(dateStrings.date,additionalDigits),year=parseYearResult.year,date=function(dateString,year){if(null===year)return null;var token,date,month,week;if(0===dateString.length)return(date=new Date(0)).setUTCFullYear(year),date;if(token=parseTokenMM.exec(dateString))return date=new Date(0),month=parseInt(token[1],10)-1,date.setUTCFullYear(year,month),date;if(token=parseTokenDDD.exec(dateString)){date=new Date(0);var dayOfYear=parseInt(token[1],10);return date.setUTCFullYear(year,0,dayOfYear),date}if(token=parseTokenMMDD.exec(dateString)){date=new Date(0),month=parseInt(token[1],10)-1;var day=parseInt(token[2],10);return date.setUTCFullYear(year,month,day),date}if(token=parseTokenWww.exec(dateString))return week=parseInt(token[1],10)-1,dayOfISOYear(year,week);if(token=parseTokenWwwD.exec(dateString)){week=parseInt(token[1],10)-1;var dayOfWeek=parseInt(token[2],10)-1;return dayOfISOYear(year,week,dayOfWeek)}return null}(parseYearResult.restDateString,year);if(date){var offset,timestamp=date.getTime(),time=0;if(dateStrings.time&&(time=function(timeString){var token,hours,minutes;if(token=parseTokenHH.exec(timeString))return(hours=parseFloat(token[1].replace(",",".")))%24*MILLISECONDS_IN_HOUR;if(token=parseTokenHHMM.exec(timeString))return hours=parseInt(token[1],10),minutes=parseFloat(token[2].replace(",",".")),hours%24*MILLISECONDS_IN_HOUR+minutes*MILLISECONDS_IN_MINUTE;if(token=parseTokenHHMMSS.exec(timeString)){hours=parseInt(token[1],10),minutes=parseInt(token[2],10);var seconds=parseFloat(token[3].replace(",","."));return hours%24*MILLISECONDS_IN_HOUR+minutes*MILLISECONDS_IN_MINUTE+1e3*seconds}return null}(dateStrings.time)),dateStrings.timezone)timezoneString=dateStrings.timezone,offset=((token=parseTokenTimezoneZ.exec(timezoneString))?0:(token=parseTokenTimezoneHH.exec(timezoneString))?(absoluteOffset=60*parseInt(token[2],10),"+"===token[1]?-absoluteOffset:absoluteOffset):(token=parseTokenTimezoneHHMM.exec(timezoneString))?(absoluteOffset=60*parseInt(token[2],10)+parseInt(token[3],10),"+"===token[1]?-absoluteOffset:absoluteOffset):0)*MILLISECONDS_IN_MINUTE;else{var fullTime=timestamp+time,fullTimeDate=new Date(fullTime);offset=getTimezoneOffsetInMilliseconds(fullTimeDate);var fullTimeDateNextDay=new Date(fullTime);fullTimeDateNextDay.setDate(fullTimeDate.getDate()+1);var offsetDiff=getTimezoneOffsetInMilliseconds(fullTimeDateNextDay)-getTimezoneOffsetInMilliseconds(fullTimeDate);offsetDiff>0&&(offset+=offsetDiff)}return new Date(timestamp+time+offset)}var timezoneString,token,absoluteOffset;return new Date(argument)}},function(module,exports){function _getPrototypeOf(o){return module.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}module.exports=_getPrototypeOf},function(module,exports,__webpack_require__){var anObject=__webpack_require__(45),IE8_DOM_DEFINE=__webpack_require__(330),toPrimitive=__webpack_require__(219),dP=Object.defineProperty;exports.f=__webpack_require__(24)?Object.defineProperty:function(O,P,Attributes){if(anObject(O),P=toPrimitive(P,!0),anObject(Attributes),IE8_DOM_DEFINE)try{return dP(O,P,Attributes)}catch(e){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported!");return"value"in Attributes&&(O[P]=Attributes.value),O}},function(module,exports,__webpack_require__){var _typeof=__webpack_require__(609),assertThisInitialized=__webpack_require__(272);module.exports=function(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?assertThisInitialized(self):call}},function(module,exports,__webpack_require__){var setPrototypeOf=__webpack_require__(610);module.exports=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&setPrototypeOf(subClass,superClass)}},function(module,exports,__webpack_require__){const Account=__webpack_require__(663),AdministrativeProcedure=__webpack_require__(752),Application=__webpack_require__(378),Document=__webpack_require__(33),BalanceHistory=__webpack_require__(755),BankAccount=__webpack_require__(239),BankingReconciliator=__webpack_require__(758),BankTransaction=__webpack_require__(759),BankAccountStats=__webpack_require__(761),Contact=__webpack_require__(376),CozyFile=__webpack_require__(381),CozyFolder=__webpack_require__(764),Group=__webpack_require__(765),Permission=__webpack_require__(766);module.exports={Account:Account,AdministrativeProcedure:AdministrativeProcedure,Application:Application,Document:Document,BalanceHistory:BalanceHistory,BankAccount:BankAccount,BankingReconciliator:BankingReconciliator,BankTransaction:BankTransaction,BankAccountStats:BankAccountStats,Contact:Contact,CozyFile:CozyFile,CozyFolder:CozyFolder,Group:Group,registerClient:Document.registerClient,Permission:Permission}},function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(98),createAggregator=__webpack_require__(325),hasOwnProperty=Object.prototype.hasOwnProperty,groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):baseAssignValue(result,key,[value])});module.exports=groupBy},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return ACCOUNT_DOCTYPE}),__webpack_require__.d(__webpack_exports__,"d",function(){return GROUP_DOCTYPE}),__webpack_require__.d(__webpack_exports__,"e",function(){return TRANSACTION_DOCTYPE}),__webpack_require__.d(__webpack_exports__,"b",function(){return BILLS_DOCTYPE}),__webpack_require__.d(__webpack_exports__,"f",function(){return TRIGGER_DOCTYPE}),__webpack_require__.d(__webpack_exports__,"c",function(){return CONTACT_DOCTYPE}),__webpack_require__.d(__webpack_exports__,"g",function(){return schema});var _babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(17),_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(84),_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(21),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(30),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(39),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(37),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(40),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__),lodash_fromPairs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(93),lodash_fromPairs__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(lodash_fromPairs__WEBPACK_IMPORTED_MODULE_7__),cozy_client__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(71),cozy_client__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(cozy_client__WEBPACK_IMPORTED_MODULE_8__),ACCOUNT_DOCTYPE="io.cozy.bank.accounts",GROUP_DOCTYPE="io.cozy.bank.groups",TRANSACTION_DOCTYPE="io.cozy.bank.operations",BILLS_DOCTYPE="io.cozy.bills",TRIGGER_DOCTYPE="io.cozy.triggers",CONTACT_DOCTYPE="io.cozy.contacts",HasManyBills=function(_HasManyInPlace){function HasManyBills(){return _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default()(this,HasManyBills),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(HasManyBills).apply(this,arguments))}return _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6___default()(HasManyBills,_HasManyInPlace),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(HasManyBills,[{key:"data",get:function(){var _this=this;return this.raw?this.raw.map(function(doctypeId){var _doctypeId$split=doctypeId.split(":"),_doctypeId$split2=_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_1___default()(_doctypeId$split,2),doctype=_doctypeId$split2[0],id=_doctypeId$split2[1];return _this.get(doctype,id)}):[]}}],[{key:"query",value:function(doc,client,assoc){var included=doc[assoc.name];if(!included||!included.length)return null;var ids=included.indexOf(":")?included.map(function(x){return x.split(":")[1]}):included,docs=lodash_fromPairs__WEBPACK_IMPORTED_MODULE_7___default()(ids.map(function(id){return[id,client.getDocumentFromState(assoc.doctype,id)]})),missingIds=Object.keys(docs).filter(function(id){return!docs[id]});return missingIds&&missingIds.length?new cozy_client__WEBPACK_IMPORTED_MODULE_8__.QueryDefinition({doctype:assoc.doctype,ids:missingIds}):Object.values(docs)}}]),HasManyBills}(cozy_client__WEBPACK_IMPORTED_MODULE_8__.HasManyInPlace),HasManyReimbursements=function(_HasManyInPlace2){function HasManyReimbursements(){return _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default()(this,HasManyReimbursements),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(HasManyReimbursements).apply(this,arguments))}return _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6___default()(HasManyReimbursements,_HasManyInPlace2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(HasManyReimbursements,[{key:"raw",get:function(){return this.target[this.name]}},{key:"data",get:function(){var _this2=this;return(this.raw||[]).map(function(reimbursement){return reimbursement.billId?_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0___default()({},reimbursement,{bill:_this2.get("io.cozy.bills",reimbursement.billId.split(":")[1])}):reimbursement})}}],[{key:"query",value:function(doc,client,assoc){var included=doc[assoc.name];if(!included||!included.length)return null;var missingIds=included.map(function(doc){return doc.billId&&doc.billId.split(":")[1]}).filter(Boolean);return new cozy_client__WEBPACK_IMPORTED_MODULE_8__.QueryDefinition({doctype:assoc.doctype,ids:missingIds})}}]),HasManyReimbursements}(cozy_client__WEBPACK_IMPORTED_MODULE_8__.HasManyInPlace),schema={transactions:{doctype:TRANSACTION_DOCTYPE,attributes:{},relationships:{account:{type:"belongs-to-in-place",doctype:ACCOUNT_DOCTYPE},bills:{type:HasManyBills,doctype:BILLS_DOCTYPE},reimbursements:{type:HasManyReimbursements,doctype:BILLS_DOCTYPE}}},bills:{doctype:BILLS_DOCTYPE},settings:{doctype:"io.cozy.bank.settings",attributes:{},relationships:{}},bankAccounts:{doctype:ACCOUNT_DOCTYPE,attributes:{},relationships:{checkingsAccount:{type:"has-one",doctype:ACCOUNT_DOCTYPE},owners:{type:"has-many",doctype:CONTACT_DOCTYPE}}},groups:{doctype:GROUP_DOCTYPE,attributes:{},relationships:{accounts:{type:cozy_client__WEBPACK_IMPORTED_MODULE_8__.HasManyInPlace,doctype:ACCOUNT_DOCTYPE}}},triggers:{doctype:TRIGGER_DOCTYPE,attributes:{},relationships:{}},apps:{doctype:"io.cozy.apps",attributes:{},relationships:{}},konnectors:{doctype:"io.cozy.konnectors",attributes:{},relationships:{}},stats:{doctype:"io.cozy.bank.accounts.stats",attributes:{},relationships:{account:{type:"has-one",doctype:ACCOUNT_DOCTYPE}}}};cozy_client__WEBPACK_IMPORTED_MODULE_8___default.a.fetchPolicies.olderThan(3e4)},,function(module,exports,__webpack_require__){var isObject=__webpack_require__(32);module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var obj,_defineProperty=__webpack_require__(343),_defineProperty2=(obj=_defineProperty)&&obj.__esModule?obj:{default:obj};exports.default=function(obj,key,value){return key in obj?(0,_defineProperty2.default)(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}},function(module,__webpack_exports__,__webpack_require__){"use strict";var tree=__webpack_require__(25),detect_node=__webpack_require__(383),detect_node_default=__webpack_require__.n(detect_node),palette=__webpack_require__(384),palette_default=__webpack_require__.n(palette),memoize=__webpack_require__(241),getCssVariableValue=__webpack_require__.n(memoize)()(function(variableName){return window.getComputedStyle(document.body).getPropertyValue("--".concat(variableName)).trim()});__webpack_require__.d(__webpack_exports__,"a",function(){return categoriesStyle}),__webpack_require__.d(__webpack_exports__,"c",function(){return categoriesMap_getCategoryIdFromName}),__webpack_require__.d(__webpack_exports__,"d",function(){return categoriesMap_getCategoryName}),__webpack_require__.d(__webpack_exports__,"e",function(){return getParentCategory}),__webpack_require__.d(__webpack_exports__,"f",function(){return isParentOf});var categoriesMap_getColor=function(color){return detect_node_default.a?palette_default.a[color]:getCssVariableValue(color)},categoriesStyle={kids:{color:categoriesMap_getColor("azure")},dailyLife:{color:categoriesMap_getColor("melon")},educationAndTraining:{color:categoriesMap_getColor("blazeOrange")},health:{color:categoriesMap_getColor("pomegranate")},homeAndRealEstate:{color:categoriesMap_getColor("mango")},incomeCat:{color:categoriesMap_getColor("emerald")},activities:{color:categoriesMap_getColor("fuchsia")||"#FC4C83"},excludeFromBudgetCat:{color:categoriesMap_getColor("darkPeriwinkle")},services:{color:categoriesMap_getColor("purpley")},tax:{color:categoriesMap_getColor("lightishPurple")},transportation:{color:categoriesMap_getColor("puertoRico")},goingOutAndTravel:{color:categoriesMap_getColor("weirdGreen")},uncategorized:{color:categoriesMap_getColor("coolGrey")}},categoriesMap_getCategoryIdFromName=function(name){return Object.keys(tree).find(function(id){return tree[id]===name})};for(var categoriesMap_catName in categoriesStyle){var category=categoriesStyle[categoriesMap_catName];category.name=categoriesMap_catName,category.id=categoriesMap_getCategoryIdFromName(categoriesMap_catName),category.children={}}var categoriesMap_getCategoryName=function(id){if(null===id)return"awaiting";if(void 0===id)return tree[0];var categoryName=tree[id];return void 0===categoryName?tree[0]:categoryName},categoryToParent=new Map(Object.keys(tree).map(function(id){return[id,function(idStr){for(var k=parseInt(idStr,10),m=10,name=tree[k];!categoriesStyle.hasOwnProperty(name);)name=tree[k-=k%m],m*=10;return categoriesStyle[name]}(id)]})),getParentCategory=function(catId){var parent=categoryToParent.get(catId);return parent&&parent.name},isParentOf=function(possibleParentCatId,catId){var parent=categoryToParent.get(catId);return Boolean(parent&&parent.id==possibleParentCatId)};Object.keys(tree).forEach(function(catId){var catName=tree[catId],parentName=getParentCategory(catId);categoriesStyle[parentName]&&(categoriesStyle[parentName].children[catId]={name:catName,color:categoriesStyle[parentName].color,id:catId})});__webpack_exports__.b=categoryToParent},function(module,exports){module.exports=require("zlib")},function(module,exports){module.exports=function(obj){return obj&&obj.__esModule?obj:{default:obj}}},,function(module,exports,__webpack_require__){var aFunction=__webpack_require__(121);module.exports=function(fn,that,length){if(aFunction(fn),void 0===that)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.normalizeDoctype=void 0;var _typeof3=_interopRequireDefault(__webpack_require__(96)),_set2=_interopRequireDefault(__webpack_require__(704)),_from2=_interopRequireDefault(__webpack_require__(214)),_toConsumableArray3=_interopRequireDefault(__webpack_require__(70)),_getIterator3=_interopRequireDefault(__webpack_require__(66)),_keys2=_interopRequireDefault(__webpack_require__(61)),_values2=_interopRequireDefault(__webpack_require__(127)),_defineProperty3=_interopRequireDefault(__webpack_require__(46)),_promise2=_interopRequireDefault(__webpack_require__(67)),_objectWithoutProperties3=_interopRequireDefault(__webpack_require__(86)),_regenerator2=_interopRequireDefault(__webpack_require__(13)),_taggedTemplateLiteral3=_interopRequireDefault(__webpack_require__(106)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_assign2=_interopRequireDefault(__webpack_require__(339)),_extends3=_interopRequireDefault(__webpack_require__(3)),_templateObject=(0,_taggedTemplateLiteral3.default)(["/data/","/",""],["/data/","/",""]),_templateObject2=(0,_taggedTemplateLiteral3.default)(["/data/","/_find"],["/data/","/_find"]),_templateObject3=(0,_taggedTemplateLiteral3.default)(["/data/","/_all_docs?include_docs=true"],["/data/","/_all_docs?include_docs=true"]),_templateObject4=(0,_taggedTemplateLiteral3.default)(["/data/","/","?rev=",""],["/data/","/","?rev=",""]),_templateObject5=(0,_taggedTemplateLiteral3.default)(["/data/","/_index"],["/data/","/_index"]);exports.normalizeDoc=normalizeDoc;var _utils=__webpack_require__(107),_uniq2=_interopRequireDefault(__webpack_require__(173)),_transform2=_interopRequireDefault(__webpack_require__(716)),_head2=_interopRequireDefault(__webpack_require__(448)),_omit2=_interopRequireDefault(__webpack_require__(110)),_startsWith2=_interopRequireDefault(__webpack_require__(717)),_qs2=_interopRequireDefault(__webpack_require__(289)),_Collection=__webpack_require__(234),_Collection2=_interopRequireDefault(_Collection),querystring=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(__webpack_require__(370));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function normalizeDoc(){var doc=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},doctype=arguments[1],id=doc._id||doc.id;return(0,_extends3.default)({id:id,_id:id,_type:doctype},doc)}var flagForDeletion=function(x){return(0,_assign2.default)({},x,{_deleted:!0})},DocumentCollection=function(){function DocumentCollection(doctype,stackClient){(0,_classCallCheck3.default)(this,DocumentCollection),this.doctype=doctype,this.stackClient=stackClient,this.indexes={}}var _ref16,_ref14,_ref13,_ref12,_ref11,_ref10,_ref9,_ref7,_ref6,_ref4,_ref3,_ref2,_ref;return(0,_createClass3.default)(DocumentCollection,[{key:"all",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(){var limit,_options$skip,skip,keys,isUsingAllDocsRoute,route,url,params,path,resp,data,_this=this,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return limit=options.limit,_options$skip=options.skip,skip=void 0===_options$skip?0:_options$skip,keys=options.keys,route=(isUsingAllDocsRoute=!!keys||null===limit)?"_all_docs":"_normal_docs",url=(0,_utils.uri)(_templateObject,this.doctype,route),params={include_docs:!0,limit:limit,skip:skip,keys:keys},path=querystring.buildURL(url,params),resp=void 0,_context.prev=7,_context.next=10,this.stackClient.fetchJSON("GET",path);case 10:resp=_context.sent,_context.next=16;break;case 13:return _context.prev=13,_context.t0=_context.catch(7),_context.abrupt("return",(0,_Collection.dontThrowNotFoundError)(_context.t0));case 16:return data=void 0,data=isUsingAllDocsRoute?resp.rows.filter(function(doc){return doc&&null!==doc.doc&&!doc.error&&!(0,_startsWith2.default)(doc.id,"_design")}).map(function(row){return normalizeDoc(row.doc,_this.doctype)}):resp.rows.map(function(row){return normalizeDoc(row,_this.doctype)}),_context.abrupt("return",{data:data,meta:{count:isUsingAllDocsRoute?data.length:resp.total_rows},skip:skip,next:skip+resp.rows.length<resp.total_rows});case 19:case"end":return _context.stop()}},_callee,this,[[7,13]])})),function(){return _ref.apply(this,arguments)})},{key:"find",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(selector){var _options$skip2,skip,resp,_this2=this,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _options$skip2=options.skip,skip=void 0===_options$skip2?0:_options$skip2,resp=void 0,_context2.prev=2,_context2.t0=this.stackClient,_context2.t1=(0,_utils.uri)(_templateObject2,this.doctype),_context2.next=7,this.toMangoOptions(selector,options);case 7:return _context2.t2=_context2.sent,_context2.next=10,_context2.t0.fetchJSON.call(_context2.t0,"POST",_context2.t1,_context2.t2);case 10:resp=_context2.sent,_context2.next=16;break;case 13:return _context2.prev=13,_context2.t3=_context2.catch(2),_context2.abrupt("return",(0,_Collection.dontThrowNotFoundError)(_context2.t3));case 16:return _context2.abrupt("return",{data:resp.docs.map(function(doc){return normalizeDoc(doc,_this2.doctype)}),meta:{count:resp.next?skip+resp.docs.length+1:resp.docs.length},next:resp.next,skip:skip});case 17:case"end":return _context2.stop()}},_callee2,this,[[2,13]])})),function(_x4){return _ref2.apply(this,arguments)})},{key:"get",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(id){return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",_Collection2.default.get(this.stackClient,(0,_utils.uri)(_templateObject,this.doctype,id),{normalize:this.constructor.normalizeDoctype(this.doctype)}));case 1:case"end":return _context3.stop()}},_callee3,this)})),function(_x5){return _ref3.apply(this,arguments)})},{key:"getAll",value:(_ref4=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(ids){var resp,rows,_this3=this;return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return resp=void 0,_context4.prev=1,_context4.next=4,this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject3,this.doctype),{keys:ids});case 4:resp=_context4.sent,_context4.next=10;break;case 7:return _context4.prev=7,_context4.t0=_context4.catch(1),_context4.abrupt("return",(0,_Collection.dontThrowNotFoundError)(_context4.t0));case 10:return rows=resp.rows.filter(function(row){return row.doc}),_context4.abrupt("return",{data:rows.map(function(row){return normalizeDoc(row.doc,_this3.doctype)}),meta:{count:rows.length}});case 12:case"end":return _context4.stop()}},_callee4,this,[[1,7]])})),function(_x6){return _ref4.apply(this,arguments)})},{key:"create",value:(_ref6=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee5(_ref5){var hasFixedId,method,endpoint,resp,_id=_ref5._id,document=(_ref5._type,(0,_objectWithoutProperties3.default)(_ref5,["_id","_type"]));return _regenerator2.default.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return method=(hasFixedId=!!_id)?"PUT":"POST",endpoint=(0,_utils.uri)(_templateObject,this.doctype,hasFixedId?_id:""),_context5.next=5,this.stackClient.fetchJSON(method,endpoint,document);case 5:return resp=_context5.sent,_context5.abrupt("return",{data:normalizeDoc(resp.data,this.doctype)});case 7:case"end":return _context5.stop()}},_callee5,this)})),function(_x7){return _ref6.apply(this,arguments)})},{key:"update",value:(_ref7=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee6(document){var resp;return _regenerator2.default.wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,this.stackClient.fetchJSON("PUT",(0,_utils.uri)(_templateObject,this.doctype,document._id),document);case 2:return resp=_context6.sent,_context6.abrupt("return",{data:normalizeDoc(resp.data,this.doctype)});case 4:case"end":return _context6.stop()}},_callee6,this)})),function(_x8){return _ref7.apply(this,arguments)})},{key:"destroy",value:(_ref9=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee7(_ref8){var resp,_id=_ref8._id,_rev=_ref8._rev,document=(0,_objectWithoutProperties3.default)(_ref8,["_id","_rev"]);return _regenerator2.default.wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,this.stackClient.fetchJSON("DELETE",(0,_utils.uri)(_templateObject4,this.doctype,_id,_rev));case 2:return resp=_context7.sent,_context7.abrupt("return",{data:normalizeDoc((0,_extends3.default)({},document,{_id:_id,_rev:resp.rev,_deleted:!0}),this.doctype)});case 4:case"end":return _context7.stop()}},_callee7,this)})),function(_x9){return _ref9.apply(this,arguments)})},{key:"updateAll",value:(_ref10=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee8(docs){var stackClient,update,firstDoc,resp;return _regenerator2.default.wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(stackClient=this.stackClient,docs&&docs.length){_context8.next=3;break}return _context8.abrupt("return",_promise2.default.resolve([]));case 3:return _context8.prev=3,_context8.next=6,stackClient.fetchJSON("POST","/data/"+this.doctype+"/_bulk_docs",{docs:docs});case 6:return update=_context8.sent,_context8.abrupt("return",update);case 10:if(_context8.prev=10,_context8.t0=_context8.catch(3),!_context8.t0.reason||!_context8.t0.reason.reason||"Database does not exist."!==_context8.t0.reason.reason){_context8.next=23;break}return _context8.next=15,this.create(docs[0]);case 15:return firstDoc=_context8.sent,_context8.next=18,this.updateAll(docs.slice(1));case 18:return(resp=_context8.sent).unshift({ok:!0,id:firstDoc._id,rev:firstDoc._rev}),_context8.abrupt("return",resp);case 23:throw _context8.t0;case 24:case"end":return _context8.stop()}},_callee8,this,[[3,10]])})),function(_x10){return _ref10.apply(this,arguments)})},{key:"destroyAll",value:function(docs){return this.updateAll(docs.map(flagForDeletion))}},{key:"toMangoOptions",value:(_ref11=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee9(selector){var sort,indexedFields,fields,_options$skip3,skip,limit,indexId,sortOrders,sortOrder,_loop,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,field,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(sort=options.sort,indexedFields=options.indexedFields,fields=options.fields,_options$skip3=options.skip,skip=void 0===_options$skip3?0:_options$skip3,limit=options.limit,sort&&!Array.isArray(sort)&&(console.warn('Passing an object to the "sort" is deprecated, please use an array instead.'),sort=(0,_transform2.default)(sort,function(acc,order,field){return acc.push((0,_defineProperty3.default)({},field,order))},[])),indexedFields=indexedFields||this.getIndexFields({sort:sort,selector:selector}),_context9.t0=options.indexId,_context9.t0){_context9.next=9;break}return _context9.next=8,this.getIndexId(indexedFields);case 8:_context9.t0=_context9.sent;case 9:if(indexId=_context9.t0,!sort){_context9.next=35;break}if(!((sortOrders=(0,_uniq2.default)(sort.map(function(sortOption){return(0,_head2.default)((0,_values2.default)(sortOption))}))).length>1)){_context9.next=14;break}throw new Error("Mango sort can only use a single order (asc or desc).");case 14:for(sortOrder=sortOrders.length>0?(0,_head2.default)(sortOrders):"asc",_loop=function(field){sort.find(function(sortOption){return(0,_head2.default)((0,_keys2.default)(sortOption))===field})||sort.push((0,_defineProperty3.default)({},field,sortOrder))},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_context9.prev=19,_iterator=(0,_getIterator3.default)(indexedFields);!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)field=_step.value,_loop(field);_context9.next=27;break;case 23:_context9.prev=23,_context9.t1=_context9.catch(19),_didIteratorError=!0,_iteratorError=_context9.t1;case 27:_context9.prev=27,_context9.prev=28,!_iteratorNormalCompletion&&_iterator.return&&_iterator.return();case 30:if(_context9.prev=30,!_didIteratorError){_context9.next=33;break}throw _iteratorError;case 33:return _context9.finish(30);case 34:return _context9.finish(27);case 35:return _context9.abrupt("return",{selector:selector,use_index:indexId,fields:fields?[].concat((0,_toConsumableArray3.default)(fields),["_id","_type","class"]):void 0,limit:limit,skip:skip,sort:sort});case 36:case"end":return _context9.stop()}},_callee9,this,[[19,23,27,35],[28,,30,34]])})),function(_x12){return _ref11.apply(this,arguments)})},{key:"checkUniquenessOf",value:(_ref12=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee10(property,value){var indexId,existingDocs;return _regenerator2.default.wrap(function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,this.getUniqueIndexId(property);case 2:return indexId=_context10.sent,_context10.next=5,this.find((0,_defineProperty3.default)({},property,value),{indexId:indexId,fields:["_id"]});case 5:return existingDocs=_context10.sent,_context10.abrupt("return",0===existingDocs.data.length);case 7:case"end":return _context10.stop()}},_callee10,this)})),function(_x13,_x14){return _ref12.apply(this,arguments)})},{key:"getUniqueIndexId",value:function(property){return this.getIndexId([property],this.doctype+"/"+property)}},{key:"getIndexId",value:(_ref13=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee11(fields){var indexName=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getIndexNameFromFields(fields);return _regenerator2.default.wrap(function(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(this.indexes[indexName]){_context11.next=4;break}return _context11.next=3,this.createIndex(fields);case 3:this.indexes[indexName]=_context11.sent;case 4:return _context11.abrupt("return",this.indexes[indexName].id);case 5:case"end":return _context11.stop()}},_callee11,this)})),function(_x16){return _ref13.apply(this,arguments)})},{key:"createIndex",value:(_ref14=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee12(fields){var indexDef,resp,indexResp,selector,options;return _regenerator2.default.wrap(function(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return indexDef={index:{fields:fields}},_context12.next=3,this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject5,this.doctype),indexDef);case 3:if(resp=_context12.sent,indexResp={id:resp.id,fields:fields},"exists"!==resp.result){_context12.next=7;break}return _context12.abrupt("return",indexResp);case 7:return selector=(0,_defineProperty3.default)({},fields[0],{$gt:null}),options={indexId:indexResp.id},_context12.next=11,(0,_utils.attempt)(this.find(selector,options));case 11:if(!_context12.sent){_context12.next=13;break}return _context12.abrupt("return",indexResp);case 13:return _context12.next=15,(0,_utils.sleep)(1e3);case 15:return _context12.next=17,(0,_utils.attempt)(this.find(selector,options));case 17:if(!_context12.sent){_context12.next=19;break}return _context12.abrupt("return",indexResp);case 19:return _context12.next=21,(0,_utils.sleep)(500);case 21:return _context12.abrupt("return",indexResp);case 22:case"end":return _context12.stop()}},_callee12,this)})),function(_x17){return _ref14.apply(this,arguments)})},{key:"getIndexNameFromFields",value:function(fields){return"by_"+fields.join("_and_")}},{key:"getIndexFields",value:function(_ref15){var selector=_ref15.selector,_ref15$sort=_ref15.sort,sort=void 0===_ref15$sort?[]:_ref15$sort;return(0,_from2.default)(new _set2.default([].concat((0,_toConsumableArray3.default)(sort.map(function(sortOption){return(0,_head2.default)((0,_keys2.default)(sortOption))})),(0,_toConsumableArray3.default)((0,_keys2.default)(selector)))))}},{key:"fetchChanges",value:(_ref16=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee13(){var haveDocsIds,urlParams,method,endpoint,params,result,newLastSeq,docs,couchOptions=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return haveDocsIds=couchOptions.doc_ids&&couchOptions.doc_ids.length>0,urlParams="","object"!==(void 0===couchOptions?"undefined":(0,_typeof3.default)(couchOptions))?(urlParams="?include_docs=true&since="+couchOptions,console.warn('fetchChanges use couchOptions as Object not a string, since is deprecated, please use fetchChanges({include_docs: true, since: "'+couchOptions+'"}).')):(0,_keys2.default)(couchOptions).length>0&&(urlParams="?"+[_qs2.default.stringify((0,_omit2.default)(couchOptions,"doc_ids")),haveDocsIds&&void 0===couchOptions.filter?"filter=_doc_ids":void 0].filter(Boolean).join("&")),method=haveDocsIds?"POST":"GET",endpoint="/data/"+this.doctype+"/_changes"+urlParams,params=haveDocsIds?{doc_ids:couchOptions.doc_ids}:void 0,_context13.next=8,this.stackClient.fetchJSON(method,endpoint,params);case 8:return result=_context13.sent,newLastSeq=result.last_seq,docs=result.results.map(function(x){return x.doc}).filter(Boolean),options.includeDesign||(docs=docs.filter(function(doc){return 0!==doc._id.indexOf("_design")})),options.includeDeleted||(docs=docs.filter(function(doc){return!doc._deleted})),_context13.abrupt("return",{newLastSeq:newLastSeq,documents:docs});case 14:case"end":return _context13.stop()}},_callee13,this)})),function(){return _ref16.apply(this,arguments)})}],[{key:"normalizeDoctype",value:function(doctype){return this.normalizeDoctypeRawApi(doctype)}},{key:"normalizeDoctypeJsonApi",value:function(doctype){return function(data,response){return normalizeDoc(data,doctype)}}},{key:"normalizeDoctypeRawApi",value:function(doctype){return function(data,response){return normalizeDoc(response,doctype)}}}]),DocumentCollection}();exports.default=DocumentCollection;exports.normalizeDoctype=DocumentCollection.normalizeDoctype},function(module,exports){module.exports=require("path")},function(module,exports,__webpack_require__){var identity=__webpack_require__(99),overRest=__webpack_require__(296),setToString=__webpack_require__(258);module.exports=function(func,start){return setToString(overRest(func,start,identity),func+"")}},function(module,exports,__webpack_require__){var isFunction=__webpack_require__(115),isLength=__webpack_require__(195);module.exports=function(value){return null!=value&&isLength(value.length)&&!isFunction(value)}},,,function(module,exports,__webpack_require__){"use strict";var _flag=__webpack_require__(49)(__webpack_require__(213));function enableFlags(flagsToEnable){Array.isArray(flagsToEnable)&&flagsToEnable.forEach(function(flagToEnable){return(0,_flag.default)(flagToEnable,!0)})}"undefined"!=typeof window&&(_flag.default.connect=__webpack_require__(619).default,_flag.default.FlagSwitcher=__webpack_require__(622).default),enableFlags([]),_flag.default.enable=enableFlags,module.exports=_flag.default},function(module,exports){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),module.webpackPolyfill=1),module}},function(module,exports){module.exports=require("buffer")},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(656),__esModule:!0}},,,function(module,exports,__webpack_require__){var dP=__webpack_require__(38),createDesc=__webpack_require__(122);module.exports=__webpack_require__(24)?function(object,key,value){return dP.f(object,key,createDesc(1,value))}:function(object,key,value){return object[key]=value,object}},function(module,exports,__webpack_require__){var IObject=__webpack_require__(220),defined=__webpack_require__(216);module.exports=function(it){return IObject(defined(it))}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(671),__esModule:!0}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(673),__esModule:!0}},function(module,exports){module.exports=require("http")},function(module,exports,__webpack_require__){var arrayLikeKeys=__webpack_require__(297),baseKeys=__webpack_require__(264),isArrayLike=__webpack_require__(55);module.exports=function(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var obj,_from=__webpack_require__(214),_from2=(obj=_from)&&obj.__esModule?obj:{default:obj};exports.default=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return(0,_from2.default)(arr)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.manifest=exports.Registry=exports.getQueryFromState=exports.cancelable=exports.dehydrate=exports.HasManyTriggers=exports.HasManyInPlace=exports.HasOneInPlace=exports.HasOne=exports.HasMany=exports.Association=exports.getDoctypeFromOperation=exports.MutationTypes=exports.Mutations=exports.QueryDefinition=exports.compose=exports.StackLink=exports.CozyLink=exports.default=void 0;var _CozyClient=__webpack_require__(390);Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return _interopRequireDefault(_CozyClient).default}});var _CozyLink=__webpack_require__(246);Object.defineProperty(exports,"CozyLink",{enumerable:!0,get:function(){return _interopRequireDefault(_CozyLink).default}});var _StackLink=__webpack_require__(391);Object.defineProperty(exports,"StackLink",{enumerable:!0,get:function(){return _interopRequireDefault(_StackLink).default}});var _flow=__webpack_require__(404);Object.defineProperty(exports,"compose",{enumerable:!0,get:function(){return _interopRequireDefault(_flow).default}});var _dsl=__webpack_require__(87);Object.defineProperty(exports,"QueryDefinition",{enumerable:!0,get:function(){return _dsl.QueryDefinition}}),Object.defineProperty(exports,"Mutations",{enumerable:!0,get:function(){return _dsl.Mutations}}),Object.defineProperty(exports,"MutationTypes",{enumerable:!0,get:function(){return _dsl.MutationTypes}}),Object.defineProperty(exports,"getDoctypeFromOperation",{enumerable:!0,get:function(){return _dsl.getDoctypeFromOperation}});var _associations=__webpack_require__(171);Object.defineProperty(exports,"Association",{enumerable:!0,get:function(){return _associations.Association}}),Object.defineProperty(exports,"HasMany",{enumerable:!0,get:function(){return _associations.HasMany}}),Object.defineProperty(exports,"HasOne",{enumerable:!0,get:function(){return _associations.HasOne}}),Object.defineProperty(exports,"HasOneInPlace",{enumerable:!0,get:function(){return _associations.HasOneInPlace}}),Object.defineProperty(exports,"HasManyInPlace",{enumerable:!0,get:function(){return _associations.HasManyInPlace}}),Object.defineProperty(exports,"HasManyTriggers",{enumerable:!0,get:function(){return _associations.HasManyTriggers}});var _helpers=__webpack_require__(392);Object.defineProperty(exports,"dehydrate",{enumerable:!0,get:function(){return _helpers.dehydrate}});var _utils=__webpack_require__(801);Object.defineProperty(exports,"cancelable",{enumerable:!0,get:function(){return _utils.cancelable}});var _store=__webpack_require__(128);Object.defineProperty(exports,"getQueryFromState",{enumerable:!0,get:function(){return _store.getQueryFromState}});var _registry=__webpack_require__(802);Object.defineProperty(exports,"Registry",{enumerable:!0,get:function(){return _interopRequireDefault(_registry).default}});var manifest=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(__webpack_require__(806));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.manifest=manifest},,,function(module,exports,__webpack_require__){var Symbol=__webpack_require__(97),getRawTag=__webpack_require__(462),objectToString=__webpack_require__(463),nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol?Symbol.toStringTag:void 0;module.exports=function(value){return null==value?void 0===value?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}},,function(module,exports){module.exports=require("fs")},function(module,exports,__webpack_require__){var baseIsNative=__webpack_require__(486),getValue=__webpack_require__(489);module.exports=function(object,key){var value=getValue(object,key);return baseIsNative(value)?value:void 0}},function(module,exports,__webpack_require__){var assignValue=__webpack_require__(178),baseAssignValue=__webpack_require__(98);module.exports=function(source,props,object,customizer){var isNew=!object;object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):void 0;void 0===newValue&&(newValue=source[key]),isNew?baseAssignValue(object,key,newValue):assignValue(object,key,newValue)}return object}},function(module,exports,__webpack_require__){"use strict";var $at=__webpack_require__(624)(!0);__webpack_require__(217)(String,"String",function(iterated){this._t=String(iterated),this._i=0},function(){var point,O=this._t,index=this._i;return index>=O.length?{value:void 0,done:!0}:(point=$at(O,index),this._i+=point.length,{value:point,done:!1})})},function(module,exports){module.exports=function(exec){try{return!!exec()}catch(e){return!0}}},function(module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},function(module,exports,__webpack_require__){var defined=__webpack_require__(216);module.exports=function(it){return Object(defined(it))}},function(module,exports,__webpack_require__){var baseFlatten=__webpack_require__(114),baseOrderBy=__webpack_require__(583),baseRest=__webpack_require__(54),isIterateeCall=__webpack_require__(142),sortBy=baseRest(function(collection,iteratees){if(null==collection)return[];var length=iteratees.length;return length>1&&isIterateeCall(collection,iteratees[0],iteratees[1])?iteratees=[]:length>2&&isIterateeCall(iteratees[0],iteratees[1],iteratees[2])&&(iteratees=[iteratees[0]]),baseOrderBy(collection,baseFlatten(iteratees,1),[])});module.exports=sortBy},function(module,exports,__webpack_require__){var arrayWithHoles=__webpack_require__(611),iterableToArrayLimit=__webpack_require__(612),nonIterableRest=__webpack_require__(613);module.exports=function(arr,i){return arrayWithHoles(arr)||iterableToArrayLimit(arr,i)||nonIterableRest()}},function(module,exports,__webpack_require__){var baseToString=__webpack_require__(207);module.exports=function(value){return null==value?"":baseToString(value)}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0,exports.default=function(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueryDefinition=exports.MutationTypes=exports.Mutations=exports.getDoctypeFromOperation=exports.uploadFile=exports.removeReferencedBy=exports.addReferencedBy=exports.removeReferencesTo=exports.addReferencesTo=exports.deleteDocument=exports.updateDocument=exports.createDocument=exports.Q=void 0;var _extends3=_interopRequireDefault(__webpack_require__(3)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isString=__webpack_require__(244),QueryDefinition=function(){function QueryDefinition(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},doctype=_ref.doctype,id=_ref.id,ids=_ref.ids,selector=_ref.selector,fields=_ref.fields,indexedFields=_ref.indexedFields,sort=_ref.sort,includes=_ref.includes,referenced=_ref.referenced,limit=_ref.limit,skip=_ref.skip,cursor=_ref.cursor;(0,_classCallCheck3.default)(this,QueryDefinition),this.doctype=doctype,this.id=id,this.ids=ids,this.selector=selector,this.fields=fields,this.indexedFields=indexedFields,this.sort=sort,this.includes=includes,this.referenced=referenced,this.limit=limit,this.skip=skip,this.cursor=cursor}return(0,_createClass3.default)(QueryDefinition,[{key:"getById",value:function(id){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{id:id}))}},{key:"getByIds",value:function(ids){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{ids:ids}))}},{key:"where",value:function(selector){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{selector:selector}))}},{key:"select",value:function(fields){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{fields:fields}))}},{key:"indexFields",value:function(indexedFields){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{indexedFields:indexedFields}))}},{key:"sortBy",value:function(sort){if(isString(sort))throw new Error('Invalid sort, should be an object (`{ label: "desc"}`), you passed a string.');return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{sort:sort}))}},{key:"include",value:function(includes){if(!Array.isArray(includes))throw new Error("include() takes an array of relationship names");return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{includes:includes}))}},{key:"limitBy",value:function(limit){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{limit:limit}))}},{key:"UNSAFE_noLimit",value:function(){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{limit:null}))}},{key:"offset",value:function(skip){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{skip:skip}))}},{key:"offsetCursor",value:function(cursor){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{cursor:cursor}))}},{key:"referencedBy",value:function(document){return new QueryDefinition((0,_extends3.default)({},this.toDefinition(),{referenced:document}))}},{key:"toDefinition",value:function(){return{doctype:this.doctype,id:this.id,ids:this.ids,selector:this.selector,fields:this.fields,indexedFields:this.indexedFields,sort:this.sort,includes:this.includes,referenced:this.referenced,limit:this.limit,skip:this.skip,cursor:this.cursor}}}]),QueryDefinition}(),createDocument=(exports.Q=function(doctype){return new QueryDefinition({doctype:doctype})},exports.createDocument=function(document){return{mutationType:MutationTypes.CREATE_DOCUMENT,document:document}}),updateDocument=exports.updateDocument=function(document){return{mutationType:MutationTypes.UPDATE_DOCUMENT,document:document}},deleteDocument=exports.deleteDocument=function(document){return{mutationType:MutationTypes.DELETE_DOCUMENT,document:document}},addReferencesTo=exports.addReferencesTo=function(document,referencedDocuments){return{mutationType:MutationTypes.ADD_REFERENCES_TO,referencedDocuments:referencedDocuments,document:document}},removeReferencesTo=exports.removeReferencesTo=function(document,referencedDocuments){return{mutationType:MutationTypes.REMOVE_REFERENCES_TO,referencedDocuments:referencedDocuments,document:document}},addReferencedBy=exports.addReferencedBy=function(document,referencedDocuments){return{mutationType:MutationTypes.ADD_REFERENCED_BY,referencedDocuments:referencedDocuments,document:document}},removeReferencedBy=exports.removeReferencedBy=function(document,referencedDocuments){return{mutationType:MutationTypes.REMOVE_REFERENCED_BY,referencedDocuments:referencedDocuments,document:document}},uploadFile=exports.uploadFile=function(file,dirPath){return{mutationType:MutationTypes.UPLOAD_FILE,file:file,dirPath:dirPath}},MutationTypes=(exports.getDoctypeFromOperation=function(operation){if(!operation.mutationType)return operation.doctype;var type=operation.mutationType;switch(type){case"CREATE_DOCUMENT":case"UPDATE_DOCUMENT":case"DELETE_DOCUMENT":return operation.document._type;case"ADD_REFERENCES_TO":case"UPLOAD_FILE":throw new Error("Not implemented");default:throw new Error("Unknown mutationType "+type)}},exports.Mutations={createDocument:createDocument,updateDocument:updateDocument,deleteDocument:deleteDocument,addReferencesTo:addReferencesTo,removeReferencesTo:removeReferencesTo,addReferencedBy:addReferencedBy,removeReferencedBy:removeReferencedBy,uploadFile:uploadFile},exports.MutationTypes={CREATE_DOCUMENT:"CREATE_DOCUMENT",UPDATE_DOCUMENT:"UPDATE_DOCUMENT",DELETE_DOCUMENT:"DELETE_DOCUMENT",ADD_REFERENCES_TO:"ADD_REFERENCES_TO",REMOVE_REFERENCES_TO:"REMOVE_REFERENCES_TO",ADD_REFERENCED_BY:"ADD_REFERENCED_BY",REMOVE_REFERENCED_BY:"REMOVE_REFERENCED_BY",UPLOAD_FILE:"UPLOAD_FILE"});exports.QueryDefinition=QueryDefinition},function(module,exports){module.exports=function(func){return function(value){return func(value)}}},function(module,exports,__webpack_require__){var baseFlatten=__webpack_require__(114);module.exports=function(array){return null!=array&&array.length?baseFlatten(array,1):[]}},function(module,exports,__webpack_require__){var arrayWithoutHoles=__webpack_require__(557),iterableToArray=__webpack_require__(558),nonIterableSpread=__webpack_require__(559);module.exports=function(arr){return arrayWithoutHoles(arr)||iterableToArray(arr)||nonIterableSpread()}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(74),isObjectLike=__webpack_require__(29),symbolTag="[object Symbol]";module.exports=function(value){return"symbol"==typeof value||isObjectLike(value)&&baseGetTag(value)==symbolTag}},function(module,exports,__webpack_require__){var isSymbol=__webpack_require__(91),INFINITY=1/0;module.exports=function(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}},function(module,exports){module.exports=function(pairs){for(var index=-1,length=null==pairs?0:pairs.length,result={};++index<length;){var pair=pairs[index];result[pair[0]]=pair[1]}return result}},function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(98),keyBy=__webpack_require__(325)(function(result,value,key){baseAssignValue(result,key,value)});module.exports=keyBy},function(module,exports,__webpack_require__){var baseIteratee=__webpack_require__(18),baseSum=__webpack_require__(608);module.exports=function(array,iteratee){return array&&array.length?baseSum(array,baseIteratee(iteratee,2)):0}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _iterator2=_interopRequireDefault(__webpack_require__(635)),_symbol2=_interopRequireDefault(__webpack_require__(639)),_typeof="function"==typeof _symbol2.default&&"symbol"==typeof _iterator2.default?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof _symbol2.default&&obj.constructor===_symbol2.default&&obj!==_symbol2.default.prototype?"symbol":typeof obj};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default="function"==typeof _symbol2.default&&"symbol"===_typeof(_iterator2.default)?function(obj){return void 0===obj?"undefined":_typeof(obj)}:function(obj){return obj&&"function"==typeof _symbol2.default&&obj.constructor===_symbol2.default&&obj!==_symbol2.default.prototype?"symbol":void 0===obj?"undefined":_typeof(obj)}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(31).Symbol;module.exports=Symbol},function(module,exports,__webpack_require__){var defineProperty=__webpack_require__(293);module.exports=function(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}},function(module,exports){module.exports=function(value){return value}},function(module,exports,__webpack_require__){var isArray=__webpack_require__(12),isKey=__webpack_require__(206),stringToPath=__webpack_require__(430),toString=__webpack_require__(85);module.exports=function(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}},function(module,exports){module.exports={}},function(module,exports,__webpack_require__){var $keys=__webpack_require__(333),enumBugKeys=__webpack_require__(223);module.exports=Object.keys||function(O){return $keys(O,enumBugKeys)}},function(module,exports,__webpack_require__){__webpack_require__(637);for(var global=__webpack_require__(19),hide=__webpack_require__(64),Iterators=__webpack_require__(101),TO_STRING_TAG=__webpack_require__(20)("toStringTag"),DOMIterables="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),i=0;i<DOMIterables.length;i++){var NAME=DOMIterables[i],Collection=global[NAME],proto=Collection&&Collection.prototype;proto&&!proto[TO_STRING_TAG]&&hide(proto,TO_STRING_TAG,NAME),Iterators[NAME]=Iterators.Array}},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Association=function(){function Association(target,name,doctype,options){(0,_classCallCheck3.default)(this,Association);var dispatch=options.dispatch,get=options.get,query=options.query,mutate=options.mutate,save=options.save;this.target=target,this.name=name,this.doctype=doctype,this.get=get,this.query=query,this.mutate=mutate,this.save=save,this.dispatch=dispatch}return(0,_createClass3.default)(Association,[{key:"raw",get:function(){throw new Error("A relationship must define its raw getter")}},{key:"data",get:function(){throw new Error("A relationship must define its data getter")}}],[{key:"query",value:function(){throw new Error("A custom relationship must define its query() function")}}]),Association}();exports.default=Association},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _defineProperties2=_interopRequireDefault(__webpack_require__(710)),_freeze2=_interopRequireDefault(__webpack_require__(713));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(strings,raw){return(0,_freeze2.default)((0,_defineProperties2.default)(strings,{raw:{value:(0,_freeze2.default)(raw)}}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.forceFileDownload=exports.slugify=exports.sleep=exports.attempt=exports.uri=void 0;var obj,_promise=__webpack_require__(67),_promise2=(obj=_promise)&&obj.__esModule?obj:{default:obj};exports.uri=function(strings){for(var _len=arguments.length,values=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)values[_key-1]=arguments[_key];for(var parts=[strings[0]],i=0;i<values.length;i++)parts.push(encodeURIComponent(values[i])+strings[i+1]);return parts.join("")},exports.attempt=function(promise){return promise.then(function(){return!0}).catch(function(){return!1})},exports.sleep=function(time,args){return new _promise2.default(function(resolve){setTimeout(resolve,time,args)})},exports.slugify=function(text){return text.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},exports.forceFileDownload=function(href,filename){var element=document.createElement("a");element.setAttribute("href",href),element.setAttribute("download",filename),element.style.display="none",document.body.appendChild(element),element.click(),document.body.removeChild(element)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"getParent",function(){return getParent}),__webpack_require__.d(__webpack_exports__,"getTransactionsByCategory",function(){return getTransactionsByCategory}),__webpack_require__.d(__webpack_exports__,"getCategoryId",function(){return getCategoryId}),__webpack_require__.d(__webpack_exports__,"getParentCategory",function(){return getParentCategory}),__webpack_require__.d(__webpack_exports__,"isAwaitingCategorization",function(){return isAwaitingCategorization}),__webpack_require__.d(__webpack_exports__,"isHealthExpense",function(){return isHealthExpense}),__webpack_require__.d(__webpack_exports__,"isHealth",function(){return isHealth}),__webpack_require__.d(__webpack_exports__,"getTransactionsTotal",function(){return getTransactionsTotal}),__webpack_require__.d(__webpack_exports__,"getGlobalCurrency",function(){return getGlobalCurrency});var _babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(17),_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0__),cozy_flags__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(58),cozy_flags__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(cozy_flags__WEBPACK_IMPORTED_MODULE_1__),ducks_categories_categoriesMap__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(47),ducks_categories_tree__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(25),cozy_doctypes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(41);__webpack_require__.d(__webpack_exports__,"getCategoryIdFromName",function(){return ducks_categories_categoriesMap__WEBPACK_IMPORTED_MODULE_2__.c});var getParent=ducks_categories_categoriesMap__WEBPACK_IMPORTED_MODULE_2__.b.get.bind(ducks_categories_categoriesMap__WEBPACK_IMPORTED_MODULE_2__.b),makeCategory=function(parent){return{id:parent.id,name:parent.name,color:parent.color,transactions:[],subcategories:{}}},makeSubcategory=function(catId){return{id:catId,name:ducks_categories_tree__WEBPACK_IMPORTED_MODULE_3__[catId],transactions:[]}},getTransactionsByCategory=function(transactions){for(var categories={},_i=0,_Object$keys=Object.keys(ducks_categories_categoriesMap__WEBPACK_IMPORTED_MODULE_2__.a);_i<_Object$keys.length;_i++){var catName=_Object$keys[_i],category=_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0___default()({name:catName},ducks_categories_categoriesMap__WEBPACK_IMPORTED_MODULE_2__.a[catName]);categories[catName]=makeCategory(category)}var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=transactions[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var transaction=_step.value;if(!isAwaitingCategorization(transaction)){var catId=getCategoryId(transaction),parent=getParent(catId)||getParent("0");categories.hasOwnProperty(parent.name)||(categories[parent.name]=makeCategory(parent));var _category=categories[parent.name];_category.subcategories.hasOwnProperty(catId)||(_category.subcategories[catId]=makeSubcategory(catId));var subcategory=_category.subcategories[catId];_category.transactions.push(transaction),subcategory.transactions.push(transaction)}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return categories},getCategoryId=function(transaction){var localModelOverride=cozy_flags__WEBPACK_IMPORTED_MODULE_1___default()("local-model-override");return cozy_doctypes__WEBPACK_IMPORTED_MODULE_4__.BankTransaction.getCategoryId(transaction,{localModelOverride:localModelOverride})},getParentCategory=function(transaction){return getParent(getCategoryId(transaction))},isAwaitingCategorization=function(transaction){return null===getCategoryId(transaction)},isHealthExpense=function(transaction){return"400610"===getCategoryId(transaction)&&transaction.amount<0},isHealth=function(transaction){var categoryId=getCategoryId(transaction);return"400600"===categoryId||"400610"===categoryId||"400620"===categoryId},subCategorySort=function(a,b){return b.percentage!==a.percentage?b.percentage-a.percentage:a.amount-b.amount},getTransactionsTotal=function(categories){var transactionsTotal=0;if(0!==categories.length){var absoluteTransactionsTotal=categories.reduce(function(total,category){return total+Math.abs(category.amount)},0),_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=categories[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var category=_step2.value;category.percentage=Math.round(Math.abs(category.amount)/absoluteTransactionsTotal*100);var absoluteSubcategoriesTotal=category.subcategories.reduce(function(total,category){return total+Math.abs(category.amount)},0),_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=category.subcategories[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var subcategory=_step3.value;subcategory.percentage=0===absoluteSubcategoriesTotal?100:Math.round(Math.abs(subcategory.amount)/absoluteSubcategoriesTotal*100)}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{_iteratorNormalCompletion3||null==_iterator3.return||_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}category.subcategories=category.subcategories.sort(subCategorySort),transactionsTotal+=category.amount}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}return transactionsTotal},getGlobalCurrency=function(categories){var currency;return categories.length>0&&(currency=categories[0].currency),currency||(currency=""),currency}},function(module,exports,__webpack_require__){var DataView=__webpack_require__(545),Map=__webpack_require__(200),Promise=__webpack_require__(546),Set=__webpack_require__(315),WeakMap=__webpack_require__(301),baseGetTag=__webpack_require__(74),toSource=__webpack_require__(294),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),getTag=baseGetTag;(DataView&&"[object DataView]"!=getTag(new DataView(new ArrayBuffer(1)))||Map&&"[object Map]"!=getTag(new Map)||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&"[object Set]"!=getTag(new Set)||WeakMap&&"[object WeakMap]"!=getTag(new WeakMap))&&(getTag=function(value){var result=baseGetTag(value),Ctor="[object Object]"==result?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return"[object DataView]";case mapCtorString:return"[object Map]";case promiseCtorString:return"[object Promise]";case setCtorString:return"[object Set]";case weakMapCtorString:return"[object WeakMap]"}return result}),module.exports=getTag},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(35),baseClone=__webpack_require__(398),baseUnset=__webpack_require__(601),castPath=__webpack_require__(100),copyObject=__webpack_require__(78),customOmitClone=__webpack_require__(603),flatRest=__webpack_require__(170),getAllKeysIn=__webpack_require__(211),omit=flatRest(function(object,paths){var result={};if(null==object)return result;var isDeep=!1;paths=arrayMap(paths,function(path){return path=castPath(path,object),isDeep||(isDeep=path.length>1),path}),copyObject(object,getAllKeysIn(object),result),isDeep&&(result=baseClone(result,7,customOmitClone));for(var length=paths.length;length--;)baseUnset(result,paths[length]);return result});module.exports=omit},function(module,exports){module.exports=require("https")},function(module,exports){module.exports=function(value,other){return value===other||value!=value&&other!=other}},,function(module,exports,__webpack_require__){var arrayPush=__webpack_require__(185),isFlattenable=__webpack_require__(554);module.exports=function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate||(predicate=isFlattenable),result||(result=[]);++index<length;){var value=array[index];depth>0&&predicate(value)?depth>1?baseFlatten(value,depth-1,predicate,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(74),isObject=__webpack_require__(26),asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";module.exports=function(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}},function(module,exports,__webpack_require__){(function(module){var root=__webpack_require__(31),stubFalse=__webpack_require__(493),freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,isBuffer=(Buffer?Buffer.isBuffer:void 0)||stubFalse;module.exports=isBuffer}).call(this,__webpack_require__(59)(module))},function(module,exports,__webpack_require__){var arrayLikeKeys=__webpack_require__(297),baseKeysIn=__webpack_require__(496),isArrayLike=__webpack_require__(55);module.exports=function(object){return isArrayLike(object)?arrayLikeKeys(object,!0):baseKeysIn(object)}},function(module,exports,__webpack_require__){var isArrayLike=__webpack_require__(55),isObjectLike=__webpack_require__(29);module.exports=function(value){return isObjectLike(value)&&isArrayLike(value)}},function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(98),baseForOwn=__webpack_require__(199),baseIteratee=__webpack_require__(18);module.exports=function(object,iteratee){var result={};return iteratee=baseIteratee(iteratee,3),baseForOwn(object,function(value,key,object){baseAssignValue(result,key,iteratee(value,key,object))}),result}},function(module,exports){module.exports=!0},function(module,exports){module.exports=function(it){if("function"!=typeof it)throw TypeError(it+" is not a function!");return it}},function(module,exports){module.exports=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}}},function(module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},function(module,exports,__webpack_require__){var def=__webpack_require__(38).f,has=__webpack_require__(81),TAG=__webpack_require__(20)("toStringTag");module.exports=function(it,tag,stat){it&&!has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})}},function(module,exports){exports.f={}.propertyIsEnumerable},function(module,exports,__webpack_require__){var ctx=__webpack_require__(51),call=__webpack_require__(336),isArrayIter=__webpack_require__(337),anObject=__webpack_require__(45),toLength=__webpack_require__(157),getIterFn=__webpack_require__(224),BREAK={},RETURN={};(exports=module.exports=function(iterable,entries,fn,that,ITERATOR){var length,step,iterator,result,iterFn=ITERATOR?function(){return iterable}:getIterFn(iterable),f=ctx(fn,that,entries?2:1),index=0;if("function"!=typeof iterFn)throw TypeError(iterable+" is not iterable!");if(isArrayIter(iterFn)){for(length=toLength(iterable.length);length>index;index++)if((result=entries?f(anObject(step=iterable[index])[0],step[1]):f(iterable[index]))===BREAK||result===RETURN)return result}else for(iterator=iterFn.call(iterable);!(step=iterator.next()).done;)if((result=call(iterator,f,step.value,entries))===BREAK||result===RETURN)return result}).BREAK=BREAK,exports.RETURN=RETURN},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(690),__esModule:!0}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.receiveMutationError=exports.receiveMutationResult=exports.initMutation=exports.receiveQueryError=exports.receiveQueryResult=exports.initQuery=exports.getRawQueryFromState=exports.getQueryFromState=exports.getQueryFromStore=exports.getDocumentFromState=exports.getCollectionFromState=exports.getStateRoot=exports.createStore=exports.StoreProxy=void 0;var _defineProperty3=_interopRequireDefault(__webpack_require__(46)),_extends5=_interopRequireDefault(__webpack_require__(3)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_queries=__webpack_require__(361);Object.defineProperty(exports,"initQuery",{enumerable:!0,get:function(){return _queries.initQuery}}),Object.defineProperty(exports,"receiveQueryResult",{enumerable:!0,get:function(){return _queries.receiveQueryResult}}),Object.defineProperty(exports,"receiveQueryError",{enumerable:!0,get:function(){return _queries.receiveQueryError}});var _mutations=__webpack_require__(233);Object.defineProperty(exports,"initMutation",{enumerable:!0,get:function(){return _mutations.initMutation}}),Object.defineProperty(exports,"receiveMutationResult",{enumerable:!0,get:function(){return _mutations.receiveMutationResult}}),Object.defineProperty(exports,"receiveMutationError",{enumerable:!0,get:function(){return _mutations.receiveMutationError}});var _redux=__webpack_require__(768),_reduxThunk2=_interopRequireDefault(__webpack_require__(698)),_documents=__webpack_require__(364),_documents2=_interopRequireDefault(_documents),_queries2=_interopRequireDefault(_queries);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StoreProxy=exports.StoreProxy=function(){function StoreProxy(state){(0,_classCallCheck3.default)(this,StoreProxy),this.state=state}return(0,_createClass3.default)(StoreProxy,[{key:"readDocument",value:function(doctype,id){return this.state.documents[doctype][id]}},{key:"writeDocument",value:function(document){this.setState(function(state){return(0,_extends5.default)({},state,{documents:(0,_extends5.default)({},state.documents,(0,_defineProperty3.default)({},document._type,(0,_extends5.default)({},state.documents[document._type],(0,_defineProperty3.default)({},document._id,document))))})})}},{key:"setState",value:function(updaterFn){this.state=updaterFn(this.state)}},{key:"getState",value:function(){return this.state}}]),StoreProxy}(),combinedReducer=function(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{documents:{},queries:{}},action=arguments[1];if(!(0,_queries.isQueryAction)(action)&&!(0,_mutations.isMutationAction)(action))return state;if(action.update){var proxy=new StoreProxy(state);return action.update(proxy,action.response),{documents:proxy.getState().documents,queries:(0,_queries2.default)(proxy.getState().queries,action,proxy.getState().documents)}}var nextDocuments=(0,_documents2.default)(state.documents,action),haveDocumentsChanged=nextDocuments!==state.documents;return{documents:nextDocuments,queries:(0,_queries2.default)(state.queries,action,nextDocuments,haveDocumentsChanged)}};exports.default=combinedReducer;exports.createStore=function(){return(0,_redux.createStore)((0,_redux.combineReducers)({cozy:combinedReducer}),(0,_redux.applyMiddleware)(_reduxThunk2.default))};var getStateRoot=exports.getStateRoot=function(state){return state.cozy||{}},getQueryFromState=(exports.getCollectionFromState=function(state,doctype){return(0,_documents.getCollectionFromSlice)(getStateRoot(state).documents,doctype)},exports.getDocumentFromState=function(state,doctype,id){return(0,_documents.getDocumentFromSlice)(getStateRoot(state).documents,doctype,id)},exports.getQueryFromStore=function(store,queryId){return getQueryFromState(store.getState(),queryId)},exports.getQueryFromState=function(state,queryId){return(0,_queries.getQueryFromSlice)(getStateRoot(state).queries,queryId,getStateRoot(state).documents)});exports.getRawQueryFromState=function(state,queryId){return(0,_queries.getQueryFromSlice)(getStateRoot(state).queries,queryId)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return getLabel}),__webpack_require__.d(__webpack_exports__,"a",function(){return getDate}),__webpack_require__.d(__webpack_exports__,"c",function(){return getReimbursedAmount}),__webpack_require__.d(__webpack_exports__,"f",function(){return isNew}),__webpack_require__.d(__webpack_exports__,"g",function(){return isReimbursementLate}),__webpack_require__.d(__webpack_exports__,"d",function(){return hasPendingReimbursement}),__webpack_require__.d(__webpack_exports__,"e",function(){return isAlreadyNotified});__webpack_require__(0),__webpack_require__(17),__webpack_require__(4),__webpack_require__(382),__webpack_require__(771);var lodash_get__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(10),lodash_get__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(lodash_get__WEBPACK_IMPORTED_MODULE_5__),lodash_sumBy__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(95),lodash_sumBy__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(lodash_sumBy__WEBPACK_IMPORTED_MODULE_6__),cozy_flags__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(58),cozy_flags__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(cozy_flags__WEBPACK_IMPORTED_MODULE_7__),date_fns_parse__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(36),date_fns_parse__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(date_fns_parse__WEBPACK_IMPORTED_MODULE_8__),date_fns_difference_in_days__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(406),date_fns_difference_in_days__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(date_fns_difference_in_days__WEBPACK_IMPORTED_MODULE_9__),ducks_categories_helpers__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(108),prevRecurRx=/\bPRLV SEPA RECU RCUR\b/,longNumber=/\b\d{5,}\b/g,notWord=/\b[A-Z]*\d+[A-Z]*\b/g,tooLong=/\b[A-Z\d]{15,}\b/g,punctuations=/[-:++]/g,spaces=/\s+/g,cleanLabel=cozy_flags__WEBPACK_IMPORTED_MODULE_7___default()("transactions.clean-label")?function(label){return label.replace(prevRecurRx," ").replace(longNumber," ").replace(notWord,"").replace(punctuations,"").replace(tooLong,"").replace(spaces," ").trim()}:function(x){return x},titleRx=/(?:^|\s)\S/g,getLabel=function(transaction){return cleanLabel(transaction.label.toLowerCase().replace(titleRx,function(a){return a.toUpperCase()}))},getDisplayDate=function(transaction){return"CreditCard"===getAccountType(transaction)&&transaction.realisationDate?transaction.realisationDate:transaction.date},getDate=function(transaction){return getDisplayDate(transaction).slice(0,10)},getAccountType=function(transaction){return lodash_get__WEBPACK_IMPORTED_MODULE_5___default()(transaction,"account.data.type")},getReimbursements=function(transaction){return lodash_get__WEBPACK_IMPORTED_MODULE_5___default()(transaction,"reimbursements.data")},REIMBURSEMENTS_STATUS_pending="pending",REIMBURSEMENTS_STATUS_reimbursed="reimbursed",getReimbursedAmount=function(expense){if(!(expense.amount<0))throw new Error("Can't get the reimbursed amount of a debit transaction");if(!function(transaction){var reimbursements=getReimbursements(transaction);return!!reimbursements&&reimbursements.length>0}(expense))return 0;var reimbursements=getReimbursements(expense);return lodash_sumBy__WEBPACK_IMPORTED_MODULE_6___default()(reimbursements,function(r){return r.amount})},isNew=function(transaction){return parseInt(transaction._rev.split("-").shift(),10)<=2},getReimbursementStatus=function(transaction){return Object(ducks_categories_helpers__WEBPACK_IMPORTED_MODULE_10__.isHealthExpense)(transaction)?getHealthExpenseReimbursementStatus(transaction):transaction.reimbursementStatus||"no-reimbursement"},getHealthExpenseReimbursementStatus=function(transaction){return transaction.reimbursementStatus?transaction.reimbursementStatus:getReimbursedAmount(expense=transaction)===-expense.amount?REIMBURSEMENTS_STATUS_reimbursed:REIMBURSEMENTS_STATUS_pending;var expense},isReimbursementLate=function(transaction){if(!Object(ducks_categories_helpers__WEBPACK_IMPORTED_MODULE_10__.isHealthExpense)(transaction))return!1;if(getReimbursementStatus(transaction)!==REIMBURSEMENTS_STATUS_pending)return!1;var transactionDate=date_fns_parse__WEBPACK_IMPORTED_MODULE_8___default()(getDate(transaction)),today=new Date;return date_fns_difference_in_days__WEBPACK_IMPORTED_MODULE_9___default()(today,transactionDate)>cozy_flags__WEBPACK_IMPORTED_MODULE_7___default()("reimbursements.late-health-limit")},hasPendingReimbursement=function(transaction){return getReimbursementStatus(transaction)===REIMBURSEMENTS_STATUS_pending},isAlreadyNotified=function(transaction,notificationClass){return Boolean(lodash_get__WEBPACK_IMPORTED_MODULE_5___default()(transaction,"cozyMetadata.notifications.".concat(notificationClass.settingKey)))}},,,function(module,exports){var MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;module.exports=function(value,length){var type=typeof value;return!!(length=null==length?MAX_SAFE_INTEGER:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(26),objectCreate=Object.create,baseCreate=function(){function object(){}return function(proto){if(!isObject(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;var result=new object;return object.prototype=void 0,result}}();module.exports=baseCreate},function(module,exports,__webpack_require__){var baseForOwn=__webpack_require__(199),baseEach=__webpack_require__(508)(baseForOwn);module.exports=baseEach},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return getAccountLabel}),__webpack_require__.d(__webpack_exports__,"d",function(){return getAccountType}),__webpack_require__.d(__webpack_exports__,"b",function(){return getAccountBalance}),__webpack_require__.d(__webpack_exports__,"a",function(){return addOwnerToAccount});var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(90),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__),lodash_uniqBy__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(89),__webpack_require__(189)),lodash_uniqBy__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(lodash_uniqBy__WEBPACK_IMPORTED_MODULE_2__),lodash_set__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(252),lodash_set__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(lodash_set__WEBPACK_IMPORTED_MODULE_3__),lodash_get__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__(770),__webpack_require__(407),__webpack_require__(95),__webpack_require__(10)),lodash_get__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(lodash_get__WEBPACK_IMPORTED_MODULE_7__),doctypes__WEBPACK_IMPORTED_MODULE_14__=(__webpack_require__(129),__webpack_require__(108),__webpack_require__(772),__webpack_require__(261),__webpack_require__(58),__webpack_require__(41),__webpack_require__(43)),getAccountLabel=function(account){return account?account.shortLabel||account.label:""},accountTypesWithTranslation=["Business","Checkings","CreditCard","Joint","Loan","LongTermSavings","Other","Reimbursements","Savings"],getAccountType=function(account){var mappedType={Article83:"LongTermSavings",Asset:"Business",Bank:"Checkings",Capitalisation:"Business",Cash:"Checkings",ConsumerCredit:"Loan","Credit card":"CreditCard",Deposit:"Checkings",Liability:"Business",LifeInsurance:"LongTermSavings",Madelin:"LongTermSavings",Market:"LongTermSavings",Mortgage:"LongTermSavings",None:"Other",PEA:"LongTermSavings",PEE:"LongTermSavings",Perco:"LongTermSavings",Perp:"LongTermSavings",RevolvingCredit:"Loan",RSP:"LongTermSavings",Unkown:"Other"}[account.type]||account.type||"Other";return accountTypesWithTranslation.includes(mappedType)?mappedType:"Other"},getAccountBalance=function(account){return"CreditCard"===account.type&&account.comingBalance?account.comingBalance:account.balance},addOwnerToAccount=function(account,owner){var currentOwners=lodash_get__WEBPACK_IMPORTED_MODULE_7___default()(account,"relationships.owners.data",[]),newOwners=lodash_uniqBy__WEBPACK_IMPORTED_MODULE_2___default()([].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(currentOwners),[{_id:owner._id,_type:doctypes__WEBPACK_IMPORTED_MODULE_14__.c}]),function(o){return o._id});return lodash_set__WEBPACK_IMPORTED_MODULE_3___default()(account,"relationships.owners.data",newOwners),account}},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(35),baseIteratee=__webpack_require__(18),basePickBy=__webpack_require__(320),getAllKeysIn=__webpack_require__(211);module.exports=function(object,predicate){if(null==object)return{};var props=arrayMap(getAllKeysIn(object),function(prop){return[prop]});return predicate=baseIteratee(predicate),basePickBy(object,props,function(value,path){return predicate(value,path[0])})}},,function(module,exports){module.exports=function(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}},function(module,exports,__webpack_require__){var toFinite=__webpack_require__(419);module.exports=function(value){var result=toFinite(value),remainder=result%1;return result==result?remainder?result-remainder:result:0}},,,function(module,exports,__webpack_require__){var eq=__webpack_require__(112),isArrayLike=__webpack_require__(55),isIndex=__webpack_require__(132),isObject=__webpack_require__(26);module.exports=function(value,index,object){if(!isObject(object))return!1;var type=typeof index;return!!("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)&&eq(object[index],value)}},function(module,exports,__webpack_require__){var baseIsArguments=__webpack_require__(492),isObjectLike=__webpack_require__(29),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};module.exports=isArguments},function(module,exports,__webpack_require__){var baseIsTypedArray=__webpack_require__(494),baseUnary=__webpack_require__(88),nodeUtil=__webpack_require__(196),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;module.exports=isTypedArray},function(module,exports,__webpack_require__){var arrayEach=__webpack_require__(168),baseEach=__webpack_require__(134),castFunction=__webpack_require__(509),isArray=__webpack_require__(12);module.exports=function(collection,iteratee){return(isArray(collection)?arrayEach:baseEach)(collection,castFunction(iteratee))}},function(module,exports,__webpack_require__){var ListCache=__webpack_require__(147),stackClear=__webpack_require__(519),stackDelete=__webpack_require__(520),stackGet=__webpack_require__(521),stackHas=__webpack_require__(522),stackSet=__webpack_require__(523);function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet,module.exports=Stack},function(module,exports,__webpack_require__){var listCacheClear=__webpack_require__(514),listCacheDelete=__webpack_require__(515),listCacheGet=__webpack_require__(516),listCacheHas=__webpack_require__(517),listCacheSet=__webpack_require__(518);function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,module.exports=ListCache},function(module,exports,__webpack_require__){var eq=__webpack_require__(112);module.exports=function(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(77)(Object,"create");module.exports=nativeCreate},function(module,exports,__webpack_require__){var isKeyable=__webpack_require__(532);module.exports=function(map,key){var data=map.__data__;return isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map}},function(module,exports,__webpack_require__){var getPrototype=__webpack_require__(299)(Object.getPrototypeOf,Object);module.exports=getPrototype},function(module,exports,__webpack_require__){var MapCache=__webpack_require__(201),setCacheAdd=__webpack_require__(541),setCacheHas=__webpack_require__(542);function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,module.exports=SetCache},function(module,exports){module.exports=function(cache,key){return cache.has(key)}},function(module,exports,__webpack_require__){var castPath=__webpack_require__(100),toKey=__webpack_require__(92);module.exports=function(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}},function(module,exports,__webpack_require__){var SetCache=__webpack_require__(152),arrayIncludes=__webpack_require__(180),arrayIncludesWith=__webpack_require__(209),cacheHas=__webpack_require__(153),createSet=__webpack_require__(556),setToArray=__webpack_require__(203),LARGE_ARRAY_SIZE=200;module.exports=function(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=arrayIncludesWith;else if(length>=LARGE_ARRAY_SIZE){var set=iteratee?null:createSet(array);if(set)return setToArray(set);isCommon=!1,includes=cacheHas,seen=new SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,isCommon&&computed==computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(45),dPs=__webpack_require__(332),enumBugKeys=__webpack_require__(223),IE_PROTO=__webpack_require__(221)("IE_PROTO"),Empty=function(){},createDict=function(){var iframeDocument,iframe=__webpack_require__(218)("iframe"),i=enumBugKeys.length;for(iframe.style.display="none",__webpack_require__(334).appendChild(iframe),iframe.src="javascript:",(iframeDocument=iframe.contentWindow.document).open(),iframeDocument.write("<script>document.F=Object<\/script>"),iframeDocument.close(),createDict=iframeDocument.F;i--;)delete createDict.prototype[enumBugKeys[i]];return createDict()};module.exports=Object.create||function(O,Properties){var result;return null!==O?(Empty.prototype=anObject(O),result=new Empty,Empty.prototype=null,result[IE_PROTO]=O):result=createDict(),void 0===Properties?result:dPs(result,Properties)}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(215),min=Math.min;module.exports=function(it){return it>0?min(toInteger(it),9007199254740991):0}},function(module,exports){var id=0,px=Math.random();module.exports=function(key){return"Symbol(".concat(void 0===key?"":key,")_",(++id+px).toString(36))}},function(module,exports,__webpack_require__){var cof=__webpack_require__(123),TAG=__webpack_require__(20)("toStringTag"),ARG="Arguments"==cof(function(){return arguments}());module.exports=function(it){var O,T,B;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(T=function(it,key){try{return it[key]}catch(e){}}(O=Object(it),TAG))?T:ARG?cof(O):"Object"==(B=cof(O))&&"function"==typeof O.callee?"Arguments":B}},function(module,exports,__webpack_require__){var $export=__webpack_require__(14),core=__webpack_require__(9),fails=__webpack_require__(80);module.exports=function(KEY,exec){var fn=(core.Object||{})[KEY]||Object[KEY],exp={};exp[KEY]=exec(fn),$export($export.S+$export.F*fails(function(){fn(1)}),"Object",exp)}},function(module,exports,__webpack_require__){var META=__webpack_require__(158)("meta"),isObject=__webpack_require__(32),has=__webpack_require__(81),setDesc=__webpack_require__(38).f,id=0,isExtensible=Object.isExtensible||function(){return!0},FREEZE=!__webpack_require__(80)(function(){return isExtensible(Object.preventExtensions({}))}),setMeta=function(it){setDesc(it,META,{value:{i:"O"+ ++id,w:{}}})},meta=module.exports={KEY:META,NEED:!1,fastKey:function(it,create){if(!isObject(it))return"symbol"==typeof it?it:("string"==typeof it?"S":"P")+it;if(!has(it,META)){if(!isExtensible(it))return"F";if(!create)return"E";setMeta(it)}return it[META].i},getWeak:function(it,create){if(!has(it,META)){if(!isExtensible(it))return!0;if(!create)return!1;setMeta(it)}return it[META].w},onFreeze:function(it){return FREEZE&&meta.NEED&&isExtensible(it)&&!has(it,META)&&setMeta(it),it}}},function(module,exports){},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(665),__esModule:!0}},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _isIterable3=_interopRequireDefault(__webpack_require__(668)),_getIterator3=_interopRequireDefault(__webpack_require__(66));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(arr,i){if(Array.isArray(arr))return arr;if((0,_isIterable3.default)(Object(arr)))return function(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=(0,_getIterator3.default)(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(692),__esModule:!0}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _toConsumableArray3=_interopRequireDefault(__webpack_require__(70)),_defineProperty3=_interopRequireDefault(__webpack_require__(46)),_extends6=_interopRequireDefault(__webpack_require__(3)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_get2=_interopRequireDefault(__webpack_require__(10)),_Association3=_interopRequireDefault(__webpack_require__(105)),_dsl=__webpack_require__(87),_store=__webpack_require__(128);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HasMany=function(_Association){function HasMany(){var _ref,_temp,_this,_ret;(0,_classCallCheck3.default)(this,HasMany);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _temp=_this=(0,_possibleConstructorReturn3.default)(this,(_ref=HasMany.__proto__||(0,_getPrototypeOf2.default)(HasMany)).call.apply(_ref,[this].concat(args))),_this.updateRelationshipData=function(getUpdatedRelationshipData){return function(dispatch,getState){var previousRelationship=(0,_store.getDocumentFromState)(getState(),_this.target._type,_this.target._id);dispatch((0,_store.receiveQueryResult)(null,{data:(0,_extends6.default)({},previousRelationship,{relationships:(0,_extends6.default)({},previousRelationship.relationships,(0,_defineProperty3.default)({},_this.name,getUpdatedRelationshipData(previousRelationship.relationships[_this.name])))})}))}},_ret=_temp,(0,_possibleConstructorReturn3.default)(_this,_ret)}return(0,_inherits3.default)(HasMany,_Association),(0,_createClass3.default)(HasMany,[{key:"fetchMore",value:function(){throw"Not implemented"}},{key:"exists",value:function(document){return this.existsById(document._id)}},{key:"existsById",value:function(id){return void 0!==this.getRelationship().data.find(function(_ref2){var _id=_ref2._id;return id===_id})}},{key:"addById",value:function(ids){var _target$relationships,_this2=this;this.target.relationships||(this.target.relationships={}),this.target.relationships[this.name]||(this.target.relationships[this.name]={data:[]});var newRelations=(ids=Array.isArray(ids)?ids:[ids]).filter(function(id){return!_this2.existsById(id)}).map(function(id){return{_id:id,_type:_this2.doctype}});return(_target$relationships=this.target.relationships[this.name].data).push.apply(_target$relationships,(0,_toConsumableArray3.default)(newRelations)),this.updateMetaCount(),this.save(this.target)}},{key:"removeById",value:function(ids){return ids=Array.isArray(ids)?ids:[ids],this.target.relationships[this.name].data=this.target.relationships[this.name].data.filter(function(_ref3){var _id=_ref3._id;return!ids.includes(_id)}),this.updateMetaCount(),this.save(this.target)}},{key:"updateMetaCount",value:function(){void 0!==(0,_get2.default)(this.target.relationships[this.name],"meta.count")&&(this.target.relationships[this.name].meta=(0,_extends6.default)({},this.target.relationships[this.name].meta,{count:this.target.relationships[this.name].data.length}))}},{key:"getRelationship",value:function(){var rawData=this.target[this.name],relationship=(0,_get2.default)(this.target,"relationships."+this.name);return relationship||(rawData&&rawData.length&&console.warn("You're trying to access data on a relationship that appear to not be loaded yet. You may want to use 'include()' on your query"),{data:[],next:!0,meta:{count:0}})}},{key:"updateTargetRelationship",value:function(store,updateFn){var prevTarget=store.readDocument(this.target._type,this.target._id);store.writeDocument(this.updateRelationship(prevTarget,updateFn))}},{key:"updateRelationship",value:function(target,updateFn){return(0,_extends6.default)({},target,{relationships:(0,_extends6.default)({},target.relationships,(0,_defineProperty3.default)({},this.name,(0,_extends6.default)({},target.relationships[this.name],updateFn(target.relationships[this.name]))))})}},{key:"dehydrate",value:function(doc){return(0,_extends6.default)({},doc,{relationships:(0,_extends6.default)({},doc.relationships,(0,_defineProperty3.default)({},this.name,{data:this.raw}))})}},{key:"raw",get:function(){return this.getRelationship().data}},{key:"data",get:function(){var _this3=this;return this.getRelationship().data.map(function(_ref4){var _id=_ref4._id,_type=_ref4._type;return _this3.get(_type,_id)})}},{key:"hasMore",get:function(){return this.getRelationship().next}},{key:"count",get:function(){var relationship=this.getRelationship();return relationship.meta?relationship.meta.count:relationship.data.length}}],[{key:"query",value:function(document,client,assoc){var ids=(0,_get2.default)(document,"relationships."+assoc.name+".data",[]).map(function(assoc){return assoc._id});return new _dsl.QueryDefinition({doctype:assoc.doctype,ids:ids})}}]),HasMany}(_Association3.default);exports.default=HasMany},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_getOwnPropertyDescriptor2=_interopRequireDefault(__webpack_require__(699));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=(0,_getOwnPropertyDescriptor2.default)(object,property);if(void 0===desc){var parent=(0,_getPrototypeOf2.default)(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;return void 0!==getter?getter.call(receiver):void 0}},function(module,exports){module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array}},function(module,exports,__webpack_require__){var basePick=__webpack_require__(555),pick=__webpack_require__(170)(function(object,paths){return null==object?{}:basePick(object,paths)});module.exports=pick},function(module,exports,__webpack_require__){var flatten=__webpack_require__(89),overRest=__webpack_require__(296),setToString=__webpack_require__(258);module.exports=function(func){return setToString(overRest(func,void 0,flatten),func+"")}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HasManyTriggers=exports.HasManyInPlace=exports.HasOneInPlace=exports.HasOne=exports.HasMany=exports.HasManyFiles=exports.Association=exports.create=exports.resolveClass=void 0;var _helpers=__webpack_require__(358);Object.defineProperty(exports,"resolveClass",{enumerable:!0,get:function(){return _helpers.resolveClass}}),Object.defineProperty(exports,"create",{enumerable:!0,get:function(){return _helpers.create}});var _HasManyFiles2=_interopRequireDefault(__webpack_require__(367)),_HasMany2=_interopRequireDefault(__webpack_require__(166)),_HasOne2=_interopRequireDefault(__webpack_require__(359)),_HasOneInPlace2=_interopRequireDefault(__webpack_require__(360)),_HasManyInPlace2=_interopRequireDefault(__webpack_require__(366)),_HasManyTriggers2=_interopRequireDefault(__webpack_require__(702)),_Association2=_interopRequireDefault(__webpack_require__(105));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.Association=_Association2.default,exports.HasManyFiles=_HasManyFiles2.default,exports.HasMany=_HasMany2.default,exports.HasOne=_HasOne2.default,exports.HasOneInPlace=_HasOneInPlace2.default,exports.HasManyInPlace=_HasManyInPlace2.default,exports.HasManyTriggers=_HasManyTriggers2.default},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return DOCTYPE}),__webpack_require__.d(__webpack_exports__,"a",function(){return DEFAULTS_SETTINGS});var DOCTYPE="io.cozy.bank.settings",DEFAULTS_SETTINGS={_type:"io.cozy.bank.settings",autogroups:{processedAccounts:[]},linkMyselfToAccounts:{processedAccounts:[]},notifications:{lastSeq:0,balanceLower:{value:100,enabled:!1},transactionGreater:{value:600,enabled:!0},healthBillLinked:{enabled:!0},lateHealthReimbursement:{value:30,enabled:!1},delayedDebit:{enabled:!1,value:2},salaire:{enabled:!1},hebdo:{enabled:!1},mensuel:{enabled:!1}},categoryBudgetAlerts:[],billsMatching:{billsLastSeq:"0",transactionsLastSeq:"0"},appSuggestions:{lastSeq:0},community:{localModelOverride:{enabled:!0}},categorization:{lastSeq:0},showIncomeCategory:!0}},function(module,exports,__webpack_require__){var baseUniq=__webpack_require__(155);module.exports=function(array){return array&&array.length?baseUniq(array):[]}},,,,,function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(98),eq=__webpack_require__(112),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(void 0!==value||key in object)||baseAssignValue(object,key,value)}},function(module,exports){var objectProto=Object.prototype;module.exports=function(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}},function(module,exports,__webpack_require__){var baseIndexOf=__webpack_require__(259);module.exports=function(array,value){return!(null==array||!array.length)&&baseIndexOf(array,value,0)>-1}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(753)()},,function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(74),getPrototype=__webpack_require__(151),isObjectLike=__webpack_require__(29),objectTag="[object Object]",funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object);module.exports=function(value){if(!isObjectLike(value)||baseGetTag(value)!=objectTag)return!1;var proto=getPrototype(value);if(null===proto)return!0;var Ctor=hasOwnProperty.call(proto,"constructor")&&proto.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString}},function(module,exports,__webpack_require__){var baseIsEqualDeep=__webpack_require__(540),isObjectLike=__webpack_require__(29);module.exports=function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!=value&&other!=other:baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack))}},function(module,exports){module.exports=function(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}},,,,function(module,exports,__webpack_require__){var baseIteratee=__webpack_require__(18),baseUniq=__webpack_require__(155);module.exports=function(array,iteratee){return array&&array.length?baseUniq(array,baseIteratee(iteratee,2)):[]}},function(module,exports){module.exports=require("querystring")},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(35),baseIteratee=__webpack_require__(18),baseMap=__webpack_require__(322),isArray=__webpack_require__(12);module.exports=function(collection,iteratee){return(isArray(collection)?arrayMap:baseMap)(collection,baseIteratee(iteratee,3))}},function(module,exports,__webpack_require__){var baseMerge=__webpack_require__(513),merge=__webpack_require__(295)(function(object,source,srcIndex){baseMerge(object,source,srcIndex)});module.exports=merge},,,function(module,exports){var MAX_SAFE_INTEGER=9007199254740991;module.exports=function(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}},function(module,exports,__webpack_require__){(function(module){var freeGlobal=__webpack_require__(281),freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,freeProcess=freeModule&&freeModule.exports===freeExports&&freeGlobal.process,nodeUtil=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();module.exports=nodeUtil}).call(this,__webpack_require__(59)(module))},function(module,exports,__webpack_require__){var baseCreate=__webpack_require__(133),baseLodash=__webpack_require__(198),MAX_ARRAY_LENGTH=4294967295;function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=MAX_ARRAY_LENGTH,this.__views__=[]}LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,module.exports=LazyWrapper},function(module,exports){module.exports=function(){}},function(module,exports,__webpack_require__){var baseFor=__webpack_require__(303),keys=__webpack_require__(69);module.exports=function(object,iteratee){return object&&baseFor(object,iteratee,keys)}},function(module,exports,__webpack_require__){var Map=__webpack_require__(77)(__webpack_require__(31),"Map");module.exports=Map},function(module,exports,__webpack_require__){var mapCacheClear=__webpack_require__(524),mapCacheDelete=__webpack_require__(531),mapCacheGet=__webpack_require__(533),mapCacheHas=__webpack_require__(534),mapCacheSet=__webpack_require__(535);function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,module.exports=MapCache},function(module,exports,__webpack_require__){var Uint8Array=__webpack_require__(308);module.exports=function(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);return new Uint8Array(result).set(new Uint8Array(arrayBuffer)),result}},function(module,exports){module.exports=function(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=value}),result}},function(module,exports,__webpack_require__){var arrayFilter=__webpack_require__(205),stubArray=__webpack_require__(314),propertyIsEnumerable=Object.prototype.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),arrayFilter(nativeGetSymbols(object),function(symbol){return propertyIsEnumerable.call(object,symbol)}))}:stubArray;module.exports=getSymbols},function(module,exports){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}},function(module,exports,__webpack_require__){var isArray=__webpack_require__(12),isSymbol=__webpack_require__(91),reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;module.exports=function(value,object){if(isArray(value))return!1;var type=typeof value;return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object)}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(97),arrayMap=__webpack_require__(35),isArray=__webpack_require__(12),isSymbol=__webpack_require__(91),INFINITY=1/0,symbolProto=Symbol?Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;module.exports=function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}},function(module,exports){module.exports=function(key){return function(object){return null==object?void 0:object[key]}}},function(module,exports){module.exports=function(array,value,comparator){for(var index=-1,length=null==array?0:array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1}},function(module){module.exports=JSON.parse('[["0","\\u0000",127,""],["8140","",5,"",9,"",6,""],["8180","",6,"",4,"",4,"",5,""],["8240","",4,"",8,"",4,"",11],["8280","",10,"",4,"",7,"",5,"",8,"",20,"",4,"",6,""],["8340","",17,"",5,"",10,"",4,"",9,""],["8380","",5,"",13,"",28,"",4,"",4,"",5],["8440","",5,"",5,""],["8480","",9,"",4,"",6,"",6,"",9,"",5,"",10,"",7,""],["8540","",9,""],["8580","",4,"",6,"",4,"",4,"",7,""],["8640","",4,"",5,"",4,"",5,""],["8680","",4,"",4,"",5,"",6,"",8,"",4,"",4,"",4,""],["8740","",7,"",11,"",4,"",4],["8780","",7,"",6,"",14,"",10,"",6,"",12,"",8,"",5,"",6],["8840","",9,"",4,"",4,""],["8880","",4,"",6,"",8,"",6,"",7,"",4,"",4,"",7],["8940","",5,"",6,"",4,"",5,"",4,"",16,""],["8980","",4,"",4,"",7,"",17,"",10,"",13,"",5,"",7,"",4,""],["8a40","",4,"",12,""],["8a80","",5,"",6,"",4,"",11,"",6,"",4,"",4,"",9,"",5],["8b40","",8,"",17,"",6,"",13,""],["8b80","",4,"",4,"",5,"",4,"",4,"",22,"",11,"",25,"",7,"",6],["8c40","",7,""],["8c80","",8,"",4,"",6,"",6,"",6,"",4,"",4,"",4],["8d40","",5,"",5,"",5,"",6,"",9,"",4],["8d80","",5,"",4,"",4,"",4,"",7,"",7,"",10,"",10,"",12,"",21,""],["8e40","",21,"",12,"",6,"",12,""],["8e80","",4,"",7,"",4,"",4,"",5,"",6,"",4,"",14,"",4,"",4,"",6],["8f40","",5,"",11,"",8,""],["8f80","",6,"",14,"",5,"",5,"",4,""],["9040","",4,"",4,"",6,""],["9080","",7,"",4,"",4,"",4,"",4,"",18,"",6],["9140","",6,"",6,"",18,"",4,""],["9180","",6,"",8,"",9,"",5,"",4,"",4,"",16,"",13,"",8,"",5,"",4,""],["9240","",6,"",5,""],["9280","",5,"",7,"",6,""],["9340","",6,"",4,"",4,"",5,""],["9380","",5,"",4,"",6,"",4,"",7,"",9,"",6,"",8,"",4,"",6,""],["9440","",24,"",7,"",7,"",4,"",8],["9480","",4,"",4,"",14,"",7,"",7,""],["9540","",4,"",4,"",6,""],["9580","",4,"",4,"",8,"",4,"",4,"",25,"",7,"",5,""],["9640","",5,"",4,""],["9680","",7,"",9,"",7,"",4,"",6,"",6,"",5],["9740","",7,"",8,"",7,"",9,""],["9780","",6,"",5,"",4,"",9,"",4,"",11,"",7,"",16,""],["9840","",4,"",5,"",9,""],["9880","",7,"",5,"",11,"",9,"",9,"",11,"",5,"",5,"",6,"",4,"",7,"",6,""],["9940","",4,"",10,"",6,"",8,"",4,"",7,"",5],["9980","",114,"",6],["9a40","",11,"",7,"",13,""],["9a80","",4,"",7,"",7,"",6,"",4,"",4,"",7,"",6,"",4,"",4,""],["9b40","",4,""],["9b80","",5,"",4,"",4,"",5,""],["9c40","",7,""],["9c80","",7,"",7,"",10,"",14,"",4,"",6,"",5],["9d40","",7,"",4,"",9,"",6,""],["9d80","",9,"",5,"",6,"",12,"",4,"",10,"",5,"",5,"",6,"",10,""],["9e40","",7,"",32,"",7,"",6,"",6],["9e80","",9,"",17,"",13,"",11,"",12,"",12,""],["9f40","",6,"",10,"",4,"",10,"",7,""],["9f80","",13,"",12,"",4,"",4,"",5,"",4,"",4,"",6,"",5,"",8,"",9,"",4],["a040","",9,"",5,"",9,"",11,"",19],["a080","",9,"",6,"",4,"",11,"",11,"",6,""],["a1a1","",7,""],["a2a1","",9],["a2b1","",19,"",19,"",9],["a2e5","",9],["a2f1","",11],["a3a1","",88,""],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a6e0",""],["a6ee",""],["a6f4",""],["a7a1","",5,"",25],["a7d1","",5,"",25],["a840","",35,"",6],["a880","",7,""],["a8a1",""],["a8bd",""],["a8c0",""],["a8c5","",36],["a940","",8,""],["a959",""],["a95c",""],["a960","",9,"",8],["a980","",4,""],["a996",""],["a9a4","",75],["aa40","",5,"",5,"",8],["aa80","",7,"",10,""],["ab40","",11,"",4,"",5,"",4],["ab80","",6,"",4],["ac40","",10,"",8,"",5,"",4,"",11],["ac80","",6,"",12,"",4,""],["ad40","",10,"",7,"",15,"",12],["ad80","",9,"",8,"",6,""],["ae40","",6,"",7,"",4,""],["ae80","",7,"",6,"",4,""],["af40","",4,""],["af80",""],["b040","",6,"",5,"",4,"",6,"",7,""],["b080","",7,"",8,"",9,""],["b140","",4,"",7,"",10,""],["b180","",4,"",7,"",7,""],["b240","",11,"",5,"",11,"",4],["b280","",12,"",8,"",4,""],["b340","",5,""],["b380","",11,"",7,"",6,""],["b440","",7,"",9],["b480","",4,"",5,"",6,""],["b540","",5,"",9,"",4,"",14,"",4,"",8,""],["b580","",6,"",4,""],["b640","",6,"",11,"",10,"",4,"",5,""],["b680","",6,"",4,""],["b740","",14,"",5,"",9,"",4,"",16],["b780","",6,""],["b840","",4,"",10,"",10,"",9,"",5,""],["b880","",4,""],["b940","",5,"",10,"",6,""],["b980","",7,""],["ba40","",4,"",4,"",7,"",5,""],["ba80","",4,"",5,"",12,"",5,""],["bb40","",9,"",36,"",5,"",9],["bb80","",6,"",4,""],["bc40","",6,"",6,"",5,"",7,"",13,"",5],["bc80","",14,"",6,""],["bd40","",54,"",7],["bd80","",32,""],["be40","",12,"",6,"",42],["be80","",32,""],["bf40","",62],["bf80","",4,"",4,"",21,""],["c040","",35,"",23,""],["c080","",6,"",9,""],["c140","",4,"",7,"",4,"",4,"",6,""],["c180","",4,"",4,"",5,""],["c240","",6,"",5,""],["c280","",13,"",5,"",11,""],["c340","",5,"",4,"",6,""],["c380","",12,"",4,""],["c440","",5,"",4,"",4,"",5,"",4,""],["c480","",7,"",5,"",6,""],["c540","",14,"",4,"",5,"",4,"",5,""],["c580","",7,"",7,""],["c640",""],["c680","",4,"",9,""],["c740","",4,"",4,"",6,"",6,"",6,""],["c780",""],["c840","",4,"",5,"",5,"",7,"",5,"",7,""],["c880","",6,"",4,"",4,""],["c940","",4,"",7,"",12,""],["c980","",4,"",4,"",10,""],["ca40","",8,"",8,"",9,"",4,"",10],["ca80","",4,"",8,""],["cb40","",6,"",10,"",6,"",5,"",6,"",6,"",4,""],["cb80","",5,"",6,"",14,""],["cc40","",4,"",10,"",15,"",13,""],["cc80","",11,"",4,"",7,""],["cd40","",6,"",6,"",4,"",5,"",4,"",4,""],["cd80",""],["ce40","",6,"",5,"",7,""],["ce80","",4,"",6,"",4,""],["cf40","",4,"",4,"",6,"",9],["cf80","",5,"",7,"",4,""],["d040","",13,"",5,"",5,"",5,"",6,""],["d080","",4,"",4,"",5,""],["d140","",4,"",4,"",6,"",5],["d180","",4,"",4,"",4,""],["d240","",8,"",24,"",5,"",19,""],["d280","",26,""],["d340","",30,"",6],["d380","",4,"",5,"",21,""],["d440","",31,"",8,"",21],["d480","",25,"",6,""],["d540","",7,"",7,"",46],["d580","",32,""],["d640","",34,"",27],["d680","",30,""],["d740","",31,"",4,"",25],["d780","",24,""],["d840","",8,"",7,"",5,"",6,"",6,"",6,""],["d880","",6,"",20,""],["d940","",62],["d980","",32,""],["da40","",14,"",8,"",4,"",9,""],["da80","",12,""],["db40","",6,"",7,"",4,""],["db80","",4,"",5,"",11,""],["dc40","",4,"",6,"",6,"",11,"",6,"",7],["dc80","",10,"",21,""],["dd40","",62],["dd80","",32,""],["de40","",32,""],["de80","",4,""],["df40","",5,"",4,"",4,"",5,"",4,"",6,""],["df80","",4,""],["e040","",19,""],["e080","",10,"",6,"",8,""],["e140","",4,"",6,"",5,"",5,""],["e180","",10,"",9,"",8,""],["e240","",62],["e280","",32,"",5,""],["e340","",45,"",16],["e380","",7,"",24,""],["e440","",5,"",24,"",31],["e480","",32,""],["e540","",51,"",10],["e580","",31,""],["e640","",34,"",27],["e680","",29,""],["e740","",7,"",54],["e780","",32,"",6,"",4,""],["e840","",14,"",43,""],["e880","",20,""],["e940","",7,"",42],["e980","",32,""],["ea40","",27,"",6,""],["ea80","",4,"",12,""],["eb40","",9,"",7,"",9,"",6,""],["eb80","",4,""],["ec40","",8,"",4,"",18,"",7],["ec80","",4,"",7,"",4,"",4,""],["ed40","",6,"",46],["ed80","",4,"",23,""],["ee40","",62],["ee80","",32,"",4,"",6,""],["ef40","",5,"",37,"",4],["ef80","",30,"",4,"",8,""],["f040","",4,"",28,"",26],["f080","",9,"",12,"",4,"",6,""],["f140","",10,"",47],["f180","",32,""],["f240","",62],["f280","",32,""],["f340","",17,"",6,"",4,""],["f380","",8,"",6,""],["f440","",5,"",10,"",10,"",7,"",5],["f480","",32,""],["f540","",62],["f580","",32,""],["f640","",62],["f680","",32,"",5,"",5,"",4,"",7,""],["f740","",62],["f780","",4,"",4,""],["f840","",62],["f880","",32],["f940","",62],["f980","",32],["fa40","",62],["fa80","",32],["fb40","",27,"",9,""],["fb80","",5,"",8,"",5,""],["fc40","",8,"",4,"",8,"",6],["fc80","",4,"",5,"",8,""],["fd40","",4,"",4,"",10,"",38],["fd80","",5,"",11,"",4,""],["fe40",""]]')},function(module,exports,__webpack_require__){var baseGetAllKeys=__webpack_require__(313),getSymbolsIn=__webpack_require__(326),keysIn=__webpack_require__(117);module.exports=function(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}},function(module,exports){var reHasUnicode=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");module.exports=function(string){return reHasUnicode.test(string)}},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(49);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.resetFlags=exports.listFlags=void 0;var _slicedToArray2=_interopRequireDefault(__webpack_require__(84)),_classCallCheck2=_interopRequireDefault(__webpack_require__(21)),_createClass2=_interopRequireDefault(__webpack_require__(30)),_microee=_interopRequireDefault(__webpack_require__(329)),_lsAdapter=_interopRequireDefault(__webpack_require__(618)),FlagStore=function(){function FlagStore(){(0,_classCallCheck2.default)(this,FlagStore),this.store={},"undefined"!=typeof localStorage&&(this.longtermStore=_lsAdapter.default),this.restore()}return(0,_createClass2.default)(FlagStore,[{key:"restore",value:function(){if(this.longtermStore)for(var allValues=this.longtermStore.getAll(),_arr=Object.entries(allValues),_i=0;_i<_arr.length;_i++){var _arr$_i=(0,_slicedToArray2.default)(_arr[_i],2),_flag=_arr$_i[0],val=_arr$_i[1];this.store[_flag]=val,this.emit("change")}}},{key:"keys",value:function(){return Object.keys(this.store)}},{key:"get",value:function(name){return this.store.hasOwnProperty(name)||(this.store[name]=null),this.store[name]}},{key:"set",value:function(name,value){this.longtermStore&&this.longtermStore.setItem(name,value),this.store[name]=value,this.emit("change")}},{key:"remove",value:function(name){delete this.store[name],this.longtermStore&&this.longtermStore.removeItem(name),this.emit("change")}}]),FlagStore}();_microee.default.mixin(FlagStore);var store=new FlagStore,flag=function(){var args=[].slice.call(arguments);return 1===args.length?store.get(args[0]):(store.set(args[0],args[1]),args[1])},listFlags=function(){return store.keys().sort()};exports.listFlags=listFlags;var resetFlags=function(){listFlags().forEach(function(name){return store.remove(name)})};exports.resetFlags=resetFlags,flag.store=store,flag.list=listFlags,flag.reset=resetFlags;var _default=flag;exports.default=_default},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(623),__esModule:!0}},function(module,exports){var ceil=Math.ceil,floor=Math.floor;module.exports=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)}},function(module,exports){module.exports=function(it){if(null==it)throw TypeError("Can't call method on  "+it);return it}},function(module,exports,__webpack_require__){"use strict";var LIBRARY=__webpack_require__(120),$export=__webpack_require__(14),redefine=__webpack_require__(331),hide=__webpack_require__(64),Iterators=__webpack_require__(101),$iterCreate=__webpack_require__(625),setToStringTag=__webpack_require__(124),getPrototypeOf=__webpack_require__(335),ITERATOR=__webpack_require__(20)("iterator"),BUGGY=!([].keys&&"next"in[].keys()),returnThis=function(){return this};module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var methods,key,IteratorPrototype,getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case"keys":case"values":return function(){return new Constructor(this,kind)}}return function(){return new Constructor(this,kind)}},TAG=NAME+" Iterator",DEF_VALUES="values"==DEFAULT,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto["@@iterator"]||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT),$entries=DEFAULT?DEF_VALUES?getMethod("entries"):$default:void 0,$anyNative="Array"==NAME&&proto.entries||$native;if($anyNative&&(IteratorPrototype=getPrototypeOf($anyNative.call(new Base)))!==Object.prototype&&IteratorPrototype.next&&(setToStringTag(IteratorPrototype,TAG,!0),LIBRARY||"function"==typeof IteratorPrototype[ITERATOR]||hide(IteratorPrototype,ITERATOR,returnThis)),DEF_VALUES&&$native&&"values"!==$native.name&&(VALUES_BUG=!0,$default=function(){return $native.call(this)}),LIBRARY&&!FORCED||!BUGGY&&!VALUES_BUG&&proto[ITERATOR]||hide(proto,ITERATOR,$default),Iterators[NAME]=$default,Iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod("values"),keys:IS_SET?$default:getMethod("keys"),entries:$entries},FORCED)for(key in methods)key in proto||redefine(proto,key,methods[key]);else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(32),document=__webpack_require__(19).document,is=isObject(document)&&isObject(document.createElement);module.exports=function(it){return is?document.createElement(it):{}}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(32);module.exports=function(it,S){if(!isObject(it))return it;var fn,val;if(S&&"function"==typeof(fn=it.toString)&&!isObject(val=fn.call(it)))return val;if("function"==typeof(fn=it.valueOf)&&!isObject(val=fn.call(it)))return val;if(!S&&"function"==typeof(fn=it.toString)&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to primitive value")}},function(module,exports,__webpack_require__){var cof=__webpack_require__(123);module.exports=Object("z").propertyIsEnumerable(0)?Object:function(it){return"String"==cof(it)?it.split(""):Object(it)}},function(module,exports,__webpack_require__){var shared=__webpack_require__(222)("keys"),uid=__webpack_require__(158);module.exports=function(key){return shared[key]||(shared[key]=uid(key))}},function(module,exports,__webpack_require__){var core=__webpack_require__(9),global=__webpack_require__(19),store=global["__core-js_shared__"]||(global["__core-js_shared__"]={});(module.exports=function(key,value){return store[key]||(store[key]=void 0!==value?value:{})})("versions",[]).push({version:core.version,mode:__webpack_require__(120)?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(module,exports){module.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(module,exports,__webpack_require__){var classof=__webpack_require__(159),ITERATOR=__webpack_require__(20)("iterator"),Iterators=__webpack_require__(101);module.exports=__webpack_require__(9).getIteratorMethod=function(it){if(null!=it)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}},function(module,exports){exports.f=Object.getOwnPropertySymbols},function(module,exports,__webpack_require__){exports.f=__webpack_require__(20)},function(module,exports,__webpack_require__){var global=__webpack_require__(19),core=__webpack_require__(9),LIBRARY=__webpack_require__(120),wksExt=__webpack_require__(226),defineProperty=__webpack_require__(38).f;module.exports=function(name){var $Symbol=core.Symbol||(core.Symbol=LIBRARY?{}:global.Symbol||{});"_"==name.charAt(0)||name in $Symbol||defineProperty($Symbol,name,{value:wksExt.f(name)})}},function(module,exports,__webpack_require__){var pIE=__webpack_require__(125),createDesc=__webpack_require__(122),toIObject=__webpack_require__(65),toPrimitive=__webpack_require__(219),has=__webpack_require__(81),IE8_DOM_DEFINE=__webpack_require__(330),gOPD=Object.getOwnPropertyDescriptor;exports.f=__webpack_require__(24)?gOPD:function(O,P){if(O=toIObject(O),P=toPrimitive(P,!0),IE8_DOM_DEFINE)try{return gOPD(O,P)}catch(e){}if(has(O,P))return createDesc(!pIE.f.call(O,P),O[P])}},function(module,exports){module.exports=function(it,Constructor,name,forbiddenField){if(!(it instanceof Constructor)||void 0!==forbiddenField&&forbiddenField in it)throw TypeError(name+": incorrect invocation!");return it}},function(module,exports,__webpack_require__){"use strict";var aFunction=__webpack_require__(121);function PromiseCapability(C){var resolve,reject;this.promise=new C(function($$resolve,$$reject){if(void 0!==resolve||void 0!==reject)throw TypeError("Bad Promise constructor");resolve=$$resolve,reject=$$reject}),this.resolve=aFunction(resolve),this.reject=aFunction(reject)}module.exports.f=function(C){return new PromiseCapability(C)}},function(module,exports,__webpack_require__){var hide=__webpack_require__(64);module.exports=function(target,src,safe){for(var key in src)safe&&target[key]?target[key]=src[key]:hide(target,key,src[key]);return target}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(32);module.exports=function(it,TYPE){if(!isObject(it)||it._t!==TYPE)throw TypeError("Incompatible receiver, "+TYPE+" required!");return it}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.receiveMutationError=exports.receiveMutationResult=exports.initMutation=exports.isReceivingMutationResult=exports.isMutationAction=void 0;var obj,_extends2=__webpack_require__(3),_extends3=(obj=_extends2)&&obj.__esModule?obj:{default:obj};var INIT_MUTATION="INIT_MUTATION",RECEIVE_MUTATION_RESULT="RECEIVE_MUTATION_RESULT",RECEIVE_MUTATION_ERROR="RECEIVE_MUTATION_ERROR";exports.isMutationAction=function(action){return-1!==[INIT_MUTATION,RECEIVE_MUTATION_RESULT,RECEIVE_MUTATION_ERROR].indexOf(action.type)},exports.isReceivingMutationResult=function(action){return action.type===RECEIVE_MUTATION_RESULT},exports.initMutation=function(mutationId,definition){return{type:INIT_MUTATION,mutationId:mutationId,definition:definition}},exports.receiveMutationResult=function(mutationId,response){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},definition=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,_extends3.default)({type:RECEIVE_MUTATION_RESULT,mutationId:mutationId,response:response},options,{definition:definition})},exports.receiveMutationError=function(mutationId,error){var definition=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:RECEIVE_MUTATION_ERROR,mutationId:mutationId,error:error,definition:definition}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Collection=exports.dontThrowNotFoundError=void 0;var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var dontThrowNotFoundError=exports.dontThrowNotFoundError=function(error){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(error.message.match(/not_found/)){var expectsCollection=Array.isArray(data);return expectsCollection?{data:data,meta:{count:0},skip:0,next:!1}:{data:data}}throw error},Collection=exports.Collection=function(){function Collection(){(0,_classCallCheck3.default)(this,Collection)}var _ref2;return(0,_createClass3.default)(Collection,null,[{key:"get",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(stackClient,endpoint,_ref){var resp,_ref$normalize=_ref.normalize,normalize=void 0===_ref$normalize?function(data,response){return data}:_ref$normalize,_ref$method=_ref.method,method=void 0===_ref$method?"GET":_ref$method;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,stackClient.fetchJSON(method,endpoint);case 3:return resp=_context.sent,_context.abrupt("return",{data:normalize(resp.data,resp)});case 7:return _context.prev=7,_context.t0=_context.catch(0),_context.abrupt("return",dontThrowNotFoundError(_context.t0,null));case 10:case"end":return _context.stop()}},_callee,this,[[0,7]])})),function(_x2,_x3,_x4){return _ref2.apply(this,arguments)})}]),Collection}();exports.default=Collection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDirectory=exports.isFile=void 0;var _typeof3=_interopRequireDefault(__webpack_require__(96)),_objectWithoutProperties3=_interopRequireDefault(__webpack_require__(86)),_getIterator3=_interopRequireDefault(__webpack_require__(66)),_taggedTemplateLiteral3=_interopRequireDefault(__webpack_require__(106)),_regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_promise2=_interopRequireDefault(__webpack_require__(67)),_extends3=_interopRequireDefault(__webpack_require__(3)),_templateObject=(0,_taggedTemplateLiteral3.default)(["/data/","/","/relationships/references"],["/data/","/","/relationships/references"]),_templateObject2=(0,_taggedTemplateLiteral3.default)(["/files/","/relationships/referenced_by"],["/files/","/relationships/referenced_by"]),_templateObject3=(0,_taggedTemplateLiteral3.default)(["/files/",""],["/files/",""]),_templateObject4=(0,_taggedTemplateLiteral3.default)(["/files/trash/",""],["/files/trash/",""]),_templateObject5=(0,_taggedTemplateLiteral3.default)(["/files/","?Name=","&Type=file&Executable=","&MetadataID=",""],["/files/","?Name=","&Type=file&Executable=","&MetadataID=",""]),_templateObject6=(0,_taggedTemplateLiteral3.default)(["/files/","?Name=","&Type=file&Executable=",""],["/files/","?Name=","&Type=file&Executable=",""]),_templateObject7=(0,_taggedTemplateLiteral3.default)(["/files/downloads?Id=",""],["/files/downloads?Id=",""]),_templateObject8=(0,_taggedTemplateLiteral3.default)(["/files/downloads?Path=",""],["/files/downloads?Path=",""]),_templateObject9=(0,_taggedTemplateLiteral3.default)(["/files/metadata?Path=",""],["/files/metadata?Path=",""]),_templateObject10=(0,_taggedTemplateLiteral3.default)(["/files/","?Name=","&Type=directory"],["/files/","?Name=","&Type=directory"]),_templateObject11=(0,_taggedTemplateLiteral3.default)(["/files/upload/metadata"],["/files/upload/metadata"]),_templateObject12=(0,_taggedTemplateLiteral3.default)(["/files/","/versions"],["/files/","/versions"]),_lite2=_interopRequireDefault(__webpack_require__(720)),_has2=_interopRequireDefault(__webpack_require__(723)),_DocumentCollection2=__webpack_require__(52),_DocumentCollection3=_interopRequireDefault(_DocumentCollection2),_utils=__webpack_require__(107),querystring=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(__webpack_require__(370));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var normalizeFile=function(file){return(0,_extends3.default)({},(0,_DocumentCollection2.normalizeDoc)(file,"io.cozy.files"),file.attributes)},sanitizeFileName=function(name){return name&&name.trim()},getFileTypeFromName=function(name){return _lite2.default.getType(name)||"application/octet-stream"},raceWithCondition=(exports.isFile=function(_ref){var _type=_ref._type,type=_ref.type;return"io.cozy.files"===_type||"directory"===type||"file"===type},exports.isDirectory=function(_ref2){return"directory"===_ref2.type},function(promises,predicate){return new _promise2.default(function(resolve){promises.forEach(function(p){return p.then(function(res){predicate(res)&&resolve(!0)})}),_promise2.default.all(promises).then(function(){return resolve(!1)})})}),FileCollection=function(_DocumentCollection){function FileCollection(doctype,stackClient){(0,_classCallCheck3.default)(this,FileCollection);var _this=(0,_possibleConstructorReturn3.default)(this,(FileCollection.__proto__||(0,_getPrototypeOf2.default)(FileCollection)).call(this,doctype,stackClient));return _this.extractResponseLinkRelated=function(res){var href=res.links&&res.links.related;if(!href)throw new Error("No related link in server response");return _this.stackClient.fullpath(href)},_this.specialDirectories={},_this}var _ref31,_ref30,_ref29,_ref28,_ref27,_ref26,_ref25,_ref24,_ref23,_ref22,_ref21,_ref18,_ref17,_ref16,_ref15,_ref14,_ref12,_ref10,_ref9,_ref7,_ref4,_ref3;return(0,_inherits3.default)(FileCollection,_DocumentCollection),(0,_createClass3.default)(FileCollection,[{key:"get",value:function(id){return this.statById(id)}},{key:"find",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(selector){var _options$skip,skip,resp,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _options$skip=options.skip,skip=void 0===_options$skip?0:_options$skip,_context.t0=this.stackClient,_context.next=4,this.toMangoOptions(selector,options);case 4:return _context.t1=_context.sent,_context.next=7,_context.t0.fetchJSON.call(_context.t0,"POST","/files/_find",_context.t1);case 7:return resp=_context.sent,_context.abrupt("return",{data:resp.data.map(function(f){return normalizeFile(f)}),meta:resp.meta,next:resp.meta.count>skip+resp.data.length,skip:skip});case 9:case"end":return _context.stop()}},_callee,this)})),function(_x2){return _ref3.apply(this,arguments)})},{key:"findReferencedBy",value:(_ref4=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(document){var params,url,path,resp,_ref5=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref5$skip=_ref5.skip,skip=void 0===_ref5$skip?0:_ref5$skip,limit=_ref5.limit,cursor=_ref5.cursor;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return params={include:"files","page[limit]":limit,"page[cursor]":cursor,sort:"datetime"},url=(0,_utils.uri)(_templateObject,document._type,document._id),path=querystring.buildURL(url,params),_context2.next=5,this.stackClient.fetchJSON("GET",path);case 5:return resp=_context2.sent,_context2.abrupt("return",{data:resp.data.map(function(f){return normalizeFile(f)}),included:resp.included?resp.included.map(function(f){return normalizeFile(f)}):[],next:(0,_has2.default)(resp,"links.next"),meta:resp.meta,skip:skip});case 7:case"end":return _context2.stop()}},_callee2,this)})),function(_x4){return _ref4.apply(this,arguments)})},{key:"addReferencedBy",value:function(document,documents){var refs=documents.map(function(d){return{id:d._id,type:d._type}});return this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject2,document._id),{data:refs})}},{key:"removeReferencedBy",value:function(document,documents){var refs=documents.map(function(d){return{id:d._id,type:d._type}});return this.stackClient.fetchJSON("DELETE",(0,_utils.uri)(_templateObject2,document._id),{data:refs})}},{key:"addReferencesTo",value:function(document,documents){var refs=documents.map(function(d){return{id:d._id,type:"io.cozy.files"}});return this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject,document._type,document._id),{data:refs})}},{key:"removeReferencesTo",value:function(document,documents){var refs=documents.map(function(d){return{id:d._id,type:"io.cozy.files"}});return this.stackClient.fetchJSON("DELETE",(0,_utils.uri)(_templateObject,document._type,document._id),{data:refs})}},{key:"destroy",value:(_ref7=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(_ref6){var _iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,ref,resp,_id=_ref6._id,relationships=_ref6.relationships,_ref8=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref8$ifMatch=_ref8.ifMatch,ifMatch=void 0===_ref8$ifMatch?"":_ref8$ifMatch;return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!(relationships&&relationships.referenced_by&&Array.isArray(relationships.referenced_by.data))){_context3.next=27;break}_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_context3.prev=4,_iterator=(0,_getIterator3.default)(relationships.referenced_by.data);case 6:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context3.next=13;break}return ref=_step.value,_context3.next=10,this.removeReferencesTo({_id:ref.id,_type:ref.type},[{_id:_id}]);case 10:_iteratorNormalCompletion=!0,_context3.next=6;break;case 13:_context3.next=19;break;case 15:_context3.prev=15,_context3.t0=_context3.catch(4),_didIteratorError=!0,_iteratorError=_context3.t0;case 19:_context3.prev=19,_context3.prev=20,!_iteratorNormalCompletion&&_iterator.return&&_iterator.return();case 22:if(_context3.prev=22,!_didIteratorError){_context3.next=25;break}throw _iteratorError;case 25:return _context3.finish(22);case 26:return _context3.finish(19);case 27:return _context3.next=29,this.stackClient.fetchJSON("DELETE",(0,_utils.uri)(_templateObject3,_id),void 0,{headers:{"If-Match":ifMatch}});case 29:return resp=_context3.sent,_context3.abrupt("return",{data:normalizeFile(resp.data)});case 31:case"end":return _context3.stop()}},_callee3,this,[[4,15,19,27],[20,,22,26]])})),function(_x6){return _ref7.apply(this,arguments)})},{key:"restore",value:function(id){return this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject4,id))}},{key:"deleteFilePermanently",value:(_ref9=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(id){var resp;return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,this.stackClient.fetchJSON("PATCH",(0,_utils.uri)(_templateObject3,id),{data:{type:"io.cozy.files",id:id,attributes:{permanent_delete:!0}}});case 2:return resp=_context4.sent,_context4.abrupt("return",resp.data);case 4:case"end":return _context4.stop()}},_callee4,this)})),function(_x7){return _ref9.apply(this,arguments)})},{key:"upload",value:(_ref10=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee5(data,dirPath){var dirId;return _regenerator2.default.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,this.ensureDirectoryExists(dirPath);case 2:return dirId=_context5.sent,_context5.abrupt("return",this.createFile(data,{dirId:dirId}));case 4:case"end":return _context5.stop()}},_callee5,this)})),function(_x8,_x9){return _ref10.apply(this,arguments)})},{key:"createFile",value:(_ref12=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee6(data){var metadataId,meta,path,_ref11=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},name=_ref11.name,_ref11$dirId=_ref11.dirId,dirId=void 0===_ref11$dirId?"":_ref11$dirId,executable=_ref11.executable,metadata=_ref11.metadata,options=(0,_objectWithoutProperties3.default)(_ref11,["name","dirId","executable","metadata"]);return _regenerator2.default.wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(name||"string"!=typeof data.name||(name=data.name),"string"==typeof(name=sanitizeFileName(name))&&""!==name){_context6.next=4;break}throw new Error("missing name argument");case 4:if(void 0===executable&&(executable=!1),metadataId="",!metadata){_context6.next=11;break}return _context6.next=9,this.createFileMetadata(metadata);case 9:meta=_context6.sent,metadataId=meta.data.id;case 11:return path=(0,_utils.uri)(_templateObject5,dirId,name,executable,metadataId),_context6.abrupt("return",this.doUpload(data,path,options));case 13:case"end":return _context6.stop()}},_callee6,this)})),function(_x11){return _ref12.apply(this,arguments)})},{key:"updateFile",value:(_ref14=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee7(data){var name,metadataId,path,meta,_ref13=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref13$executable=_ref13.executable,executable=void 0!==_ref13$executable&&_ref13$executable,fileId=_ref13.fileId,metadata=_ref13.metadata,options=(0,_objectWithoutProperties3.default)(_ref13,["executable","fileId","metadata"]);return _regenerator2.default.wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(fileId&&"string"==typeof fileId){_context7.next=2;break}throw new Error("missing fileId argument");case 2:if("string"==typeof data.name){_context7.next=4;break}throw new Error("missing name in data argument");case 4:if("string"==typeof(name=sanitizeFileName(data.name))&&""!==name){_context7.next=7;break}throw new Error("missing name argument");case 7:if(metadataId=void 0,path=(0,_utils.uri)(_templateObject6,fileId,name,executable),!metadata){_context7.next=15;break}return _context7.next=12,this.createFileMetadata(metadata);case 12:meta=_context7.sent,metadataId=meta.data.id,path=path+"&MetadataID="+metadataId;case 15:return _context7.abrupt("return",this.doUpload(data,path,options,"PUT"));case 16:case"end":return _context7.stop()}},_callee7,this)})),function(_x13){return _ref14.apply(this,arguments)})},{key:"getDownloadLinkById",value:function(id){return this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject7,id)).then(this.extractResponseLinkRelated)}},{key:"getDownloadLinkByPath",value:function(path){return this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject8,path)).then(this.extractResponseLinkRelated)}},{key:"download",value:(_ref15=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee8(file){var href;return _regenerator2.default.wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,this.getDownloadLinkById(file._id);case 2:href=_context8.sent,(0,_utils.forceFileDownload)(href+"?Dl=1",file.name);case 4:case"end":return _context8.stop()}},_callee8,this)})),function(_x14){return _ref15.apply(this,arguments)})},{key:"downloadArchive",value:(_ref16=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee9(fileIds){var filename,href,fullpath,notSecureFilename=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"files";return _regenerator2.default.wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return filename=(0,_utils.slugify)(notSecureFilename),_context9.next=3,this.getArchiveLinkByIds(fileIds,filename);case 3:href=_context9.sent,fullpath=this.stackClient.fullpath(href),(0,_utils.forceFileDownload)(fullpath,filename+".zip");case 6:case"end":return _context9.stop()}},_callee9,this)})),function(_x16){return _ref16.apply(this,arguments)})},{key:"getArchiveLinkByIds",value:(_ref17=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee10(ids){var resp,name=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"files";return _regenerator2.default.wrap(function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,this.stackClient.fetchJSON("POST","/files/archive",{data:{type:"io.cozy.archives",attributes:{name:name,ids:ids}}});case 2:return resp=_context10.sent,_context10.abrupt("return",resp.links.related);case 4:case"end":return _context10.stop()}},_callee10,this)})),function(_x18){return _ref17.apply(this,arguments)})},{key:"isChildOf",value:(_ref18=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee11(child,parent){var _ref19,childID,childDirID,childPath,_ref20,parentID,childDoc,currPath,targetsPath,newPath,_this2=this;return _regenerator2.default.wrap(function(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(_ref19="object"===(void 0===child?"undefined":(0,_typeof3.default)(child))?child:{_id:child},childID=_ref19._id,childDirID=_ref19.dirID,childPath=_ref19.path,_ref20="object"===(void 0===parent?"undefined":(0,_typeof3.default)(parent))?parent:{_id:parent},parentID=_ref20._id,childID!==parentID&&childDirID!==parentID){_context11.next=4;break}return _context11.abrupt("return",!0);case 4:if(childPath){_context11.next=10;break}return _context11.next=7,this.statById(childID);case 7:childDoc=_context11.sent,childPath=childDoc.path,childDirID=childDoc.dirID;case 10:for(currPath=childPath,targetsPath=[childPath];""!=currPath;)lastIndex=void 0,lastIndex=(path=currPath).lastIndexOf("/"),""!=(newPath=path.substring(0,lastIndex))&&targetsPath.push(newPath),currPath=newPath;return targetsPath.reverse(),_context11.abrupt("return",raceWithCondition(targetsPath.map(function(path){return _this2.statByPath(path)}),function(stat){return stat.data._id==parentID}));case 15:case"end":return _context11.stop()}var path,lastIndex},_callee11,this)})),function(_x19,_x20){return _ref18.apply(this,arguments)})},{key:"statById",value:(_ref21=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee12(id){var limit,_options$skip2,params,url,path,resp,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return limit=options.limit,_options$skip2=options.skip,params={limit:limit,skip:void 0===_options$skip2?0:_options$skip2},url=(0,_utils.uri)(_templateObject3,id),path=querystring.buildURL(url,params),_context12.next=6,this.stackClient.fetchJSON("GET",path);case 6:return resp=_context12.sent,_context12.abrupt("return",{data:normalizeFile(resp.data),included:resp.included&&resp.included.map(function(f){return normalizeFile(f)})});case 8:case"end":return _context12.stop()}},_callee12,this)})),function(_x22){return _ref21.apply(this,arguments)})},{key:"statByPath",value:(_ref22=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee13(path){var resp;return _regenerator2.default.wrap(function(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return _context13.next=2,this.stackClient.fetchJSON("GET",(0,_utils.uri)(_templateObject9,path));case 2:return resp=_context13.sent,_context13.abrupt("return",{data:normalizeFile(resp.data),included:resp.included&&resp.included.map(function(f){return normalizeFile(f)})});case 4:case"end":return _context13.stop()}},_callee13,this)})),function(_x23){return _ref22.apply(this,arguments)})},{key:"createDirectory",value:(_ref23=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee14(){var name,dirId,lastModifiedDate,safeName,lastModified,resp,attributes=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _regenerator2.default.wrap(function(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:if(name=attributes.name,dirId=attributes.dirId,lastModifiedDate=attributes.lastModifiedDate,safeName=sanitizeFileName(name),"string"==typeof name&&""!==safeName){_context14.next=4;break}throw new Error("missing name argument");case 4:return lastModified=lastModifiedDate&&("string"==typeof lastModifiedDate?new Date(lastModifiedDate):lastModifiedDate),_context14.next=7,this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject10,dirId,safeName),void 0,{headers:{Date:lastModified?lastModified.toGMTString():""}});case 7:return resp=_context14.sent,_context14.abrupt("return",{data:normalizeFile(resp.data)});case 9:case"end":return _context14.stop()}},_callee14,this)})),function(){return _ref23.apply(this,arguments)})},{key:"ensureDirectoryExists",value:(_ref24=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee15(path){var resp;return _regenerator2.default.wrap(function(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:if(this.specialDirectories[path]){_context15.next=5;break}return _context15.next=3,this.createDirectoryByPath(path);case 3:resp=_context15.sent,this.specialDirectories[path]=resp.data._id;case 5:return _context15.abrupt("return",this.specialDirectories[path]);case 6:case"end":return _context15.stop()}},_callee15,this)})),function(_x25){return _ref24.apply(this,arguments)})},{key:"getDirectoryOrCreate",value:(_ref25=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee16(name,parentDirectory){var safeName,path,stat,parsedError,errors;return _regenerator2.default.wrap(function(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:if(!parentDirectory||parentDirectory.attributes){_context16.next=2;break}throw new Error("Malformed parent directory");case 2:return safeName=sanitizeFileName(name),path=("io.cozy.files.root-dir"===parentDirectory._id?"":parentDirectory.attributes.path)+"/"+safeName,_context16.prev=4,_context16.next=7,this.statByPath(path||"/");case 7:return stat=_context16.sent,_context16.abrupt("return",stat);case 11:if(_context16.prev=11,_context16.t0=_context16.catch(4),parsedError=JSON.parse(_context16.t0.message),!(errors=parsedError.errors)||!errors.length||"404"!==errors[0].status){_context16.next=17;break}return _context16.abrupt("return",this.createDirectory({name:safeName,dirId:parentDirectory&&parentDirectory._id}));case 17:throw errors;case 18:case"end":return _context16.stop()}},_callee16,this,[[4,11]])})),function(_x26,_x27){return _ref25.apply(this,arguments)})},{key:"createDirectoryByPath",value:(_ref26=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee17(path){var parts,root,parentDir,_iteratorNormalCompletion2,_didIteratorError2,_iteratorError2,_iterator2,_step2,part;return _regenerator2.default.wrap(function(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:return parts=path.split("/").filter(function(part){return""!==part}),_context17.next=3,this.statById("io.cozy.files.root-dir");case 3:if(root=_context17.sent,parts.length){_context17.next=6;break}return _context17.abrupt("return",root);case 6:parentDir=root,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0,_context17.prev=10,_iterator2=(0,_getIterator3.default)(parts);case 12:if(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done){_context17.next=20;break}return part=_step2.value,_context17.next=16,this.getDirectoryOrCreate(part,parentDir.data);case 16:parentDir=_context17.sent;case 17:_iteratorNormalCompletion2=!0,_context17.next=12;break;case 20:_context17.next=26;break;case 22:_context17.prev=22,_context17.t0=_context17.catch(10),_didIteratorError2=!0,_iteratorError2=_context17.t0;case 26:_context17.prev=26,_context17.prev=27,!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return();case 29:if(_context17.prev=29,!_didIteratorError2){_context17.next=32;break}throw _iteratorError2;case 32:return _context17.finish(29);case 33:return _context17.finish(26);case 34:return _context17.abrupt("return",parentDir);case 35:case"end":return _context17.stop()}},_callee17,this,[[10,22,26,34],[27,,29,33]])})),function(_x28){return _ref26.apply(this,arguments)})},{key:"updateAttributes",value:(_ref27=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee18(id,attributes){var resp;return _regenerator2.default.wrap(function(_context18){for(;;)switch(_context18.prev=_context18.next){case 0:return _context18.next=2,this.stackClient.fetchJSON("PATCH",(0,_utils.uri)(_templateObject3,id),{data:{type:"io.cozy.files",id:id,attributes:attributes}});case 2:return resp=_context18.sent,_context18.abrupt("return",{data:normalizeFile(resp.data)});case 4:case"end":return _context18.stop()}},_callee18,this)})),function(_x29,_x30){return _ref27.apply(this,arguments)})},{key:"updateFileMetadata",value:(_ref28=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee19(id,attributes){return _regenerator2.default.wrap(function(_context19){for(;;)switch(_context19.prev=_context19.next){case 0:return console.warn("CozyClient FileCollection updateFileMetadata method is deprecated. Use updateAttributes instead"),_context19.abrupt("return",this.updateAttributes(id,attributes));case 2:case"end":return _context19.stop()}},_callee19,this)})),function(_x31,_x32){return _ref28.apply(this,arguments)})},{key:"createFileMetadata",value:(_ref29=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee20(attributes){var resp;return _regenerator2.default.wrap(function(_context20){for(;;)switch(_context20.prev=_context20.next){case 0:return _context20.next=2,this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject11),{data:{type:"io.cozy.files.metadata",attributes:attributes}});case 2:return resp=_context20.sent,_context20.abrupt("return",{data:resp.data});case 4:case"end":return _context20.stop()}},_callee20,this)})),function(_x33){return _ref29.apply(this,arguments)})},{key:"updateMetadataAttribute",value:(_ref30=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee21(id,metadata){var resp;return _regenerator2.default.wrap(function(_context21){for(;;)switch(_context21.prev=_context21.next){case 0:return _context21.next=2,this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject12,id),{data:{type:"io.cozy.files.metadata",attributes:metadata}});case 2:return resp=_context21.sent,_context21.abrupt("return",{data:resp.data});case 4:case"end":return _context21.stop()}},_callee21,this)})),function(_x34,_x35){return _ref30.apply(this,arguments)})},{key:"doUpload",value:(_ref31=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee22(data,path,options){var isBuffer,isFile,isBlob,isStream,isString,_ref32,contentType,contentLength,checksum,lastModifiedDate,ifMatch,headers,resp,method=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"POST";return _regenerator2.default.wrap(function(_context22){for(;;)switch(_context22.prev=_context22.next){case 0:if(data){_context22.next=2;break}throw new Error("missing data argument");case 2:if(data.buffer&&data.buffer instanceof ArrayBuffer&&(data=data.buffer),isBuffer="undefined"!=typeof ArrayBuffer&&data instanceof ArrayBuffer,isFile="undefined"!=typeof File&&data instanceof File,isBlob="undefined"!=typeof Blob&&data instanceof Blob,isStream=!0===data.readable&&"function"==typeof data.pipe,isString="string"==typeof data,isBuffer||isFile||isBlob||isStream||isString){_context22.next=10;break}throw new Error("invalid data type");case 10:return contentType=(_ref32=options||{}).contentType,contentLength=_ref32.contentLength,checksum=_ref32.checksum,lastModifiedDate=_ref32.lastModifiedDate,ifMatch=_ref32.ifMatch,contentType||(isBuffer?contentType="application/octet-stream":isFile?(contentType=data.type||getFileTypeFromName(data.name.toLowerCase())||"application/octet-stream",lastModifiedDate||(lastModifiedDate=data.lastModifiedDate)):isBlob?contentType=data.type||"application/octet-stream":isStream?contentType="application/octet-stream":"string"==typeof data&&(contentType="text/plain")),lastModifiedDate&&"string"==typeof lastModifiedDate&&(lastModifiedDate=new Date(lastModifiedDate)),headers={"Content-Type":contentType},contentLength&&(headers["Content-Length"]=String(contentLength)),checksum&&(headers["Content-MD5"]=checksum),lastModifiedDate&&(headers.Date=lastModifiedDate.toGMTString()),ifMatch&&(headers["If-Match"]=ifMatch),_context22.next=20,this.stackClient.fetchJSON(method,path,data,{headers:headers});case 20:return resp=_context22.sent,_context22.abrupt("return",{data:normalizeFile(resp.data)});case 22:case"end":return _context22.stop()}},_callee22,this)})),function(_x37,_x38,_x39){return _ref31.apply(this,arguments)})}]),FileCollection}(_DocumentCollection3.default);exports.default=FileCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isMobile=exports.isIOS=exports.isAndroid=exports.isMobileApp=exports.isWebApp=exports.isAndroidApp=exports.isIOSApp=exports.getPlatform=void 0;var _cordova=__webpack_require__(237),getPlatform=function(){return(0,_cordova.isCordova)()?window.cordova.platformId:"web"};exports.getPlatform=getPlatform;var isPlatform=function(platform){return getPlatform()===platform};exports.isIOSApp=function(){return isPlatform("ios")};exports.isAndroidApp=function(){return isPlatform("android")};exports.isWebApp=function(){return isPlatform("web")};exports.isMobileApp=function(){return(0,_cordova.isCordova)()};var isAndroid=function(){return window.navigator.userAgent&&window.navigator.userAgent.indexOf("Android")>=0};exports.isAndroid=isAndroid;var isIOS=function(){return window.navigator.userAgent&&/iPad|iPhone|iPod/.test(window.navigator.userAgent)};exports.isIOS=isIOS;exports.isMobile=function(){return isAndroid()||isIOS()}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isCordova=void 0;exports.isCordova=function(){return"undefined"!=typeof window&&void 0!==window.cordova}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hasSafariPlugin=exports.hasInAppBrowserPlugin=exports.hasDevicePlugin=void 0;var _cordova=__webpack_require__(237);exports.hasDevicePlugin=function(){return(0,_cordova.isCordova)()&&void 0!==window.device};exports.hasInAppBrowserPlugin=function(){return(0,_cordova.isCordova)()&&void 0!==window.cordova.InAppBrowser};exports.hasSafariPlugin=function(){return new Promise(function(resolve){(0,_cordova.isCordova)()&&void 0!==window.SafariViewController?window.SafariViewController.isAvailable(function(available){return resolve(available)}):resolve(!1)})}},function(module,exports,__webpack_require__){const groupBy=__webpack_require__(42),get=__webpack_require__(10),Document=__webpack_require__(33),matching=__webpack_require__(756),{getSlugFromInstitutionLabel:getSlugFromInstitutionLabel}=__webpack_require__(380);class BankAccount extends Document{static reconciliate(fetchedAccounts,localAccounts){return matching.matchAccounts(fetchedAccounts,localAccounts).map(matching=>({...matching.account,_id:matching.match?matching.match._id:void 0}))}static findDuplicateAccountsWithNoOperations(accounts,operations){const opsByAccountId=groupBy(operations,op=>op.account),duplicateAccountGroups=Object.entries(groupBy(accounts,x=>x.institutionLabel+" > "+x.label)).map(([,duplicateGroup])=>duplicateGroup).filter(duplicateGroup=>duplicateGroup.length>1),res=[];for(const duplicateAccounts of duplicateAccountGroups)for(const account of duplicateAccounts){0===(opsByAccountId[account._id]||[]).length&&res.push(account)}return res}static hasIncoherentCreatedByApp(account){const predictedSlug=getSlugFromInstitutionLabel(account.institutionLabel),createdByApp=account.cozyMetadata&&account.cozyMetadata.createdByApp;return Boolean(predictedSlug&&createdByApp&&predictedSlug!==createdByApp)}static getUpdatedAt(account){const vendorUpdatedAt=get(account,"metadata.updatedAt");if(vendorUpdatedAt)return vendorUpdatedAt;const cozyUpdatedAt=get(account,"cozyMetadata.updatedAt");return cozyUpdatedAt||null}}BankAccount.normalizeAccountNumber=matching.normalizeAccountNumber,BankAccount.doctype="io.cozy.bank.accounts",BankAccount.idAttributes=["_id"],BankAccount.version=1,BankAccount.checkedAttributes=null,BankAccount.vendorIdAttr="vendorId",module.exports=BankAccount},function(module,exports,__webpack_require__){"use strict";module.exports.EOL="\n",module.exports.SUPPRESS="==SUPPRESS==",module.exports.OPTIONAL="?",module.exports.ZERO_OR_MORE="*",module.exports.ONE_OR_MORE="+",module.exports.PARSER="A...",module.exports.REMAINDER="...",module.exports._UNRECOGNIZED_ARGS_ATTR="_unrecognized_args"},function(module,exports,__webpack_require__){var MapCache=__webpack_require__(201),FUNC_ERROR_TEXT="Expected a function";function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache,module.exports=memoize},function(module,__webpack_exports__,__webpack_require__){"use strict";(function(module){var root,_ponyfill_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(385);root="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:module;var result=Object(_ponyfill_js__WEBPACK_IMPORTED_MODULE_0__.a)(root);__webpack_exports__.a=result}).call(this,__webpack_require__(697)(module))},,function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(74),isArray=__webpack_require__(12),isObjectLike=__webpack_require__(29),stringTag="[object String]";module.exports=function(value){return"string"==typeof value||!isArray(value)&&isObjectLike(value)&&baseGetTag(value)==stringTag}},function(module,exports,__webpack_require__){var baseCreate=__webpack_require__(133),baseLodash=__webpack_require__(198);function LodashWrapper(value,chainAll){this.__wrapped__=value,this.__actions__=[],this.__chain__=!!chainAll,this.__index__=0,this.__values__=void 0}LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,module.exports=LodashWrapper},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.chain=void 0;var _toConsumableArray3=_interopRequireDefault(__webpack_require__(70)),_stringify2=_interopRequireDefault(__webpack_require__(165)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CozyLink=function(){function CozyLink(requestHandler){(0,_classCallCheck3.default)(this,CozyLink),"function"==typeof requestHandler&&(this.request=requestHandler)}return(0,_createClass3.default)(CozyLink,[{key:"request",value:function(operation,result,forward){throw new Error("request is not implemented")}}]),CozyLink}();exports.default=CozyLink;var toLink=function(handler){return"function"==typeof handler?new CozyLink(handler):handler},defaultLinkHandler=function(operation,result){if(result)return result;if(operation.execute)return operation.execute();throw new Error("No link could handle operation "+(0,_stringify2.default)(operation))},concat=(exports.chain=function(links){return[].concat((0,_toConsumableArray3.default)(links),[defaultLinkHandler]).map(toLink).reduce(concat)},function(firstLink,nextLink){return new CozyLink(function(operation,result,forward){return firstLink.request(operation,result,function(op,res){return nextLink.request(op,res,forward)})})})},,,function(module,exports){module.exports=function(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(620)},function(module,exports){module.exports=function(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}},function(module,exports,__webpack_require__){var baseSet=__webpack_require__(321);module.exports=function(object,path,value){return null==object?object:baseSet(object,path,value)}},,,,,,function(module,exports,__webpack_require__){var baseSetToString=__webpack_require__(490),setToString=__webpack_require__(415)(baseSetToString);module.exports=setToString},function(module,exports,__webpack_require__){var baseFindIndex=__webpack_require__(266),baseIsNaN=__webpack_require__(503),strictIndexOf=__webpack_require__(504);module.exports=function(array,value,fromIndex){return value==value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}},function(module,exports,__webpack_require__){var parse=__webpack_require__(36);module.exports=function(dirtyDate,dirtyAmount){var date=parse(dirtyDate),amount=Number(dirtyAmount);return date.setDate(date.getDate()+amount),date}},function(module,exports,__webpack_require__){var startOfDay=__webpack_require__(782),MILLISECONDS_IN_MINUTE=6e4,MILLISECONDS_IN_DAY=864e5;module.exports=function(dirtyDateLeft,dirtyDateRight){var startOfDayLeft=startOfDay(dirtyDateLeft),startOfDayRight=startOfDay(dirtyDateRight),timestampLeft=startOfDayLeft.getTime()-startOfDayLeft.getTimezoneOffset()*MILLISECONDS_IN_MINUTE,timestampRight=startOfDayRight.getTime()-startOfDayRight.getTimezoneOffset()*MILLISECONDS_IN_MINUTE;return Math.round((timestampLeft-timestampRight)/MILLISECONDS_IN_DAY)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return getDefaultedSettings}),__webpack_require__.d(__webpack_exports__,"b",function(){return fetchSettings}),__webpack_require__.d(__webpack_exports__,"e",function(){return updateSettings}),__webpack_require__.d(__webpack_exports__,"a",function(){return fetchCategoryAlerts}),__webpack_require__.d(__webpack_exports__,"d",function(){return updateCategoryAlerts});var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__),lodash_get__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(10),lodash_get__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(lodash_get__WEBPACK_IMPORTED_MODULE_2__),lodash_merge__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(192),lodash_merge__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(lodash_merge__WEBPACK_IMPORTED_MODULE_3__),ducks_settings_constants__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(172),cozy_logger__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(34),log=__webpack_require__.n(cozy_logger__WEBPACK_IMPORTED_MODULE_5__).a.namespace("settings.helpers"),getDefaultedSettings=function(incompleteSettings){return lodash_merge__WEBPACK_IMPORTED_MODULE_3___default()({},ducks_settings_constants__WEBPACK_IMPORTED_MODULE_4__.a,incompleteSettings)},fetchSettings=function(){var _ref=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee(client){var settingsCol;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,client.query(client.find(ducks_settings_constants__WEBPACK_IMPORTED_MODULE_4__.b));case 2:return settingsCol=_context.sent,_context.abrupt("return",getDefaultedSettingsFromCollection(settingsCol));case 4:case"end":return _context.stop()}},_callee)}));return function(_x){return _ref.apply(this,arguments)}}(),updateSettings=function(){var _ref2=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee2(client,newSettings){var col;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return col=client.collection(ducks_settings_constants__WEBPACK_IMPORTED_MODULE_4__.b),_context2.next=3,col.update(newSettings);case 3:case"end":return _context2.stop()}},_callee2)}));return function(_x2,_x3){return _ref2.apply(this,arguments)}}(),getDefaultedSettingsFromCollection=function(col){var settings=lodash_get__WEBPACK_IMPORTED_MODULE_2___default()(col,"data[0]");return getDefaultedSettings(settings)},fetchCategoryAlerts=function(){var _ref3=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee3(client){var settings;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.prev=0,_context3.next=3,fetchSettings(client);case 3:return settings=_context3.sent,_context3.abrupt("return",settings.categoryBudgetAlerts);case 7:return _context3.prev=7,_context3.t0=_context3.catch(0),log("error","Error while fetching category alerts (".concat(_context3.t0.message,")")),_context3.abrupt("return",[]);case 11:case"end":return _context3.stop()}},_callee3,null,[[0,7]])}));return function(_x4){return _ref3.apply(this,arguments)}}(),updateCategoryAlerts=function(){var _ref4=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee4(client,updatedAlerts){var settings;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,fetchSettings(client);case 2:return(settings=_context4.sent).categoryBudgetAlerts=updatedAlerts,_context4.abrupt("return",updateSettings(client,settings));case 5:case"end":return _context4.stop()}},_callee4)}));return function(_x5,_x6){return _ref4.apply(this,arguments)}}()},,function(module,exports,__webpack_require__){var isPrototype=__webpack_require__(179),nativeKeys=__webpack_require__(495),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}},function(module,exports,__webpack_require__){var metaMap=__webpack_require__(416),noop=__webpack_require__(302),getData=metaMap?function(func){return metaMap.get(func)}:noop;module.exports=getData},function(module,exports){module.exports=function(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}},,function(module,exports,__webpack_require__){var baseKeys=__webpack_require__(264),getTag=__webpack_require__(109),isArrayLike=__webpack_require__(55),isString=__webpack_require__(244),stringSize=__webpack_require__(604),mapTag="[object Map]",setTag="[object Set]";module.exports=function(collection){if(null==collection)return 0;if(isArrayLike(collection))return isString(collection)?stringSize(collection):collection.length;var tag=getTag(collection);return tag==mapTag||tag==setTag?collection.size:baseKeys(collection).length}},function(module,exports,__webpack_require__){"use strict";var c=__webpack_require__(240),Action=module.exports=function(options){if(options=options||{},this.optionStrings=options.optionStrings||[],this.dest=options.dest,this.nargs=void 0!==options.nargs?options.nargs:null,this.constant=void 0!==options.constant?options.constant:null,this.defaultValue=options.defaultValue,this.type=void 0!==options.type?options.type:null,this.choices=void 0!==options.choices?options.choices:null,this.required=void 0!==options.required&&options.required,this.help=void 0!==options.help?options.help:null,this.metavar=void 0!==options.metavar?options.metavar:null,!(this.optionStrings instanceof Array))throw new Error("optionStrings should be an array");if(void 0!==this.required&&"boolean"!=typeof this.required)throw new Error("required should be a boolean")};Action.prototype.getName=function(){return this.optionStrings.length>0?this.optionStrings.join("/"):null!==this.metavar&&this.metavar!==c.SUPPRESS?this.metavar:void 0!==this.dest&&this.dest!==c.SUPPRESS?this.dest:null},Action.prototype.isOptional=function(){return!this.isPositional()},Action.prototype.isPositional=function(){return 0===this.optionStrings.length},Action.prototype.call=function(){throw new Error(".call() not defined")}},function(module,exports,__webpack_require__){var baseExtremum=__webpack_require__(423),baseGt=__webpack_require__(453),baseIteratee=__webpack_require__(18);module.exports=function(array,iteratee){return array&&array.length?baseExtremum(array,baseIteratee(iteratee,2),baseGt):void 0}},function(module,exports){module.exports=function(array){var length=null==array?0:array.length;return length?array[length-1]:void 0}},function(module,exports){module.exports=function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}},function(module,exports,__webpack_require__){var baseIsEqual=__webpack_require__(184);module.exports=function(value,other){return baseIsEqual(value,other)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var stream__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(11),stream__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(stream__WEBPACK_IMPORTED_MODULE_0__),http__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(68),http__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(http__WEBPACK_IMPORTED_MODULE_1__),url__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(23),url__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_2__),https__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(111),https__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(https__WEBPACK_IMPORTED_MODULE_3__),zlib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(48),zlib__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(zlib__WEBPACK_IMPORTED_MODULE_4__);const Readable=stream__WEBPACK_IMPORTED_MODULE_0___default.a.Readable,BUFFER=Symbol("buffer"),TYPE=Symbol("type");class Blob{constructor(){this[TYPE]="";const blobParts=arguments[0],options=arguments[1],buffers=[];let size=0;if(blobParts){const a=blobParts,length=Number(a.length);for(let i=0;i<length;i++){const element=a[i];let buffer;size+=(buffer=element instanceof Buffer?element:ArrayBuffer.isView(element)?Buffer.from(element.buffer,element.byteOffset,element.byteLength):element instanceof ArrayBuffer?Buffer.from(element):element instanceof Blob?element[BUFFER]:Buffer.from("string"==typeof element?element:String(element))).length,buffers.push(buffer)}}this[BUFFER]=Buffer.concat(buffers);let type=options&&void 0!==options.type&&String(options.type).toLowerCase();type&&!/[^\u0020-\u007E]/.test(type)&&(this[TYPE]=type)}get size(){return this[BUFFER].length}get type(){return this[TYPE]}text(){return Promise.resolve(this[BUFFER].toString())}arrayBuffer(){const buf=this[BUFFER],ab=buf.buffer.slice(buf.byteOffset,buf.byteOffset+buf.byteLength);return Promise.resolve(ab)}stream(){const readable=new Readable;return readable._read=function(){},readable.push(this[BUFFER]),readable.push(null),readable}toString(){return"[object Blob]"}slice(){const size=this.size,start=arguments[0],end=arguments[1];let relativeStart,relativeEnd;relativeStart=void 0===start?0:start<0?Math.max(size+start,0):Math.min(start,size),relativeEnd=void 0===end?size:end<0?Math.max(size+end,0):Math.min(end,size);const span=Math.max(relativeEnd-relativeStart,0),slicedBuffer=this[BUFFER].slice(relativeStart,relativeStart+span),blob=new Blob([],{type:arguments[2]});return blob[BUFFER]=slicedBuffer,blob}}function FetchError(message,type,systemError){Error.call(this,message),this.message=message,this.type=type,systemError&&(this.code=this.errno=systemError.code),Error.captureStackTrace(this,this.constructor)}let convert;Object.defineProperties(Blob.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(Blob.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),FetchError.prototype=Object.create(Error.prototype),FetchError.prototype.constructor=FetchError,FetchError.prototype.name="FetchError";try{convert=__webpack_require__(431).convert}catch(e){}const INTERNALS=Symbol("Body internals"),PassThrough=stream__WEBPACK_IMPORTED_MODULE_0___default.a.PassThrough;function Body(body){var _this=this,_ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref$size=_ref.size;let size=void 0===_ref$size?0:_ref$size;var _ref$timeout=_ref.timeout;let timeout=void 0===_ref$timeout?0:_ref$timeout;null==body?body=null:isURLSearchParams(body)?body=Buffer.from(body.toString()):isBlob(body)||Buffer.isBuffer(body)||("[object ArrayBuffer]"===Object.prototype.toString.call(body)?body=Buffer.from(body):ArrayBuffer.isView(body)?body=Buffer.from(body.buffer,body.byteOffset,body.byteLength):body instanceof stream__WEBPACK_IMPORTED_MODULE_0___default.a||(body=Buffer.from(String(body)))),this[INTERNALS]={body:body,disturbed:!1,error:null},this.size=size,this.timeout=timeout,body instanceof stream__WEBPACK_IMPORTED_MODULE_0___default.a&&body.on("error",function(err){const error="AbortError"===err.name?err:new FetchError(`Invalid response body while trying to fetch ${_this.url}: ${err.message}`,"system",err);_this[INTERNALS].error=error})}function consumeBody(){var _this4=this;if(this[INTERNALS].disturbed)return Body.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[INTERNALS].disturbed=!0,this[INTERNALS].error)return Body.Promise.reject(this[INTERNALS].error);let body=this.body;if(null===body)return Body.Promise.resolve(Buffer.alloc(0));if(isBlob(body)&&(body=body.stream()),Buffer.isBuffer(body))return Body.Promise.resolve(body);if(!(body instanceof stream__WEBPACK_IMPORTED_MODULE_0___default.a))return Body.Promise.resolve(Buffer.alloc(0));let accum=[],accumBytes=0,abort=!1;return new Body.Promise(function(resolve,reject){let resTimeout;_this4.timeout&&(resTimeout=setTimeout(function(){abort=!0,reject(new FetchError(`Response timeout while trying to fetch ${_this4.url} (over ${_this4.timeout}ms)`,"body-timeout"))},_this4.timeout)),body.on("error",function(err){"AbortError"===err.name?(abort=!0,reject(err)):reject(new FetchError(`Invalid response body while trying to fetch ${_this4.url}: ${err.message}`,"system",err))}),body.on("data",function(chunk){if(!abort&&null!==chunk){if(_this4.size&&accumBytes+chunk.length>_this4.size)return abort=!0,void reject(new FetchError(`content size at ${_this4.url} over limit: ${_this4.size}`,"max-size"));accumBytes+=chunk.length,accum.push(chunk)}}),body.on("end",function(){if(!abort){clearTimeout(resTimeout);try{resolve(Buffer.concat(accum,accumBytes))}catch(err){reject(new FetchError(`Could not create Buffer from response body for ${_this4.url}: ${err.message}`,"system",err))}}})})}function isURLSearchParams(obj){return"object"==typeof obj&&"function"==typeof obj.append&&"function"==typeof obj.delete&&"function"==typeof obj.get&&"function"==typeof obj.getAll&&"function"==typeof obj.has&&"function"==typeof obj.set&&("URLSearchParams"===obj.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(obj)||"function"==typeof obj.sort)}function isBlob(obj){return"object"==typeof obj&&"function"==typeof obj.arrayBuffer&&"string"==typeof obj.type&&"function"==typeof obj.stream&&"function"==typeof obj.constructor&&"string"==typeof obj.constructor.name&&/^(Blob|File)$/.test(obj.constructor.name)&&/^(Blob|File)$/.test(obj[Symbol.toStringTag])}function clone(instance){let p1,p2,body=instance.body;if(instance.bodyUsed)throw new Error("cannot clone body after it is used");return body instanceof stream__WEBPACK_IMPORTED_MODULE_0___default.a&&"function"!=typeof body.getBoundary&&(p1=new PassThrough,p2=new PassThrough,body.pipe(p1),body.pipe(p2),instance[INTERNALS].body=p1,body=p2),body}function extractContentType(body){return null===body?null:"string"==typeof body?"text/plain;charset=UTF-8":isURLSearchParams(body)?"application/x-www-form-urlencoded;charset=UTF-8":isBlob(body)?body.type||null:Buffer.isBuffer(body)?null:"[object ArrayBuffer]"===Object.prototype.toString.call(body)?null:ArrayBuffer.isView(body)?null:"function"==typeof body.getBoundary?`multipart/form-data;boundary=${body.getBoundary()}`:body instanceof stream__WEBPACK_IMPORTED_MODULE_0___default.a?null:"text/plain;charset=UTF-8"}function getTotalBytes(instance){const body=instance.body;return null===body?0:isBlob(body)?body.size:Buffer.isBuffer(body)?body.length:body&&"function"==typeof body.getLengthSync&&(body._lengthRetrievers&&0==body._lengthRetrievers.length||body.hasKnownLength&&body.hasKnownLength())?body.getLengthSync():null}Body.prototype={get body(){return this[INTERNALS].body},get bodyUsed(){return this[INTERNALS].disturbed},arrayBuffer(){return consumeBody.call(this).then(function(buf){return buf.buffer.slice(buf.byteOffset,buf.byteOffset+buf.byteLength)})},blob(){let ct=this.headers&&this.headers.get("content-type")||"";return consumeBody.call(this).then(function(buf){return Object.assign(new Blob([],{type:ct.toLowerCase()}),{[BUFFER]:buf})})},json(){var _this2=this;return consumeBody.call(this).then(function(buffer){try{return JSON.parse(buffer.toString())}catch(err){return Body.Promise.reject(new FetchError(`invalid json response body at ${_this2.url} reason: ${err.message}`,"invalid-json"))}})},text(){return consumeBody.call(this).then(function(buffer){return buffer.toString()})},buffer(){return consumeBody.call(this)},textConverted(){var _this3=this;return consumeBody.call(this).then(function(buffer){return function(buffer,headers){if("function"!=typeof convert)throw new Error("The package `encoding` must be installed to use the textConverted() function");const ct=headers.get("content-type");let res,str,charset="utf-8";ct&&(res=/charset=([^;]*)/i.exec(ct));str=buffer.slice(0,1024).toString(),!res&&str&&(res=/<meta.+?charset=(['"])(.+?)\1/i.exec(str));!res&&str&&(res=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(str))&&(res=/charset=(.*)/i.exec(res.pop()));!res&&str&&(res=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(str));res&&("gb2312"!==(charset=res.pop())&&"gbk"!==charset||(charset="gb18030"));return convert(buffer,"UTF-8",charset).toString()}(buffer,_this3.headers)})}},Object.defineProperties(Body.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),Body.mixIn=function(proto){for(const name of Object.getOwnPropertyNames(Body.prototype))if(!(name in proto)){const desc=Object.getOwnPropertyDescriptor(Body.prototype,name);Object.defineProperty(proto,name,desc)}},Body.Promise=global.Promise;const invalidTokenRegex=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,invalidHeaderCharRegex=/[^\t\x20-\x7e\x80-\xff]/;function validateName(name){if(name=`${name}`,invalidTokenRegex.test(name)||""===name)throw new TypeError(`${name} is not a legal HTTP header name`)}function validateValue(value){if(value=`${value}`,invalidHeaderCharRegex.test(value))throw new TypeError(`${value} is not a legal HTTP header value`)}function find(map,name){name=name.toLowerCase();for(const key in map)if(key.toLowerCase()===name)return key}const MAP=Symbol("map");class Headers{constructor(){let init=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[MAP]=Object.create(null),init instanceof Headers){const rawHeaders=init.raw(),headerNames=Object.keys(rawHeaders);for(const headerName of headerNames)for(const value of rawHeaders[headerName])this.append(headerName,value)}else if(null==init);else{if("object"!=typeof init)throw new TypeError("Provided initializer must be an object");{const method=init[Symbol.iterator];if(null!=method){if("function"!=typeof method)throw new TypeError("Header pairs must be iterable");const pairs=[];for(const pair of init){if("object"!=typeof pair||"function"!=typeof pair[Symbol.iterator])throw new TypeError("Each header pair must be iterable");pairs.push(Array.from(pair))}for(const pair of pairs){if(2!==pair.length)throw new TypeError("Each header pair must be a name/value tuple");this.append(pair[0],pair[1])}}else for(const key of Object.keys(init)){const value=init[key];this.append(key,value)}}}}get(name){validateName(name=`${name}`);const key=find(this[MAP],name);return void 0===key?null:this[MAP][key].join(", ")}forEach(callback){let thisArg=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,pairs=getHeaders(this),i=0;for(;i<pairs.length;){var _pairs$i=pairs[i];const name=_pairs$i[0],value=_pairs$i[1];callback.call(thisArg,value,name,this),pairs=getHeaders(this),i++}}set(name,value){value=`${value}`,validateName(name=`${name}`),validateValue(value);const key=find(this[MAP],name);this[MAP][void 0!==key?key:name]=[value]}append(name,value){value=`${value}`,validateName(name=`${name}`),validateValue(value);const key=find(this[MAP],name);void 0!==key?this[MAP][key].push(value):this[MAP][name]=[value]}has(name){return validateName(name=`${name}`),void 0!==find(this[MAP],name)}delete(name){validateName(name=`${name}`);const key=find(this[MAP],name);void 0!==key&&delete this[MAP][key]}raw(){return this[MAP]}keys(){return createHeadersIterator(this,"key")}values(){return createHeadersIterator(this,"value")}[Symbol.iterator](){return createHeadersIterator(this,"key+value")}}function getHeaders(headers){let kind=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";return Object.keys(headers[MAP]).sort().map("key"===kind?function(k){return k.toLowerCase()}:"value"===kind?function(k){return headers[MAP][k].join(", ")}:function(k){return[k.toLowerCase(),headers[MAP][k].join(", ")]})}Headers.prototype.entries=Headers.prototype[Symbol.iterator],Object.defineProperty(Headers.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(Headers.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});const INTERNAL=Symbol("internal");function createHeadersIterator(target,kind){const iterator=Object.create(HeadersIteratorPrototype);return iterator[INTERNAL]={target:target,kind:kind,index:0},iterator}const HeadersIteratorPrototype=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==HeadersIteratorPrototype)throw new TypeError("Value of `this` is not a HeadersIterator");var _INTERNAL=this[INTERNAL];const target=_INTERNAL.target,kind=_INTERNAL.kind,index=_INTERNAL.index,values=getHeaders(target,kind);return index>=values.length?{value:void 0,done:!0}:(this[INTERNAL].index=index+1,{value:values[index],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function exportNodeCompatibleHeaders(headers){const obj=Object.assign({__proto__:null},headers[MAP]),hostHeaderKey=find(headers[MAP],"Host");return void 0!==hostHeaderKey&&(obj[hostHeaderKey]=obj[hostHeaderKey][0]),obj}Object.defineProperty(HeadersIteratorPrototype,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});const INTERNALS$1=Symbol("Response internals"),STATUS_CODES=http__WEBPACK_IMPORTED_MODULE_1___default.a.STATUS_CODES;class Response{constructor(){let body=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,opts=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Body.call(this,body,opts);const status=opts.status||200,headers=new Headers(opts.headers);if(null!=body&&!headers.has("Content-Type")){const contentType=extractContentType(body);contentType&&headers.append("Content-Type",contentType)}this[INTERNALS$1]={url:opts.url,status:status,statusText:opts.statusText||STATUS_CODES[status],headers:headers,counter:opts.counter}}get url(){return this[INTERNALS$1].url||""}get status(){return this[INTERNALS$1].status}get ok(){return this[INTERNALS$1].status>=200&&this[INTERNALS$1].status<300}get redirected(){return this[INTERNALS$1].counter>0}get statusText(){return this[INTERNALS$1].statusText}get headers(){return this[INTERNALS$1].headers}clone(){return new Response(clone(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}Body.mixIn(Response.prototype),Object.defineProperties(Response.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(Response.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const INTERNALS$2=Symbol("Request internals"),parse_url=url__WEBPACK_IMPORTED_MODULE_2___default.a.parse,format_url=url__WEBPACK_IMPORTED_MODULE_2___default.a.format,streamDestructionSupported="destroy"in stream__WEBPACK_IMPORTED_MODULE_0___default.a.Readable.prototype;function isRequest(input){return"object"==typeof input&&"object"==typeof input[INTERNALS$2]}class Request{constructor(input){let parsedURL,init=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};isRequest(input)?parsedURL=parse_url(input.url):(parsedURL=input&&input.href?parse_url(input.href):parse_url(`${input}`),input={});let method=init.method||input.method||"GET";if(method=method.toUpperCase(),(null!=init.body||isRequest(input)&&null!==input.body)&&("GET"===method||"HEAD"===method))throw new TypeError("Request with GET/HEAD method cannot have body");let inputBody=null!=init.body?init.body:isRequest(input)&&null!==input.body?clone(input):null;Body.call(this,inputBody,{timeout:init.timeout||input.timeout||0,size:init.size||input.size||0});const headers=new Headers(init.headers||input.headers||{});if(null!=inputBody&&!headers.has("Content-Type")){const contentType=extractContentType(inputBody);contentType&&headers.append("Content-Type",contentType)}let signal=isRequest(input)?input.signal:null;if("signal"in init&&(signal=init.signal),null!=signal&&!function(signal){const proto=signal&&"object"==typeof signal&&Object.getPrototypeOf(signal);return!(!proto||"AbortSignal"!==proto.constructor.name)}(signal))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[INTERNALS$2]={method:method,redirect:init.redirect||input.redirect||"follow",headers:headers,parsedURL:parsedURL,signal:signal},this.follow=void 0!==init.follow?init.follow:void 0!==input.follow?input.follow:20,this.compress=void 0!==init.compress?init.compress:void 0===input.compress||input.compress,this.counter=init.counter||input.counter||0,this.agent=init.agent||input.agent}get method(){return this[INTERNALS$2].method}get url(){return format_url(this[INTERNALS$2].parsedURL)}get headers(){return this[INTERNALS$2].headers}get redirect(){return this[INTERNALS$2].redirect}get signal(){return this[INTERNALS$2].signal}clone(){return new Request(this)}}function AbortError(message){Error.call(this,message),this.type="aborted",this.message=message,Error.captureStackTrace(this,this.constructor)}Body.mixIn(Request.prototype),Object.defineProperty(Request.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(Request.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),AbortError.prototype=Object.create(Error.prototype),AbortError.prototype.constructor=AbortError,AbortError.prototype.name="AbortError";const PassThrough$1=stream__WEBPACK_IMPORTED_MODULE_0___default.a.PassThrough,resolve_url=url__WEBPACK_IMPORTED_MODULE_2___default.a.resolve;function fetch(url,opts){if(!fetch.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return Body.Promise=fetch.Promise,new fetch.Promise(function(resolve,reject){const request=new Request(url,opts),options=function(request){const parsedURL=request[INTERNALS$2].parsedURL,headers=new Headers(request[INTERNALS$2].headers);if(headers.has("Accept")||headers.set("Accept","*/*"),!parsedURL.protocol||!parsedURL.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(parsedURL.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(request.signal&&request.body instanceof stream__WEBPACK_IMPORTED_MODULE_0___default.a.Readable&&!streamDestructionSupported)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let contentLengthValue=null;if(null==request.body&&/^(POST|PUT)$/i.test(request.method)&&(contentLengthValue="0"),null!=request.body){const totalBytes=getTotalBytes(request);"number"==typeof totalBytes&&(contentLengthValue=String(totalBytes))}contentLengthValue&&headers.set("Content-Length",contentLengthValue),headers.has("User-Agent")||headers.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),request.compress&&!headers.has("Accept-Encoding")&&headers.set("Accept-Encoding","gzip,deflate");let agent=request.agent;return"function"==typeof agent&&(agent=agent(parsedURL)),headers.has("Connection")||agent||headers.set("Connection","close"),Object.assign({},parsedURL,{method:request.method,headers:exportNodeCompatibleHeaders(headers),agent:agent})}(request),send=("https:"===options.protocol?https__WEBPACK_IMPORTED_MODULE_3___default.a:http__WEBPACK_IMPORTED_MODULE_1___default.a).request,signal=request.signal;let response=null;const abort=function(){let error=new AbortError("The user aborted a request.");reject(error),request.body&&request.body instanceof stream__WEBPACK_IMPORTED_MODULE_0___default.a.Readable&&request.body.destroy(error),response&&response.body&&response.body.emit("error",error)};if(signal&&signal.aborted)return void abort();const abortAndFinalize=function(){abort(),finalize()},req=send(options);let reqTimeout;function finalize(){req.abort(),signal&&signal.removeEventListener("abort",abortAndFinalize),clearTimeout(reqTimeout)}signal&&signal.addEventListener("abort",abortAndFinalize),request.timeout&&req.once("socket",function(socket){reqTimeout=setTimeout(function(){reject(new FetchError(`network timeout at: ${request.url}`,"request-timeout")),finalize()},request.timeout)}),req.on("error",function(err){reject(new FetchError(`request to ${request.url} failed, reason: ${err.message}`,"system",err)),finalize()}),req.on("response",function(res){clearTimeout(reqTimeout);const headers=function(obj){const headers=new Headers;for(const name of Object.keys(obj))if(!invalidTokenRegex.test(name))if(Array.isArray(obj[name]))for(const val of obj[name])invalidHeaderCharRegex.test(val)||(void 0===headers[MAP][name]?headers[MAP][name]=[val]:headers[MAP][name].push(val));else invalidHeaderCharRegex.test(obj[name])||(headers[MAP][name]=[obj[name]]);return headers}(res.headers);if(fetch.isRedirect(res.statusCode)){const location=headers.get("Location"),locationURL=null===location?null:resolve_url(request.url,location);switch(request.redirect){case"error":return reject(new FetchError(`redirect mode is set to error: ${request.url}`,"no-redirect")),void finalize();case"manual":if(null!==locationURL)try{headers.set("Location",locationURL)}catch(err){reject(err)}break;case"follow":if(null===locationURL)break;if(request.counter>=request.follow)return reject(new FetchError(`maximum redirect reached at: ${request.url}`,"max-redirect")),void finalize();const requestOpts={headers:new Headers(request.headers),follow:request.follow,counter:request.counter+1,agent:request.agent,compress:request.compress,method:request.method,body:request.body,signal:request.signal,timeout:request.timeout};return 303!==res.statusCode&&request.body&&null===getTotalBytes(request)?(reject(new FetchError("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void finalize()):(303!==res.statusCode&&(301!==res.statusCode&&302!==res.statusCode||"POST"!==request.method)||(requestOpts.method="GET",requestOpts.body=void 0,requestOpts.headers.delete("content-length")),resolve(fetch(new Request(locationURL,requestOpts))),void finalize())}}res.once("end",function(){signal&&signal.removeEventListener("abort",abortAndFinalize)});let body=res.pipe(new PassThrough$1);const response_options={url:request.url,status:res.statusCode,statusText:res.statusMessage,headers:headers,size:request.size,timeout:request.timeout,counter:request.counter},codings=headers.get("Content-Encoding");if(!request.compress||"HEAD"===request.method||null===codings||204===res.statusCode||304===res.statusCode)return response=new Response(body,response_options),void resolve(response);const zlibOptions={flush:zlib__WEBPACK_IMPORTED_MODULE_4___default.a.Z_SYNC_FLUSH,finishFlush:zlib__WEBPACK_IMPORTED_MODULE_4___default.a.Z_SYNC_FLUSH};if("gzip"==codings||"x-gzip"==codings)return body=body.pipe(zlib__WEBPACK_IMPORTED_MODULE_4___default.a.createGunzip(zlibOptions)),response=new Response(body,response_options),void resolve(response);if("deflate"!=codings&&"x-deflate"!=codings){if("br"==codings&&"function"==typeof zlib__WEBPACK_IMPORTED_MODULE_4___default.a.createBrotliDecompress)return body=body.pipe(zlib__WEBPACK_IMPORTED_MODULE_4___default.a.createBrotliDecompress()),response=new Response(body,response_options),void resolve(response);response=new Response(body,response_options),resolve(response)}else{res.pipe(new PassThrough$1).once("data",function(chunk){body=8==(15&chunk[0])?body.pipe(zlib__WEBPACK_IMPORTED_MODULE_4___default.a.createInflate()):body.pipe(zlib__WEBPACK_IMPORTED_MODULE_4___default.a.createInflateRaw()),response=new Response(body,response_options),resolve(response)})}}),function(dest,instance){const body=instance.body;null===body?dest.end():isBlob(body)?body.stream().pipe(dest):Buffer.isBuffer(body)?(dest.write(body),dest.end()):body.pipe(dest)}(req,request)})}fetch.isRedirect=function(code){return 301===code||302===code||303===code||307===code||308===code},fetch.Promise=global.Promise,__webpack_exports__.a=fetch},,function(module,exports){module.exports=function(array,start,end){var index=-1,length=array.length;start<0&&(start=-start>length?0:length+start),(end=end>length?length:end)<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}},function(module,exports,__webpack_require__){var g=function(){return this||"object"==typeof self&&self}()||Function("return this")(),hadRuntime=g.regeneratorRuntime&&Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime")>=0,oldRuntime=hadRuntime&&g.regeneratorRuntime;if(g.regeneratorRuntime=void 0,module.exports=__webpack_require__(454),hadRuntime)g.regeneratorRuntime=oldRuntime;else try{delete g.regeneratorRuntime}catch(e){g.regeneratorRuntime=void 0}},function(module,exports,__webpack_require__){var cssKeywords=__webpack_require__(457),reverseKeywords={};for(var key in cssKeywords)cssKeywords.hasOwnProperty(key)&&(reverseKeywords[cssKeywords[key]]=key);var convert=module.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var model in convert)if(convert.hasOwnProperty(model)){if(!("channels"in convert[model]))throw new Error("missing channels property: "+model);if(!("labels"in convert[model]))throw new Error("missing channel labels property: "+model);if(convert[model].labels.length!==convert[model].channels)throw new Error("channel and label counts mismatch: "+model);var channels=convert[model].channels,labels=convert[model].labels;delete convert[model].channels,delete convert[model].labels,Object.defineProperty(convert[model],"channels",{value:channels}),Object.defineProperty(convert[model],"labels",{value:labels})}convert.rgb.hsl=function(rgb){var h,l,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return max===min?h=0:r===max?h=(g-b)/delta:g===max?h=2+(b-r)/delta:b===max&&(h=4+(r-g)/delta),(h=Math.min(60*h,360))<0&&(h+=360),l=(min+max)/2,[h,100*(max===min?0:l<=.5?delta/(max+min):delta/(2-max-min)),100*l]},convert.rgb.hsv=function(rgb){var rdif,gdif,bdif,h,s,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,v=Math.max(r,g,b),diff=v-Math.min(r,g,b),diffc=function(c){return(v-c)/6/diff+.5};return 0===diff?h=s=0:(s=diff/v,rdif=diffc(r),gdif=diffc(g),bdif=diffc(b),r===v?h=bdif-gdif:g===v?h=1/3+rdif-bdif:b===v&&(h=2/3+gdif-rdif),h<0?h+=1:h>1&&(h-=1)),[360*h,100*s,100*v]},convert.rgb.hwb=function(rgb){var r=rgb[0],g=rgb[1],b=rgb[2];return[convert.rgb.hsl(rgb)[0],100*(1/255*Math.min(r,Math.min(g,b))),100*(b=1-1/255*Math.max(r,Math.max(g,b)))]},convert.rgb.cmyk=function(rgb){var k,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;return[100*((1-r-(k=Math.min(1-r,1-g,1-b)))/(1-k)||0),100*((1-g-k)/(1-k)||0),100*((1-b-k)/(1-k)||0),100*k]},convert.rgb.keyword=function(rgb){var reversed=reverseKeywords[rgb];if(reversed)return reversed;var currentClosestKeyword,x,y,currentClosestDistance=1/0;for(var keyword in cssKeywords)if(cssKeywords.hasOwnProperty(keyword)){var value=cssKeywords[keyword],distance=(x=rgb,y=value,Math.pow(x[0]-y[0],2)+Math.pow(x[1]-y[1],2)+Math.pow(x[2]-y[2],2));distance<currentClosestDistance&&(currentClosestDistance=distance,currentClosestKeyword=keyword)}return currentClosestKeyword},convert.keyword.rgb=function(keyword){return cssKeywords[keyword]},convert.rgb.xyz=function(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;return[100*(.4124*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.3576*(g=g>.04045?Math.pow((g+.055)/1.055,2.4):g/12.92)+.1805*(b=b>.04045?Math.pow((b+.055)/1.055,2.4):b/12.92)),100*(.2126*r+.7152*g+.0722*b),100*(.0193*r+.1192*g+.9505*b)]},convert.rgb.lab=function(rgb){var xyz=convert.rgb.xyz(rgb),x=xyz[0],y=xyz[1],z=xyz[2];return y/=100,z/=108.883,x=(x/=95.047)>.008856?Math.pow(x,1/3):7.787*x+16/116,[116*(y=y>.008856?Math.pow(y,1/3):7.787*y+16/116)-16,500*(x-y),200*(y-(z=z>.008856?Math.pow(z,1/3):7.787*z+16/116))]},convert.hsl.rgb=function(hsl){var t1,t2,t3,rgb,val,h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100;if(0===s)return[val=255*l,val,val];t1=2*l-(t2=l<.5?l*(1+s):l+s-l*s),rgb=[0,0,0];for(var i=0;i<3;i++)(t3=h+1/3*-(i-1))<0&&t3++,t3>1&&t3--,val=6*t3<1?t1+6*(t2-t1)*t3:2*t3<1?t2:3*t3<2?t1+(t2-t1)*(2/3-t3)*6:t1,rgb[i]=255*val;return rgb},convert.hsl.hsv=function(hsl){var h=hsl[0],s=hsl[1]/100,l=hsl[2]/100,smin=s,lmin=Math.max(l,.01);return s*=(l*=2)<=1?l:2-l,smin*=lmin<=1?lmin:2-lmin,[h,100*(0===l?2*smin/(lmin+smin):2*s/(l+s)),100*((l+s)/2)]},convert.hsv.rgb=function(hsv){var h=hsv[0]/60,s=hsv[1]/100,v=hsv[2]/100,hi=Math.floor(h)%6,f=h-Math.floor(h),p=255*v*(1-s),q=255*v*(1-s*f),t=255*v*(1-s*(1-f));switch(v*=255,hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q]}},convert.hsv.hsl=function(hsv){var lmin,sl,l,h=hsv[0],s=hsv[1]/100,v=hsv[2]/100,vmin=Math.max(v,.01);return l=(2-s)*v,sl=s*vmin,[h,100*(sl=(sl/=(lmin=(2-s)*vmin)<=1?lmin:2-lmin)||0),100*(l/=2)]},convert.hwb.rgb=function(hwb){var i,v,f,n,r,g,b,h=hwb[0]/360,wh=hwb[1]/100,bl=hwb[2]/100,ratio=wh+bl;switch(ratio>1&&(wh/=ratio,bl/=ratio),f=6*h-(i=Math.floor(6*h)),0!=(1&i)&&(f=1-f),n=wh+f*((v=1-bl)-wh),i){default:case 6:case 0:r=v,g=n,b=wh;break;case 1:r=n,g=v,b=wh;break;case 2:r=wh,g=v,b=n;break;case 3:r=wh,g=n,b=v;break;case 4:r=n,g=wh,b=v;break;case 5:r=v,g=wh,b=n}return[255*r,255*g,255*b]},convert.cmyk.rgb=function(cmyk){var c=cmyk[0]/100,m=cmyk[1]/100,y=cmyk[2]/100,k=cmyk[3]/100;return[255*(1-Math.min(1,c*(1-k)+k)),255*(1-Math.min(1,m*(1-k)+k)),255*(1-Math.min(1,y*(1-k)+k))]},convert.xyz.rgb=function(xyz){var r,g,b,x=xyz[0]/100,y=xyz[1]/100,z=xyz[2]/100;return g=-.9689*x+1.8758*y+.0415*z,b=.0557*x+-.204*y+1.057*z,r=(r=3.2406*x+-1.5372*y+-.4986*z)>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,g=g>.0031308?1.055*Math.pow(g,1/2.4)-.055:12.92*g,b=b>.0031308?1.055*Math.pow(b,1/2.4)-.055:12.92*b,[255*(r=Math.min(Math.max(0,r),1)),255*(g=Math.min(Math.max(0,g),1)),255*(b=Math.min(Math.max(0,b),1))]},convert.xyz.lab=function(xyz){var x=xyz[0],y=xyz[1],z=xyz[2];return y/=100,z/=108.883,x=(x/=95.047)>.008856?Math.pow(x,1/3):7.787*x+16/116,[116*(y=y>.008856?Math.pow(y,1/3):7.787*y+16/116)-16,500*(x-y),200*(y-(z=z>.008856?Math.pow(z,1/3):7.787*z+16/116))]},convert.lab.xyz=function(lab){var x,y,z,l=lab[0];x=lab[1]/500+(y=(l+16)/116),z=y-lab[2]/200;var y2=Math.pow(y,3),x2=Math.pow(x,3),z2=Math.pow(z,3);return y=y2>.008856?y2:(y-16/116)/7.787,x=x2>.008856?x2:(x-16/116)/7.787,z=z2>.008856?z2:(z-16/116)/7.787,[x*=95.047,y*=100,z*=108.883]},convert.lab.lch=function(lab){var h,l=lab[0],a=lab[1],b=lab[2];return(h=360*Math.atan2(b,a)/2/Math.PI)<0&&(h+=360),[l,Math.sqrt(a*a+b*b),h]},convert.lch.lab=function(lch){var hr,l=lch[0],c=lch[1];return hr=lch[2]/360*2*Math.PI,[l,c*Math.cos(hr),c*Math.sin(hr)]},convert.rgb.ansi16=function(args){var r=args[0],g=args[1],b=args[2],value=1 in arguments?arguments[1]:convert.rgb.hsv(args)[2];if(0===(value=Math.round(value/50)))return 30;var ansi=30+(Math.round(b/255)<<2|Math.round(g/255)<<1|Math.round(r/255));return 2===value&&(ansi+=60),ansi},convert.hsv.ansi16=function(args){return convert.rgb.ansi16(convert.hsv.rgb(args),args[2])},convert.rgb.ansi256=function(args){var r=args[0],g=args[1],b=args[2];return r===g&&g===b?r<8?16:r>248?231:Math.round((r-8)/247*24)+232:16+36*Math.round(r/255*5)+6*Math.round(g/255*5)+Math.round(b/255*5)},convert.ansi16.rgb=function(args){var color=args%10;if(0===color||7===color)return args>50&&(color+=3.5),[color=color/10.5*255,color,color];var mult=.5*(1+~~(args>50));return[(1&color)*mult*255,(color>>1&1)*mult*255,(color>>2&1)*mult*255]},convert.ansi256.rgb=function(args){if(args>=232){var c=10*(args-232)+8;return[c,c,c]}var rem;return args-=16,[Math.floor(args/36)/5*255,Math.floor((rem=args%36)/6)/5*255,rem%6/5*255]},convert.rgb.hex=function(args){var string=(((255&Math.round(args[0]))<<16)+((255&Math.round(args[1]))<<8)+(255&Math.round(args[2]))).toString(16).toUpperCase();return"000000".substring(string.length)+string},convert.hex.rgb=function(args){var match=args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!match)return[0,0,0];var colorString=match[0];3===match[0].length&&(colorString=colorString.split("").map(function(char){return char+char}).join(""));var integer=parseInt(colorString,16);return[integer>>16&255,integer>>8&255,255&integer]},convert.rgb.hcg=function(rgb){var hue,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,max=Math.max(Math.max(r,g),b),min=Math.min(Math.min(r,g),b),chroma=max-min;return hue=chroma<=0?0:max===r?(g-b)/chroma%6:max===g?2+(b-r)/chroma:4+(r-g)/chroma+4,hue/=6,[360*(hue%=1),100*chroma,100*(chroma<1?min/(1-chroma):0)]},convert.hsl.hcg=function(hsl){var s=hsl[1]/100,l=hsl[2]/100,c=1,f=0;return(c=l<.5?2*s*l:2*s*(1-l))<1&&(f=(l-.5*c)/(1-c)),[hsl[0],100*c,100*f]},convert.hsv.hcg=function(hsv){var s=hsv[1]/100,v=hsv[2]/100,c=s*v,f=0;return c<1&&(f=(v-c)/(1-c)),[hsv[0],100*c,100*f]},convert.hcg.rgb=function(hcg){var h=hcg[0]/360,c=hcg[1]/100,g=hcg[2]/100;if(0===c)return[255*g,255*g,255*g];var mg,pure=[0,0,0],hi=h%1*6,v=hi%1,w=1-v;switch(Math.floor(hi)){case 0:pure[0]=1,pure[1]=v,pure[2]=0;break;case 1:pure[0]=w,pure[1]=1,pure[2]=0;break;case 2:pure[0]=0,pure[1]=1,pure[2]=v;break;case 3:pure[0]=0,pure[1]=w,pure[2]=1;break;case 4:pure[0]=v,pure[1]=0,pure[2]=1;break;default:pure[0]=1,pure[1]=0,pure[2]=w}return mg=(1-c)*g,[255*(c*pure[0]+mg),255*(c*pure[1]+mg),255*(c*pure[2]+mg)]},convert.hcg.hsv=function(hcg){var c=hcg[1]/100,v=c+hcg[2]/100*(1-c),f=0;return v>0&&(f=c/v),[hcg[0],100*f,100*v]},convert.hcg.hsl=function(hcg){var c=hcg[1]/100,l=hcg[2]/100*(1-c)+.5*c,s=0;return l>0&&l<.5?s=c/(2*l):l>=.5&&l<1&&(s=c/(2*(1-l))),[hcg[0],100*s,100*l]},convert.hcg.hwb=function(hcg){var c=hcg[1]/100,v=c+hcg[2]/100*(1-c);return[hcg[0],100*(v-c),100*(1-v)]},convert.hwb.hcg=function(hwb){var w=hwb[1]/100,v=1-hwb[2]/100,c=v-w,g=0;return c<1&&(g=(v-c)/(1-c)),[hwb[0],100*c,100*g]},convert.apple.rgb=function(apple){return[apple[0]/65535*255,apple[1]/65535*255,apple[2]/65535*255]},convert.rgb.apple=function(rgb){return[rgb[0]/255*65535,rgb[1]/255*65535,rgb[2]/255*65535]},convert.gray.rgb=function(args){return[args[0]/100*255,args[0]/100*255,args[0]/100*255]},convert.gray.hsl=convert.gray.hsv=function(args){return[0,0,args[0]]},convert.gray.hwb=function(gray){return[0,100,gray[0]]},convert.gray.cmyk=function(gray){return[0,0,0,gray[0]]},convert.gray.lab=function(gray){return[gray[0],0,0]},convert.gray.hex=function(gray){var val=255&Math.round(gray[0]/100*255),string=((val<<16)+(val<<8)+val).toString(16).toUpperCase();return"000000".substring(string.length)+string},convert.rgb.gray=function(rgb){return[(rgb[0]+rgb[1]+rgb[2])/3/255*100]}},function(module,exports){module.exports=require("os")},,function(module,exports){var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global;module.exports=freeGlobal},,,,,,,,function(module,exports,__webpack_require__){"use strict";var stringify=__webpack_require__(475),parse=__webpack_require__(476),formats=__webpack_require__(291);module.exports={formats:formats,parse:parse,stringify:stringify}},function(module,exports,__webpack_require__){"use strict";var has=Object.prototype.hasOwnProperty,isArray=Array.isArray,hexTable=function(){for(var array=[],i=0;i<256;++i)array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase());return array}(),arrayToObject=function(source,options){for(var obj=options&&options.plainObjects?Object.create(null):{},i=0;i<source.length;++i)void 0!==source[i]&&(obj[i]=source[i]);return obj};module.exports={arrayToObject:arrayToObject,assign:function(target,source){return Object.keys(source).reduce(function(acc,key){return acc[key]=source[key],acc},target)},combine:function(a,b){return[].concat(a,b)},compact:function(value){for(var queue=[{obj:{o:value},prop:"o"}],refs=[],i=0;i<queue.length;++i)for(var item=queue[i],obj=item.obj[item.prop],keys=Object.keys(obj),j=0;j<keys.length;++j){var key=keys[j],val=obj[key];"object"==typeof val&&null!==val&&-1===refs.indexOf(val)&&(queue.push({obj:obj,prop:key}),refs.push(val))}return function(queue){for(;queue.length>1;){var item=queue.pop(),obj=item.obj[item.prop];if(isArray(obj)){for(var compacted=[],j=0;j<obj.length;++j)void 0!==obj[j]&&compacted.push(obj[j]);item.obj[item.prop]=compacted}}}(queue),value},decode:function(str,decoder,charset){var strWithoutPlus=str.replace(/\+/g," ");if("iso-8859-1"===charset)return strWithoutPlus.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(strWithoutPlus)}catch(e){return strWithoutPlus}},encode:function(str,defaultEncoder,charset){if(0===str.length)return str;var string="string"==typeof str?str:String(str);if("iso-8859-1"===charset)return escape(string).replace(/%u[0-9a-f]{4}/gi,function($0){return"%26%23"+parseInt($0.slice(2),16)+"%3B"});for(var out="",i=0;i<string.length;++i){var c=string.charCodeAt(i);45===c||46===c||95===c||126===c||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122?out+=string.charAt(i):c<128?out+=hexTable[c]:c<2048?out+=hexTable[192|c>>6]+hexTable[128|63&c]:c<55296||c>=57344?out+=hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|63&c]:(i+=1,c=65536+((1023&c)<<10|1023&string.charCodeAt(i)),out+=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|63&c])}return out},isBuffer:function(obj){return!(!obj||"object"!=typeof obj||!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)))},isRegExp:function(obj){return"[object RegExp]"===Object.prototype.toString.call(obj)},merge:function merge(target,source,options){if(!source)return target;if("object"!=typeof source){if(isArray(target))target.push(source);else{if(!target||"object"!=typeof target)return[target,source];(options&&(options.plainObjects||options.allowPrototypes)||!has.call(Object.prototype,source))&&(target[source]=!0)}return target}if(!target||"object"!=typeof target)return[target].concat(source);var mergeTarget=target;return isArray(target)&&!isArray(source)&&(mergeTarget=arrayToObject(target,options)),isArray(target)&&isArray(source)?(source.forEach(function(item,i){if(has.call(target,i)){var targetItem=target[i];targetItem&&"object"==typeof targetItem&&item&&"object"==typeof item?target[i]=merge(targetItem,item,options):target.push(item)}else target[i]=item}),target):Object.keys(source).reduce(function(acc,key){var value=source[key];return has.call(acc,key)?acc[key]=merge(acc[key],value,options):acc[key]=value,acc},mergeTarget)}}},function(module,exports,__webpack_require__){"use strict";var replace=String.prototype.replace,percentTwenties=/%20/g;module.exports={default:"RFC3986",formatters:{RFC1738:function(value){return replace.call(value,percentTwenties,"+")},RFC3986:function(value){return value}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},,function(module,exports,__webpack_require__){var getNative=__webpack_require__(77),defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}();module.exports=defineProperty},function(module,exports){var funcToString=Function.prototype.toString;module.exports=function(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}},function(module,exports,__webpack_require__){var baseRest=__webpack_require__(54),isIterateeCall=__webpack_require__(142);module.exports=function(assigner){return baseRest(function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:void 0,guard=length>2?sources[2]:void 0;for(customizer=assigner.length>3&&"function"==typeof customizer?(length--,customizer):void 0,guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?void 0:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object})}},function(module,exports,__webpack_require__){var apply=__webpack_require__(249),nativeMax=Math.max;module.exports=function(func,start,transform){return start=nativeMax(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),apply(func,this,otherArgs)}}},function(module,exports,__webpack_require__){var baseTimes=__webpack_require__(298),isArguments=__webpack_require__(143),isArray=__webpack_require__(12),isBuffer=__webpack_require__(116),isIndex=__webpack_require__(132),isTypedArray=__webpack_require__(144),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}},function(module,exports){module.exports=function(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}},function(module,exports){module.exports=function(func,transform){return function(arg){return func(transform(arg))}}},,function(module,exports,__webpack_require__){var WeakMap=__webpack_require__(77)(__webpack_require__(31),"WeakMap");module.exports=WeakMap},function(module,exports){module.exports=function(){}},function(module,exports,__webpack_require__){var baseFor=__webpack_require__(507)();module.exports=baseFor},,function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(98),eq=__webpack_require__(112);module.exports=function(object,key,value){(void 0===value||eq(object[key],value))&&(void 0!==value||key in object)||baseAssignValue(object,key,value)}},function(module,exports,__webpack_require__){(function(module){var root=__webpack_require__(31),freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;module.exports=function(buffer,isDeep){if(isDeep)return buffer.slice();var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);return buffer.copy(result),result}}).call(this,__webpack_require__(59)(module))},function(module,exports,__webpack_require__){var cloneArrayBuffer=__webpack_require__(202);module.exports=function(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}},function(module,exports,__webpack_require__){var Uint8Array=__webpack_require__(31).Uint8Array;module.exports=Uint8Array},function(module,exports,__webpack_require__){var baseCreate=__webpack_require__(133),getPrototype=__webpack_require__(151),isPrototype=__webpack_require__(179);module.exports=function(object){return"function"!=typeof object.constructor||isPrototype(object)?{}:baseCreate(getPrototype(object))}},function(module,exports){module.exports=function(object,key){if(("constructor"!==key||"function"!=typeof object[key])&&"__proto__"!=key)return object[key]}},function(module,exports,__webpack_require__){var SetCache=__webpack_require__(152),arraySome=__webpack_require__(420),cacheHas=__webpack_require__(153),COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;module.exports=function(array,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var stacked=stack.get(array);if(stacked&&stack.get(other))return stacked==other;var index=-1,result=!0,seen=bitmask&COMPARE_UNORDERED_FLAG?new SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)})){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}},function(module,exports,__webpack_require__){var baseGetAllKeys=__webpack_require__(313),getSymbols=__webpack_require__(204),keys=__webpack_require__(69);module.exports=function(object){return baseGetAllKeys(object,keys,getSymbols)}},function(module,exports,__webpack_require__){var arrayPush=__webpack_require__(185),isArray=__webpack_require__(12);module.exports=function(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}},function(module,exports){module.exports=function(){return[]}},function(module,exports,__webpack_require__){var Set=__webpack_require__(77)(__webpack_require__(31),"Set");module.exports=Set},function(module,exports,__webpack_require__){var isObject=__webpack_require__(26);module.exports=function(value){return value==value&&!isObject(value)}},function(module,exports){module.exports=function(key,srcValue){return function(object){return null!=object&&object[key]===srcValue&&(void 0!==srcValue||key in Object(object))}}},function(module,exports,__webpack_require__){var baseHasIn=__webpack_require__(550),hasPath=__webpack_require__(319);module.exports=function(object,path){return null!=object&&hasPath(object,path,baseHasIn)}},function(module,exports,__webpack_require__){var castPath=__webpack_require__(100),isArguments=__webpack_require__(143),isArray=__webpack_require__(12),isIndex=__webpack_require__(132),isLength=__webpack_require__(195),toKey=__webpack_require__(92);module.exports=function(object,path,hasFunc){for(var index=-1,length=(path=castPath(path,object)).length,result=!1;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}},function(module,exports,__webpack_require__){var baseGet=__webpack_require__(154),baseSet=__webpack_require__(321),castPath=__webpack_require__(100);module.exports=function(object,paths,predicate){for(var index=-1,length=paths.length,result={};++index<length;){var path=paths[index],value=baseGet(object,path);predicate(value,path)&&baseSet(result,castPath(path,object),value)}return result}},function(module,exports,__webpack_require__){var assignValue=__webpack_require__(178),castPath=__webpack_require__(100),isIndex=__webpack_require__(132),isObject=__webpack_require__(26),toKey=__webpack_require__(92);module.exports=function(object,path,value,customizer){if(!isObject(object))return object;for(var index=-1,length=(path=castPath(path,object)).length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=toKey(path[index]),newValue=value;if(index!=lastIndex){var objValue=nested[key];void 0===(newValue=customizer?customizer(objValue,key,nested):void 0)&&(newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{})}assignValue(nested,key,newValue),nested=nested[key]}return object}},function(module,exports,__webpack_require__){var baseEach=__webpack_require__(134),isArrayLike=__webpack_require__(55);module.exports=function(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}},function(module){module.exports=JSON.parse('[["a140","",62],["a180","",32],["a240","",62],["a280","",32],["a2ab","",5],["a2e3",""],["a2ef",""],["a2fd",""],["a340","",62],["a380","",31,""],["a440","",62],["a480","",32],["a4f4","",10],["a540","",62],["a580","",32],["a5f7","",7],["a640","",62],["a680","",32],["a6b9","",7],["a6d9","",6],["a6ec",""],["a6f3",""],["a6f6","",8],["a740","",62],["a780","",32],["a7c2","",14],["a7f2","",12],["a896","",10],["a8bc",""],["a8bf",""],["a8c1",""],["a8ea","",20],["a958",""],["a95b",""],["a95d",""],["a989","",11],["a997","",12],["a9f0","",14],["aaa1","",93],["aba1","",93],["aca1","",93],["ada1","",93],["aea1","",93],["afa1","",93],["d7fa","",4],["f8a1","",93],["f9a1","",93],["faa1","",93],["fba1","",93],["fca1","",93],["fda1","",93],["fe50",""],["fe80","",6,"",93]]')},function(module){module.exports=JSON.parse('[["0","\\u0000",127],["a140",""],["a1a1","",4,""],["a240","",7,""],["a2a1","",9,"",9,"",8,"",25,"",21],["a340","",16,"",6,"",16,"",6,"",10],["a3a1","",25,""],["a3e1",""],["a440",""],["a4a1",""],["a540",""],["a5a1",""],["a640",""],["a6a1",""],["a740",""],["a7a1",""],["a840",""],["a8a1",""],["a940",""],["a9a1",""],["aa40",""],["aaa1",""],["ab40",""],["aba1",""],["ac40",""],["aca1",""],["ad40",""],["ada1",""],["ae40",""],["aea1",""],["af40",""],["afa1",""],["b040",""],["b0a1",""],["b140",""],["b1a1",""],["b240",""],["b2a1",""],["b340",""],["b3a1",""],["b440",""],["b4a1",""],["b540",""],["b5a1",""],["b640",""],["b6a1",""],["b740",""],["b7a1",""],["b840",""],["b8a1",""],["b940",""],["b9a1",""],["ba40",""],["baa1",""],["bb40",""],["bba1",""],["bc40",""],["bca1",""],["bd40",""],["bda1",""],["be40",""],["bea1",""],["bf40",""],["bfa1",""],["c040",""],["c0a1",""],["c140",""],["c1a1",""],["c240",""],["c2a1",""],["c340",""],["c3a1",""],["c440",""],["c4a1",""],["c540",""],["c5a1",""],["c640",""],["c940",""],["c9a1",""],["ca40",""],["caa1",""],["cb40",""],["cba1",""],["cc40",""],["cca1",""],["cd40",""],["cda1",""],["ce40",""],["cea1",""],["cf40",""],["cfa1",""],["d040",""],["d0a1",""],["d140",""],["d1a1",""],["d240",""],["d2a1",""],["d340",""],["d3a1",""],["d440",""],["d4a1",""],["d540",""],["d5a1",""],["d640",""],["d6a1",""],["d740",""],["d7a1",""],["d840",""],["d8a1",""],["d940",""],["d9a1",""],["da40",""],["daa1",""],["db40",""],["dba1",""],["dc40",""],["dca1",""],["dd40",""],["dda1",""],["de40",""],["dea1",""],["df40",""],["dfa1",""],["e040",""],["e0a1",""],["e140",""],["e1a1",""],["e240",""],["e2a1",""],["e340",""],["e3a1",""],["e440",""],["e4a1",""],["e540",""],["e5a1",""],["e640",""],["e6a1",""],["e740",""],["e7a1",""],["e840",""],["e8a1",""],["e940",""],["e9a1",""],["ea40",""],["eaa1",""],["eb40",""],["eba1",""],["ec40",""],["eca1",""],["ed40",""],["eda1",""],["ee40",""],["eea1",""],["ef40",""],["efa1",""],["f040",""],["f0a1",""],["f140",""],["f1a1",""],["f240",""],["f2a1",""],["f340",""],["f3a1",""],["f440",""],["f4a1",""],["f540",""],["f5a1",""],["f640",""],["f6a1",""],["f740",""],["f7a1",""],["f840",""],["f8a1",""],["f940",""],["f9a1",""]]')},function(module,exports,__webpack_require__){var arrayAggregator=__webpack_require__(581),baseAggregator=__webpack_require__(582),baseIteratee=__webpack_require__(18),isArray=__webpack_require__(12);module.exports=function(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,baseIteratee(iteratee,2),accumulator)}}},function(module,exports,__webpack_require__){var arrayPush=__webpack_require__(185),getPrototype=__webpack_require__(151),getSymbols=__webpack_require__(204),stubArray=__webpack_require__(314),getSymbolsIn=Object.getOwnPropertySymbols?function(object){for(var result=[];object;)arrayPush(result,getSymbols(object)),object=getPrototype(object);return result}:stubArray;module.exports=getSymbolsIn},,function(module,exports){const Secret=function(data){return Object.assign(this,data),this};Secret.prototype.toString=function(){throw new Error("Cannot convert Secret to string")},module.exports=Secret},function(module,exports){function M(){this._events={}}M.prototype={on:function(ev,cb){this._events||(this._events={});var e=this._events;return(e[ev]||(e[ev]=[])).push(cb),this},removeListener:function(ev,cb){var i,e=this._events[ev]||[];for(i=e.length-1;i>=0&&e[i];i--)e[i]!==cb&&e[i].cb!==cb||e.splice(i,1)},removeAllListeners:function(ev){ev?this._events[ev]&&(this._events[ev]=[]):this._events={}},listeners:function(ev){return this._events&&this._events[ev]||[]},emit:function(ev){this._events||(this._events={});var i,args=Array.prototype.slice.call(arguments,1),e=this._events[ev]||[];for(i=e.length-1;i>=0&&e[i];i--)e[i].apply(this,args);return this},when:function(ev,cb){return this.once(ev,cb,!0)},once:function(ev,cb,when){if(!cb)return this;function c(){when||this.removeListener(ev,c),cb.apply(this,arguments)&&when&&this.removeListener(ev,c)}return c.cb=cb,this.on(ev,c),this}},M.mixin=function(dest){var k,o=M.prototype;for(k in o)o.hasOwnProperty(k)&&(dest.prototype[k]=o[k])},module.exports=M},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(24)&&!__webpack_require__(80)(function(){return 7!=Object.defineProperty(__webpack_require__(218)("div"),"a",{get:function(){return 7}}).a})},function(module,exports,__webpack_require__){module.exports=__webpack_require__(64)},function(module,exports,__webpack_require__){var dP=__webpack_require__(38),anObject=__webpack_require__(45),getKeys=__webpack_require__(102);module.exports=__webpack_require__(24)?Object.defineProperties:function(O,Properties){anObject(O);for(var P,keys=getKeys(Properties),length=keys.length,i=0;length>i;)dP.f(O,P=keys[i++],Properties[P]);return O}},function(module,exports,__webpack_require__){var has=__webpack_require__(81),toIObject=__webpack_require__(65),arrayIndexOf=__webpack_require__(626)(!1),IE_PROTO=__webpack_require__(221)("IE_PROTO");module.exports=function(object,names){var key,O=toIObject(object),i=0,result=[];for(key in O)key!=IE_PROTO&&has(O,key)&&result.push(key);for(;names.length>i;)has(O,key=names[i++])&&(~arrayIndexOf(result,key)||result.push(key));return result}},function(module,exports,__webpack_require__){var document=__webpack_require__(19).document;module.exports=document&&document.documentElement},function(module,exports,__webpack_require__){var has=__webpack_require__(81),toObject=__webpack_require__(82),IE_PROTO=__webpack_require__(221)("IE_PROTO"),ObjectProto=Object.prototype;module.exports=Object.getPrototypeOf||function(O){return O=toObject(O),has(O,IE_PROTO)?O[IE_PROTO]:"function"==typeof O.constructor&&O instanceof O.constructor?O.constructor.prototype:O instanceof Object?ObjectProto:null}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(45);module.exports=function(iterator,fn,value,entries){try{return entries?fn(anObject(value)[0],value[1]):fn(value)}catch(e){var ret=iterator.return;throw void 0!==ret&&anObject(ret.call(iterator)),e}}},function(module,exports,__webpack_require__){var Iterators=__webpack_require__(101),ITERATOR=__webpack_require__(20)("iterator"),ArrayProto=Array.prototype;module.exports=function(it){return void 0!==it&&(Iterators.Array===it||ArrayProto[ITERATOR]===it)}},function(module,exports,__webpack_require__){var ITERATOR=__webpack_require__(20)("iterator"),SAFE_CLOSING=!1;try{var riter=[7][ITERATOR]();riter.return=function(){SAFE_CLOSING=!0},Array.from(riter,function(){throw 2})}catch(e){}module.exports=function(exec,skipClosing){if(!skipClosing&&!SAFE_CLOSING)return!1;var safe=!1;try{var arr=[7],iter=arr[ITERATOR]();iter.next=function(){return{done:safe=!0}},arr[ITERATOR]=function(){return iter},exec(arr)}catch(e){}return safe}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(630),__esModule:!0}},function(module,exports){module.exports=function(done,value){return{value:value,done:!!done}}},function(module,exports,__webpack_require__){var cof=__webpack_require__(123);module.exports=Array.isArray||function(arg){return"Array"==cof(arg)}},function(module,exports,__webpack_require__){var $keys=__webpack_require__(333),hiddenKeys=__webpack_require__(223).concat("length","prototype");exports.f=Object.getOwnPropertyNames||function(O){return $keys(O,hiddenKeys)}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(653),__esModule:!0}},,,function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(24),getKeys=__webpack_require__(102),toIObject=__webpack_require__(65),isEnum=__webpack_require__(125).f;module.exports=function(isEntries){return function(it){for(var key,O=toIObject(it),keys=getKeys(O),length=keys.length,i=0,result=[];length>i;)key=keys[i++],DESCRIPTORS&&!isEnum.call(O,key)||result.push(isEntries?[key,O[key]]:O[key]);return result}}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(45),aFunction=__webpack_require__(121),SPECIES=__webpack_require__(20)("species");module.exports=function(O,D){var S,C=anObject(O).constructor;return void 0===C||null==(S=anObject(C)[SPECIES])?D:aFunction(S)}},function(module,exports,__webpack_require__){var defer,channel,port,ctx=__webpack_require__(51),invoke=__webpack_require__(675),html=__webpack_require__(334),cel=__webpack_require__(218),global=__webpack_require__(19),process=global.process,setTask=global.setImmediate,clearTask=global.clearImmediate,MessageChannel=global.MessageChannel,Dispatch=global.Dispatch,counter=0,queue={},run=function(){var id=+this;if(queue.hasOwnProperty(id)){var fn=queue[id];delete queue[id],fn()}},listener=function(event){run.call(event.data)};setTask&&clearTask||(setTask=function(fn){for(var args=[],i=1;arguments.length>i;)args.push(arguments[i++]);return queue[++counter]=function(){invoke("function"==typeof fn?fn:Function(fn),args)},defer(counter),counter},clearTask=function(id){delete queue[id]},"process"==__webpack_require__(123)(process)?defer=function(id){process.nextTick(ctx(run,id,1))}:Dispatch&&Dispatch.now?defer=function(id){Dispatch.now(ctx(run,id,1))}:MessageChannel?(port=(channel=new MessageChannel).port2,channel.port1.onmessage=listener,defer=ctx(port.postMessage,port,1)):global.addEventListener&&"function"==typeof postMessage&&!global.importScripts?(defer=function(id){global.postMessage(id+"","*")},global.addEventListener("message",listener,!1)):defer="onreadystatechange"in cel("script")?function(id){html.appendChild(cel("script")).onreadystatechange=function(){html.removeChild(this),run.call(id)}}:function(id){setTimeout(ctx(run,id,1),0)}),module.exports={set:setTask,clear:clearTask}},function(module,exports){module.exports=function(exec){try{return{e:!1,v:exec()}}catch(e){return{e:!0,v:e}}}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(45),isObject=__webpack_require__(32),newPromiseCapability=__webpack_require__(230);module.exports=function(C,x){if(anObject(C),isObject(x)&&x.constructor===C)return x;var promiseCapability=newPromiseCapability.f(C);return(0,promiseCapability.resolve)(x),promiseCapability.promise}},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(19),core=__webpack_require__(9),dP=__webpack_require__(38),DESCRIPTORS=__webpack_require__(24),SPECIES=__webpack_require__(20)("species");module.exports=function(KEY){var C="function"==typeof core[KEY]?core[KEY]:global[KEY];DESCRIPTORS&&C&&!C[SPECIES]&&dP.f(C,SPECIES,{configurable:!0,get:function(){return this}})}},function(module,exports,__webpack_require__){"use strict";var dP=__webpack_require__(38).f,create=__webpack_require__(156),redefineAll=__webpack_require__(231),ctx=__webpack_require__(51),anInstance=__webpack_require__(229),forOf=__webpack_require__(126),$iterDefine=__webpack_require__(217),step=__webpack_require__(340),setSpecies=__webpack_require__(351),DESCRIPTORS=__webpack_require__(24),fastKey=__webpack_require__(161).fastKey,validate=__webpack_require__(232),SIZE=DESCRIPTORS?"_s":"size",getEntry=function(that,key){var entry,index=fastKey(key);if("F"!==index)return that._i[index];for(entry=that._f;entry;entry=entry.n)if(entry.k==key)return entry};module.exports={getConstructor:function(wrapper,NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){anInstance(that,C,NAME,"_i"),that._t=NAME,that._i=create(null),that._f=void 0,that._l=void 0,that[SIZE]=0,null!=iterable&&forOf(iterable,IS_MAP,that[ADDER],that)});return redefineAll(C.prototype,{clear:function(){for(var that=validate(this,NAME),data=that._i,entry=that._f;entry;entry=entry.n)entry.r=!0,entry.p&&(entry.p=entry.p.n=void 0),delete data[entry.i];that._f=that._l=void 0,that[SIZE]=0},delete:function(key){var that=validate(this,NAME),entry=getEntry(that,key);if(entry){var next=entry.n,prev=entry.p;delete that._i[entry.i],entry.r=!0,prev&&(prev.n=next),next&&(next.p=prev),that._f==entry&&(that._f=next),that._l==entry&&(that._l=prev),that[SIZE]--}return!!entry},forEach:function(callbackfn){validate(this,NAME);for(var entry,f=ctx(callbackfn,arguments.length>1?arguments[1]:void 0,3);entry=entry?entry.n:this._f;)for(f(entry.v,entry.k,this);entry&&entry.r;)entry=entry.p},has:function(key){return!!getEntry(validate(this,NAME),key)}}),DESCRIPTORS&&dP(C.prototype,"size",{get:function(){return validate(this,NAME)[SIZE]}}),C},def:function(that,key,value){var prev,index,entry=getEntry(that,key);return entry?entry.v=value:(that._l=entry={i:index=fastKey(key,!0),k:key,v:value,p:prev=that._l,n:void 0,r:!1},that._f||(that._f=entry),prev&&(prev.n=entry),that[SIZE]++,"F"!==index&&(that._i[index]=entry)),that},getEntry:getEntry,setStrong:function(C,NAME,IS_MAP){$iterDefine(C,NAME,function(iterated,kind){this._t=validate(iterated,NAME),this._k=kind,this._l=void 0},function(){for(var kind=this._k,entry=this._l;entry&&entry.r;)entry=entry.p;return this._t&&(this._l=entry=entry?entry.n:this._t._f)?step(0,"keys"==kind?entry.k:"values"==kind?entry.v:[entry.k,entry.v]):(this._t=void 0,step(1))},IS_MAP?"entries":"values",!IS_MAP,!0),setSpecies(NAME)}}},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(19),$export=__webpack_require__(14),meta=__webpack_require__(161),fails=__webpack_require__(80),hide=__webpack_require__(64),redefineAll=__webpack_require__(231),forOf=__webpack_require__(126),anInstance=__webpack_require__(229),isObject=__webpack_require__(32),setToStringTag=__webpack_require__(124),dP=__webpack_require__(38).f,each=__webpack_require__(683)(0),DESCRIPTORS=__webpack_require__(24);module.exports=function(NAME,wrapper,methods,common,IS_MAP,IS_WEAK){var Base=global[NAME],C=Base,ADDER=IS_MAP?"set":"add",proto=C&&C.prototype,O={};return DESCRIPTORS&&"function"==typeof C&&(IS_WEAK||proto.forEach&&!fails(function(){(new C).entries().next()}))?(C=wrapper(function(target,iterable){anInstance(target,C,NAME,"_c"),target._c=new Base,null!=iterable&&forOf(iterable,IS_MAP,target[ADDER],target)}),each("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(KEY){var IS_ADDER="add"==KEY||"set"==KEY;KEY in proto&&(!IS_WEAK||"clear"!=KEY)&&hide(C.prototype,KEY,function(a,b){if(anInstance(this,C,KEY),!IS_ADDER&&IS_WEAK&&!isObject(a))return"get"==KEY&&void 0;var result=this._c[KEY](0===a?0:a,b);return IS_ADDER?this:result})}),IS_WEAK||dP(C.prototype,"size",{get:function(){return this._c.size}})):(C=common.getConstructor(wrapper,NAME,IS_MAP,ADDER),redefineAll(C.prototype,methods),meta.NEED=!0),setToStringTag(C,NAME),O[NAME]=C,$export($export.G+$export.W+$export.F,O),IS_WEAK||common.setStrong(C,NAME,IS_MAP),C}},function(module,exports,__webpack_require__){var classof=__webpack_require__(159),from=__webpack_require__(687);module.exports=function(NAME){return function(){if(classof(this)!=NAME)throw TypeError(NAME+"#toJSON isn't generic");return from(this)}}},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(14);module.exports=function(COLLECTION){$export($export.S,COLLECTION,{of:function(){for(var length=arguments.length,A=new Array(length);length--;)A[length]=arguments[length];return new this(A)}})}},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(14),aFunction=__webpack_require__(121),ctx=__webpack_require__(51),forOf=__webpack_require__(126);module.exports=function(COLLECTION){$export($export.S,COLLECTION,{from:function(source){var mapping,A,n,cb,mapFn=arguments[1];return aFunction(this),(mapping=void 0!==mapFn)&&aFunction(mapFn),null==source?new this:(A=[],mapping?(n=0,cb=ctx(mapFn,arguments[2],2),forOf(source,!1,function(nextItem){A.push(cb(nextItem,n++))})):forOf(source,!1,A.push,A),new this(A))}})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.REGISTRATION_ABORT="REGISTRATION_ABORT"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=exports.resolveClass=exports.attachRelationships=exports.responseToRelationship=exports.pickTypeAndId=void 0;var _extends3=_interopRequireDefault(__webpack_require__(3)),_pick2=_interopRequireDefault(__webpack_require__(169)),_pickBy2=_interopRequireDefault(__webpack_require__(136)),_Association2=_interopRequireDefault(__webpack_require__(105)),_HasOne2=_interopRequireDefault(__webpack_require__(359)),_HasOneInPlace2=_interopRequireDefault(__webpack_require__(360)),_HasMany2=_interopRequireDefault(__webpack_require__(166)),_HasManyInPlace2=_interopRequireDefault(__webpack_require__(366)),_HasManyFiles2=_interopRequireDefault(__webpack_require__(367));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var pickTypeAndId=exports.pickTypeAndId=function(x){return(0,_pick2.default)(x,"_type","_id")},attachRelationship=(exports.responseToRelationship=function(response){return(0,_pickBy2.default)({data:(fn=pickTypeAndId,objOrArr=response.data,Array.isArray(objOrArr)?objOrArr.map(fn):fn(objOrArr)),meta:response.meta,next:response.next,skip:response.skip});var fn,objOrArr},function(doc,relationships){return(0,_extends3.default)({},doc,{relationships:(0,_extends3.default)({},doc.relationships,relationships)})}),aliases=(exports.attachRelationships=function(response,relationshipsByDocId){if(Array.isArray(response.data))return(0,_extends3.default)({},response,{data:response.data.map(function(doc){return attachRelationship(doc,relationshipsByDocId[doc._id])})});var doc=response.data;return(0,_extends3.default)({},response,{data:attachRelationship(doc,relationshipsByDocId[doc._id])})},{"io.cozy.files:has-many":_HasManyFiles2.default,"has-many":_HasMany2.default,"belongs-to-in-place":_HasOneInPlace2.default,"has-one":_HasOne2.default,"has-one-in-place":_HasOneInPlace2.default,"has-many-in-place":_HasManyInPlace2.default});exports.resolveClass=function(doctype,type){if(void 0===type)throw new Error("Undefined type for "+doctype);if("string"!=typeof type)return type;var cls=aliases[doctype+":"+type]||aliases[type];if(cls)return cls;throw new Error("Unknown association '"+type+"'")},exports.create=function(target,_ref,accessors){var name=_ref.name,type=_ref.type,doctype=_ref.doctype;if(target[name]instanceof _Association2.default)throw new Error("Association "+name+" already exists");return new type(target,name,doctype,accessors)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=_interopRequireDefault(__webpack_require__(46)),_extends4=_interopRequireDefault(__webpack_require__(3)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_get3=_interopRequireDefault(__webpack_require__(10)),_set3=_interopRequireDefault(__webpack_require__(252));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HasOne=function(_Association){function HasOne(){return(0,_classCallCheck3.default)(this,HasOne),(0,_possibleConstructorReturn3.default)(this,(HasOne.__proto__||(0,_getPrototypeOf2.default)(HasOne)).apply(this,arguments))}return(0,_inherits3.default)(HasOne,_Association),(0,_createClass3.default)(HasOne,[{key:"set",value:function(doc){if(doc&&doc._type!==this.doctype)throw new Error("Tried to associate a "+doc._type+" document to a HasOne relationship on "+this.doctype+" document");var path="relationships["+this.name+"].data";doc?(0,_set3.default)(this.target,path,{_id:doc._id,_type:doc._type}):(0,_set3.default)(this.target,path,void 0)}},{key:"unset",value:function(){this.set(void 0)}},{key:"dehydrate",value:function(doc){return(0,_extends4.default)({},doc,{relationships:(0,_extends4.default)({},doc.relationships,(0,_defineProperty3.default)({},this.name,{data:this.raw}))})}},{key:"raw",get:function(){return(0,_get3.default)(this.target,"relationships["+this.name+"].data",null)}},{key:"data",get:function(){return this.raw?this.get(this.doctype,this.raw._id):null}}],[{key:"query",value:function(doc,client,assoc){var relationship=(0,_get3.default)(doc,"relationships."+assoc.name+".data",{});return client.get(assoc.doctype,relationship._id)}}]),HasOne}(_interopRequireDefault(__webpack_require__(105)).default);exports.default=HasOne},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BelongsToInPlace=void 0;var _defineProperty3=_interopRequireDefault(__webpack_require__(46)),_extends4=_interopRequireDefault(__webpack_require__(3)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HasOneInPlace=function(_Association){function HasOneInPlace(){return(0,_classCallCheck3.default)(this,HasOneInPlace),(0,_possibleConstructorReturn3.default)(this,(HasOneInPlace.__proto__||(0,_getPrototypeOf2.default)(HasOneInPlace)).apply(this,arguments))}return(0,_inherits3.default)(HasOneInPlace,_Association),(0,_createClass3.default)(HasOneInPlace,[{key:"dehydrate",value:function(doc){return(0,_extends4.default)({},doc,(0,_defineProperty3.default)({},this.name,this.raw||void 0))}},{key:"raw",get:function(){return this.target[this.name]}},{key:"data",get:function(){return this.get(this.doctype,this.raw)}}],[{key:"query",value:function(doc,client,assoc){var id=doc[assoc.name];return client.getDocumentFromState(assoc.doctype,id)||client.get(assoc.doctype,id)}}]),HasOneInPlace}(_interopRequireDefault(__webpack_require__(105)).default);exports.default=HasOneInPlace;exports.BelongsToInPlace=HasOneInPlace},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getQueryFromSlice=exports.receiveQueryError=exports.receiveQueryResult=exports.initQuery=exports.convert$gtNullSelectors=exports.isReceivingData=exports.isQueryAction=void 0;var _defineProperty3=_interopRequireDefault(__webpack_require__(46)),_entries2=_interopRequireDefault(__webpack_require__(163)),_getIterator3=_interopRequireDefault(__webpack_require__(66)),_slicedToArray3=_interopRequireDefault(__webpack_require__(164)),_toConsumableArray3=_interopRequireDefault(__webpack_require__(70)),_extends4=_interopRequireDefault(__webpack_require__(3)),_mapValues2=_interopRequireDefault(__webpack_require__(119)),_union2=_interopRequireDefault(__webpack_require__(693)),_difference2=_interopRequireDefault(__webpack_require__(447)),_intersection2=_interopRequireDefault(__webpack_require__(695)),_isPlainObject2=_interopRequireDefault(__webpack_require__(183)),_documents=__webpack_require__(364),_mutations=__webpack_require__(233),_helpers=__webpack_require__(365),_sift2=_interopRequireDefault(__webpack_require__(696)),_get2=_interopRequireDefault(__webpack_require__(10));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var INIT_QUERY="INIT_QUERY",RECEIVE_QUERY_RESULT="RECEIVE_QUERY_RESULT",RECEIVE_QUERY_ERROR="RECEIVE_QUERY_ERROR",isQueryAction=exports.isQueryAction=function(action){return-1!==[INIT_QUERY,RECEIVE_QUERY_RESULT,RECEIVE_QUERY_ERROR].indexOf(action.type)},queryInitialState=(exports.isReceivingData=function(action){return action.type===RECEIVE_QUERY_RESULT},{id:null,definition:null,fetchStatus:"pending",lastFetch:null,lastUpdate:null,lastError:null,hasMore:!1,count:0,data:[]}),query=function(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:queryInitialState,action=arguments[1];switch(action.type){case INIT_QUERY:return(0,_extends4.default)({},state,{id:action.queryId,definition:action.queryDefinition,fetchStatus:"loading"});case RECEIVE_QUERY_RESULT:var response=action.response,common={fetchStatus:"loaded",lastFetch:Date.now(),lastUpdate:Date.now()};return response.data?Array.isArray(response.data)?(0,_extends4.default)({},state,common,{hasMore:void 0!==response.next?response.next:state.hasMore,count:response.meta&&response.meta.count?response.meta.count:response.data.length,data:0===response.skip?response.data.map(_helpers.properId):[].concat((0,_toConsumableArray3.default)(state.data),(0,_toConsumableArray3.default)(response.data.map(_helpers.properId)))}):(0,_extends4.default)({},state,common,{hasMore:!1,count:1,data:[(0,_helpers.properId)(response.data)]}):state;case RECEIVE_QUERY_ERROR:return(0,_extends4.default)({},state,{id:action.queryId,fetchStatus:"failed",lastError:action.error});default:return state}},convert$gtNullSelectors=exports.convert$gtNullSelectors=function convert$gtNullSelectors(selector){var result={},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=(0,_getIterator3.default)((0,_entries2.default)(selector));!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var _ref=_step.value,_ref2=(0,_slicedToArray3.default)(_ref,2),key=_ref2[0],value=_ref2[1],convertedValue=(0,_isPlainObject2.default)(value)?convert$gtNullSelectors(value):value;result["$gt"===key&&null===convertedValue?"$gtnull":key]=convertedValue}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return result},getQueryDocumentsChecker=function(query){var queryDefinition,qdoctype=query.definition.doctype,selectorFilterFn=(queryDefinition=query.definition).selector?(_sift2.default.use({$gtnull:function(selectorValue,actualValue){return!!actualValue}}),(0,_sift2.default)(convert$gtNullSelectors(queryDefinition.selector))):queryDefinition.id?(0,_sift2.default)({_id:queryDefinition.id}):null;return function(datum){return datum._type===qdoctype&&(!(selectorFilterFn&&!selectorFilterFn(datum))&&!datum._deleted)}},autoQueryUpdater=function(action){return function(query){var data=(0,_get2.default)(action,"response.data")||(0,_get2.default)(action,"definition.document");return data?(Array.isArray(data)||(data=[data]),data.length?query.definition.doctype!==data[0]._type?query:function(query,newData){var isFulfilled=getQueryDocumentsChecker(query),matchedIds=newData.filter(function(doc){return isFulfilled(doc)}).map(_helpers.properId),unmatchedIds=newData.filter(function(doc){return!isFulfilled(doc)}).map(_helpers.properId),originalIds=query.data,toRemove=(0,_intersection2.default)(originalIds,unmatchedIds),toAdd=(0,_difference2.default)(matchedIds,originalIds),toUpdate=(0,_intersection2.default)(originalIds,matchedIds),changed=toRemove.length||toAdd.length||toUpdate.length,updatedData=(0,_difference2.default)((0,_union2.default)(originalIds,toAdd),toRemove);return(0,_extends4.default)({},query,{data:updatedData,count:updatedData.length,lastUpdate:changed?Date.now():query.lastUpdate})}(query,data):query):query}},manualQueryUpdater=function(action,documents){return function(query){var updateQueries=action.updateQueries,response=action.response,updater=updateQueries[query.id];if(!updater)return query;var doctype=query.definition.doctype,oldData=query.data,newDataIds=updater(mapIdsToDocuments(documents,doctype,oldData),response).map(_helpers.properId);return(0,_extends4.default)({},query,{data:newDataIds,count:newDataIds.length,lastUpdate:Date.now()})}};exports.default=function(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},action=arguments[1],nextDocuments=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},haveDocumentsChanged=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(action.type==INIT_QUERY)return(0,_extends4.default)({},state,(0,_defineProperty3.default)({},action.queryId,query(state[action.queryId],action)));if(isQueryAction(action)){var updater=autoQueryUpdater(action);return(0,_mapValues2.default)(state,function(queryState){return queryState.id==action.queryId?query(queryState,action):haveDocumentsChanged?updater(queryState):queryState})}if((0,_mutations.isReceivingMutationResult)(action)){var _updater=action.updateQueries?manualQueryUpdater(action,nextDocuments):autoQueryUpdater(action);return(0,_mapValues2.default)(state,_updater)}return state};exports.initQuery=function(queryId,queryDefinition){if(!queryDefinition.doctype)throw new Error("Cannot init query with no doctype");return{type:INIT_QUERY,queryId:queryId,queryDefinition:queryDefinition}},exports.receiveQueryResult=function(queryId,response){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,_extends4.default)({type:RECEIVE_QUERY_RESULT,queryId:queryId,response:response},options)},exports.receiveQueryError=function(queryId,error){return{type:RECEIVE_QUERY_ERROR,queryId:queryId,error:error}};var mapIdsToDocuments=function(documents,doctype,ids){return ids.map(function(id){return(0,_documents.getDocumentFromSlice)(documents,doctype,id)})};exports.getQueryFromSlice=function(state,queryId,documents){if(!state||!state[queryId])return(0,_extends4.default)({},queryInitialState,{data:null});var query=state[queryId];return documents?(0,_extends4.default)({},query,{data:mapIdsToDocuments(documents,query.definition.doctype,query.data)}):query}},function(module,exports,__webpack_require__){var SetCache=__webpack_require__(152),arrayIncludes=__webpack_require__(180),arrayIncludesWith=__webpack_require__(209),arrayMap=__webpack_require__(35),baseUnary=__webpack_require__(88),cacheHas=__webpack_require__(153),nativeMin=Math.min;module.exports=function(arrays,iteratee,comparator){for(var includes=comparator?arrayIncludesWith:arrayIncludes,length=arrays[0].length,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),maxLength=1/0,result=[];othIndex--;){var array=arrays[othIndex];othIndex&&iteratee&&(array=arrayMap(array,baseUnary(iteratee))),maxLength=nativeMin(array.length,maxLength),caches[othIndex]=!comparator&&(iteratee||length>=120&&array.length>=120)?new SetCache(othIndex&&array):void 0}array=arrays[0];var index=-1,seen=caches[0];outer:for(;++index<length&&result.length<maxLength;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){for(othIndex=othLength;--othIndex;){var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator)))continue outer}seen&&seen.push(computed),result.push(value)}}return result}},function(module,exports,__webpack_require__){var isArrayLikeObject=__webpack_require__(118);module.exports=function(value){return isArrayLikeObject(value)?value:[]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractAndMergeDocument=exports.getCollectionFromSlice=exports.getDocumentFromSlice=exports.mergeDocumentsWithRelationships=void 0;var _values2=_interopRequireDefault(__webpack_require__(127)),_defineProperty3=_interopRequireDefault(__webpack_require__(46)),_extends5=_interopRequireDefault(__webpack_require__(3)),_queries=__webpack_require__(361),_mutations=__webpack_require__(233),_keyBy2=_interopRequireDefault(__webpack_require__(94)),_get2=_interopRequireDefault(__webpack_require__(10)),_isEqual2=_interopRequireDefault(__webpack_require__(273)),_helpers=__webpack_require__(365);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var storeDocument=function(state,document){var type=document._type;if(!type)throw new Error("Document without _type");if(!(0,_helpers.properId)(document))throw new Error("Document without id");var existingDoc=(0,_get2.default)(state,[type,(0,_helpers.properId)(document)]);return(0,_isEqual2.default)(existingDoc,document)?state:(0,_extends5.default)({},state,(0,_defineProperty3.default)({},type,(0,_extends5.default)({},state[type],(0,_defineProperty3.default)({},(0,_helpers.properId)(document),mergeDocumentsWithRelationships(existingDoc,document)))))},mergeDocumentsWithRelationships=exports.mergeDocumentsWithRelationships=function(){var prevDocument=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},nextDocument=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},merged=(0,_extends5.default)({},prevDocument,nextDocument);return(prevDocument.relationships||nextDocument.relationships)&&(merged.relationships=(0,_extends5.default)({},prevDocument.relationships,nextDocument.relationships)),merged};exports.default=function(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},action=arguments[1];if(!(0,_queries.isReceivingData)(action)&&!(0,_mutations.isReceivingMutationResult)(action))return state;var _action$response=action.response,data=_action$response.data,included=_action$response.included;if(!data||Array.isArray(data)&&0===data.length)return state;var updatedStateWithIncluded=included?included.reduce(storeDocument,state):state;return Array.isArray(data)?extractAndMergeDocument(data,updatedStateWithIncluded):storeDocument(updatedStateWithIncluded,data)};exports.getDocumentFromSlice=function(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},doctype=arguments[1],id=arguments[2];if(!doctype)throw new Error("getDocumentFromSlice: Cannot retrieve document with undefined doctype");if(!id)throw new Error("getDocumentFromSlice: Cannot retrieve document with undefined id");return state[doctype]&&state[doctype][id]?state[doctype][id]:null},exports.getCollectionFromSlice=function(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},doctype=arguments[1];if(!doctype)throw new Error("getDocumentFromSlice: Cannot retrieve document with undefined doctype");return state[doctype]?(0,_values2.default)(state[doctype]):null};var extractAndMergeDocument=exports.extractAndMergeDocument=function(data,updatedStateWithIncluded){var doctype=data[0]._type;if(!doctype)throw new Error("Document without _type",data[0]);var sortedData=(0,_keyBy2.default)(data,_helpers.properId),mergedData={};return updatedStateWithIncluded&&updatedStateWithIncluded[doctype]&&(0,_values2.default)(updatedStateWithIncluded[doctype]).map(function(dataState){mergedData[doctype]||(mergedData[doctype]={});var id=(0,_helpers.properId)(dataState);sortedData[id]?mergedData[doctype][id]=(0,_extends5.default)({},dataState,sortedData[id],mergedData[doctype][id]):mergedData[doctype][id]=(0,_extends5.default)({},dataState,mergedData[doctype][id])}),(0,_values2.default)(sortedData).map(function(data){mergedData[doctype]||(mergedData[doctype]={});var id=(0,_helpers.properId)(data);mergedData[doctype][id]?mergedData[doctype][id]=(0,_extends5.default)({},mergedData[doctype][id],data):mergedData[doctype][id]=data}),(0,_extends5.default)({},updatedStateWithIncluded,mergedData)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.properId=function(doc){return doc.id||doc._id}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty3=_interopRequireDefault(__webpack_require__(46)),_extends4=_interopRequireDefault(__webpack_require__(3)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_Association3=_interopRequireDefault(__webpack_require__(105)),_dsl2=_interopRequireDefault(__webpack_require__(87));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HasManyInPlace=function(_Association){function HasManyInPlace(){return(0,_classCallCheck3.default)(this,HasManyInPlace),(0,_possibleConstructorReturn3.default)(this,(HasManyInPlace.__proto__||(0,_getPrototypeOf2.default)(HasManyInPlace)).apply(this,arguments))}return(0,_inherits3.default)(HasManyInPlace,_Association),(0,_createClass3.default)(HasManyInPlace,[{key:"addById",value:function(id){this.getRelationship().push(id)}},{key:"removeById",value:function(id){var rel=this.getRelationship(),index=rel.indexOf(id);-1!==index&&rel.splice(index,1)}},{key:"existsById",value:function(id){return-1!==this.getRelationship().indexOf(id)}},{key:"getRelationship",value:function(){return this.target[this.name]=this.target[this.name]||[],this.target[this.name]}},{key:"dehydrate",value:function(doc){return(0,_extends4.default)({},doc,(0,_defineProperty3.default)({},this.name,this.raw||[]))}},{key:"raw",get:function(){return this.target[this.name]}},{key:"data",get:function(){var _this2=this,doctype=this.doctype;return(this.raw||[]).map(function(_id){return _this2.get(doctype,_id)})}}],[{key:"query",value:function(){return this.raw&&this.raw.length>0?(0,_dsl2.default)({doctype:this.doctype,ids:this.raw}):null}}]),HasManyInPlace}(_Association3.default);exports.default=HasManyInPlace},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_toConsumableArray3=_interopRequireDefault(__webpack_require__(70)),_extends3=_interopRequireDefault(__webpack_require__(3)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_get3=_interopRequireDefault(__webpack_require__(167)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_omit2=_interopRequireDefault(__webpack_require__(110)),_HasMany3=_interopRequireDefault(__webpack_require__(166)),_dsl=__webpack_require__(87),_store=__webpack_require__(128);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HasManyFiles=function(_HasMany){function HasManyFiles(){return(0,_classCallCheck3.default)(this,HasManyFiles),(0,_possibleConstructorReturn3.default)(this,(HasManyFiles.__proto__||(0,_getPrototypeOf2.default)(HasManyFiles)).apply(this,arguments))}var _ref4,_ref3,_ref;return(0,_inherits3.default)(HasManyFiles,_HasMany),(0,_createClass3.default)(HasManyFiles,[{key:"fetchMore",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(){var queryDef,relationships,lastRelationship,_this2=this;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return queryDef=new _dsl.QueryDefinition({doctype:"io.cozy.files"}),relationships=this.getRelationship().data,lastRelationship=relationships[relationships.length-1],_context2.next=5,this.dispatch(function(){var _ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(dispatch,getState){var lastRelDoc,lastDatetime,cursorKey,startDocId,cursorView,response;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return lastRelDoc=(0,_store.getDocumentFromState)(getState(),lastRelationship._type,lastRelationship._id),lastDatetime=lastRelDoc.attributes.metadata.datetime,cursorKey=[_this2.target._type,_this2.target._id,lastDatetime],startDocId=relationships[relationships.length-1]._id,cursorView=[cursorKey,startDocId],_context.next=7,_this2.query(queryDef.referencedBy(_this2.target).offsetCursor(cursorView));case 7:return(response=_context.sent).data.shift(),_context.next=11,_this2.dispatch(_this2.updateRelationshipData(function(previousRelationshipData){return(0,_extends3.default)({},previousRelationshipData,{data:[].concat((0,_toConsumableArray3.default)(previousRelationshipData.data),(0,_toConsumableArray3.default)(response.data)),next:response.next})}));case 11:case"end":return _context.stop()}},_callee,_this2)}));return function(_x,_x2){return _ref2.apply(this,arguments)}}());case 5:case"end":return _context2.stop()}},_callee2,this)})),function(){return _ref.apply(this,arguments)})},{key:"addById",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(ids){var relations,_this3=this;return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return ids=Array.isArray(ids)?ids:[ids],relations=ids.map(function(id){return{_id:id,_type:_this3.doctype}}),_context3.next=4,this.mutate(this.insertDocuments(relations));case 4:return _context3.next=6,(0,_get3.default)(HasManyFiles.prototype.__proto__||(0,_getPrototypeOf2.default)(HasManyFiles.prototype),"addById",this).call(this,ids);case 6:case"end":return _context3.stop()}},_callee3,this)})),function(_x3){return _ref3.apply(this,arguments)})},{key:"removeById",value:(_ref4=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(ids){var relations,_this4=this;return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return ids=Array.isArray(ids)?ids:[ids],relations=ids.map(function(id){return{_id:id,_type:_this4.doctype}}),_context4.next=4,this.mutate(this.removeDocuments(relations));case 4:return _context4.next=6,(0,_get3.default)(HasManyFiles.prototype.__proto__||(0,_getPrototypeOf2.default)(HasManyFiles.prototype),"removeById",this).call(this,ids);case 6:case"end":return _context4.stop()}},_callee4,this)})),function(_x4){return _ref4.apply(this,arguments)})},{key:"insertDocuments",value:function(referencedDocs){if("io.cozy.files"===this.target._type)return _dsl.Mutations.addReferencedBy(this.target,referencedDocs);if("io.cozy.files"===referencedDocs[0]._type)return _dsl.Mutations.addReferencesTo(this.target,referencedDocs);throw new Error("Either the document or the references should be io.cozy.files")}},{key:"removeDocuments",value:function(referencedDocs){if("io.cozy.files"===this.target._type)return _dsl.Mutations.removeReferencedBy(this.target,referencedDocs);if("io.cozy.files"===referencedDocs[0]._type)return _dsl.Mutations.removeReferencesTo(this.target,referencedDocs);throw new Error("Either the document or the references should be io.cozy.files")}},{key:"dehydrate",value:function(doc){return(0,_omit2.default)(doc,[this.name,"relationships."+this.name])}}],[{key:"query",value:function(document,client,assoc){var cursor=[[document._type,document._id],""];return client.find(assoc.doctype).referencedBy(document).offsetCursor(cursor)}}]),HasManyFiles}(_HasMany3.default);exports.default=HasManyFiles},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FetchError=void 0;var _getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_stringify2=_interopRequireDefault(__webpack_require__(165)),_regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_extends3=_interopRequireDefault(__webpack_require__(3)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_AppCollection=__webpack_require__(369),_AppCollection2=_interopRequireDefault(_AppCollection),_AppToken2=_interopRequireDefault(__webpack_require__(719)),_DocumentCollection2=_interopRequireDefault(__webpack_require__(52)),_FileCollection2=_interopRequireDefault(__webpack_require__(235)),_JobCollection=__webpack_require__(371),_JobCollection2=_interopRequireDefault(_JobCollection),_KonnectorCollection=__webpack_require__(725),_KonnectorCollection2=_interopRequireDefault(_KonnectorCollection),_SharingCollection2=_interopRequireDefault(__webpack_require__(726)),_PermissionCollection2=_interopRequireDefault(__webpack_require__(727)),_TriggerCollection=__webpack_require__(372),_TriggerCollection2=_interopRequireDefault(_TriggerCollection),_SettingsCollection=__webpack_require__(728),_SettingsCollection2=_interopRequireDefault(_SettingsCollection),_getIconURL3=_interopRequireDefault(__webpack_require__(729)),_logDeprecate2=_interopRequireDefault(__webpack_require__(373)),_errors2=_interopRequireDefault(__webpack_require__(731));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CozyStackClient=function(){function CozyStackClient(options){(0,_classCallCheck3.default)(this,CozyStackClient);var opts=(0,_extends3.default)({},options),token=opts.token,_opts$uri=opts.uri,uri=void 0===_opts$uri?"":_opts$uri;this.options=opts,this.setUri(uri),this.setToken(token),this.konnectors=new _KonnectorCollection2.default(this),this.jobs=new _JobCollection2.default(this)}var _ref4,_ref3,_ref2,_ref;return(0,_createClass3.default)(CozyStackClient,[{key:"collection",value:function(doctype){if(!doctype)throw new Error("CozyStackClient.collection() called without a doctype");switch(doctype){case _AppCollection.APPS_DOCTYPE:return new _AppCollection2.default(this);case _KonnectorCollection.KONNECTORS_DOCTYPE:return new _KonnectorCollection2.default(this);case"io.cozy.files":return new _FileCollection2.default(doctype,this);case"io.cozy.sharings":return new _SharingCollection2.default(doctype,this);case"io.cozy.permissions":return new _PermissionCollection2.default(doctype,this);case _TriggerCollection.TRIGGERS_DOCTYPE:return new _TriggerCollection2.default(this);case _JobCollection.JOBS_DOCTYPE:return new _JobCollection2.default(this);case _SettingsCollection.SETTINGS_DOCTYPE:return new _SettingsCollection2.default(this);default:return new _DocumentCollection2.default(doctype,this)}}},{key:"fetch",value:function(_fetch){function fetch(_x,_x2,_x3){return _fetch.apply(this,arguments)}return fetch.toString=function(){return _fetch.toString()},fetch}((_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(method,path,body){var options,headers,_this=this,opts=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return(options=(0,_extends3.default)({},opts)).method=method,headers=options.headers=(0,_extends3.default)({},opts.headers),"GET"!==method&&"HEAD"!==method&&void 0!==body&&headers["Content-Type"]&&(options.body=body),headers.Authorization||(headers.Authorization=this.getAuthorizationHeader()),options.credentials="include",_context.abrupt("return",fetch(this.fullpath(path),options).catch(function(err){throw _this.checkForRevocation(err),err}));case 7:case"end":return _context.stop()}},_callee,this)})),function(_x5,_x6,_x7){return _ref.apply(this,arguments)}))},{key:"checkForRevocation",value:function(err){err.message&&_errors2.default.CLIENT_NOT_FOUND.test(err.message)&&this.onRevocationChange(!0)}},{key:"onRevocationChange",value:function(state){this.options&&this.options.onRevocationChange&&this.options.onRevocationChange(state)}},{key:"refreshToken",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(){var options,response,html,parser,doc,appNode,cozyToken,newToken;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(this.token){_context2.next=2;break}throw new Error("Cannot refresh an empty token");case 2:if(options={method:"GET",credentials:"include"},global.document){_context2.next=5;break}throw new Error("Not in a web context, cannot refresh token");case 5:return _context2.next=7,fetch("/",options);case 7:if((response=_context2.sent).ok){_context2.next=10;break}throw new Error("couldn't fetch a new token - response "+response.statusCode);case 10:return _context2.next=12,response.text();case 12:if(html=_context2.sent,parser=new DOMParser,doc=parser.parseFromString(html,"text/html")){_context2.next=17;break}throw Error("couldn't fetch a new token - doc is not html");case 17:if(appNode=doc.querySelector('div[role="application"]')){_context2.next=20;break}throw Error("couldn't fetch a new token - no div[role=application]");case 20:if(cozyToken=appNode.dataset.cozyToken){_context2.next=23;break}throw Error("couldn't fetch a new token -- missing data-cozy-token attribute");case 23:return newToken=new _AppToken2.default(cozyToken),this.onTokenRefresh&&"function"==typeof this.onTokenRefresh&&this.onTokenRefresh(newToken),_context2.abrupt("return",newToken);case 26:case"end":return _context2.stop()}},_callee2,this)})),function(){return _ref2.apply(this,arguments)})},{key:"fetchJSON",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(method,path,body){var token,options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.prev=0,_context3.next=3,this.fetchJSONWithCurrentToken(method,path,body,options);case 3:return _context3.abrupt("return",_context3.sent);case 6:if(_context3.prev=6,_context3.t0=_context3.catch(0),!_errors2.default.EXPIRED_TOKEN.test(_context3.t0.message)){_context3.next=25;break}return token=void 0,_context3.prev=10,_context3.next=13,this.refreshToken();case 13:token=_context3.sent,_context3.next=19;break;case 16:throw _context3.prev=16,_context3.t1=_context3.catch(10),_context3.t0;case 19:return this.setToken(token),_context3.next=22,this.fetchJSONWithCurrentToken(method,path,body,options);case 22:return _context3.abrupt("return",_context3.sent);case 25:throw _context3.t0;case 26:case"end":return _context3.stop()}},_callee3,this,[[0,6],[10,16]])})),function(_x9,_x10,_x11){return _ref3.apply(this,arguments)})},{key:"fetchJSONWithCurrentToken",value:(_ref4=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(method,path,body){var headers,resp,contentType,isJson,data,options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return(headers=options.headers=options.headers||{}).Accept="application/json","GET"!==method&&"HEAD"!==method&&void 0!==body&&(headers["Content-Type"]||(headers["Content-Type"]="application/json",body=(0,_stringify2.default)(body))),_context4.next=5,this.fetch(method,path,body,options);case 5:return resp=_context4.sent,contentType=resp.headers.get("content-type"),isJson=contentType&&contentType.indexOf("json")>=0,_context4.next=10,isJson?resp.json():resp.text();case 10:if(data=_context4.sent,!resp.ok){_context4.next=13;break}return _context4.abrupt("return",data);case 13:throw new FetchError(resp,data);case 14:case"end":return _context4.stop()}},_callee4,this)})),function(_x13,_x14,_x15){return _ref4.apply(this,arguments)})},{key:"fullpath",value:function(path){return path.startsWith("http")?path:this.uri+path}},{key:"getAuthorizationHeader",value:function(){return this.token?this.token.toAuthHeader():null}},{key:"setCredentials",value:function(token){return(0,_logDeprecate2.default)("CozyStackClient::setCredentials is deprecated, use CozyStackClient::setToken"),this.setToken(token)}},{key:"getCredentials",value:function(){return(0,_logDeprecate2.default)("CozyStackClient::getCredentials is deprecated, use CozyStackClient::getAuthorizationHeader"),this.getAuthorizationHeader()}},{key:"setToken",value:function(token){this.token=token?new _AppToken2.default(token):null,token&&this.onRevocationChange(!1)}},{key:"getAccessToken",value:function(){return this.token&&this.token.getAccessToken()}},{key:"setUri",value:function(uri){this.uri=function(uri){if(null===uri)return null;for(;"/"===uri[uri.length-1];)uri=uri.slice(0,-1);return uri}(uri)}},{key:"getIconURL",value:function(opts){return(0,_getIconURL3.default)(this,opts)}}]),CozyStackClient}(),FetchError=exports.FetchError=function(_Error){function FetchError(response,reason){(0,_classCallCheck3.default)(this,FetchError);var _this2=(0,_possibleConstructorReturn3.default)(this,(FetchError.__proto__||(0,_getPrototypeOf2.default)(FetchError)).call(this));return Error.captureStackTrace&&Error.captureStackTrace(_this2,_this2.constructor),_this2.name="FetchError",_this2.response=response,_this2.url=response.url,_this2.status=response.status,_this2.reason=reason,Object.defineProperty(_this2,"message",{value:reason.message||("string"==typeof reason?reason:(0,_stringify2.default)(reason))}),_this2}return(0,_inherits3.default)(FetchError,_Error),FetchError}(Error);exports.default=CozyStackClient},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.normalizeApp=exports.APPS_DOCTYPE=void 0;var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_extends3=_interopRequireDefault(__webpack_require__(3)),_DocumentCollection2=__webpack_require__(52),_DocumentCollection3=_interopRequireDefault(_DocumentCollection2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var APPS_DOCTYPE=exports.APPS_DOCTYPE="io.cozy.apps",normalizeApp=exports.normalizeApp=function(app,doctype){return(0,_extends3.default)({},app,(0,_DocumentCollection2.normalizeDoc)(app,doctype),app.attributes)},AppCollection=function(_DocumentCollection){function AppCollection(stackClient){(0,_classCallCheck3.default)(this,AppCollection);var _this=(0,_possibleConstructorReturn3.default)(this,(AppCollection.__proto__||(0,_getPrototypeOf2.default)(AppCollection)).call(this,APPS_DOCTYPE,stackClient));return _this.endpoint="/apps/",_this}var _ref5,_ref4,_ref3,_ref2,_ref;return(0,_inherits3.default)(AppCollection,_DocumentCollection),(0,_createClass3.default)(AppCollection,[{key:"all",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(){var resp,_this2=this;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.stackClient.fetchJSON("GET",this.endpoint);case 2:return resp=_context.sent,_context.abrupt("return",{data:resp.data.map(function(app){return normalizeApp(app,_this2.doctype)}),meta:{count:resp.meta.count},skip:0,next:!1});case 4:case"end":return _context.stop()}},_callee,this)})),function(){return _ref.apply(this,arguments)})},{key:"get",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(){return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:throw new Error("get() method is not yet implemented");case 1:case"end":return _context2.stop()}},_callee2,this)})),function(){return _ref2.apply(this,arguments)})},{key:"create",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(){return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:throw new Error("create() method is not available for applications");case 1:case"end":return _context3.stop()}},_callee3,this)})),function(){return _ref3.apply(this,arguments)})},{key:"update",value:(_ref4=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(){return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:throw new Error("update() method is not available for applications");case 1:case"end":return _context4.stop()}},_callee4,this)})),function(){return _ref4.apply(this,arguments)})},{key:"destroy",value:(_ref5=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee5(){return _regenerator2.default.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:throw new Error("destroy() method is not available for applications");case 1:case"end":return _context5.stop()}},_callee5,this)})),function(){return _ref5.apply(this,arguments)})}]),AppCollection}(_DocumentCollection3.default);AppCollection.normalizeDoctype=_DocumentCollection3.default.normalizeDoctypeJsonApi,exports.default=AppCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildURL=exports.encode=void 0;var _slicedToArray3=_interopRequireDefault(__webpack_require__(164)),_entries2=_interopRequireDefault(__webpack_require__(163)),_pickBy2=_interopRequireDefault(__webpack_require__(136));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var encode=exports.encode=function(data){return(0,_entries2.default)(data).map(function(_ref){var _ref2=(0,_slicedToArray3.default)(_ref,2);return _ref2[0]+"="+function encodeValues(values){var fromArray=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.isArray(values)?"["+values.map(function(v){return encodeValues(v,!0)}).join(",")+"]":fromArray?encodeURIComponent('"'+values+'"'):encodeURIComponent(values)}(_ref2[1])}).join("&")};exports.buildURL=function(url,params){var qs=encode((0,_pickBy2.default)(params));return qs?url+"?"+qs:url}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hasJobFinished=exports.normalizeJob=exports.JOBS_DOCTYPE=void 0;var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_taggedTemplateLiteral3=_interopRequireDefault(__webpack_require__(106)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_extends3=_interopRequireDefault(__webpack_require__(3)),_promise2=_interopRequireDefault(__webpack_require__(67)),_templateObject=(0,_taggedTemplateLiteral3.default)(["/jobs/",""],["/jobs/",""]),_Collection2=_interopRequireDefault(__webpack_require__(234)),_DocumentCollection=__webpack_require__(52),_utils=__webpack_require__(107);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var JOBS_DOCTYPE=exports.JOBS_DOCTYPE="io.cozy.jobs",sleep=function(delay){return new _promise2.default(function(resolve){return setTimeout(resolve,delay)})},normalizeJob=exports.normalizeJob=function(job){return(0,_extends3.default)({},job,(0,_DocumentCollection.normalizeDoc)(job,JOBS_DOCTYPE),job.attributes)},hasJobFinished=exports.hasJobFinished=function(job){return"done"===job.state||"errored"===job.state},JobCollection=function(){function JobCollection(stackClient){(0,_classCallCheck3.default)(this,JobCollection),this.stackClient=stackClient}var _ref2,_ref;return(0,_createClass3.default)(JobCollection,[{key:"queued",value:function(workerType){return this.stackClient.fetchJSON("GET","/jobs/queue/"+workerType)}},{key:"create",value:function(workerType,args,options){return this.stackClient.fetchJSON("POST","/jobs/queue/"+workerType,{data:{type:JOBS_DOCTYPE,attributes:{arguments:args||{},options:options||{}}}})}},{key:"get",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(id){return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",_Collection2.default.get(this.stackClient,(0,_utils.uri)(_templateObject,id),{normalize:normalizeJob}));case 1:case"end":return _context.stop()}},_callee,this)})),function(_x){return _ref.apply(this,arguments)})},{key:"waitFor",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(id){var start,jobData,now,_ref3=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref3$onUpdate=_ref3.onUpdate,onUpdate=void 0===_ref3$onUpdate?null:_ref3$onUpdate,_ref3$until=_ref3.until,until=void 0===_ref3$until?hasJobFinished:_ref3$until,_ref3$delay=_ref3.delay,delay=void 0===_ref3$delay?5e3:_ref3$delay,_ref3$timeout=_ref3.timeout,timeout=void 0===_ref3$timeout?3e5:_ref3$timeout;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return start=Date.now(),_context2.next=3,this.get(id);case 3:jobData=_context2.sent.data.attributes;case 4:if(jobData&&until(jobData)){_context2.next=16;break}return _context2.next=7,sleep(delay);case 7:return _context2.next=9,this.get(id);case 9:if(jobData=_context2.sent.data.attributes,onUpdate&&onUpdate(jobData),now=Date.now(),!(start-now>timeout)){_context2.next=14;break}throw new Error("Timeout for JobCollection::waitFor");case 14:_context2.next=4;break;case 16:return _context2.abrupt("return",jobData);case 17:case"end":return _context2.stop()}},_callee2,this)})),function(_x3){return _ref2.apply(this,arguments)})}]),JobCollection}();exports.default=JobCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isForAccount=exports.isForKonnector=exports.normalizeTrigger=exports.TRIGGERS_DOCTYPE=exports.JOBS_DOCTYPE=void 0;var _keys2=_interopRequireDefault(__webpack_require__(61)),_taggedTemplateLiteral3=_interopRequireDefault(__webpack_require__(106)),_regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_get3=_interopRequireDefault(__webpack_require__(167)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_extends3=_interopRequireDefault(__webpack_require__(3)),_templateObject=(0,_taggedTemplateLiteral3.default)(["/jobs/triggers"],["/jobs/triggers"]),_templateObject2=(0,_taggedTemplateLiteral3.default)(["/jobs/triggers/",""],["/jobs/triggers/",""]),_templateObject3=(0,_taggedTemplateLiteral3.default)(["/jobs/triggers/","/launch"],["/jobs/triggers/","/launch"]),_Collection=__webpack_require__(234),_Collection2=_interopRequireDefault(_Collection),_DocumentCollection2=__webpack_require__(52),_DocumentCollection3=_interopRequireDefault(_DocumentCollection2),_JobCollection=__webpack_require__(371),_utils=__webpack_require__(107);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.JOBS_DOCTYPE="io.cozy.jobs";var TRIGGERS_DOCTYPE=exports.TRIGGERS_DOCTYPE="io.cozy.triggers",normalizeTrigger=exports.normalizeTrigger=function(trigger){return(0,_extends3.default)({},trigger,(0,_DocumentCollection2.normalizeDoc)(trigger,TRIGGERS_DOCTYPE),trigger.attributes)},TriggerCollection=(exports.isForKonnector=function(triggerAttrs,slug){return"konnector"===triggerAttrs.worker&&triggerAttrs.message.konnector==slug},exports.isForAccount=function(triggerAttrs,accountId){return triggerAttrs.message.account==accountId},function(_DocumentCollection){function TriggerCollection(stackClient){return(0,_classCallCheck3.default)(this,TriggerCollection),(0,_possibleConstructorReturn3.default)(this,(TriggerCollection.__proto__||(0,_getPrototypeOf2.default)(TriggerCollection)).call(this,TRIGGERS_DOCTYPE,stackClient))}var _ref7,_ref6,_ref5,_ref4,_ref3,_ref2,_ref;return(0,_inherits3.default)(TriggerCollection,_DocumentCollection),(0,_createClass3.default)(TriggerCollection,[{key:"all",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(){var resp;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,this.stackClient.fetchJSON("GET","/jobs/triggers");case 3:return resp=_context.sent,_context.abrupt("return",{data:resp.data.map(function(row){return normalizeTrigger(row,TRIGGERS_DOCTYPE)}),meta:{count:resp.data.length},next:!1,skip:0});case 7:return _context.prev=7,_context.t0=_context.catch(0),_context.abrupt("return",(0,_Collection.dontThrowNotFoundError)(_context.t0));case 10:case"end":return _context.stop()}},_callee,this,[[0,7]])})),function(){return _ref.apply(this,arguments)})},{key:"create",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(attributes){var path,resp;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return path=(0,_utils.uri)(_templateObject),_context2.next=3,this.stackClient.fetchJSON("POST",path,{data:{attributes:attributes}});case 3:return resp=_context2.sent,_context2.abrupt("return",{data:normalizeTrigger(resp.data)});case 5:case"end":return _context2.stop()}},_callee2,this)})),function(_x2){return _ref2.apply(this,arguments)})},{key:"destroy",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(document){var _id;return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(_id=document._id){_context3.next=3;break}throw new Error("TriggerCollection.destroy needs a document with an _id");case 3:return _context3.next=5,this.stackClient.fetchJSON("DELETE",(0,_utils.uri)(_templateObject2,_id));case 5:return _context3.abrupt("return",{data:normalizeTrigger((0,_extends3.default)({},document,{_deleted:!0}))});case 6:case"end":return _context3.stop()}},_callee3,this)})),function(_x3){return _ref3.apply(this,arguments)})},{key:"find",value:(_ref4=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(){var url,resp,selector=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(1!==(0,_keys2.default)(selector).length||!selector.worker){_context4.next=14;break}return url="/jobs/triggers?Worker="+selector.worker,_context4.prev=2,_context4.next=5,this.stackClient.fetchJSON("GET",url);case 5:return resp=_context4.sent,_context4.abrupt("return",{data:resp.data.map(function(row){return normalizeTrigger(row,TRIGGERS_DOCTYPE)}),meta:{count:resp.data.length},next:!1,skip:0});case 9:return _context4.prev=9,_context4.t0=_context4.catch(2),_context4.abrupt("return",(0,_Collection.dontThrowNotFoundError)(_context4.t0));case 12:_context4.next=15;break;case 14:return _context4.abrupt("return",(0,_get3.default)(TriggerCollection.prototype.__proto__||(0,_getPrototypeOf2.default)(TriggerCollection.prototype),"find",this).call(this,selector,options));case 15:case"end":return _context4.stop()}},_callee4,this,[[2,9]])})),function(){return _ref4.apply(this,arguments)})},{key:"get",value:(_ref5=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee5(id){return _regenerator2.default.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.abrupt("return",_Collection2.default.get(this.stackClient,(0,_utils.uri)(_templateObject2,id),{normalize:normalizeTrigger}));case 1:case"end":return _context5.stop()}},_callee5,this)})),function(_x6){return _ref5.apply(this,arguments)})},{key:"launch",value:(_ref6=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee6(trigger){var path,resp;return _regenerator2.default.wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return path=(0,_utils.uri)(_templateObject3,trigger._id),_context6.next=3,this.stackClient.fetchJSON("POST",path);case 3:return resp=_context6.sent,_context6.abrupt("return",{data:(0,_JobCollection.normalizeJob)(resp.data)});case 5:case"end":return _context6.stop()}},_callee6,this)})),function(_x7){return _ref6.apply(this,arguments)})},{key:"update",value:(_ref7=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee7(){return _regenerator2.default.wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:throw new Error("update() method is not available for triggers");case 1:case"end":return _context7.stop()}},_callee7,this)})),function(){return _ref7.apply(this,arguments)})}]),TriggerCollection}(_DocumentCollection3.default));TriggerCollection.normalizeDoctype=_DocumentCollection3.default.normalizeDoctypeJsonApi,exports.default=TriggerCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=function(){var _console;(_console=console).warn.apply(_console,arguments)}},function(module,exports,__webpack_require__){var baseSlice=__webpack_require__(276);module.exports=function(array,start,end){var length=array.length;return end=void 0===end?length:end,!start&&end>=length?array:baseSlice(array,start,end)}},function(module,exports,__webpack_require__){var asciiToArray=__webpack_require__(739),hasUnicode=__webpack_require__(212),unicodeToArray=__webpack_require__(740);module.exports=function(string){return hasUnicode(string)?unicodeToArray(string):asciiToArray(string)}},function(module,exports,__webpack_require__){const PropTypes=__webpack_require__(181),get=__webpack_require__(10),log=__webpack_require__(377),Document=__webpack_require__(33),getPrimaryOrFirst=property=>obj=>obj[property]&&0!==obj[property].length?obj[property].find(property=>property.primary)||obj[property][0]:"";class Contact extends Document{static isContact(candidate){return candidate._type===Contact.doctype}static getInitials(contact){if("string"==typeof contact)return log("warn","Passing a string to Contact.getInitials will be deprecated soon."),contact[0].toUpperCase();if(contact.name)return["givenName","familyName"].map(part=>get(contact,["name",part,0],"")).join("").toUpperCase();const email=Contact.getPrimaryEmail(contact);return email?email[0].toUpperCase():(log("warn","Contact has no name and no email."),"")}static getPrimaryEmail(contact){return Array.isArray(contact.email)?getPrimaryOrFirst("email")(contact).address:contact.email}static getPrimaryCozy(contact){return Array.isArray(contact.cozy)?getPrimaryOrFirst("cozy")(contact).url:contact.url}static getPrimaryPhone(contact){return getPrimaryOrFirst("phone")(contact).number}static getPrimaryAddress(contact){return getPrimaryOrFirst("address")(contact).formattedAddress}static getFullname(contact){return contact.fullname?contact.fullname:contact.name?["namePrefix","givenName","additionalName","familyName","nameSuffix"].map(part=>contact.name[part]).filter(part=>void 0!==part).join(" ").trim():void 0}static getDisplayName(contact){return Contact.getFullname(contact)||Contact.getPrimaryEmail(contact)}}const ContactShape=PropTypes.shape({_id:PropTypes.string.isRequired,_type:PropTypes.string.isRequired,fullname:PropTypes.string,name:PropTypes.shape({givenName:PropTypes.string,familyName:PropTypes.string,additionalName:PropTypes.string,namePrefix:PropTypes.string,nameSuffix:PropTypes.string}),birthday:PropTypes.string,note:PropTypes.string,email:PropTypes.arrayOf(PropTypes.shape({address:PropTypes.string.isRequired,label:PropTypes.string,type:PropTypes.string,primary:PropTypes.bool})),address:PropTypes.arrayOf(PropTypes.shape({street:PropTypes.string,pobox:PropTypes.string,city:PropTypes.string,region:PropTypes.string,postcode:PropTypes.string,country:PropTypes.string,type:PropTypes.string,primary:PropTypes.bool,label:PropTypes.string,formattedAddress:PropTypes.string})),phone:PropTypes.arrayOf(PropTypes.shape({number:PropTypes.string.isRequired,type:PropTypes.string,label:PropTypes.string,primary:PropTypes.bool})),cozy:PropTypes.arrayOf(PropTypes.shape({url:PropTypes.string.isRequired,label:PropTypes.string,primary:PropTypes.bool})),company:PropTypes.string,jobTitle:PropTypes.string,trashed:PropTypes.bool,me:PropTypes.bool,relationships:PropTypes.shape({accounts:PropTypes.shape({data:PropTypes.arrayOf(PropTypes.shape({_id:PropTypes.string.isRequired,_type:PropTypes.string.isRequired}))}),groups:PropTypes.shape({data:PropTypes.arrayOf(PropTypes.shape({_id:PropTypes.string.isRequired,_type:PropTypes.string.isRequired}))})})});Contact.doctype="io.cozy.contacts",Contact.propType=ContactShape,module.exports=Contact},function(module,exports,__webpack_require__){const log=__webpack_require__(34).namespace("doctypes");module.exports=log},function(module,exports,__webpack_require__){const Document=__webpack_require__(33),STORE_SLUG="store";class Application extends Document{static getStoreInstallationURL(appData=[],app={}){if(!app.slug)throw new Error("Expected app / konnector with the defined slug");const storeApp=this.isInstalled(appData,{slug:STORE_SLUG});if(!storeApp)return null;const storeUrl=storeApp.links&&storeApp.links.related;return storeUrl?`${storeUrl}#/discover/${app.slug}/install`:null}static isInstalled(apps=[],wantedApp={}){return apps.find(app=>app.attributes&&app.attributes.slug===wantedApp.slug)}static getUrl(app){return app.links&&app.links.related}}Application.schema={doctype:"io.cozy.apps",attributes:{}},Application.doctype="io.cozy.apps",module.exports=Application},function(module,exports){module.exports={eitherIncludes:(str1,str2)=>Boolean(str1&&str2&&(str1.includes(str2)||str2.includes(str1)))}},function(module,exports,__webpack_require__){const labelSlugs=__webpack_require__(757),institutionLabelsCompiled=Object.entries(labelSlugs).map(([ilabelRx,slug])=>"/"===ilabelRx[0]&&"/"===ilabelRx[ilabelRx.length-1]?[new RegExp(ilabelRx.substr(1,ilabelRx.length-2),"i"),slug]:[ilabelRx,slug]);module.exports={getSlugFromInstitutionLabel:institutionLabel=>{if(institutionLabel)for(const[rx,slug]of institutionLabelsCompiled)if(rx instanceof RegExp){if(institutionLabel.match(rx))return slug}else if(rx.toLowerCase()===institutionLabel.toLowerCase())return slug}}},function(module,exports,__webpack_require__){const trimEnd=__webpack_require__(762),Document=__webpack_require__(33),FILENAME_WITH_EXTENSION_REGEX=/(.+)(\..*)$/;class CozyFile extends Document{static async getFullpath(dirId,name){if(!dirId)throw new Error("You must provide a dirId");const parentDir=await this.get(dirId);return`${trimEnd(parentDir.path,"/")}/${name}`}static async move(fileId,destination,force=!1){const{folderId:folderId,path:path}=destination,filesCollection=this.cozyClient.collection("io.cozy.files");try{return{moved:(await filesCollection.updateFileMetadata(fileId,{dir_id:folderId})).data,deleted:null}}catch(e){if(409===e.status&&force){let destinationPath;if(path)destinationPath=path;else{const filename=(await this.get(fileId)).name;destinationPath=await this.getFullpath(folderId,filename)}const conflictResp=await filesCollection.statByPath(destinationPath);return await filesCollection.destroy(conflictResp.data),{moved:(await filesCollection.updateFileMetadata(fileId,{dir_id:folderId})).data,deleted:conflictResp.data.id}}throw e}}static splitFilename(file){if(!file.name)throw new Error("file should have a name property ");if("file"===file.type){const match=file.name.match(FILENAME_WITH_EXTENSION_REGEX);if(match)return{filename:match[1],extension:match[2]}}return{filename:file.name,extension:""}}static async overrideFileForPath(path,file,metadata){path.endsWith("/")||(path+="/");const filesCollection=this.cozyClient.collection("io.cozy.files");try{const existingFile=await filesCollection.statByPath(path+file.name),{id:fileId,dir_id:dirId}=existingFile.data;return await filesCollection.updateFile(file,{dirId:dirId,fileId:fileId,metadata:metadata})}catch(error){if(/Not Found/.test(error)){const dirId=await filesCollection.ensureDirectoryExists(path);return await filesCollection.createFile(file,{dirId:dirId,metadata:metadata})}throw error}}static generateNewFileNameOnConflict(filenameWithoutExtension){const regex=new RegExp("(_)([0-9]+)$"),matches=filenameWithoutExtension.match(regex);if(matches){let versionNumber=parseInt(matches[2]);return versionNumber++,filenameWithoutExtension.replace(new RegExp("(_)([0-9]+)$"),`_${versionNumber}`)}return`${filenameWithoutExtension}_1`}static generateFileNameForRevision(file,revision,f){const{filename:filename,extension:extension}=CozyFile.splitFilename({name:file.name,type:"file"});return`${filename}_${f(revision.updated_at,"DD MMMM - HH[h]mm")}${extension}`}static async uploadFileWithConflictStrategy(name,file,dirId,conflictStrategy){const filesCollection=this.cozyClient.collection("io.cozy.files");try{const path=await CozyFile.getFullpath(dirId,name),existingFile=await filesCollection.statByPath(path),{id:fileId}=existingFile.data;if("erase"===conflictStrategy){return await filesCollection.updateFile(file,{dirId:dirId,fileId:fileId,name:name})}{const{filename:filename,extension:extension}=CozyFile.splitFilename({name:name,type:"file"}),newFileName=CozyFile.generateNewFileNameOnConflict(filename)+extension;return CozyFile.uploadFileWithConflictStrategy(newFileName,file,dirId,conflictStrategy)}}catch(error){if(/Not Found/.test(error.message))return await CozyFile.upload(name,file,dirId);throw error}}static async upload(name,file,dirId){return this.cozyClient.collection("io.cozy.files").createFile(file,{name:name,dirId:dirId,contentType:"image/jpeg"})}}CozyFile.doctype="io.cozy.files",module.exports=CozyFile},function(module,exports,__webpack_require__){var find=__webpack_require__(655)(__webpack_require__(912));module.exports=find},function(module,exports){module.exports="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)},function(module,exports){module.exports={black:"var(--black)",white:"var(--white)",paleGrey:"var(--paleGrey)",silver:"var(--silver)",coolGrey:"var(--coolGrey)",slateGrey:"var(--slateGrey)",charcoalGrey:"var(--charcoalGrey)",overlay:"var(--overlay)",zircon:"var(--zircon)",frenchPass:"var(--frenchPass)",dodgerBlue:"var(--dodgerBlue)",scienceBlue:"var(--scienceBlue)",puertoRico:"var(--puertoRico)",grannyApple:"var(--grannyApple)",emerald:"var(--emerald)",malachite:"var(--malachite)",seafoamGreen:"var(--seafoamGreen)",brightSun:"var(--brightSun)",texasRose:"var(--texasRose)",chablis:"var(--chablis)",yourPink:"var(--yourPink)",fuchsia:"var(--fuchsia)",pomegranate:"var(--pomegranate)",monza:"var(--monza)",portage:"var(--portage)",azure:"var(--azure)",melon:"var(--melon)",blazeOrange:"var(--blazeOrange)",mango:"var(--mango)",pumpkinOrange:"var(--pumpkinOrange)",lavender:"var(--lavender)",darkPeriwinkle:"var(--darkPeriwinkle)",purpley:"var(--purpley)",lightishPurple:"var(--lightishPurple)",barney:"var(--barney)",weirdGreen:"var(--weirdGreen)",primaryColor:"var(--primaryColor)",primaryColorLight:"var(--primaryColorLight)",primaryContrastTextColor:"var(--primaryContrastTextColor)"}},function(module,__webpack_exports__,__webpack_require__){"use strict";function symbolObservablePonyfill(root){var result,Symbol=root.Symbol;return"function"==typeof Symbol?Symbol.observable?result=Symbol.observable:(result=Symbol("observable"),Symbol.observable=result):result="@@observable",result}__webpack_require__.d(__webpack_exports__,"a",function(){return symbolObservablePonyfill})},,function(module,exports){function serializer(replacer,cycleReplacer){var stack=[],keys=[];return null==cycleReplacer&&(cycleReplacer=function(key,value){return stack[0]===value?"[Circular ~]":"[Circular ~."+keys.slice(0,stack.indexOf(value)).join(".")+"]"}),function(key,value){if(stack.length>0){var thisPos=stack.indexOf(this);~thisPos?stack.splice(thisPos+1):stack.push(this),~thisPos?keys.splice(thisPos,1/0,key):keys.push(key),~stack.indexOf(value)&&(value=cycleReplacer.call(this,key,value))}else stack.push(value);return null==replacer?value:replacer.call(this,key,value)}}(module.exports=function(obj,replacer,spaces,cycleReplacer){return JSON.stringify(obj,serializer(replacer,cycleReplacer),spaces)}).getSerialize=serializer},,function(module,exports,__webpack_require__){var realNames=__webpack_require__(500),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(func){for(var result=func.name+"",array=realNames[result],length=hasOwnProperty.call(realNames,result)?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _entries2=_interopRequireDefault(__webpack_require__(163)),_toArray3=_interopRequireDefault(__webpack_require__(667)),_slicedToArray3=_interopRequireDefault(__webpack_require__(164)),_promise2=_interopRequireDefault(__webpack_require__(67)),_map2=_interopRequireDefault(__webpack_require__(680)),_keys2=_interopRequireDefault(__webpack_require__(61)),_values2=_interopRequireDefault(__webpack_require__(127)),_toConsumableArray3=_interopRequireDefault(__webpack_require__(70)),_extends3=_interopRequireDefault(__webpack_require__(3)),_regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_getIterator3=_interopRequireDefault(__webpack_require__(66)),_objectWithoutProperties3=_interopRequireDefault(__webpack_require__(86)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_const=__webpack_require__(357),_StackLink2=_interopRequireDefault(__webpack_require__(391)),_associations=__webpack_require__(171),_helpers=__webpack_require__(358),_helpers2=__webpack_require__(392),_dsl=__webpack_require__(87),_cozyStackClient=__webpack_require__(703),_cozyStackClient2=_interopRequireDefault(_cozyStackClient),_mobile=__webpack_require__(734),_optimize2=_interopRequireDefault(__webpack_require__(744)),_store=__webpack_require__(128),_store2=_interopRequireDefault(_store),_policies2=_interopRequireDefault(__webpack_require__(746)),_Schema2=_interopRequireDefault(__webpack_require__(747)),_CozyLink=__webpack_require__(246),_ObservableQuery2=_interopRequireDefault(__webpack_require__(749)),_mapValues2=_interopRequireDefault(__webpack_require__(119)),_fromPairs2=_interopRequireDefault(__webpack_require__(93)),_flatten2=_interopRequireDefault(__webpack_require__(89)),_uniqBy2=_interopRequireDefault(__webpack_require__(189)),_zip2=_interopRequireDefault(__webpack_require__(750)),_forEach2=_interopRequireDefault(__webpack_require__(145)),_get2=_interopRequireDefault(__webpack_require__(10)),_microee2=_interopRequireDefault(__webpack_require__(329));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ensureArray=function(arr){return Array.isArray(arr)?arr:[arr]},deprecatedHandler=function(msg){return{get:function(target,prop){return console.warn(msg),target[prop]}}},CozyClient=function(){function CozyClient(_ref){var link=_ref.link,links=_ref.links,_ref$schema=_ref.schema,schema=void 0===_ref$schema?{}:_ref$schema,_ref$appMetadata=_ref.appMetadata,appMetadata=void 0===_ref$appMetadata?{}:_ref$appMetadata,options=(0,_objectWithoutProperties3.default)(_ref,["link","links","schema","appMetadata"]);(0,_classCallCheck3.default)(this,CozyClient),link&&console.warn("`link` is deprecated, use `links`"),this.appMetadata=appMetadata,this.options=options,this.idCounter=1,this.isLogged=!1,this.instanceOptions={},this.handleRevocationChange=this.handleRevocationChange.bind(this),this.handleTokenRefresh=this.handleTokenRefresh.bind(this),this.createClient(),this.links=ensureArray(link||links||new _StackLink2.default),this.registerClientOnLinks(),this.chain=(0,_CozyLink.chain)(this.links),this.schema=new _Schema2.default(schema,this.getStackClient()),this.plugins={};try{this.loadInstanceOptionsFromDOM()}catch(err){}options.uri&&options.token&&this.login()}var _ref19,_ref18,_ref17,_ref14,_ref13,_ref12,_ref10,_ref9,_ref7,_ref6,_ref5,_ref3,_ref2;return(0,_createClass3.default)(CozyClient,[{key:"registerPlugin",value:function(Plugin,options){if(!Plugin.pluginName)throw new Error("Cannot register a plugin whose class does not have `pluginName` attribute.");if(this.plugins[Plugin.pluginName])throw new Error("Cannot register plugin "+Plugin.pluginName+". A plugin with the same name has already been registered.");var instance=new Plugin(this,options);return this.plugins[Plugin.pluginName]=instance,instance}},{key:"addSchema",value:function(schemaDefinition){this.schema.add(schemaDefinition)}},{key:"registerClientOnLinks",value:function(){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=(0,_getIterator3.default)(this.links);!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var link=_step.value;if(link.registerClient)try{link.registerClient(this)}catch(e){console.warn(e)}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}},{key:"login",value:function(options){return this.isLogged&&!this.isRevoked?(console.warn("CozyClient is already logged."),this.loginPromise):this.loginPromise=this._login(options)}},{key:"_login",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(options){var _iteratorNormalCompletion2,_didIteratorError2,_iteratorError2,_iterator2,_step2,link;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:this.emit("beforeLogin"),this.registerClientOnLinks(),options&&(options.uri&&this.stackClient.setUri(options.uri),options.token&&this.stackClient.setToken(options.token)),_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0,_context.prev=6,_iterator2=(0,_getIterator3.default)(this.links);case 8:if(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done){_context.next=16;break}if(!(link=_step2.value).onLogin){_context.next=13;break}return _context.next=13,link.onLogin();case 13:_iteratorNormalCompletion2=!0,_context.next=8;break;case 16:_context.next=22;break;case 18:_context.prev=18,_context.t0=_context.catch(6),_didIteratorError2=!0,_iteratorError2=_context.t0;case 22:_context.prev=22,_context.prev=23,!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return();case 25:if(_context.prev=25,!_didIteratorError2){_context.next=28;break}throw _iteratorError2;case 28:return _context.finish(25);case 29:return _context.finish(22);case 30:this.isLogged=!0,this.isRevoked=!1,this.emit("login");case 33:case"end":return _context.stop()}},_callee,this,[[6,18,22,30],[23,,25,29]])})),function(_x){return _ref2.apply(this,arguments)})},{key:"logout",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(){var _iteratorNormalCompletion3,_didIteratorError3,_iteratorError3,_iterator3,_step3,link;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(this.isLogged){_context2.next=3;break}return console.warn("CozyClient isn't logged."),_context2.abrupt("return");case 3:if(this.emit("beforeLogout"),this.isLogged=!1,!(this.stackClient instanceof _cozyStackClient.OAuthClient)){_context2.next=17;break}if(_context2.prev=6,!this.stackClient.unregister||this.stackClient.isRegistered&&!this.stackClient.isRegistered()){_context2.next=10;break}return _context2.next=10,this.stackClient.unregister();case 10:_context2.next=15;break;case 12:_context2.prev=12,_context2.t0=_context2.catch(6),console.warn("Impossible to unregister client on stack: "+_context2.t0);case 15:_context2.next=25;break;case 17:return _context2.prev=17,_context2.next=20,this.stackClient.fetch("DELETE","/auth/login");case 20:_context2.next=25;break;case 22:_context2.prev=22,_context2.t1=_context2.catch(17),console.warn("Impossible to log out: "+_context2.t1);case 25:_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0,_context2.prev=28,_iterator3=(0,_getIterator3.default)(this.links);case 30:if(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done){_context2.next=44;break}if(!(link=_step3.value).reset){_context2.next=41;break}return _context2.prev=33,_context2.next=36,link.reset();case 36:_context2.next=41;break;case 38:_context2.prev=38,_context2.t2=_context2.catch(33),console.warn(_context2.t2);case 41:_iteratorNormalCompletion3=!0,_context2.next=30;break;case 44:_context2.next=50;break;case 46:_context2.prev=46,_context2.t3=_context2.catch(28),_didIteratorError3=!0,_iteratorError3=_context2.t3;case 50:_context2.prev=50,_context2.prev=51,!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return();case 53:if(_context2.prev=53,!_didIteratorError3){_context2.next=56;break}throw _iteratorError3;case 56:return _context2.finish(53);case 57:return _context2.finish(50);case 58:this.emit("logout");case 59:case"end":return _context2.stop()}},_callee2,this,[[6,12],[17,22],[28,46,50,58],[33,38],[51,,53,57]])})),function(){return _ref3.apply(this,arguments)})},{key:"collection",value:function(doctype){return this.getStackClient().collection(doctype)}},{key:"fetch",value:function(method,path,body){var options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.getStackClient().fetch(method,path,body,options)}},{key:"all",value:function(doctype){return new _dsl.QueryDefinition({doctype:doctype})}},{key:"find",value:function(doctype){var selector=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return new _dsl.QueryDefinition({doctype:doctype,selector:selector})}},{key:"get",value:function(doctype,id){return new _dsl.QueryDefinition({doctype:doctype,id:id})}},{key:"create",value:(_ref5=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(type,_ref4,relationships){_ref4._type;var document,attributes=(0,_objectWithoutProperties3.default)(_ref4,["_type"]),options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return document=(0,_extends3.default)({_type:type},attributes),_context3.next=3,this.schema.validate(document);case 3:if(!0===_context3.sent){_context3.next=6;break}throw new Error("Validation failed");case 6:return _context3.abrupt("return",this.mutate(this.getDocumentSavePlan(document,relationships),options));case 7:case"end":return _context3.stop()}},_callee3,this)})),function(_x5,_x6,_x7){return _ref5.apply(this,arguments)})},{key:"validate",value:function(document){return this.schema.validate(document)}},{key:"save",value:(_ref6=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(document){var mutationOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,this.schema.validate(document);case 2:if(!0===_context4.sent){_context4.next=5;break}throw new Error("Validation failed");case 5:return _context4.abrupt("return",this.mutate(this.getDocumentSavePlan(document),mutationOptions));case 6:case"end":return _context4.stop()}},_callee4,this)})),function(_x9){return _ref6.apply(this,arguments)})},{key:"ensureCozyMetadata",value:function(document){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{event:"creation"},METADATA_VERSION=1;if(void 0===this.appMetadata)return document;var doctypeVersion=void 0;if(document._type){var schema=this.schema.getDoctypeSchema(document._type);doctypeVersion=(0,_get2.default)(schema,"doctypeVersion")}var _appMetadata=this.appMetadata,slug=_appMetadata.slug,sourceAccount=_appMetadata.sourceAccount,version=_appMetadata.version,now=(new Date).toISOString(),cozyMetadata=(0,_get2.default)(document,"cozyMetadata",{});return"creation"===options.event?cozyMetadata=(0,_extends3.default)({metadataVersion:METADATA_VERSION,doctypeVersion:doctypeVersion,createdByApp:slug,sourceAccount:sourceAccount,createdAt:now,createdByAppVersion:version,updatedAt:now,updatedByApps:slug?[{date:now,slug:slug,version:version}]:[]},cozyMetadata):"update"===options.event&&(cozyMetadata=(0,_extends3.default)({},cozyMetadata,{updatedAt:now,updatedByApps:[{date:now,slug:slug,version:version}].concat((0,_toConsumableArray3.default)((0,_get2.default)(document,"cozyMetadata.updatedByApps",[]).filter(function(info){return info.slug!==slug})))})),(0,_extends3.default)({},document,{cozyMetadata:cozyMetadata})}},{key:"getDocumentSavePlan",value:function(document,relationships){var _this=this,newDocument=!document._rev,dehydratedDoc=this.ensureCozyMetadata((0,_helpers2.dehydrate)(document),{event:newDocument?"creation":"update"}),saveMutation=newDocument?_dsl.Mutations.createDocument(dehydratedDoc):_dsl.Mutations.updateDocument(dehydratedDoc);if(!(relationships&&(0,_values2.default)(relationships).filter(function(relations){return Array.isArray(relations)?relations.length>0:relations}).length>0))return saveMutation;if(relationships&&!newDocument)throw new Error("Unable to save relationships on a not-new document");return[saveMutation,function(response){var document=_this.hydrateDocument(response.data);return(0,_keys2.default)(relationships).map(function(name){var val=relationships[name];return Array.isArray(val)?document[name].insertDocuments(val):document[name].setDocument(val)})}]}},{key:"triggerHook",value:function(name,document){if(CozyClient.hooks){var hooks=(CozyClient.hooks[document._type]||{})[name]||[],_iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _step4,_iterator4=(0,_getIterator3.default)(hooks);!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){(0,_step4.value)(this,document)}}catch(err){_didIteratorError4=!0,_iteratorError4=err}finally{try{!_iteratorNormalCompletion4&&_iterator4.return&&_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}}}},{key:"destroy",value:(_ref7=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee5(document){var res,mutationOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,this.triggerHook("before:destroy",document);case 2:return _context5.next=4,this.mutate(_dsl.Mutations.deleteDocument(document),mutationOptions);case 4:return res=_context5.sent,_context5.next=7,this.triggerHook("after:destroy",document);case 7:return _context5.abrupt("return",res);case 8:case"end":return _context5.stop()}},_callee5,this)})),function(_x12){return _ref7.apply(this,arguments)})},{key:"upload",value:function(file,dirPath){var mutationOptions=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.mutate(_dsl.Mutations.uploadFile(file,dirPath),mutationOptions)}},{key:"ensureQueryExists",value:function(queryId,queryDefinition){this.ensureStore(),"loaded"===(0,_store.getQueryFromState)(this.store.getState(),queryId).fetchStatus&&queryDefinition.skip||this.dispatch((0,_store.initQuery)(queryId,queryDefinition))}},{key:"query",value:(_ref9=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee6(queryDefinition){var queryId,response,_ref8=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},update=_ref8.update,options=(0,_objectWithoutProperties3.default)(_ref8,["update"]);return _regenerator2.default.wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return this.ensureStore(),queryId=options.as||this.generateId(),this.ensureQueryExists(queryId,queryDefinition),_context6.prev=3,_context6.next=6,this.requestQuery(queryDefinition);case 6:return response=_context6.sent,this.dispatch((0,_store.receiveQueryResult)(queryId,response,{update:update})),_context6.abrupt("return",response);case 11:throw _context6.prev=11,_context6.t0=_context6.catch(3),this.dispatch((0,_store.receiveQueryError)(queryId,_context6.t0)),_context6.t0;case 15:case"end":return _context6.stop()}},_callee6,this,[[3,11]])})),function(_x15){return _ref9.apply(this,arguments)})},{key:"queryAll",value:(_ref10=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee7(queryDefinition,options){var documents,resp;return _regenerator2.default.wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:documents=[],resp={next:!0};case 2:if(!resp||!resp.next){_context7.next=9;break}return _context7.next=5,this.query(queryDefinition.offset(documents.length),options);case 5:resp=_context7.sent,documents.push.apply(documents,(0,_toConsumableArray3.default)(resp.data)),_context7.next=2;break;case 9:return _context7.abrupt("return",documents);case 10:case"end":return _context7.stop()}},_callee7,this)})),function(_x16,_x17){return _ref10.apply(this,arguments)})},{key:"watchQuery",value:function(){return console.warn("client.watchQuery is deprecated, please use client.makeObservableQuery."),this.makeObservableQuery.apply(this,arguments)}},{key:"makeObservableQuery",value:function(queryDefinition){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ensureStore();var queryId=options.as||this.generateId();return this.ensureQueryExists(queryId,queryDefinition),new _ObservableQuery2.default(queryId,queryDefinition,this)}},{key:"mutate",value:(_ref12=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee8(mutationDefinition){var mutationId,response,_ref11=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},update=_ref11.update,updateQueries=_ref11.updateQueries,options=(0,_objectWithoutProperties3.default)(_ref11,["update","updateQueries"]);return _regenerator2.default.wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return this.ensureStore(),mutationId=options.as||this.generateId(),this.dispatch((0,_store.initMutation)(mutationId,mutationDefinition)),_context8.prev=3,_context8.next=6,this.requestMutation(mutationDefinition);case 6:return response=_context8.sent,this.dispatch((0,_store.receiveMutationResult)(mutationId,response,{update:update,updateQueries:updateQueries},mutationDefinition)),_context8.abrupt("return",response);case 11:throw _context8.prev=11,_context8.t0=_context8.catch(3),this.dispatch((0,_store.receiveMutationError)(mutationId,_context8.t0,mutationDefinition)),_context8.t0;case 15:case"end":return _context8.stop()}},_callee8,this,[[3,11]])})),function(_x20){return _ref12.apply(this,arguments)})},{key:"requestQuery",value:(_ref13=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee9(definition){var mainResponse,withIncluded;return _regenerator2.default.wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,this.chain.request(definition);case 2:if(mainResponse=_context9.sent,definition.includes){_context9.next=5;break}return _context9.abrupt("return",mainResponse);case 5:return _context9.next=7,this.fetchRelationships(mainResponse,this.getIncludesRelationships(definition));case 7:return withIncluded=_context9.sent,_context9.abrupt("return",withIncluded);case 9:case"end":return _context9.stop()}},_callee9,this)})),function(_x21){return _ref13.apply(this,arguments)})},{key:"fetchRelationships",value:(_ref14=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee10(response,relationshipsByName){var isSingleDoc,responseDocs,queryDefToDocIdAndRel,documents,definitions,optimizedDefinitions,responses,uniqueDocuments,included,relationshipsByDocId,_iteratorNormalCompletion5,_didIteratorError5,_iteratorError5,_iterator5,_step5,_ref15,_ref16,def,resp,docIdAndRel,_docIdAndRel,docId,relName,_this2=this;return _regenerator2.default.wrap(function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if((isSingleDoc=!Array.isArray(response.data))||0!==response.data.length){_context10.next=3;break}return _context10.abrupt("return",response);case 3:return responseDocs=isSingleDoc?[response.data]:response.data,queryDefToDocIdAndRel=new _map2.default,documents=[],definitions=[],responseDocs.forEach(function(doc){return(0,_forEach2.default)(relationshipsByName,function(relationship,relName){var queryDef=relationship.type.query(doc,_this2,relationship),docId=doc._id;queryDefToDocIdAndRel.set(queryDef,[docId,relName]),queryDef instanceof _dsl.QueryDefinition?definitions.push(queryDef):documents.push(queryDef)})}),optimizedDefinitions=(0,_optimize2.default)(definitions),_context10.next=11,_promise2.default.all(optimizedDefinitions.map(function(req){return _this2.chain.request(req)}));case 11:for(responses=_context10.sent,uniqueDocuments=(0,_uniqBy2.default)((0,_flatten2.default)(documents),"_id"),included=(0,_flatten2.default)(responses.map(function(r){return r.included||r.data})).concat(uniqueDocuments).filter(Boolean),relationshipsByDocId={},_iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0,_context10.prev=18,_iterator5=(0,_getIterator3.default)((0,_zip2.default)(optimizedDefinitions,responses));!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0)_ref15=_step5.value,_ref16=(0,_slicedToArray3.default)(_ref15,2),def=_ref16[0],resp=_ref16[1],(docIdAndRel=queryDefToDocIdAndRel.get(def))&&(_docIdAndRel=(0,_slicedToArray3.default)(docIdAndRel,2),docId=_docIdAndRel[0],relName=_docIdAndRel[1],relationshipsByDocId[docId]=relationshipsByDocId[docId]||{},relationshipsByDocId[docId][relName]=(0,_helpers.responseToRelationship)(resp));_context10.next=26;break;case 22:_context10.prev=22,_context10.t0=_context10.catch(18),_didIteratorError5=!0,_iteratorError5=_context10.t0;case 26:_context10.prev=26,_context10.prev=27,!_iteratorNormalCompletion5&&_iterator5.return&&_iterator5.return();case 29:if(_context10.prev=29,!_didIteratorError5){_context10.next=32;break}throw _iteratorError5;case 32:return _context10.finish(29);case 33:return _context10.finish(26);case 34:return _context10.abrupt("return",(0,_extends3.default)({},(0,_helpers.attachRelationships)(response,relationshipsByDocId),{included:included}));case 35:case"end":return _context10.stop()}},_callee10,this,[[18,22,26,34],[27,,29,33]])})),function(_x22,_x23){return _ref14.apply(this,arguments)})},{key:"requestMutation",value:(_ref17=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee11(definition){var _definition,first,rest,firstResponse,_this3=this;return _regenerator2.default.wrap(function(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(!Array.isArray(definition)){_context11.next=8;break}return _definition=(0,_toArray3.default)(definition),first=_definition[0],rest=_definition.slice(1),_context11.next=4,this.requestMutation(first);case 4:return firstResponse=_context11.sent,_context11.next=7,_promise2.default.all(rest.map(function(def){return"function"==typeof def?_this3.requestMutation(def(firstResponse)):_this3.requestMutation(def)}));case 7:return _context11.abrupt("return",firstResponse);case 8:return _context11.abrupt("return",this.chain.request(definition));case 9:case"end":return _context11.stop()}},_callee11,this)})),function(_x24){return _ref17.apply(this,arguments)})},{key:"getIncludesRelationships",value:function(queryDefinition){var _this4=this,includes=queryDefinition.includes,doctype=queryDefinition.doctype;return includes?(0,_fromPairs2.default)(includes.map(function(relName){return[relName,_this4.schema.getRelationship(doctype,relName)]})):{}}},{key:"hydrateDocuments",value:function(doctype,documents){var _this5=this;if(!1===this.options.autoHydrate)return documents;var schema=this.schema.getDoctypeSchema(doctype);return schema.relationships?documents.map(function(doc){return _this5.hydrateDocument(doc,schema)}):documents}},{key:"hydrateDocument",value:function(document,schema){return document?(schema=schema||this.schema.getDoctypeSchema(document._type),(0,_extends3.default)({},document,this.hydrateRelationships(document,schema.relationships))):document}},{key:"hydrateRelationships",value:function(document,schemaRelationships){var methods=this.getRelationshipStoreAccessors();return(0,_mapValues2.default)(schemaRelationships,function(assoc,name){return(0,_associations.create)(document,assoc,methods)})}},{key:"makeNewDocument",value:function(doctype){var obj={_type:doctype};return this.hydrateDocument(obj)}},{key:"getAssociation",value:function(document,associationName){return(0,_associations.create)(document,this.schema.getAssociation(document._type,associationName),this.getRelationshipStoreAccessors())}},{key:"getRelationshipStoreAccessors",value:function(){var _this6=this;return this.storeAccesors||(this.storeAccessors={get:this.getDocumentFromState.bind(this),save:function(document,opts){return _this6.save.call(_this6,document,opts)},dispatch:this.dispatch.bind(this),query:function(def,opts){return _this6.query.call(_this6,def,opts)},mutate:function(def,opts){return _this6.mutate.call(_this6,def,opts)}}),this.storeAccessors}},{key:"getCollectionFromState",value:function(type){try{return(0,_store.getCollectionFromState)(this.store.getState(),type)}catch(e){return console.warn("Could not getCollectionFromState",type,e.message),null}}},{key:"getDocumentFromState",value:function(type,id){try{return(0,_store.getDocumentFromState)(this.store.getState(),type,id)}catch(e){return console.warn("Could not getDocumentFromState",type,id,e.message),null}}},{key:"getQueryFromState",value:function(id){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},hydrated=options.hydrated||!1;try{var queryResults=(0,_store.getQueryFromState)(this.store.getState(),id),doctype=queryResults.definition&&queryResults.definition.doctype,data=hydrated&&doctype?this.hydrateDocuments(doctype,queryResults.data):queryResults.data;return(0,_extends3.default)({},queryResults,{data:data})}catch(e){return console.warn("Could not getQueryFromState",id,e.message),null}}},{key:"register",value:function(cozyUrl){return this.getStackClient().setUri(cozyUrl),this.startOAuthFlow(_mobile.authenticateWithCordova)}},{key:"startOAuthFlow",value:(_ref18=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee12(openURLCallback){var stackClient;return _regenerator2.default.wrap(function(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return stackClient=this.getStackClient(),_context12.next=3,stackClient.register();case 3:return _context12.abrupt("return",this.authorize(openURLCallback));case 4:case"end":return _context12.stop()}},_callee12,this)})),function(_x26){return _ref18.apply(this,arguments)})},{key:"authorize",value:(_ref19=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee13(openURLCallback){var stackClient,stateCode,url,redirectedURL,code,token;return _regenerator2.default.wrap(function(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return _context13.prev=0,stackClient=this.getStackClient(),stateCode=stackClient.generateStateCode(),url=stackClient.getAuthCodeURL(stateCode),_context13.next=6,openURLCallback(url);case 6:return redirectedURL=_context13.sent,code=stackClient.getAccessCodeFromURL(redirectedURL,stateCode),_context13.next=10,stackClient.fetchAccessToken(code);case 10:return token=_context13.sent,stackClient.setToken(token),_context13.abrupt("return",{token:token,infos:stackClient.oauthOptions,client:stackClient.oauthOptions});case 15:throw _context13.prev=15,_context13.t0=_context13.catch(0),_context13.t0.message===_const.REGISTRATION_ABORT&&this.getStackClient().unregister(),_context13.t0;case 19:case"end":return _context13.stop()}},_callee13,this,[[0,15]])})),function(_x27){return _ref19.apply(this,arguments)})},{key:"renewAuthorization",value:function(){return this.authorize(_mobile.authenticateWithCordova)}},{key:"setStore",value:function(store){var _ref20=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref20$force=_ref20.force,force=void 0!==_ref20$force&&_ref20$force;if(void 0===store)throw new Error("Store is undefined");if(this.store&&!force)throw new Error("Client already has a store, it is forbidden to change store.");this.store=store}},{key:"ensureStore",value:function(){this.store||this.setStore((0,_store.createStore)())}},{key:"handleRevocationChange",value:function(state){state?(this.isRevoked=!0,this.emit("revoked")):(this.isRevoked=!1,this.emit("unrevoked"))}},{key:"handleTokenRefresh",value:function(token){this.emit("tokenRefreshed"),this.options.onTokenRefresh&&(deprecatedHandler("Using onTokenRefresh is deprecated, please use events like this: cozyClient.on('tokenUpdated', token => console.log('Token is updated', token)). https://git.io/fj3M3"),this.options.onTokenRefresh(token))}},{key:"createClient",value:function(){this.options.client&&console.warn("CozyClient: Using options.client is deprecated, please use options.stackClient.");var warningForCustomHandlers=void 0===this.options.warningForCustomHandlers||this.options.warningForCustomHandlers,stackClient=this.options.client||this.options.stackClient,handlers={onRevocationChange:this.handleRevocationChange,onTokenRefresh:this.handleTokenRefresh};if(stackClient){this.stackClient=stackClient,stackClient.options||(stackClient.options={});var _iteratorNormalCompletion6=!0,_didIteratorError6=!1,_iteratorError6=void 0;try{for(var _step6,_iterator6=(0,_getIterator3.default)((0,_keys2.default)(handlers));!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=!0){var handlerName=_step6.value;stackClient.options[handlerName]?warningForCustomHandlers&&console.warn("You passed a stackClient with its own "+handlerName+". It is not supported, unexpected things might happen."):stackClient.options[handlerName]=handlers[handlerName]}}catch(err){_didIteratorError6=!0,_iteratorError6=err}finally{try{!_iteratorNormalCompletion6&&_iterator6.return&&_iterator6.return()}finally{if(_didIteratorError6)throw _iteratorError6}}}else{var options=(0,_extends3.default)({},this.options,handlers);this.stackClient=this.options.oauth?new _cozyStackClient.OAuthClient(options):new _cozyStackClient2.default(options)}this.client=new Proxy(this.stackClient,deprecatedHandler("Using cozyClient.client is deprecated, please use cozyClient.stackClient."))}},{key:"getClient",value:function(){return console.warn("CozyClient: getClient() is deprecated, please use getStackClient()."),this.getStackClient()}},{key:"getStackClient",value:function(){return this.stackClient||this.createClient(),this.stackClient}},{key:"reducer",value:function(){return _store2.default}},{key:"dispatch",value:function(action){return this.store.dispatch(action)}},{key:"generateId",value:function(){var id=this.idCounter;return this.idCounter++,id}},{key:"getInstanceOptions",value:function(){return this.instanceOptions}},{key:"loadInstanceOptionsFromDOM",value:function(){var selector=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"[role=application]",root=document.querySelector(selector);this.instanceOptions=(0,_extends3.default)({},root.dataset)}},{key:"setData",value:function(data){var _this7=this;this.ensureStore(),(0,_entries2.default)(data).forEach(function(_ref21){var _ref22=(0,_slicedToArray3.default)(_ref21,2),data=(_ref22[0],_ref22[1]);_this7.dispatch((0,_store.receiveQueryResult)(null,{data:data}))})}}],[{key:"fromOldClient",value:function(oldClient,options){return new CozyClient((0,_extends3.default)({uri:oldClient._url,token:oldClient._token.token},options))}},{key:"fromEnv",value:function(env){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_env=env=env||("undefined"!=typeof process?process.env:{}),COZY_URL=_env.COZY_URL,COZY_CREDENTIALS=_env.COZY_CREDENTIALS,NODE_ENV=_env.NODE_ENV;if(!COZY_URL||!COZY_CREDENTIALS)throw new Error("Env used to instantiate CozyClient must have COZY_URL and COZY_CREDENTIALS");return"development"===NODE_ENV?options.oauth=JSON.parse(COZY_CREDENTIALS):options.token=COZY_CREDENTIALS.trim(),options.uri=COZY_URL.trim(),new CozyClient((0,_extends3.default)({},options))}},{key:"registerHook",value:function(doctype,name,fn){CozyClient.hooks=CozyClient.hooks||{};var hooks=CozyClient.hooks[doctype]=CozyClient.hooks[doctype]||{};hooks[name]=hooks[name]||[],hooks[name].push(fn)}}]),CozyClient}();CozyClient.fetchPolicies=_policies2.default,_microee2.default.mixin(CozyClient),exports.default=CozyClient},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _objectWithoutProperties3=_interopRequireDefault(__webpack_require__(86)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_dsl=__webpack_require__(87);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StackLink=function(_CozyLink){function StackLink(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},client=_ref.client,stackClient=_ref.stackClient;(0,_classCallCheck3.default)(this,StackLink);var _this=(0,_possibleConstructorReturn3.default)(this,(StackLink.__proto__||(0,_getPrototypeOf2.default)(StackLink)).call(this));return client&&console.info("Using options.client is deprecated, prefer options.stackClient"),_this.stackClient=stackClient||client,_this}return(0,_inherits3.default)(StackLink,_CozyLink),(0,_createClass3.default)(StackLink,[{key:"registerClient",value:function(client){this.stackClient=client.stackClient||client.client}},{key:"reset",value:function(){this.stackClient=null}},{key:"request",value:function(operation,result,forward){return operation.mutationType?this.executeMutation(operation,result,forward):this.executeQuery(operation)}},{key:"executeQuery",value:function(query){var doctype=query.doctype,selector=query.selector,id=query.id,ids=query.ids,referenced=query.referenced,options=(0,_objectWithoutProperties3.default)(query,["doctype","selector","id","ids","referenced"]);if(!doctype)throw console.warn("Bad query",query),new Error("No doctype found in a query definition");var collection=this.stackClient.collection(doctype);return id?collection.get(id):ids?collection.getAll(ids):referenced?collection.findReferencedBy(referenced,options):selector||options.sort?collection.find(selector,options):collection.all(options)}},{key:"executeMutation",value:function(mutation,result,forward){var mutationType=mutation.mutationType,props=(0,_objectWithoutProperties3.default)(mutation,["mutationType"]);switch(mutationType){case _dsl.MutationTypes.CREATE_DOCUMENT:return this.stackClient.collection(props.document._type).create(props.document);case _dsl.MutationTypes.UPDATE_DOCUMENT:return this.stackClient.collection(props.document._type).update(props.document);case _dsl.MutationTypes.DELETE_DOCUMENT:return this.stackClient.collection(props.document._type).destroy(props.document);case _dsl.MutationTypes.ADD_REFERENCES_TO:return this.stackClient.collection(props.referencedDocuments[0]._type).addReferencesTo(props.document,props.referencedDocuments);case _dsl.MutationTypes.REMOVE_REFERENCES_TO:return this.stackClient.collection(props.referencedDocuments[0]._type).removeReferencesTo(props.document,props.referencedDocuments);case _dsl.MutationTypes.ADD_REFERENCED_BY:if("io.cozy.files"===props.document._type)return this.stackClient.collection("io.cozy.files").addReferencedBy(props.document,props.referencedDocuments);throw new Error("The document type should be io.cozy.files");case _dsl.MutationTypes.REMOVE_REFERENCED_BY:if("io.cozy.files"===props.document._type)return this.stackClient.collection("io.cozy.files").removeReferencedBy(props.document,props.referencedDocuments);throw new Error("The document type should be io.cozy.files");case _dsl.MutationTypes.UPLOAD_FILE:return this.stackClient.collection("io.cozy.files").upload(props.file,props.dirPath);default:return forward(mutation,result)}}}]),StackLink}(_interopRequireDefault(__webpack_require__(246)).default);exports.default=StackLink},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.dehydrate=void 0;var _slicedToArray3=_interopRequireDefault(__webpack_require__(164)),_entries2=_interopRequireDefault(__webpack_require__(163)),_associations=__webpack_require__(171);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.dehydrate=function(document){return(0,_entries2.default)(document).reduce(function(document,_ref){var _ref2=(0,_slicedToArray3.default)(_ref,2),key=_ref2[0],value=_ref2[1];if(value instanceof _associations.Association){if(!value.dehydrate)throw new Error("Association on key "+key+" should have a dehydrate method");document=value.dehydrate(document)}else document[key]=value;return document},{})}},,function(module,exports){module.exports=function(value){return void 0===value}},,,,function(module,exports,__webpack_require__){var Stack=__webpack_require__(146),arrayEach=__webpack_require__(168),assignValue=__webpack_require__(178),baseAssign=__webpack_require__(433),baseAssignIn=__webpack_require__(589),cloneBuffer=__webpack_require__(306),copyArray=__webpack_require__(138),copySymbols=__webpack_require__(590),copySymbolsIn=__webpack_require__(591),getAllKeys=__webpack_require__(312),getAllKeysIn=__webpack_require__(211),getTag=__webpack_require__(109),initCloneArray=__webpack_require__(592),initCloneByTag=__webpack_require__(593),initCloneObject=__webpack_require__(309),isArray=__webpack_require__(12),isBuffer=__webpack_require__(116),isMap=__webpack_require__(597),isObject=__webpack_require__(26),isSet=__webpack_require__(599),keys=__webpack_require__(69),CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,argsTag="[object Arguments]",funcTag="[object Function]",genTag="[object GeneratorFunction]",objectTag="[object Object]",cloneableTags={};cloneableTags[argsTag]=cloneableTags["[object Array]"]=cloneableTags["[object ArrayBuffer]"]=cloneableTags["[object DataView]"]=cloneableTags["[object Boolean]"]=cloneableTags["[object Date]"]=cloneableTags["[object Float32Array]"]=cloneableTags["[object Float64Array]"]=cloneableTags["[object Int8Array]"]=cloneableTags["[object Int16Array]"]=cloneableTags["[object Int32Array]"]=cloneableTags["[object Map]"]=cloneableTags["[object Number]"]=cloneableTags[objectTag]=cloneableTags["[object RegExp]"]=cloneableTags["[object Set]"]=cloneableTags["[object String]"]=cloneableTags["[object Symbol]"]=cloneableTags["[object Uint8Array]"]=cloneableTags["[object Uint8ClampedArray]"]=cloneableTags["[object Uint16Array]"]=cloneableTags["[object Uint32Array]"]=!0,cloneableTags["[object Error]"]=cloneableTags[funcTag]=cloneableTags["[object WeakMap]"]=!1,module.exports=function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=bitmask&CLONE_DEEP_FLAG,isFlat=bitmask&CLONE_FLAT_FLAG,isFull=bitmask&CLONE_SYMBOLS_FLAG;if(customizer&&(result=object?customizer(value,key,object,stack):customizer(value)),void 0!==result)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=initCloneArray(value),!isDeep)return copyArray(value,result)}else{var tag=getTag(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer(value))return cloneBuffer(value,isDeep);if(tag==objectTag||tag==argsTag||isFunc&&!object){if(result=isFlat||isFunc?{}:initCloneObject(value),!isDeep)return isFlat?copySymbolsIn(value,baseAssignIn(result,value)):copySymbols(value,baseAssign(result,value))}else{if(!cloneableTags[tag])return object?value:{};result=initCloneByTag(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked)return stacked;stack.set(value,result),isSet(value)?value.forEach(function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))}):isMap(value)&&value.forEach(function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))});var keysFunc=isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys,props=isArr?void 0:keysFunc(value);return arrayEach(props||value,function(subValue,key){props&&(subValue=value[key=subValue]),assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}),result}},,,,,function(module,exports,__webpack_require__){var baseFlatten=__webpack_require__(114),map=__webpack_require__(191);module.exports=function(collection,iteratee){return baseFlatten(map(collection,iteratee),1)}},function(module,exports,__webpack_require__){var flow=__webpack_require__(443)();module.exports=flow},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"getPlatform",{enumerable:!0,get:function(){return _platform.getPlatform}}),Object.defineProperty(exports,"isIOSApp",{enumerable:!0,get:function(){return _platform.isIOSApp}}),Object.defineProperty(exports,"isAndroidApp",{enumerable:!0,get:function(){return _platform.isAndroidApp}}),Object.defineProperty(exports,"isWebApp",{enumerable:!0,get:function(){return _platform.isWebApp}}),Object.defineProperty(exports,"isMobileApp",{enumerable:!0,get:function(){return _platform.isMobileApp}}),Object.defineProperty(exports,"isAndroid",{enumerable:!0,get:function(){return _platform.isAndroid}}),Object.defineProperty(exports,"isIOS",{enumerable:!0,get:function(){return _platform.isIOS}}),Object.defineProperty(exports,"isMobile",{enumerable:!0,get:function(){return _platform.isMobile}}),Object.defineProperty(exports,"getDeviceName",{enumerable:!0,get:function(){return _device.getDeviceName}}),Object.defineProperty(exports,"checkApp",{enumerable:!0,get:function(){return _apps.checkApp}}),Object.defineProperty(exports,"startApp",{enumerable:!0,get:function(){return _apps.startApp}}),Object.defineProperty(exports,"hasDevicePlugin",{enumerable:!0,get:function(){return _plugins.hasDevicePlugin}}),Object.defineProperty(exports,"hasInAppBrowserPlugin",{enumerable:!0,get:function(){return _plugins.hasInAppBrowserPlugin}}),Object.defineProperty(exports,"hasSafariPlugin",{enumerable:!0,get:function(){return _plugins.hasSafariPlugin}}),Object.defineProperty(exports,"nativeLinkOpen",{enumerable:!0,get:function(){return _link.nativeLinkOpen}}),Object.defineProperty(exports,"openDeeplinkOrRedirect",{enumerable:!0,get:function(){return _deeplink.openDeeplinkOrRedirect}});var _platform=__webpack_require__(236),_device=__webpack_require__(735),_apps=__webpack_require__(741),_plugins=__webpack_require__(238),_link=__webpack_require__(742),_deeplink=__webpack_require__(743)},function(module,exports,__webpack_require__){var parse=__webpack_require__(36),differenceInCalendarDays=__webpack_require__(261),compareAsc=__webpack_require__(785);module.exports=function(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft),dateRight=parse(dirtyDateRight),sign=compareAsc(dateLeft,dateRight),difference=Math.abs(differenceInCalendarDays(dateLeft,dateRight));return dateLeft.setDate(dateLeft.getDate()-sign*difference),sign*(difference-(compareAsc(dateLeft,dateRight)===-sign))}},function(module,exports,__webpack_require__){var arrayEvery=__webpack_require__(909),overEvery=__webpack_require__(910)(arrayEvery);module.exports=overEvery},,,,,function(module,exports){module.exports=require("string_decoder")},,,function(module,exports){var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;module.exports=function(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=HOT_SPAN-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=HOT_COUNT)return arguments[0]}else count=0;return func.apply(void 0,arguments)}}},function(module,exports,__webpack_require__){var WeakMap=__webpack_require__(301),metaMap=WeakMap&&new WeakMap;module.exports=metaMap},,,function(module,exports,__webpack_require__){var toNumber=__webpack_require__(506),INFINITY=1/0,MAX_INTEGER=17976931348623157e292;module.exports=function(value){return value?(value=toNumber(value))===INFINITY||value===-INFINITY?(value<0?-1:1)*MAX_INTEGER:value==value?value:0:0===value?value:0}},function(module,exports){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}},function(module,exports){var FUNC_ERROR_TEXT="Expected a function";module.exports=function(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){var args=arguments;switch(args.length){case 0:return!predicate.call(this);case 1:return!predicate.call(this,args[0]);case 2:return!predicate.call(this,args[0],args[1]);case 3:return!predicate.call(this,args[0],args[1],args[2])}return!predicate.apply(this,args)}}},function(module,exports){module.exports=function(argument){return argument instanceof Date}},function(module,exports,__webpack_require__){var isSymbol=__webpack_require__(91);module.exports=function(array,iteratee,comparator){for(var index=-1,length=array.length;++index<length;){var value=array[index],current=iteratee(value);if(null!=current&&(void 0===computed?current==current&&!isSymbol(current):comparator(current,computed)))var computed=current,result=value}return result}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return runService});var node_fetch__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(274),cozy_client__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(71),cozy_client__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(cozy_client__WEBPACK_IMPORTED_MODULE_1__),doctypes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(43),cozy_doctypes__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(41);global.fetch=node_fetch__WEBPACK_IMPORTED_MODULE_0__.a;var assertEnvVar=function(varName){if(!process.env[varName])throw new Error("".concat(varName," environment variable is not set"))},runService=function(service){assertEnvVar("COZY_URL"),assertEnvVar("COZY_CREDENTIALS");var client=new cozy_client__WEBPACK_IMPORTED_MODULE_1___default.a({uri:process.env.COZY_URL.trim(),schema:doctypes__WEBPACK_IMPORTED_MODULE_2__.g,token:process.env.COZY_CREDENTIALS.trim()});return cozy_doctypes__WEBPACK_IMPORTED_MODULE_3__.Document.registerClient(client),service({client:client}).catch(function(e){console.error(e),process.exit(1)})}},function(module,exports,__webpack_require__){"use strict";const escapeStringRegexp=__webpack_require__(426),ansiStyles=__webpack_require__(455),stdoutColor=__webpack_require__(459).stdout,template=__webpack_require__(461),isSimpleWindowsTerm="win32"===process.platform&&!(process.env.TERM||"").toLowerCase().startsWith("xterm"),levelMapping=["ansi","ansi","ansi256","ansi16m"],skipModels=new Set(["gray"]),styles=Object.create(null);function applyOptions(obj,options){options=options||{};const scLevel=stdoutColor?stdoutColor.level:0;obj.level=void 0===options.level?scLevel:options.level,obj.enabled="enabled"in options?options.enabled:obj.level>0}function Chalk(options){if(!this||!(this instanceof Chalk)||this.template){const chalk={};return applyOptions(chalk,options),chalk.template=function(){const args=[].slice.call(arguments);return chalkTag.apply(null,[chalk.template].concat(args))},Object.setPrototypeOf(chalk,Chalk.prototype),Object.setPrototypeOf(chalk.template,chalk),chalk.template.constructor=Chalk,chalk.template}applyOptions(this,options)}isSimpleWindowsTerm&&(ansiStyles.blue.open="[94m");for(const key of Object.keys(ansiStyles))ansiStyles[key].closeRe=new RegExp(escapeStringRegexp(ansiStyles[key].close),"g"),styles[key]={get(){const codes=ansiStyles[key];return build.call(this,this._styles?this._styles.concat(codes):[codes],this._empty,key)}};styles.visible={get(){return build.call(this,this._styles||[],!0,"visible")}},ansiStyles.color.closeRe=new RegExp(escapeStringRegexp(ansiStyles.color.close),"g");for(const model of Object.keys(ansiStyles.color.ansi))skipModels.has(model)||(styles[model]={get(){const level=this.level;return function(){const open=ansiStyles.color[levelMapping[level]][model].apply(null,arguments),codes={open:open,close:ansiStyles.color.close,closeRe:ansiStyles.color.closeRe};return build.call(this,this._styles?this._styles.concat(codes):[codes],this._empty,model)}}});ansiStyles.bgColor.closeRe=new RegExp(escapeStringRegexp(ansiStyles.bgColor.close),"g");for(const model of Object.keys(ansiStyles.bgColor.ansi)){if(skipModels.has(model))continue;styles["bg"+model[0].toUpperCase()+model.slice(1)]={get(){const level=this.level;return function(){const open=ansiStyles.bgColor[levelMapping[level]][model].apply(null,arguments),codes={open:open,close:ansiStyles.bgColor.close,closeRe:ansiStyles.bgColor.closeRe};return build.call(this,this._styles?this._styles.concat(codes):[codes],this._empty,model)}}}}const proto=Object.defineProperties(()=>{},styles);function build(_styles,_empty,key){const builder=function(){return applyStyle.apply(builder,arguments)};builder._styles=_styles,builder._empty=_empty;const self=this;return Object.defineProperty(builder,"level",{enumerable:!0,get:()=>self.level,set(level){self.level=level}}),Object.defineProperty(builder,"enabled",{enumerable:!0,get:()=>self.enabled,set(enabled){self.enabled=enabled}}),builder.hasGrey=this.hasGrey||"gray"===key||"grey"===key,builder.__proto__=proto,builder}function applyStyle(){const args=arguments,argsLen=args.length;let str=String(arguments[0]);if(0===argsLen)return"";if(argsLen>1)for(let a=1;a<argsLen;a++)str+=" "+args[a];if(!this.enabled||this.level<=0||!str)return this._empty?"":str;const originalDim=ansiStyles.dim.open;isSimpleWindowsTerm&&this.hasGrey&&(ansiStyles.dim.open="");for(const code of this._styles.slice().reverse())str=(str=code.open+str.replace(code.closeRe,code.open)+code.close).replace(/\r?\n/g,`${code.close}$&${code.open}`);return ansiStyles.dim.open=originalDim,str}function chalkTag(chalk,strings){if(!Array.isArray(strings))return[].slice.call(arguments,1).join(" ");const args=[].slice.call(arguments,2),parts=[strings.raw[0]];for(let i=1;i<strings.length;i++)parts.push(String(args[i-1]).replace(/[{}\\]/g,"\\$&")),parts.push(String(strings.raw[i]));return template(chalk,parts.join(""))}Object.defineProperties(Chalk.prototype,styles),module.exports=Chalk(),module.exports.supportsColor=stdoutColor,module.exports.default=module.exports},function(module,exports,__webpack_require__){"use strict";var matchOperatorsRe=/[|\\{}()[\]^$+*?.]/g;module.exports=function(str){if("string"!=typeof str)throw new TypeError("Expected a string");return str.replace(matchOperatorsRe,"\\$&")}},,function(module,exports,__webpack_require__){var LazyWrapper=__webpack_require__(197),getData=__webpack_require__(265),getFuncName=__webpack_require__(389),lodash=__webpack_require__(501);module.exports=function(func){var funcName=getFuncName(func),other=lodash[funcName];if("function"!=typeof other||!(funcName in LazyWrapper.prototype))return!1;if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}},function(module,exports){module.exports=function(map){var index=-1,result=Array(map.size);return map.forEach(function(value,key){result[++index]=[key,value]}),result}},function(module,exports,__webpack_require__){var memoizeCapped=__webpack_require__(549),rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}),result});module.exports=stringToPath},function(module,exports,__webpack_require__){"use strict";var iconvLite=__webpack_require__(432),Iconv=__webpack_require__(577);function convertIconvLite(str,to,from){return"UTF-8"===to?iconvLite.decode(str,from):"UTF-8"===from?iconvLite.encode(str,to):iconvLite.encode(iconvLite.decode(str,from),to)}function checkEncoding(name){return(name||"").toString().trim().replace(/^latin[\-_]?(\d+)$/i,"ISO-8859-$1").replace(/^win(?:dows)?[\-_]?(\d+)$/i,"WINDOWS-$1").replace(/^utf[\-_]?(\d+)$/i,"UTF-$1").replace(/^ks_c_5601\-1987$/i,"CP949").replace(/^us[\-_]?ascii$/i,"ASCII").toUpperCase()}module.exports.convert=function(str,to,from,useLite){var result;from=checkEncoding(from||"UTF-8"),to=checkEncoding(to||"UTF-8"),str=str||"","UTF-8"!==from&&"string"==typeof str&&(str=new Buffer(str,"binary"));if(from===to)result="string"==typeof str?new Buffer(str):str;else if(Iconv&&!useLite)try{result=function(str,to,from){var response,iconv;return iconv=new Iconv(from,to+"//TRANSLIT//IGNORE"),(response=iconv.convert(str)).slice(0,response.length)}(str,to,from)}catch(E){console.error(E);try{result=convertIconvLite(str,to,from)}catch(E){console.error(E),result=str}}else try{result=convertIconvLite(str,to,from)}catch(E){console.error(E),result=str}"string"==typeof result&&(result=new Buffer(result,"utf-8"));return result}},function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(15).Buffer,bomHandling=__webpack_require__(560),iconv=module.exports;iconv.encodings=null,iconv.defaultCharUnicode="",iconv.defaultCharSingleByte="?",iconv.encode=function(str,encoding,options){str=""+(str||"");var encoder=iconv.getEncoder(encoding,options),res=encoder.write(str),trail=encoder.end();return trail&&trail.length>0?Buffer.concat([res,trail]):res},iconv.decode=function(buf,encoding,options){"string"==typeof buf&&(iconv.skipDecodeWarning||(console.error("Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding"),iconv.skipDecodeWarning=!0),buf=Buffer.from(""+(buf||""),"binary"));var decoder=iconv.getDecoder(encoding,options),res=decoder.write(buf),trail=decoder.end();return trail?res+trail:res},iconv.encodingExists=function(enc){try{return iconv.getCodec(enc),!0}catch(e){return!1}},iconv.toEncoding=iconv.encode,iconv.fromEncoding=iconv.decode,iconv._codecDataCache={},iconv.getCodec=function(encoding){iconv.encodings||(iconv.encodings=__webpack_require__(561));for(var enc=iconv._canonicalizeEncoding(encoding),codecOptions={};;){var codec=iconv._codecDataCache[enc];if(codec)return codec;var codecDef=iconv.encodings[enc];switch(typeof codecDef){case"string":enc=codecDef;break;case"object":for(var key in codecDef)codecOptions[key]=codecDef[key];codecOptions.encodingName||(codecOptions.encodingName=enc),enc=codecDef.type;break;case"function":return codecOptions.encodingName||(codecOptions.encodingName=enc),codec=new codecDef(codecOptions,iconv),iconv._codecDataCache[codecOptions.encodingName]=codec,codec;default:throw new Error("Encoding not recognized: '"+encoding+"' (searched as: '"+enc+"')")}}},iconv._canonicalizeEncoding=function(encoding){return(""+encoding).toLowerCase().replace(/:\d{4}$|[^0-9a-z]/g,"")},iconv.getEncoder=function(encoding,options){var codec=iconv.getCodec(encoding),encoder=new codec.encoder(options,codec);return codec.bomAware&&options&&options.addBOM&&(encoder=new bomHandling.PrependBOM(encoder,options)),encoder},iconv.getDecoder=function(encoding,options){var codec=iconv.getCodec(encoding),decoder=new codec.decoder(options,codec);return!codec.bomAware||options&&!1===options.stripBOM||(decoder=new bomHandling.StripBOM(decoder,options)),decoder};var nodeVer="undefined"!=typeof process&&process.versions&&process.versions.node;if(nodeVer){var nodeVerArr=nodeVer.split(".").map(Number);(nodeVerArr[0]>0||nodeVerArr[1]>=10)&&__webpack_require__(575)(iconv),__webpack_require__(576)(iconv)}},function(module,exports,__webpack_require__){var copyObject=__webpack_require__(78),keys=__webpack_require__(69);module.exports=function(object,source){return object&&copyObject(source,keys(source),object)}},function(module,exports,__webpack_require__){var baseIteratee=__webpack_require__(18),negate=__webpack_require__(421),pickBy=__webpack_require__(136);module.exports=function(object,predicate){return pickBy(object,negate(baseIteratee(predicate)))}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(){"use strict";var EventTarget=function(){this._listeners={}};EventTarget.prototype.addEventListener=function(type,listener){this._listeners[type]=this._listeners[type]||[],this._listeners[type].indexOf(listener)<0&&this._listeners[type].push(listener)},EventTarget.prototype.removeEventListener=function(type,listener){if(this._listeners[type]){var p=this._listeners[type].indexOf(listener);p>=0&&this._listeners[type].splice(p,1)}},EventTarget.prototype.dispatchEvent=function(evt){if(this._listeners[evt.type]&&this._listeners[evt.type].length)for(var listeners=this._listeners[evt.type].slice(),i=0,l=listeners.length;i<l;++i)listeners[i].call(this,evt)};var promiseToIterator=function(promise){var called=!1;return{next:function(){return called?{done:!0}:(called=!0,{value:promise})}}},PromisePoolEvent=function(target,type,data){this.target=target,this.type=type,this.data=data},PromisePool=function(source,concurrency,options){if(EventTarget.call(this),"number"!=typeof concurrency||Math.floor(concurrency)!==concurrency||concurrency<1)throw new Error("Invalid concurrency");this._concurrency=concurrency,this._options=options||{},this._options.promise=this._options.promise||Promise,this._iterator=function(obj,Promise){var func,type=typeof obj;if("object"===type){if("function"==typeof obj.next)return obj;if("function"==typeof obj.then)return promiseToIterator(obj)}return"function"===type?"function"==typeof(func=obj).constructor&&"GeneratorFunction"===func.constructor.name?obj():function(func){return{next:function(){var promise=func();return promise?{value:promise}:{done:!0}}}}(obj):promiseToIterator(Promise.resolve(obj))}(source,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return(PromisePool.prototype=new EventTarget).constructor=PromisePool,PromisePool.prototype.concurrency=function(value){return void 0!==value&&(this._concurrency=value,this.active()&&this._proceed()),this._concurrency},PromisePool.prototype.size=function(){return this._size},PromisePool.prototype.active=function(){return!!this._promise},PromisePool.prototype.promise=function(){return this._promise},PromisePool.prototype.start=function(){var that=this,Promise=this._options.promise;return this._promise=new Promise(function(resolve,reject){that._callbacks={reject:reject,resolve:resolve},that._proceed()}),this._promise},PromisePool.prototype._fireEvent=function(type,data){this.dispatchEvent(new PromisePoolEvent(this,type,data))},PromisePool.prototype._settle=function(error){error?this._callbacks.reject(error):this._callbacks.resolve(),this._promise=null,this._callbacks=null},PromisePool.prototype._onPooledPromiseFulfilled=function(promise,result){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:promise,result:result}),this._proceed())},PromisePool.prototype._onPooledPromiseRejected=function(promise,error){this._size--,this.active()&&(this._fireEvent("rejected",{promise:promise,error:error}),this._settle(error||new Error("Unknown error")))},PromisePool.prototype._trackPromise=function(promise){var that=this;promise.then(function(result){that._onPooledPromiseFulfilled(promise,result)},function(error){that._onPooledPromiseRejected(promise,error)}).catch(function(err){that._settle(new Error("Promise processing failed: "+err))})},PromisePool.prototype._proceed=function(){if(!this._done){for(var result={done:!1};this._size<this._concurrency&&!(result=this._iterator.next()).done;)this._size++,this._trackPromise(result.value);this._done=null===result||!!result.done}this._done&&0===this._size&&this._settle()},PromisePool.PromisePoolEvent=PromisePoolEvent,PromisePool.PromisePool=PromisePool,PromisePool})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(module,exports,__webpack_require__){var parse=__webpack_require__(36);module.exports=function(dirtyDate,dirtyDateToCompare){var date=parse(dirtyDate),dateToCompare=parse(dirtyDateToCompare);return date.getTime()>dateToCompare.getTime()}},,,,,,,function(module,exports,__webpack_require__){var LodashWrapper=__webpack_require__(245),flatRest=__webpack_require__(170),getData=__webpack_require__(265),getFuncName=__webpack_require__(389),isArray=__webpack_require__(12),isLaziable=__webpack_require__(428),FUNC_ERROR_TEXT="Expected a function",WRAP_CURRY_FLAG=8,WRAP_PARTIAL_FLAG=32,WRAP_ARY_FLAG=128,WRAP_REARG_FLAG=256;module.exports=function(fromRight){return flatRest(function(funcs){var length=funcs.length,index=length,prereq=LodashWrapper.prototype.thru;for(fromRight&&funcs.reverse();index--;){var func=funcs[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(prereq&&!wrapper&&"wrapper"==getFuncName(func))var wrapper=new LodashWrapper([],!0)}for(index=wrapper?index:length;++index<length;){func=funcs[index];var funcName=getFuncName(func),data="wrapper"==funcName?getData(func):void 0;wrapper=data&&isLaziable(data[0])&&data[1]==(WRAP_ARY_FLAG|WRAP_CURRY_FLAG|WRAP_PARTIAL_FLAG|WRAP_REARG_FLAG)&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value))return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}})}},,,,function(module,exports,__webpack_require__){var baseDifference=__webpack_require__(694),baseFlatten=__webpack_require__(114),baseRest=__webpack_require__(54),isArrayLikeObject=__webpack_require__(118),difference=baseRest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0)):[]});module.exports=difference},function(module,exports){module.exports=function(array){return array&&array.length?array[0]:void 0}},,,,,function(module,exports){module.exports=function(value,other){return value>other}},function(module,exports){!function(global){"use strict";var undefined,Op=Object.prototype,hasOwn=Op.hasOwnProperty,$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag",inModule="object"==typeof module,runtime=global.regeneratorRuntime;if(runtime)inModule&&(module.exports=runtime);else{(runtime=global.regeneratorRuntime=inModule?module.exports:{}).wrap=wrap;var GenStateSuspendedStart="suspendedStart",GenStateSuspendedYield="suspendedYield",GenStateExecuting="executing",GenStateCompleted="completed",ContinueSentinel={},IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this};var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype,GeneratorFunctionPrototype.constructor=GeneratorFunction,GeneratorFunctionPrototype[toStringTagSymbol]=GeneratorFunction.displayName="GeneratorFunction",runtime.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},runtime.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,toStringTagSymbol in genFun||(genFun[toStringTagSymbol]="GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},runtime.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this},runtime.AsyncIterator=AsyncIterator,runtime.async=function(innerFn,outerFn,self,tryLocsList){var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList));return runtime.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})},defineIteratorMethods(Gp),Gp[toStringTagSymbol]="Generator",Gp[iteratorSymbol]=function(){return this},Gp.toString=function(){return"[object Generator]"},runtime.keys=function(object){var keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},runtime.values=values,Context.prototype={constructor:Context,reset:function(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined)},stop:function(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=undefined),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=undefined),ContinueSentinel}}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return generator._invoke=function(innerFn,self,context){var state=GenStateSuspendedStart;return function(method,arg){if(state===GenStateExecuting)throw new Error("Generator is already running");if(state===GenStateCompleted){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if(state===GenStateSuspendedStart)throw state=GenStateCompleted,context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?GenStateCompleted:GenStateSuspendedYield,record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state=GenStateCompleted,context.method="throw",context.arg=record.arg)}}}(innerFn,self,context),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){prototype[method]=function(arg){return this._invoke(method,arg)}})}function AsyncIterator(generator){var previousPromise;this._invoke=function(method,arg){function callInvokeWithMethodAndArg(){return new Promise(function(resolve,reject){!function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==typeof value&&hasOwn.call(value,"__await")?Promise.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)}):Promise.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result)},function(error){return invoke("throw",error,resolve,reject)})}reject(record.arg)}(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(method===undefined){if(context.delegate=null,"throw"===context.method){if(delegate.iterator.return&&(context.method="return",context.arg=undefined,maybeInvokeDelegate(delegate,context),"throw"===context.method))return ContinueSentinel;context.method="throw",context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=undefined,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:undefined,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(module,exports,__webpack_require__){"use strict";(function(module){const colorConvert=__webpack_require__(456),wrapAnsi16=(fn,offset)=>(function(){const code=fn.apply(colorConvert,arguments);return`[${code+offset}m`}),wrapAnsi256=(fn,offset)=>(function(){const code=fn.apply(colorConvert,arguments);return`[${38+offset};5;${code}m`}),wrapAnsi16m=(fn,offset)=>(function(){const rgb=fn.apply(colorConvert,arguments);return`[${38+offset};2;${rgb[0]};${rgb[1]};${rgb[2]}m`});Object.defineProperty(module,"exports",{enumerable:!0,get:function(){const codes=new Map,styles={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};styles.color.grey=styles.color.gray;for(const groupName of Object.keys(styles)){const group=styles[groupName];for(const styleName of Object.keys(group)){const style=group[styleName];styles[styleName]={open:`[${style[0]}m`,close:`[${style[1]}m`},group[styleName]=styles[styleName],codes.set(style[0],style[1])}Object.defineProperty(styles,groupName,{value:group,enumerable:!1}),Object.defineProperty(styles,"codes",{value:codes,enumerable:!1})}const ansi2ansi=n=>n,rgb2rgb=(r,g,b)=>[r,g,b];styles.color.close="[39m",styles.bgColor.close="[49m",styles.color.ansi={ansi:wrapAnsi16(ansi2ansi,0)},styles.color.ansi256={ansi256:wrapAnsi256(ansi2ansi,0)},styles.color.ansi16m={rgb:wrapAnsi16m(rgb2rgb,0)},styles.bgColor.ansi={ansi:wrapAnsi16(ansi2ansi,10)},styles.bgColor.ansi256={ansi256:wrapAnsi256(ansi2ansi,10)},styles.bgColor.ansi16m={rgb:wrapAnsi16m(rgb2rgb,10)};for(let key of Object.keys(colorConvert)){if("object"!=typeof colorConvert[key])continue;const suite=colorConvert[key];"ansi16"===key&&(key="ansi"),"ansi16"in suite&&(styles.color.ansi[key]=wrapAnsi16(suite.ansi16,0),styles.bgColor.ansi[key]=wrapAnsi16(suite.ansi16,10)),"ansi256"in suite&&(styles.color.ansi256[key]=wrapAnsi256(suite.ansi256,0),styles.bgColor.ansi256[key]=wrapAnsi256(suite.ansi256,10)),"rgb"in suite&&(styles.color.ansi16m[key]=wrapAnsi16m(suite.rgb,0),styles.bgColor.ansi16m[key]=wrapAnsi16m(suite.rgb,10))}return styles}})}).call(this,__webpack_require__(59)(module))},function(module,exports,__webpack_require__){var conversions=__webpack_require__(278),route=__webpack_require__(458),convert={};Object.keys(conversions).forEach(function(fromModel){convert[fromModel]={},Object.defineProperty(convert[fromModel],"channels",{value:conversions[fromModel].channels}),Object.defineProperty(convert[fromModel],"labels",{value:conversions[fromModel].labels});var routes=route(fromModel);Object.keys(routes).forEach(function(toModel){var fn=routes[toModel];convert[fromModel][toModel]=function(fn){var wrappedFn=function(args){if(null==args)return args;arguments.length>1&&(args=Array.prototype.slice.call(arguments));var result=fn(args);if("object"==typeof result)for(var len=result.length,i=0;i<len;i++)result[i]=Math.round(result[i]);return result};return"conversion"in fn&&(wrappedFn.conversion=fn.conversion),wrappedFn}(fn),convert[fromModel][toModel].raw=function(fn){var wrappedFn=function(args){return null==args?args:(arguments.length>1&&(args=Array.prototype.slice.call(arguments)),fn(args))};return"conversion"in fn&&(wrappedFn.conversion=fn.conversion),wrappedFn}(fn)})}),module.exports=convert},function(module,exports,__webpack_require__){"use strict";module.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(module,exports,__webpack_require__){var conversions=__webpack_require__(278);function deriveBFS(fromModel){var graph=function(){for(var graph={},models=Object.keys(conversions),len=models.length,i=0;i<len;i++)graph[models[i]]={distance:-1,parent:null};return graph}(),queue=[fromModel];for(graph[fromModel].distance=0;queue.length;)for(var current=queue.pop(),adjacents=Object.keys(conversions[current]),len=adjacents.length,i=0;i<len;i++){var adjacent=adjacents[i],node=graph[adjacent];-1===node.distance&&(node.distance=graph[current].distance+1,node.parent=current,queue.unshift(adjacent))}return graph}function link(from,to){return function(args){return to(from(args))}}function wrapConversion(toModel,graph){for(var path=[graph[toModel].parent,toModel],fn=conversions[graph[toModel].parent][toModel],cur=graph[toModel].parent;graph[cur].parent;)path.unshift(graph[cur].parent),fn=link(conversions[graph[cur].parent][cur],fn),cur=graph[cur].parent;return fn.conversion=path,fn}module.exports=function(fromModel){for(var graph=deriveBFS(fromModel),conversion={},models=Object.keys(graph),len=models.length,i=0;i<len;i++){var toModel=models[i];null!==graph[toModel].parent&&(conversion[toModel]=wrapConversion(toModel,graph))}return conversion}},function(module,exports,__webpack_require__){"use strict";const os=__webpack_require__(279),hasFlag=__webpack_require__(460),env=process.env;let forceColor;function getSupportLevel(stream){return function(level){return 0!==level&&{level:level,hasBasic:!0,has256:level>=2,has16m:level>=3}}(function(stream){if(!1===forceColor)return 0;if(hasFlag("color=16m")||hasFlag("color=full")||hasFlag("color=truecolor"))return 3;if(hasFlag("color=256"))return 2;if(stream&&!stream.isTTY&&!0!==forceColor)return 0;const min=forceColor?1:0;if("win32"===process.platform){const osRelease=os.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(osRelease[0])>=10&&Number(osRelease[2])>=10586?Number(osRelease[2])>=14931?3:2:1}if("CI"in env)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(sign=>sign in env)||"codeship"===env.CI_NAME?1:min;if("TEAMCITY_VERSION"in env)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(env.TEAMCITY_VERSION)?1:0;if("truecolor"===env.COLORTERM)return 3;if("TERM_PROGRAM"in env){const version=parseInt((env.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(env.TERM_PROGRAM){case"iTerm.app":return version>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(env.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(env.TERM)?1:"COLORTERM"in env?1:(env.TERM,min)}(stream))}hasFlag("no-color")||hasFlag("no-colors")||hasFlag("color=false")?forceColor=!1:(hasFlag("color")||hasFlag("colors")||hasFlag("color=true")||hasFlag("color=always"))&&(forceColor=!0),"FORCE_COLOR"in env&&(forceColor=0===env.FORCE_COLOR.length||0!==parseInt(env.FORCE_COLOR,10)),module.exports={supportsColor:getSupportLevel,stdout:getSupportLevel(process.stdout),stderr:getSupportLevel(process.stderr)}},function(module,exports,__webpack_require__){"use strict";module.exports=(flag,argv)=>{argv=argv||process.argv;const prefix=flag.startsWith("-")?"":1===flag.length?"-":"--",pos=argv.indexOf(prefix+flag),terminatorPos=argv.indexOf("--");return-1!==pos&&(-1===terminatorPos||pos<terminatorPos)}},function(module,exports,__webpack_require__){"use strict";const TEMPLATE_REGEX=/(?:\\(u[a-f\d]{4}|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi,STYLE_REGEX=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g,STRING_REGEX=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/,ESCAPE_REGEX=/\\(u[a-f\d]{4}|x[a-f\d]{2}|.)|([^\\])/gi,ESCAPES=new Map([["n","\n"],["r","\r"],["t","\t"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e",""],["a",""]]);function unescape(c){return"u"===c[0]&&5===c.length||"x"===c[0]&&3===c.length?String.fromCharCode(parseInt(c.slice(1),16)):ESCAPES.get(c)||c}function parseArguments(name,args){const results=[],chunks=args.trim().split(/\s*,\s*/g);let matches;for(const chunk of chunks)if(isNaN(chunk)){if(!(matches=chunk.match(STRING_REGEX)))throw new Error(`Invalid Chalk template style argument: ${chunk} (in style '${name}')`);results.push(matches[2].replace(ESCAPE_REGEX,(m,escape,chr)=>escape?unescape(escape):chr))}else results.push(Number(chunk));return results}function parseStyle(style){STYLE_REGEX.lastIndex=0;const results=[];let matches;for(;null!==(matches=STYLE_REGEX.exec(style));){const name=matches[1];if(matches[2]){const args=parseArguments(name,matches[2]);results.push([name].concat(args))}else results.push([name])}return results}function buildStyle(chalk,styles){const enabled={};for(const layer of styles)for(const style of layer.styles)enabled[style[0]]=layer.inverse?null:style.slice(1);let current=chalk;for(const styleName of Object.keys(enabled))if(Array.isArray(enabled[styleName])){if(!(styleName in current))throw new Error(`Unknown Chalk style: ${styleName}`);current=enabled[styleName].length>0?current[styleName].apply(current,enabled[styleName]):current[styleName]}return current}module.exports=(chalk,tmp)=>{const styles=[],chunks=[];let chunk=[];if(tmp.replace(TEMPLATE_REGEX,(m,escapeChar,inverse,style,close,chr)=>{if(escapeChar)chunk.push(unescape(escapeChar));else if(style){const str=chunk.join("");chunk=[],chunks.push(0===styles.length?str:buildStyle(chalk,styles)(str)),styles.push({inverse:inverse,styles:parseStyle(style)})}else if(close){if(0===styles.length)throw new Error("Found extraneous } in Chalk template literal");chunks.push(buildStyle(chalk,styles)(chunk.join(""))),chunk=[],styles.pop()}else chunk.push(chr)}),chunks.push(chunk.join("")),styles.length>0){const errMsg=`Chalk template literal is missing ${styles.length} closing bracket${1===styles.length?"":"s"} (\`}\`)`;throw new Error(errMsg)}return chunks.join("")}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(97),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=Symbol?Symbol.toStringTag:void 0;module.exports=function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}},function(module,exports){var nativeObjectToString=Object.prototype.toString;module.exports=function(value){return nativeObjectToString.call(value)}},,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__(290),formats=__webpack_require__(291),has=Object.prototype.hasOwnProperty,arrayPrefixGenerators={brackets:function(prefix){return prefix+"[]"},comma:"comma",indices:function(prefix,key){return prefix+"["+key+"]"},repeat:function(prefix){return prefix}},isArray=Array.isArray,push=Array.prototype.push,pushToArray=function(arr,valueOrArray){push.apply(arr,isArray(valueOrArray)?valueOrArray:[valueOrArray])},toISO=Date.prototype.toISOString,defaults={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:utils.encode,encodeValuesOnly:!1,formatter:formats.formatters[formats.default],indices:!1,serializeDate:function(date){return toISO.call(date)},skipNulls:!1,strictNullHandling:!1},stringify=function stringify(object,prefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly,charset){var obj=object;if("function"==typeof filter?obj=filter(prefix,obj):obj instanceof Date?obj=serializeDate(obj):"comma"===generateArrayPrefix&&isArray(obj)&&(obj=obj.join(",")),null===obj){if(strictNullHandling)return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder,charset):prefix;obj=""}if("string"==typeof obj||"number"==typeof obj||"boolean"==typeof obj||utils.isBuffer(obj))return encoder?[formatter(encodeValuesOnly?prefix:encoder(prefix,defaults.encoder,charset))+"="+formatter(encoder(obj,defaults.encoder,charset))]:[formatter(prefix)+"="+formatter(String(obj))];var objKeys,values=[];if(void 0===obj)return values;if(isArray(filter))objKeys=filter;else{var keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}for(var i=0;i<objKeys.length;++i){var key=objKeys[i];skipNulls&&null===obj[key]||(isArray(obj)?pushToArray(values,stringify(obj[key],"function"==typeof generateArrayPrefix?generateArrayPrefix(prefix,key):prefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly,charset)):pushToArray(values,stringify(obj[key],prefix+(allowDots?"."+key:"["+key+"]"),generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly,charset)))}return values};module.exports=function(object,opts){var objKeys,obj=object,options=function(opts){if(!opts)return defaults;if(null!==opts.encoder&&void 0!==opts.encoder&&"function"!=typeof opts.encoder)throw new TypeError("Encoder has to be a function.");var charset=opts.charset||defaults.charset;if(void 0!==opts.charset&&"utf-8"!==opts.charset&&"iso-8859-1"!==opts.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var format=formats.default;if(void 0!==opts.format){if(!has.call(formats.formatters,opts.format))throw new TypeError("Unknown format option provided.");format=opts.format}var formatter=formats.formatters[format],filter=defaults.filter;return("function"==typeof opts.filter||isArray(opts.filter))&&(filter=opts.filter),{addQueryPrefix:"boolean"==typeof opts.addQueryPrefix?opts.addQueryPrefix:defaults.addQueryPrefix,allowDots:void 0===opts.allowDots?defaults.allowDots:!!opts.allowDots,charset:charset,charsetSentinel:"boolean"==typeof opts.charsetSentinel?opts.charsetSentinel:defaults.charsetSentinel,delimiter:void 0===opts.delimiter?defaults.delimiter:opts.delimiter,encode:"boolean"==typeof opts.encode?opts.encode:defaults.encode,encoder:"function"==typeof opts.encoder?opts.encoder:defaults.encoder,encodeValuesOnly:"boolean"==typeof opts.encodeValuesOnly?opts.encodeValuesOnly:defaults.encodeValuesOnly,filter:filter,formatter:formatter,serializeDate:"function"==typeof opts.serializeDate?opts.serializeDate:defaults.serializeDate,skipNulls:"boolean"==typeof opts.skipNulls?opts.skipNulls:defaults.skipNulls,sort:"function"==typeof opts.sort?opts.sort:null,strictNullHandling:"boolean"==typeof opts.strictNullHandling?opts.strictNullHandling:defaults.strictNullHandling}}(opts);"function"==typeof options.filter?obj=(0,options.filter)("",obj):isArray(options.filter)&&(objKeys=options.filter);var arrayFormat,keys=[];if("object"!=typeof obj||null===obj)return"";arrayFormat=opts&&opts.arrayFormat in arrayPrefixGenerators?opts.arrayFormat:opts&&"indices"in opts?opts.indices?"indices":"repeat":"indices";var generateArrayPrefix=arrayPrefixGenerators[arrayFormat];objKeys||(objKeys=Object.keys(obj)),options.sort&&objKeys.sort(options.sort);for(var i=0;i<objKeys.length;++i){var key=objKeys[i];options.skipNulls&&null===obj[key]||pushToArray(keys,stringify(obj[key],key,generateArrayPrefix,options.strictNullHandling,options.skipNulls,options.encode?options.encoder:null,options.filter,options.sort,options.allowDots,options.serializeDate,options.formatter,options.encodeValuesOnly,options.charset))}var joined=keys.join(options.delimiter),prefix=!0===options.addQueryPrefix?"?":"";return options.charsetSentinel&&("iso-8859-1"===options.charset?prefix+="utf8=%26%2310003%3B&":prefix+="utf8=%E2%9C%93&"),joined.length>0?prefix+joined:""}},function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__(290),has=Object.prototype.hasOwnProperty,defaults={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:utils.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},interpretNumericEntities=function(str){return str.replace(/&#(\d+);/g,function($0,numberStr){return String.fromCharCode(parseInt(numberStr,10))})},parseKeys=function(givenKey,val,options){if(givenKey){var key=options.allowDots?givenKey.replace(/\.([^.[]+)/g,"[$1]"):givenKey,child=/(\[[^[\]]*])/g,segment=/(\[[^[\]]*])/.exec(key),parent=segment?key.slice(0,segment.index):key,keys=[];if(parent){if(!options.plainObjects&&has.call(Object.prototype,parent)&&!options.allowPrototypes)return;keys.push(parent)}for(var i=0;null!==(segment=child.exec(key))&&i<options.depth;){if(i+=1,!options.plainObjects&&has.call(Object.prototype,segment[1].slice(1,-1))&&!options.allowPrototypes)return;keys.push(segment[1])}return segment&&keys.push("["+key.slice(segment.index)+"]"),function(chain,val,options){for(var leaf=val,i=chain.length-1;i>=0;--i){var obj,root=chain[i];if("[]"===root&&options.parseArrays)obj=[].concat(leaf);else{obj=options.plainObjects?Object.create(null):{};var cleanRoot="["===root.charAt(0)&&"]"===root.charAt(root.length-1)?root.slice(1,-1):root,index=parseInt(cleanRoot,10);options.parseArrays||""!==cleanRoot?!isNaN(index)&&root!==cleanRoot&&String(index)===cleanRoot&&index>=0&&options.parseArrays&&index<=options.arrayLimit?(obj=[])[index]=leaf:obj[cleanRoot]=leaf:obj={0:leaf}}leaf=obj}return leaf}(keys,val,options)}};module.exports=function(str,opts){var options=function(opts){if(!opts)return defaults;if(null!==opts.decoder&&void 0!==opts.decoder&&"function"!=typeof opts.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==opts.charset&&"utf-8"!==opts.charset&&"iso-8859-1"!==opts.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var charset=void 0===opts.charset?defaults.charset:opts.charset;return{allowDots:void 0===opts.allowDots?defaults.allowDots:!!opts.allowDots,allowPrototypes:"boolean"==typeof opts.allowPrototypes?opts.allowPrototypes:defaults.allowPrototypes,arrayLimit:"number"==typeof opts.arrayLimit?opts.arrayLimit:defaults.arrayLimit,charset:charset,charsetSentinel:"boolean"==typeof opts.charsetSentinel?opts.charsetSentinel:defaults.charsetSentinel,comma:"boolean"==typeof opts.comma?opts.comma:defaults.comma,decoder:"function"==typeof opts.decoder?opts.decoder:defaults.decoder,delimiter:"string"==typeof opts.delimiter||utils.isRegExp(opts.delimiter)?opts.delimiter:defaults.delimiter,depth:"number"==typeof opts.depth?opts.depth:defaults.depth,ignoreQueryPrefix:!0===opts.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof opts.interpretNumericEntities?opts.interpretNumericEntities:defaults.interpretNumericEntities,parameterLimit:"number"==typeof opts.parameterLimit?opts.parameterLimit:defaults.parameterLimit,parseArrays:!1!==opts.parseArrays,plainObjects:"boolean"==typeof opts.plainObjects?opts.plainObjects:defaults.plainObjects,strictNullHandling:"boolean"==typeof opts.strictNullHandling?opts.strictNullHandling:defaults.strictNullHandling}}(opts);if(""===str||null==str)return options.plainObjects?Object.create(null):{};for(var tempObj="string"==typeof str?function(str,options){var i,obj={},cleanStr=options.ignoreQueryPrefix?str.replace(/^\?/,""):str,limit=options.parameterLimit===1/0?void 0:options.parameterLimit,parts=cleanStr.split(options.delimiter,limit),skipIndex=-1,charset=options.charset;if(options.charsetSentinel)for(i=0;i<parts.length;++i)0===parts[i].indexOf("utf8=")&&("utf8=%E2%9C%93"===parts[i]?charset="utf-8":"utf8=%26%2310003%3B"===parts[i]&&(charset="iso-8859-1"),skipIndex=i,i=parts.length);for(i=0;i<parts.length;++i)if(i!==skipIndex){var key,val,part=parts[i],bracketEqualsPos=part.indexOf("]="),pos=-1===bracketEqualsPos?part.indexOf("="):bracketEqualsPos+1;-1===pos?(key=options.decoder(part,defaults.decoder,charset),val=options.strictNullHandling?null:""):(key=options.decoder(part.slice(0,pos),defaults.decoder,charset),val=options.decoder(part.slice(pos+1),defaults.decoder,charset)),val&&options.interpretNumericEntities&&"iso-8859-1"===charset&&(val=interpretNumericEntities(val)),val&&options.comma&&val.indexOf(",")>-1&&(val=val.split(",")),has.call(obj,key)?obj[key]=utils.combine(obj[key],val):obj[key]=val}return obj}(str,options):str,obj=options.plainObjects?Object.create(null):{},keys=Object.keys(tempObj),i=0;i<keys.length;++i){var key=keys[i],newObj=parseKeys(key,tempObj[key],options);obj=utils.merge(obj,newObj,options)}return utils.compact(obj)}},,,,,,,,,,function(module,exports,__webpack_require__){var isFunction=__webpack_require__(115),isMasked=__webpack_require__(487),isObject=__webpack_require__(26),toSource=__webpack_require__(294),reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=function(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value))}},function(module,exports,__webpack_require__){var uid,coreJsData=__webpack_require__(488),maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"";module.exports=function(func){return!!maskSrcKey&&maskSrcKey in func}},function(module,exports,__webpack_require__){var coreJsData=__webpack_require__(31)["__core-js_shared__"];module.exports=coreJsData},function(module,exports){module.exports=function(object,key){return null==object?void 0:object[key]}},function(module,exports,__webpack_require__){var constant=__webpack_require__(491),defineProperty=__webpack_require__(293),identity=__webpack_require__(99),baseSetToString=defineProperty?function(func,string){return defineProperty(func,"toString",{configurable:!0,enumerable:!1,value:constant(string),writable:!0})}:identity;module.exports=baseSetToString},function(module,exports){module.exports=function(value){return function(){return value}}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(74),isObjectLike=__webpack_require__(29),argsTag="[object Arguments]";module.exports=function(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}},function(module,exports){module.exports=function(){return!1}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(74),isLength=__webpack_require__(195),isObjectLike=__webpack_require__(29),typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object DataView]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1,module.exports=function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}},function(module,exports,__webpack_require__){var nativeKeys=__webpack_require__(299)(Object.keys,Object);module.exports=nativeKeys},function(module,exports,__webpack_require__){var isObject=__webpack_require__(26),isPrototype=__webpack_require__(179),nativeKeysIn=__webpack_require__(497),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object){if(!isObject(object))return nativeKeysIn(object);var isProto=isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&hasOwnProperty.call(object,key))&&result.push(key);return result}},function(module,exports){module.exports=function(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result}},,,function(module,exports){module.exports={}},function(module,exports,__webpack_require__){var LazyWrapper=__webpack_require__(197),LodashWrapper=__webpack_require__(245),baseLodash=__webpack_require__(198),isArray=__webpack_require__(12),isObjectLike=__webpack_require__(29),wrapperClone=__webpack_require__(502),hasOwnProperty=Object.prototype.hasOwnProperty;function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}lodash.prototype=baseLodash.prototype,lodash.prototype.constructor=lodash,module.exports=lodash},function(module,exports,__webpack_require__){var LazyWrapper=__webpack_require__(197),LodashWrapper=__webpack_require__(245),copyArray=__webpack_require__(138);module.exports=function(wrapper){if(wrapper instanceof LazyWrapper)return wrapper.clone();var result=new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__);return result.__actions__=copyArray(wrapper.__actions__),result.__index__=wrapper.__index__,result.__values__=wrapper.__values__,result}},function(module,exports){module.exports=function(value){return value!=value}},function(module,exports){module.exports=function(array,value,fromIndex){for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}},,function(module,exports,__webpack_require__){var isObject=__webpack_require__(26),isSymbol=__webpack_require__(91),NAN=NaN,reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;module.exports=function(value){if("number"==typeof value)return value;if(isSymbol(value))return NAN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN:+value}},function(module,exports){module.exports=function(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}},function(module,exports,__webpack_require__){var isArrayLike=__webpack_require__(55);module.exports=function(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}},function(module,exports,__webpack_require__){var identity=__webpack_require__(99);module.exports=function(value){return"function"==typeof value?value:identity}},,,,function(module,exports,__webpack_require__){var Stack=__webpack_require__(146),assignMergeValue=__webpack_require__(305),baseFor=__webpack_require__(303),baseMergeDeep=__webpack_require__(536),isObject=__webpack_require__(26),keysIn=__webpack_require__(117),safeGet=__webpack_require__(310);module.exports=function baseMerge(object,source,srcIndex,customizer,stack){object!==source&&baseFor(source,function(srcValue,key){if(stack||(stack=new Stack),isObject(srcValue))baseMergeDeep(object,source,key,srcIndex,baseMerge,customizer,stack);else{var newValue=customizer?customizer(safeGet(object,key),srcValue,key+"",object,source,stack):void 0;void 0===newValue&&(newValue=srcValue),assignMergeValue(object,key,newValue)}},keysIn)}},function(module,exports){module.exports=function(){this.__data__=[],this.size=0}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(148),splice=Array.prototype.splice;module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0||(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,0))}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(148);module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(148);module.exports=function(key){return assocIndexOf(this.__data__,key)>-1}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(148);module.exports=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this}},function(module,exports,__webpack_require__){var ListCache=__webpack_require__(147);module.exports=function(){this.__data__=new ListCache,this.size=0}},function(module,exports){module.exports=function(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result}},function(module,exports){module.exports=function(key){return this.__data__.get(key)}},function(module,exports){module.exports=function(key){return this.__data__.has(key)}},function(module,exports,__webpack_require__){var ListCache=__webpack_require__(147),Map=__webpack_require__(200),MapCache=__webpack_require__(201),LARGE_ARRAY_SIZE=200;module.exports=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<LARGE_ARRAY_SIZE-1)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this}},function(module,exports,__webpack_require__){var Hash=__webpack_require__(525),ListCache=__webpack_require__(147),Map=__webpack_require__(200);module.exports=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}},function(module,exports,__webpack_require__){var hashClear=__webpack_require__(526),hashDelete=__webpack_require__(527),hashGet=__webpack_require__(528),hashHas=__webpack_require__(529),hashSet=__webpack_require__(530);function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,module.exports=Hash},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(149);module.exports=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}},function(module,exports){module.exports=function(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(149),HASH_UNDEFINED="__lodash_hash_undefined__",hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;if(nativeCreate){var result=data[key];return result===HASH_UNDEFINED?void 0:result}return hasOwnProperty.call(data,key)?data[key]:void 0}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(149),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty.call(data,key)}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(149),HASH_UNDEFINED="__lodash_hash_undefined__";module.exports=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&void 0===value?HASH_UNDEFINED:value,this}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(150);module.exports=function(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result}},function(module,exports){module.exports=function(value){var type=typeof value;return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(150);module.exports=function(key){return getMapData(this,key).get(key)}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(150);module.exports=function(key){return getMapData(this,key).has(key)}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(150);module.exports=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this}},function(module,exports,__webpack_require__){var assignMergeValue=__webpack_require__(305),cloneBuffer=__webpack_require__(306),cloneTypedArray=__webpack_require__(307),copyArray=__webpack_require__(138),initCloneObject=__webpack_require__(309),isArguments=__webpack_require__(143),isArray=__webpack_require__(12),isArrayLikeObject=__webpack_require__(118),isBuffer=__webpack_require__(116),isFunction=__webpack_require__(115),isObject=__webpack_require__(26),isPlainObject=__webpack_require__(183),isTypedArray=__webpack_require__(144),safeGet=__webpack_require__(310),toPlainObject=__webpack_require__(537);module.exports=function(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=safeGet(object,key),srcValue=safeGet(source,key),stacked=stack.get(srcValue);if(stacked)assignMergeValue(object,key,stacked);else{var newValue=customizer?customizer(objValue,srcValue,key+"",object,source,stack):void 0,isCommon=void 0===newValue;if(isCommon){var isArr=isArray(srcValue),isBuff=!isArr&&isBuffer(srcValue),isTyped=!isArr&&!isBuff&&isTypedArray(srcValue);newValue=srcValue,isArr||isBuff||isTyped?isArray(objValue)?newValue=objValue:isArrayLikeObject(objValue)?newValue=copyArray(objValue):isBuff?(isCommon=!1,newValue=cloneBuffer(srcValue,!0)):isTyped?(isCommon=!1,newValue=cloneTypedArray(srcValue,!0)):newValue=[]:isPlainObject(srcValue)||isArguments(srcValue)?(newValue=objValue,isArguments(objValue)?newValue=toPlainObject(objValue):isObject(objValue)&&!isFunction(objValue)||(newValue=initCloneObject(srcValue))):isCommon=!1}isCommon&&(stack.set(srcValue,newValue),mergeFunc(newValue,srcValue,srcIndex,customizer,stack),stack.delete(srcValue)),assignMergeValue(object,key,newValue)}}},function(module,exports,__webpack_require__){var copyObject=__webpack_require__(78),keysIn=__webpack_require__(117);module.exports=function(value){return copyObject(value,keysIn(value))}},function(module,exports,__webpack_require__){var baseIsMatch=__webpack_require__(539),getMatchData=__webpack_require__(547),matchesStrictComparable=__webpack_require__(317);module.exports=function(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}},function(module,exports,__webpack_require__){var Stack=__webpack_require__(146),baseIsEqual=__webpack_require__(184),COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;module.exports=function(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var stack=new Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(void 0===result?baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG,customizer,stack):result))return!1}}return!0}},function(module,exports,__webpack_require__){var Stack=__webpack_require__(146),equalArrays=__webpack_require__(311),equalByTag=__webpack_require__(543),equalObjects=__webpack_require__(544),getTag=__webpack_require__(109),isArray=__webpack_require__(12),isBuffer=__webpack_require__(116),isTypedArray=__webpack_require__(144),COMPARE_PARTIAL_FLAG=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?arrayTag:getTag(object),othTag=othIsArr?arrayTag:getTag(other),objIsObj=(objTag=objTag==argsTag?objectTag:objTag)==objectTag,othIsObj=(othTag=othTag==argsTag?objectTag:othTag)==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(bitmask&COMPARE_PARTIAL_FLAG)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}return!!isSameTag&&(stack||(stack=new Stack),equalObjects(object,other,bitmask,customizer,equalFunc,stack))}},function(module,exports){var HASH_UNDEFINED="__lodash_hash_undefined__";module.exports=function(value){return this.__data__.set(value,HASH_UNDEFINED),this}},function(module,exports){module.exports=function(value){return this.__data__.has(value)}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(97),Uint8Array=__webpack_require__(308),eq=__webpack_require__(112),equalArrays=__webpack_require__(311),mapToArray=__webpack_require__(429),setToArray=__webpack_require__(203),COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;module.exports=function(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case arrayBufferTag:return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:var isPartial=bitmask&COMPARE_PARTIAL_FLAG;if(convert||(convert=setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=COMPARE_UNORDERED_FLAG,stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case symbolTag:if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}},function(module,exports,__webpack_require__){var getAllKeys=__webpack_require__(312),COMPARE_PARTIAL_FLAG=1,hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG,objProps=getAllKeys(object),objLength=objProps.length;if(objLength!=getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var stacked=stack.get(object);if(stacked&&stack.get(other))return stacked==other;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor)&&(result=!1)}return stack.delete(object),stack.delete(other),result}},function(module,exports,__webpack_require__){var DataView=__webpack_require__(77)(__webpack_require__(31),"DataView");module.exports=DataView},function(module,exports,__webpack_require__){var Promise=__webpack_require__(77)(__webpack_require__(31),"Promise");module.exports=Promise},function(module,exports,__webpack_require__){var isStrictComparable=__webpack_require__(316),keys=__webpack_require__(69);module.exports=function(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}},function(module,exports,__webpack_require__){var baseIsEqual=__webpack_require__(184),get=__webpack_require__(10),hasIn=__webpack_require__(318),isKey=__webpack_require__(206),isStrictComparable=__webpack_require__(316),matchesStrictComparable=__webpack_require__(317),toKey=__webpack_require__(92),COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;module.exports=function(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return void 0===objValue&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}},function(module,exports,__webpack_require__){var memoize=__webpack_require__(241),MAX_MEMOIZE_SIZE=500;module.exports=function(func){var result=memoize(func,function(key){return cache.size===MAX_MEMOIZE_SIZE&&cache.clear(),key}),cache=result.cache;return result}},function(module,exports){module.exports=function(object,key){return null!=object&&key in Object(object)}},function(module,exports,__webpack_require__){var baseProperty=__webpack_require__(208),basePropertyDeep=__webpack_require__(552),isKey=__webpack_require__(206),toKey=__webpack_require__(92);module.exports=function(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}},function(module,exports,__webpack_require__){var baseGet=__webpack_require__(154);module.exports=function(path){return function(object){return baseGet(object,path)}}},,function(module,exports,__webpack_require__){var Symbol=__webpack_require__(97),isArguments=__webpack_require__(143),isArray=__webpack_require__(12),spreadableSymbol=Symbol?Symbol.isConcatSpreadable:void 0;module.exports=function(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}},function(module,exports,__webpack_require__){var basePickBy=__webpack_require__(320),hasIn=__webpack_require__(318);module.exports=function(object,paths){return basePickBy(object,paths,function(value,path){return hasIn(object,path)})}},function(module,exports,__webpack_require__){var Set=__webpack_require__(315),noop=__webpack_require__(302),setToArray=__webpack_require__(203),createSet=Set&&1/setToArray(new Set([,-0]))[1]==1/0?function(values){return new Set(values)}:noop;module.exports=createSet},function(module,exports){module.exports=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}},function(module,exports){module.exports=function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}},function(module,exports){module.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(module,exports,__webpack_require__){"use strict";function PrependBOMWrapper(encoder,options){this.encoder=encoder,this.addBOM=!0}function StripBOMWrapper(decoder,options){this.decoder=decoder,this.pass=!1,this.options=options||{}}exports.PrependBOM=PrependBOMWrapper,PrependBOMWrapper.prototype.write=function(str){return this.addBOM&&(str="\ufeff"+str,this.addBOM=!1),this.encoder.write(str)},PrependBOMWrapper.prototype.end=function(){return this.encoder.end()},exports.StripBOM=StripBOMWrapper,StripBOMWrapper.prototype.write=function(buf){var res=this.decoder.write(buf);return this.pass||!res?res:("\ufeff"===res[0]&&(res=res.slice(1),"function"==typeof this.options.stripBOM&&this.options.stripBOM()),this.pass=!0,res)},StripBOMWrapper.prototype.end=function(){return this.decoder.end()}},function(module,exports,__webpack_require__){"use strict";for(var modules=[__webpack_require__(562),__webpack_require__(563),__webpack_require__(564),__webpack_require__(565),__webpack_require__(566),__webpack_require__(567),__webpack_require__(568),__webpack_require__(569)],i=0;i<modules.length;i++){module=modules[i];for(var enc in module)Object.prototype.hasOwnProperty.call(module,enc)&&(exports[enc]=module[enc])}},function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(15).Buffer;function InternalCodec(codecOptions,iconv){this.enc=codecOptions.encodingName,this.bomAware=codecOptions.bomAware,"base64"===this.enc?this.encoder=InternalEncoderBase64:"cesu8"===this.enc&&(this.enc="utf8",this.encoder=InternalEncoderCesu8,""!==Buffer.from("eda0bdedb2a9","hex").toString()&&(this.decoder=InternalDecoderCesu8,this.defaultCharUnicode=iconv.defaultCharUnicode))}module.exports={utf8:{type:"_internal",bomAware:!0},cesu8:{type:"_internal",bomAware:!0},unicode11utf8:"utf8",ucs2:{type:"_internal",bomAware:!0},utf16le:"ucs2",binary:{type:"_internal"},base64:{type:"_internal"},hex:{type:"_internal"},_internal:InternalCodec},InternalCodec.prototype.encoder=InternalEncoder,InternalCodec.prototype.decoder=InternalDecoder;var StringDecoder=__webpack_require__(412).StringDecoder;function InternalDecoder(options,codec){StringDecoder.call(this,codec.enc)}function InternalEncoder(options,codec){this.enc=codec.enc}function InternalEncoderBase64(options,codec){this.prevStr=""}function InternalEncoderCesu8(options,codec){}function InternalDecoderCesu8(options,codec){this.acc=0,this.contBytes=0,this.accBytes=0,this.defaultCharUnicode=codec.defaultCharUnicode}StringDecoder.prototype.end||(StringDecoder.prototype.end=function(){}),InternalDecoder.prototype=StringDecoder.prototype,InternalEncoder.prototype.write=function(str){return Buffer.from(str,this.enc)},InternalEncoder.prototype.end=function(){},InternalEncoderBase64.prototype.write=function(str){var completeQuads=(str=this.prevStr+str).length-str.length%4;return this.prevStr=str.slice(completeQuads),str=str.slice(0,completeQuads),Buffer.from(str,"base64")},InternalEncoderBase64.prototype.end=function(){return Buffer.from(this.prevStr,"base64")},InternalEncoderCesu8.prototype.write=function(str){for(var buf=Buffer.alloc(3*str.length),bufIdx=0,i=0;i<str.length;i++){var charCode=str.charCodeAt(i);charCode<128?buf[bufIdx++]=charCode:charCode<2048?(buf[bufIdx++]=192+(charCode>>>6),buf[bufIdx++]=128+(63&charCode)):(buf[bufIdx++]=224+(charCode>>>12),buf[bufIdx++]=128+(charCode>>>6&63),buf[bufIdx++]=128+(63&charCode))}return buf.slice(0,bufIdx)},InternalEncoderCesu8.prototype.end=function(){},InternalDecoderCesu8.prototype.write=function(buf){for(var acc=this.acc,contBytes=this.contBytes,accBytes=this.accBytes,res="",i=0;i<buf.length;i++){var curByte=buf[i];128!=(192&curByte)?(contBytes>0&&(res+=this.defaultCharUnicode,contBytes=0),curByte<128?res+=String.fromCharCode(curByte):curByte<224?(acc=31&curByte,contBytes=1,accBytes=1):curByte<240?(acc=15&curByte,contBytes=2,accBytes=1):res+=this.defaultCharUnicode):contBytes>0?(acc=acc<<6|63&curByte,accBytes++,0===--contBytes&&(res+=2===accBytes&&acc<128&&acc>0?this.defaultCharUnicode:3===accBytes&&acc<2048?this.defaultCharUnicode:String.fromCharCode(acc))):res+=this.defaultCharUnicode}return this.acc=acc,this.contBytes=contBytes,this.accBytes=accBytes,res},InternalDecoderCesu8.prototype.end=function(){var res=0;return this.contBytes>0&&(res+=this.defaultCharUnicode),res}},function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(15).Buffer;function Utf16BECodec(){}function Utf16BEEncoder(){}function Utf16BEDecoder(){this.overflowByte=-1}function Utf16Codec(codecOptions,iconv){this.iconv=iconv}function Utf16Encoder(options,codec){void 0===(options=options||{}).addBOM&&(options.addBOM=!0),this.encoder=codec.iconv.getEncoder("utf-16le",options)}function Utf16Decoder(options,codec){this.decoder=null,this.initialBytes=[],this.initialBytesLen=0,this.options=options||{},this.iconv=codec.iconv}function detectEncoding(buf,defaultEncoding){var enc=defaultEncoding||"utf-16le";if(buf.length>=2)if(254==buf[0]&&255==buf[1])enc="utf-16be";else if(255==buf[0]&&254==buf[1])enc="utf-16le";else{for(var asciiCharsLE=0,asciiCharsBE=0,_len=Math.min(buf.length-buf.length%2,64),i=0;i<_len;i+=2)0===buf[i]&&0!==buf[i+1]&&asciiCharsBE++,0!==buf[i]&&0===buf[i+1]&&asciiCharsLE++;asciiCharsBE>asciiCharsLE?enc="utf-16be":asciiCharsBE<asciiCharsLE&&(enc="utf-16le")}return enc}exports.utf16be=Utf16BECodec,Utf16BECodec.prototype.encoder=Utf16BEEncoder,Utf16BECodec.prototype.decoder=Utf16BEDecoder,Utf16BECodec.prototype.bomAware=!0,Utf16BEEncoder.prototype.write=function(str){for(var buf=Buffer.from(str,"ucs2"),i=0;i<buf.length;i+=2){var tmp=buf[i];buf[i]=buf[i+1],buf[i+1]=tmp}return buf},Utf16BEEncoder.prototype.end=function(){},Utf16BEDecoder.prototype.write=function(buf){if(0==buf.length)return"";var buf2=Buffer.alloc(buf.length+1),i=0,j=0;for(-1!==this.overflowByte&&(buf2[0]=buf[0],buf2[1]=this.overflowByte,i=1,j=2);i<buf.length-1;i+=2,j+=2)buf2[j]=buf[i+1],buf2[j+1]=buf[i];return this.overflowByte=i==buf.length-1?buf[buf.length-1]:-1,buf2.slice(0,j).toString("ucs2")},Utf16BEDecoder.prototype.end=function(){},exports.utf16=Utf16Codec,Utf16Codec.prototype.encoder=Utf16Encoder,Utf16Codec.prototype.decoder=Utf16Decoder,Utf16Encoder.prototype.write=function(str){return this.encoder.write(str)},Utf16Encoder.prototype.end=function(){return this.encoder.end()},Utf16Decoder.prototype.write=function(buf){if(!this.decoder){if(this.initialBytes.push(buf),this.initialBytesLen+=buf.length,this.initialBytesLen<16)return"";var encoding=detectEncoding(buf=Buffer.concat(this.initialBytes),this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(encoding,this.options),this.initialBytes.length=this.initialBytesLen=0}return this.decoder.write(buf)},Utf16Decoder.prototype.end=function(){if(!this.decoder){var buf=Buffer.concat(this.initialBytes),encoding=detectEncoding(buf,this.options.defaultEncoding);this.decoder=this.iconv.getDecoder(encoding,this.options);var res=this.decoder.write(buf),trail=this.decoder.end();return trail?res+trail:res}return this.decoder.end()}},function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(15).Buffer;function Utf7Codec(codecOptions,iconv){this.iconv=iconv}exports.utf7=Utf7Codec,exports.unicode11utf7="utf7",Utf7Codec.prototype.encoder=Utf7Encoder,Utf7Codec.prototype.decoder=Utf7Decoder,Utf7Codec.prototype.bomAware=!0;var nonDirectChars=/[^A-Za-z0-9'\(\),-\.\/:\? \n\r\t]+/g;function Utf7Encoder(options,codec){this.iconv=codec.iconv}function Utf7Decoder(options,codec){this.iconv=codec.iconv,this.inBase64=!1,this.base64Accum=""}Utf7Encoder.prototype.write=function(str){return Buffer.from(str.replace(nonDirectChars,function(chunk){return"+"+("+"===chunk?"":this.iconv.encode(chunk,"utf16-be").toString("base64").replace(/=+$/,""))+"-"}.bind(this)))},Utf7Encoder.prototype.end=function(){};for(var base64Regex=/[A-Za-z0-9\/+]/,base64Chars=[],i=0;i<256;i++)base64Chars[i]=base64Regex.test(String.fromCharCode(i));var plusChar="+".charCodeAt(0),minusChar="-".charCodeAt(0),andChar="&".charCodeAt(0);function Utf7IMAPCodec(codecOptions,iconv){this.iconv=iconv}function Utf7IMAPEncoder(options,codec){this.iconv=codec.iconv,this.inBase64=!1,this.base64Accum=Buffer.alloc(6),this.base64AccumIdx=0}function Utf7IMAPDecoder(options,codec){this.iconv=codec.iconv,this.inBase64=!1,this.base64Accum=""}Utf7Decoder.prototype.write=function(buf){for(var res="",lastI=0,inBase64=this.inBase64,base64Accum=this.base64Accum,i=0;i<buf.length;i++)if(inBase64){if(!base64Chars[buf[i]]){if(i==lastI&&buf[i]==minusChar)res+="+";else{var b64str=base64Accum+buf.slice(lastI,i).toString();res+=this.iconv.decode(Buffer.from(b64str,"base64"),"utf16-be")}buf[i]!=minusChar&&i--,lastI=i+1,inBase64=!1,base64Accum=""}}else buf[i]==plusChar&&(res+=this.iconv.decode(buf.slice(lastI,i),"ascii"),lastI=i+1,inBase64=!0);if(inBase64){var canBeDecoded=(b64str=base64Accum+buf.slice(lastI).toString()).length-b64str.length%8;base64Accum=b64str.slice(canBeDecoded),b64str=b64str.slice(0,canBeDecoded),res+=this.iconv.decode(Buffer.from(b64str,"base64"),"utf16-be")}else res+=this.iconv.decode(buf.slice(lastI),"ascii");return this.inBase64=inBase64,this.base64Accum=base64Accum,res},Utf7Decoder.prototype.end=function(){var res="";return this.inBase64&&this.base64Accum.length>0&&(res=this.iconv.decode(Buffer.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",res},exports.utf7imap=Utf7IMAPCodec,Utf7IMAPCodec.prototype.encoder=Utf7IMAPEncoder,Utf7IMAPCodec.prototype.decoder=Utf7IMAPDecoder,Utf7IMAPCodec.prototype.bomAware=!0,Utf7IMAPEncoder.prototype.write=function(str){for(var inBase64=this.inBase64,base64Accum=this.base64Accum,base64AccumIdx=this.base64AccumIdx,buf=Buffer.alloc(5*str.length+10),bufIdx=0,i=0;i<str.length;i++){var uChar=str.charCodeAt(i);32<=uChar&&uChar<=126?(inBase64&&(base64AccumIdx>0&&(bufIdx+=buf.write(base64Accum.slice(0,base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),bufIdx),base64AccumIdx=0),buf[bufIdx++]=minusChar,inBase64=!1),inBase64||(buf[bufIdx++]=uChar,uChar===andChar&&(buf[bufIdx++]=minusChar))):(inBase64||(buf[bufIdx++]=andChar,inBase64=!0),inBase64&&(base64Accum[base64AccumIdx++]=uChar>>8,base64Accum[base64AccumIdx++]=255&uChar,base64AccumIdx==base64Accum.length&&(bufIdx+=buf.write(base64Accum.toString("base64").replace(/\//g,","),bufIdx),base64AccumIdx=0)))}return this.inBase64=inBase64,this.base64AccumIdx=base64AccumIdx,buf.slice(0,bufIdx)},Utf7IMAPEncoder.prototype.end=function(){var buf=Buffer.alloc(10),bufIdx=0;return this.inBase64&&(this.base64AccumIdx>0&&(bufIdx+=buf.write(this.base64Accum.slice(0,this.base64AccumIdx).toString("base64").replace(/\//g,",").replace(/=+$/,""),bufIdx),this.base64AccumIdx=0),buf[bufIdx++]=minusChar,this.inBase64=!1),buf.slice(0,bufIdx)};var base64IMAPChars=base64Chars.slice();base64IMAPChars[",".charCodeAt(0)]=!0,Utf7IMAPDecoder.prototype.write=function(buf){for(var res="",lastI=0,inBase64=this.inBase64,base64Accum=this.base64Accum,i=0;i<buf.length;i++)if(inBase64){if(!base64IMAPChars[buf[i]]){if(i==lastI&&buf[i]==minusChar)res+="&";else{var b64str=base64Accum+buf.slice(lastI,i).toString().replace(/,/g,"/");res+=this.iconv.decode(Buffer.from(b64str,"base64"),"utf16-be")}buf[i]!=minusChar&&i--,lastI=i+1,inBase64=!1,base64Accum=""}}else buf[i]==andChar&&(res+=this.iconv.decode(buf.slice(lastI,i),"ascii"),lastI=i+1,inBase64=!0);if(inBase64){var canBeDecoded=(b64str=base64Accum+buf.slice(lastI).toString().replace(/,/g,"/")).length-b64str.length%8;base64Accum=b64str.slice(canBeDecoded),b64str=b64str.slice(0,canBeDecoded),res+=this.iconv.decode(Buffer.from(b64str,"base64"),"utf16-be")}else res+=this.iconv.decode(buf.slice(lastI),"ascii");return this.inBase64=inBase64,this.base64Accum=base64Accum,res},Utf7IMAPDecoder.prototype.end=function(){var res="";return this.inBase64&&this.base64Accum.length>0&&(res=this.iconv.decode(Buffer.from(this.base64Accum,"base64"),"utf16-be")),this.inBase64=!1,this.base64Accum="",res}},function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(15).Buffer;function SBCSCodec(codecOptions,iconv){if(!codecOptions)throw new Error("SBCS codec is called without the data.");if(!codecOptions.chars||128!==codecOptions.chars.length&&256!==codecOptions.chars.length)throw new Error("Encoding '"+codecOptions.type+"' has incorrect 'chars' (must be of len 128 or 256)");if(128===codecOptions.chars.length){for(var asciiString="",i=0;i<128;i++)asciiString+=String.fromCharCode(i);codecOptions.chars=asciiString+codecOptions.chars}this.decodeBuf=Buffer.from(codecOptions.chars,"ucs2");var encodeBuf=Buffer.alloc(65536,iconv.defaultCharSingleByte.charCodeAt(0));for(i=0;i<codecOptions.chars.length;i++)encodeBuf[codecOptions.chars.charCodeAt(i)]=i;this.encodeBuf=encodeBuf}function SBCSEncoder(options,codec){this.encodeBuf=codec.encodeBuf}function SBCSDecoder(options,codec){this.decodeBuf=codec.decodeBuf}exports._sbcs=SBCSCodec,SBCSCodec.prototype.encoder=SBCSEncoder,SBCSCodec.prototype.decoder=SBCSDecoder,SBCSEncoder.prototype.write=function(str){for(var buf=Buffer.alloc(str.length),i=0;i<str.length;i++)buf[i]=this.encodeBuf[str.charCodeAt(i)];return buf},SBCSEncoder.prototype.end=function(){},SBCSDecoder.prototype.write=function(buf){for(var decodeBuf=this.decodeBuf,newBuf=Buffer.alloc(2*buf.length),idx1=0,idx2=0,i=0;i<buf.length;i++)idx1=2*buf[i],newBuf[idx2=2*i]=decodeBuf[idx1],newBuf[idx2+1]=decodeBuf[idx1+1];return newBuf.toString("ucs2")},SBCSDecoder.prototype.end=function(){}},function(module,exports,__webpack_require__){"use strict";module.exports={10029:"maccenteuro",maccenteuro:{type:"_sbcs",chars:""},808:"cp808",ibm808:"cp808",cp808:{type:"_sbcs",chars:""},mik:{type:"_sbcs",chars:""},ascii8bit:"ascii",usascii:"ascii",ansix34:"ascii",ansix341968:"ascii",ansix341986:"ascii",csascii:"ascii",cp367:"ascii",ibm367:"ascii",isoir6:"ascii",iso646us:"ascii",iso646irv:"ascii",us:"ascii",latin1:"iso88591",latin2:"iso88592",latin3:"iso88593",latin4:"iso88594",latin5:"iso88599",latin6:"iso885910",latin7:"iso885913",latin8:"iso885914",latin9:"iso885915",latin10:"iso885916",csisolatin1:"iso88591",csisolatin2:"iso88592",csisolatin3:"iso88593",csisolatin4:"iso88594",csisolatincyrillic:"iso88595",csisolatinarabic:"iso88596",csisolatingreek:"iso88597",csisolatinhebrew:"iso88598",csisolatin5:"iso88599",csisolatin6:"iso885910",l1:"iso88591",l2:"iso88592",l3:"iso88593",l4:"iso88594",l5:"iso88599",l6:"iso885910",l7:"iso885913",l8:"iso885914",l9:"iso885915",l10:"iso885916",isoir14:"iso646jp",isoir57:"iso646cn",isoir100:"iso88591",isoir101:"iso88592",isoir109:"iso88593",isoir110:"iso88594",isoir144:"iso88595",isoir127:"iso88596",isoir126:"iso88597",isoir138:"iso88598",isoir148:"iso88599",isoir157:"iso885910",isoir166:"tis620",isoir179:"iso885913",isoir199:"iso885914",isoir203:"iso885915",isoir226:"iso885916",cp819:"iso88591",ibm819:"iso88591",cyrillic:"iso88595",arabic:"iso88596",arabic8:"iso88596",ecma114:"iso88596",asmo708:"iso88596",greek:"iso88597",greek8:"iso88597",ecma118:"iso88597",elot928:"iso88597",hebrew:"iso88598",hebrew8:"iso88598",turkish:"iso88599",turkish8:"iso88599",thai:"iso885911",thai8:"iso885911",celtic:"iso885914",celtic8:"iso885914",isoceltic:"iso885914",tis6200:"tis620",tis62025291:"tis620",tis62025330:"tis620",1e4:"macroman",10006:"macgreek",10007:"maccyrillic",10079:"maciceland",10081:"macturkish",cspc8codepage437:"cp437",cspc775baltic:"cp775",cspc850multilingual:"cp850",cspcp852:"cp852",cspc862latinhebrew:"cp862",cpgr:"cp869",msee:"cp1250",mscyrl:"cp1251",msansi:"cp1252",msgreek:"cp1253",msturk:"cp1254",mshebr:"cp1255",msarab:"cp1256",winbaltrim:"cp1257",cp20866:"koi8r",20866:"koi8r",ibm878:"koi8r",cskoi8r:"koi8r",cp21866:"koi8u",21866:"koi8u",ibm1168:"koi8u",strk10482002:"rk1048",tcvn5712:"tcvn",tcvn57121:"tcvn",gb198880:"iso646cn",cn:"iso646cn",csiso14jisc6220ro:"iso646jp",jisc62201969ro:"iso646jp",jp:"iso646jp",cshproman8:"hproman8",r8:"hproman8",roman8:"hproman8",xroman8:"hproman8",ibm1051:"hproman8",mac:"macintosh",csmacintosh:"macintosh"}},function(module,exports,__webpack_require__){"use strict";module.exports={437:"cp437",737:"cp737",775:"cp775",850:"cp850",852:"cp852",855:"cp855",856:"cp856",857:"cp857",858:"cp858",860:"cp860",861:"cp861",862:"cp862",863:"cp863",864:"cp864",865:"cp865",866:"cp866",869:"cp869",874:"windows874",922:"cp922",1046:"cp1046",1124:"cp1124",1125:"cp1125",1129:"cp1129",1133:"cp1133",1161:"cp1161",1162:"cp1162",1163:"cp1163",1250:"windows1250",1251:"windows1251",1252:"windows1252",1253:"windows1253",1254:"windows1254",1255:"windows1255",1256:"windows1256",1257:"windows1257",1258:"windows1258",28591:"iso88591",28592:"iso88592",28593:"iso88593",28594:"iso88594",28595:"iso88595",28596:"iso88596",28597:"iso88597",28598:"iso88598",28599:"iso88599",28600:"iso885910",28601:"iso885911",28603:"iso885913",28604:"iso885914",28605:"iso885915",28606:"iso885916",windows874:{type:"_sbcs",chars:""},win874:"windows874",cp874:"windows874",windows1250:{type:"_sbcs",chars:""},win1250:"windows1250",cp1250:"windows1250",windows1251:{type:"_sbcs",chars:""},win1251:"windows1251",cp1251:"windows1251",windows1252:{type:"_sbcs",chars:""},win1252:"windows1252",cp1252:"windows1252",windows1253:{type:"_sbcs",chars:""},win1253:"windows1253",cp1253:"windows1253",windows1254:{type:"_sbcs",chars:""},win1254:"windows1254",cp1254:"windows1254",windows1255:{type:"_sbcs",chars:""},win1255:"windows1255",cp1255:"windows1255",windows1256:{type:"_sbcs",chars:""},win1256:"windows1256",cp1256:"windows1256",windows1257:{type:"_sbcs",chars:""},win1257:"windows1257",cp1257:"windows1257",windows1258:{type:"_sbcs",chars:""},win1258:"windows1258",cp1258:"windows1258",iso88591:{type:"_sbcs",chars:""},cp28591:"iso88591",iso88592:{type:"_sbcs",chars:""},cp28592:"iso88592",iso88593:{type:"_sbcs",chars:""},cp28593:"iso88593",iso88594:{type:"_sbcs",chars:""},cp28594:"iso88594",iso88595:{type:"_sbcs",chars:""},cp28595:"iso88595",iso88596:{type:"_sbcs",chars:""},cp28596:"iso88596",iso88597:{type:"_sbcs",chars:""},cp28597:"iso88597",iso88598:{type:"_sbcs",chars:""},cp28598:"iso88598",iso88599:{type:"_sbcs",chars:""},cp28599:"iso88599",iso885910:{type:"_sbcs",chars:""},cp28600:"iso885910",iso885911:{type:"_sbcs",chars:""},cp28601:"iso885911",iso885913:{type:"_sbcs",chars:""},cp28603:"iso885913",iso885914:{type:"_sbcs",chars:""},cp28604:"iso885914",iso885915:{type:"_sbcs",chars:""},cp28605:"iso885915",iso885916:{type:"_sbcs",chars:""},cp28606:"iso885916",cp437:{type:"_sbcs",chars:""},ibm437:"cp437",csibm437:"cp437",cp737:{type:"_sbcs",chars:""},ibm737:"cp737",csibm737:"cp737",cp775:{type:"_sbcs",chars:""},ibm775:"cp775",csibm775:"cp775",cp850:{type:"_sbcs",chars:""},ibm850:"cp850",csibm850:"cp850",cp852:{type:"_sbcs",chars:""},ibm852:"cp852",csibm852:"cp852",cp855:{type:"_sbcs",chars:""},ibm855:"cp855",csibm855:"cp855",cp856:{type:"_sbcs",chars:""},ibm856:"cp856",csibm856:"cp856",cp857:{type:"_sbcs",chars:""},ibm857:"cp857",csibm857:"cp857",cp858:{type:"_sbcs",chars:""},ibm858:"cp858",csibm858:"cp858",cp860:{type:"_sbcs",chars:""},ibm860:"cp860",csibm860:"cp860",cp861:{type:"_sbcs",chars:""},ibm861:"cp861",csibm861:"cp861",cp862:{type:"_sbcs",chars:""},ibm862:"cp862",csibm862:"cp862",cp863:{type:"_sbcs",chars:""},ibm863:"cp863",csibm863:"cp863",cp864:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},ibm864:"cp864",csibm864:"cp864",cp865:{type:"_sbcs",chars:""},ibm865:"cp865",csibm865:"cp865",cp866:{type:"_sbcs",chars:""},ibm866:"cp866",csibm866:"cp866",cp869:{type:"_sbcs",chars:""},ibm869:"cp869",csibm869:"cp869",cp922:{type:"_sbcs",chars:""},ibm922:"cp922",csibm922:"cp922",cp1046:{type:"_sbcs",chars:""},ibm1046:"cp1046",csibm1046:"cp1046",cp1124:{type:"_sbcs",chars:""},ibm1124:"cp1124",csibm1124:"cp1124",cp1125:{type:"_sbcs",chars:""},ibm1125:"cp1125",csibm1125:"cp1125",cp1129:{type:"_sbcs",chars:""},ibm1129:"cp1129",csibm1129:"cp1129",cp1133:{type:"_sbcs",chars:""},ibm1133:"cp1133",csibm1133:"cp1133",cp1161:{type:"_sbcs",chars:""},ibm1161:"cp1161",csibm1161:"cp1161",cp1162:{type:"_sbcs",chars:""},ibm1162:"cp1162",csibm1162:"cp1162",cp1163:{type:"_sbcs",chars:""},ibm1163:"cp1163",csibm1163:"cp1163",maccroatian:{type:"_sbcs",chars:""},maccyrillic:{type:"_sbcs",chars:""},macgreek:{type:"_sbcs",chars:""},maciceland:{type:"_sbcs",chars:""},macroman:{type:"_sbcs",chars:""},macromania:{type:"_sbcs",chars:""},macthai:{type:"_sbcs",chars:"\ufeff"},macturkish:{type:"_sbcs",chars:""},macukraine:{type:"_sbcs",chars:""},koi8r:{type:"_sbcs",chars:""},koi8u:{type:"_sbcs",chars:""},koi8ru:{type:"_sbcs",chars:""},koi8t:{type:"_sbcs",chars:""},armscii8:{type:"_sbcs",chars:")(.,-"},rk1048:{type:"_sbcs",chars:""},tcvn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},georgianacademy:{type:"_sbcs",chars:""},georgianps:{type:"_sbcs",chars:""},pt154:{type:"_sbcs",chars:""},viscii:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"},iso646cn:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}"},iso646jp:{type:"_sbcs",chars:"\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}"},hproman8:{type:"_sbcs",chars:""},macintosh:{type:"_sbcs",chars:""},ascii:{type:"_sbcs",chars:""},tis620:{type:"_sbcs",chars:""}}},function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(15).Buffer;exports._dbcs=DBCSCodec;for(var UNASSIGNED=-1,GB18030_CODE=-2,NODE_START=-1e3,UNASSIGNED_NODE=new Array(256),i=0;i<256;i++)UNASSIGNED_NODE[i]=UNASSIGNED;function DBCSCodec(codecOptions,iconv){if(this.encodingName=codecOptions.encodingName,!codecOptions)throw new Error("DBCS codec is called without the data.");if(!codecOptions.table)throw new Error("Encoding '"+this.encodingName+"' has no data.");var mappingTable=codecOptions.table();this.decodeTables=[],this.decodeTables[0]=UNASSIGNED_NODE.slice(0),this.decodeTableSeq=[];for(var i=0;i<mappingTable.length;i++)this._addDecodeChunk(mappingTable[i]);this.defaultCharUnicode=iconv.defaultCharUnicode,this.encodeTable=[],this.encodeTableSeq=[];var skipEncodeChars={};if(codecOptions.encodeSkipVals)for(i=0;i<codecOptions.encodeSkipVals.length;i++){var val=codecOptions.encodeSkipVals[i];if("number"==typeof val)skipEncodeChars[val]=!0;else for(var j=val.from;j<=val.to;j++)skipEncodeChars[j]=!0}if(this._fillEncodeTable(0,0,skipEncodeChars),codecOptions.encodeAdd)for(var uChar in codecOptions.encodeAdd)Object.prototype.hasOwnProperty.call(codecOptions.encodeAdd,uChar)&&this._setEncodeChar(uChar.charCodeAt(0),codecOptions.encodeAdd[uChar]);if(this.defCharSB=this.encodeTable[0][iconv.defaultCharSingleByte.charCodeAt(0)],this.defCharSB===UNASSIGNED&&(this.defCharSB=this.encodeTable[0]["?"]),this.defCharSB===UNASSIGNED&&(this.defCharSB="?".charCodeAt(0)),"function"==typeof codecOptions.gb18030){this.gb18030=codecOptions.gb18030();var thirdByteNodeIdx=this.decodeTables.length,thirdByteNode=this.decodeTables[thirdByteNodeIdx]=UNASSIGNED_NODE.slice(0),fourthByteNodeIdx=this.decodeTables.length,fourthByteNode=this.decodeTables[fourthByteNodeIdx]=UNASSIGNED_NODE.slice(0);for(i=129;i<=254;i++){var secondByteNodeIdx=NODE_START-this.decodeTables[0][i],secondByteNode=this.decodeTables[secondByteNodeIdx];for(j=48;j<=57;j++)secondByteNode[j]=NODE_START-thirdByteNodeIdx}for(i=129;i<=254;i++)thirdByteNode[i]=NODE_START-fourthByteNodeIdx;for(i=48;i<=57;i++)fourthByteNode[i]=GB18030_CODE}}function DBCSEncoder(options,codec){this.leadSurrogate=-1,this.seqObj=void 0,this.encodeTable=codec.encodeTable,this.encodeTableSeq=codec.encodeTableSeq,this.defaultCharSingleByte=codec.defCharSB,this.gb18030=codec.gb18030}function DBCSDecoder(options,codec){this.nodeIdx=0,this.prevBuf=Buffer.alloc(0),this.decodeTables=codec.decodeTables,this.decodeTableSeq=codec.decodeTableSeq,this.defaultCharUnicode=codec.defaultCharUnicode,this.gb18030=codec.gb18030}function findIdx(table,val){if(table[0]>val)return-1;for(var l=0,r=table.length;l<r-1;){var mid=l+Math.floor((r-l+1)/2);table[mid]<=val?l=mid:r=mid}return l}DBCSCodec.prototype.encoder=DBCSEncoder,DBCSCodec.prototype.decoder=DBCSDecoder,DBCSCodec.prototype._getDecodeTrieNode=function(addr){for(var bytes=[];addr>0;addr>>=8)bytes.push(255&addr);0==bytes.length&&bytes.push(0);for(var node=this.decodeTables[0],i=bytes.length-1;i>0;i--){var val=node[bytes[i]];if(val==UNASSIGNED)node[bytes[i]]=NODE_START-this.decodeTables.length,this.decodeTables.push(node=UNASSIGNED_NODE.slice(0));else{if(!(val<=NODE_START))throw new Error("Overwrite byte in "+this.encodingName+", addr: "+addr.toString(16));node=this.decodeTables[NODE_START-val]}}return node},DBCSCodec.prototype._addDecodeChunk=function(chunk){var curAddr=parseInt(chunk[0],16),writeTable=this._getDecodeTrieNode(curAddr);curAddr&=255;for(var k=1;k<chunk.length;k++){var part=chunk[k];if("string"==typeof part)for(var l=0;l<part.length;){var code=part.charCodeAt(l++);if(55296<=code&&code<56320){var codeTrail=part.charCodeAt(l++);if(!(56320<=codeTrail&&codeTrail<57344))throw new Error("Incorrect surrogate pair in "+this.encodingName+" at chunk "+chunk[0]);writeTable[curAddr++]=65536+1024*(code-55296)+(codeTrail-56320)}else if(4080<code&&code<=4095){for(var len=4095-code+2,seq=[],m=0;m<len;m++)seq.push(part.charCodeAt(l++));writeTable[curAddr++]=-10-this.decodeTableSeq.length,this.decodeTableSeq.push(seq)}else writeTable[curAddr++]=code}else{if("number"!=typeof part)throw new Error("Incorrect type '"+typeof part+"' given in "+this.encodingName+" at chunk "+chunk[0]);var charCode=writeTable[curAddr-1]+1;for(l=0;l<part;l++)writeTable[curAddr++]=charCode++}}if(curAddr>255)throw new Error("Incorrect chunk in "+this.encodingName+" at addr "+chunk[0]+": too long"+curAddr)},DBCSCodec.prototype._getEncodeBucket=function(uCode){var high=uCode>>8;return void 0===this.encodeTable[high]&&(this.encodeTable[high]=UNASSIGNED_NODE.slice(0)),this.encodeTable[high]},DBCSCodec.prototype._setEncodeChar=function(uCode,dbcsCode){var bucket=this._getEncodeBucket(uCode),low=255&uCode;bucket[low]<=-10?this.encodeTableSeq[-10-bucket[low]][-1]=dbcsCode:bucket[low]==UNASSIGNED&&(bucket[low]=dbcsCode)},DBCSCodec.prototype._setEncodeSequence=function(seq,dbcsCode){var node,uCode=seq[0],bucket=this._getEncodeBucket(uCode),low=255&uCode;bucket[low]<=-10?node=this.encodeTableSeq[-10-bucket[low]]:(node={},bucket[low]!==UNASSIGNED&&(node[-1]=bucket[low]),bucket[low]=-10-this.encodeTableSeq.length,this.encodeTableSeq.push(node));for(var j=1;j<seq.length-1;j++){var oldVal=node[uCode];"object"==typeof oldVal?node=oldVal:(node=node[uCode]={},void 0!==oldVal&&(node[-1]=oldVal))}node[uCode=seq[seq.length-1]]=dbcsCode},DBCSCodec.prototype._fillEncodeTable=function(nodeIdx,prefix,skipEncodeChars){for(var node=this.decodeTables[nodeIdx],i=0;i<256;i++){var uCode=node[i],mbCode=prefix+i;skipEncodeChars[mbCode]||(uCode>=0?this._setEncodeChar(uCode,mbCode):uCode<=NODE_START?this._fillEncodeTable(NODE_START-uCode,mbCode<<8,skipEncodeChars):uCode<=-10&&this._setEncodeSequence(this.decodeTableSeq[-10-uCode],mbCode))}},DBCSEncoder.prototype.write=function(str){for(var newBuf=Buffer.alloc(str.length*(this.gb18030?4:3)),leadSurrogate=this.leadSurrogate,seqObj=this.seqObj,nextChar=-1,i=0,j=0;;){if(-1===nextChar){if(i==str.length)break;var uCode=str.charCodeAt(i++)}else{uCode=nextChar;nextChar=-1}if(55296<=uCode&&uCode<57344)if(uCode<56320){if(-1===leadSurrogate){leadSurrogate=uCode;continue}leadSurrogate=uCode,uCode=UNASSIGNED}else-1!==leadSurrogate?(uCode=65536+1024*(leadSurrogate-55296)+(uCode-56320),leadSurrogate=-1):uCode=UNASSIGNED;else-1!==leadSurrogate&&(nextChar=uCode,uCode=UNASSIGNED,leadSurrogate=-1);var dbcsCode=UNASSIGNED;if(void 0!==seqObj&&uCode!=UNASSIGNED){var resCode=seqObj[uCode];if("object"==typeof resCode){seqObj=resCode;continue}"number"==typeof resCode?dbcsCode=resCode:null==resCode&&void 0!==(resCode=seqObj[-1])&&(dbcsCode=resCode,nextChar=uCode),seqObj=void 0}else if(uCode>=0){var subtable=this.encodeTable[uCode>>8];if(void 0!==subtable&&(dbcsCode=subtable[255&uCode]),dbcsCode<=-10){seqObj=this.encodeTableSeq[-10-dbcsCode];continue}if(dbcsCode==UNASSIGNED&&this.gb18030){var idx=findIdx(this.gb18030.uChars,uCode);if(-1!=idx){dbcsCode=this.gb18030.gbChars[idx]+(uCode-this.gb18030.uChars[idx]);newBuf[j++]=129+Math.floor(dbcsCode/12600),dbcsCode%=12600,newBuf[j++]=48+Math.floor(dbcsCode/1260),dbcsCode%=1260,newBuf[j++]=129+Math.floor(dbcsCode/10),dbcsCode%=10,newBuf[j++]=48+dbcsCode;continue}}}dbcsCode===UNASSIGNED&&(dbcsCode=this.defaultCharSingleByte),dbcsCode<256?newBuf[j++]=dbcsCode:dbcsCode<65536?(newBuf[j++]=dbcsCode>>8,newBuf[j++]=255&dbcsCode):(newBuf[j++]=dbcsCode>>16,newBuf[j++]=dbcsCode>>8&255,newBuf[j++]=255&dbcsCode)}return this.seqObj=seqObj,this.leadSurrogate=leadSurrogate,newBuf.slice(0,j)},DBCSEncoder.prototype.end=function(){if(-1!==this.leadSurrogate||void 0!==this.seqObj){var newBuf=Buffer.alloc(10),j=0;if(this.seqObj){var dbcsCode=this.seqObj[-1];void 0!==dbcsCode&&(dbcsCode<256?newBuf[j++]=dbcsCode:(newBuf[j++]=dbcsCode>>8,newBuf[j++]=255&dbcsCode)),this.seqObj=void 0}return-1!==this.leadSurrogate&&(newBuf[j++]=this.defaultCharSingleByte,this.leadSurrogate=-1),newBuf.slice(0,j)}},DBCSEncoder.prototype.findIdx=findIdx,DBCSDecoder.prototype.write=function(buf){var newBuf=Buffer.alloc(2*buf.length),nodeIdx=this.nodeIdx,prevBuf=this.prevBuf,prevBufOffset=this.prevBuf.length,seqStart=-this.prevBuf.length;prevBufOffset>0&&(prevBuf=Buffer.concat([prevBuf,buf.slice(0,10)]));for(var i=0,j=0;i<buf.length;i++){var uCode,curByte=i>=0?buf[i]:prevBuf[i+prevBufOffset];if((uCode=this.decodeTables[nodeIdx][curByte])>=0);else if(uCode===UNASSIGNED)i=seqStart,uCode=this.defaultCharUnicode.charCodeAt(0);else if(uCode===GB18030_CODE){var curSeq=seqStart>=0?buf.slice(seqStart,i+1):prevBuf.slice(seqStart+prevBufOffset,i+1+prevBufOffset),ptr=12600*(curSeq[0]-129)+1260*(curSeq[1]-48)+10*(curSeq[2]-129)+(curSeq[3]-48),idx=findIdx(this.gb18030.gbChars,ptr);uCode=this.gb18030.uChars[idx]+ptr-this.gb18030.gbChars[idx]}else{if(uCode<=NODE_START){nodeIdx=NODE_START-uCode;continue}if(!(uCode<=-10))throw new Error("iconv-lite internal error: invalid decoding table value "+uCode+" at "+nodeIdx+"/"+curByte);for(var seq=this.decodeTableSeq[-10-uCode],k=0;k<seq.length-1;k++)uCode=seq[k],newBuf[j++]=255&uCode,newBuf[j++]=uCode>>8;uCode=seq[seq.length-1]}if(uCode>65535){uCode-=65536;var uCodeLead=55296+Math.floor(uCode/1024);newBuf[j++]=255&uCodeLead,newBuf[j++]=uCodeLead>>8,uCode=56320+uCode%1024}newBuf[j++]=255&uCode,newBuf[j++]=uCode>>8,nodeIdx=0,seqStart=i+1}return this.nodeIdx=nodeIdx,this.prevBuf=seqStart>=0?buf.slice(seqStart):prevBuf.slice(seqStart+prevBufOffset),newBuf.slice(0,j).toString("ucs2")},DBCSDecoder.prototype.end=function(){for(var ret="";this.prevBuf.length>0;){ret+=this.defaultCharUnicode;var buf=this.prevBuf.slice(1);this.prevBuf=Buffer.alloc(0),this.nodeIdx=0,buf.length>0&&(ret+=this.write(buf))}return this.nodeIdx=0,ret}},function(module,exports,__webpack_require__){"use strict";module.exports={shiftjis:{type:"_dbcs",table:function(){return __webpack_require__(570)},encodeAdd:{"":92,"":126},encodeSkipVals:[{from:60736,to:63808}]},csshiftjis:"shiftjis",mskanji:"shiftjis",sjis:"shiftjis",windows31j:"shiftjis",ms31j:"shiftjis",xsjis:"shiftjis",windows932:"shiftjis",ms932:"shiftjis",932:"shiftjis",cp932:"shiftjis",eucjp:{type:"_dbcs",table:function(){return __webpack_require__(571)},encodeAdd:{"":92,"":126}},gb2312:"cp936",gb231280:"cp936",gb23121980:"cp936",csgb2312:"cp936",csiso58gb231280:"cp936",euccn:"cp936",windows936:"cp936",ms936:"cp936",936:"cp936",cp936:{type:"_dbcs",table:function(){return __webpack_require__(210)}},gbk:{type:"_dbcs",table:function(){return __webpack_require__(210).concat(__webpack_require__(323))}},xgbk:"gbk",isoir58:"gbk",gb18030:{type:"_dbcs",table:function(){return __webpack_require__(210).concat(__webpack_require__(323))},gb18030:function(){return __webpack_require__(572)},encodeSkipVals:[128],encodeAdd:{"":41699}},chinese:"gb18030",windows949:"cp949",ms949:"cp949",949:"cp949",cp949:{type:"_dbcs",table:function(){return __webpack_require__(573)}},cseuckr:"cp949",csksc56011987:"cp949",euckr:"cp949",isoir149:"cp949",korean:"cp949",ksc56011987:"cp949",ksc56011989:"cp949",ksc5601:"cp949",windows950:"cp950",ms950:"cp950",950:"cp950",cp950:{type:"_dbcs",table:function(){return __webpack_require__(324)}},big5:"big5hkscs",big5hkscs:{type:"_dbcs",table:function(){return __webpack_require__(324).concat(__webpack_require__(574))},encodeSkipVals:[41676]},cnbig5:"big5hkscs",csbig5:"big5hkscs",xxbig5:"big5hkscs"}},function(module){module.exports=JSON.parse('[["0","\\u0000",128],["a1","",62],["8140","",9,""],["8180",""],["81b8",""],["81c8",""],["81da",""],["81f0",""],["81fc",""],["824f","",9],["8260","",25],["8281","",25],["829f","",82],["8340","",62],["8380","",22],["839f","",16,"",6],["83bf","",16,"",6],["8440","",5,"",25],["8470","",5,"",7],["8480","",17],["849f",""],["8740","",19,"",9],["875f",""],["877e",""],["8780","",4,""],["889f",""],["8940",""],["8980",""],["8a40",""],["8a80",""],["8b40",""],["8b80",""],["8c40",""],["8c80",""],["8d40",""],["8d80",""],["8e40",""],["8e80",""],["8f40",""],["8f80",""],["9040",""],["9080",""],["9140",""],["9180",""],["9240",""],["9280",""],["9340",""],["9380",""],["9440",""],["9480",""],["9540",""],["9580",""],["9640",""],["9680",""],["9740",""],["9780",""],["9840",""],["989f",""],["9940",""],["9980",""],["9a40",""],["9a80",""],["9b40",""],["9b80",""],["9c40",""],["9c80",""],["9d40",""],["9d80",""],["9e40",""],["9e80",""],["9f40",""],["9f80",""],["e040",""],["e080",""],["e140",""],["e180",""],["e240",""],["e280",""],["e340",""],["e380",""],["e440",""],["e480",""],["e540",""],["e580",""],["e640",""],["e680",""],["e740",""],["e780",""],["e840",""],["e880",""],["e940",""],["e980",""],["ea40",""],["ea80",""],["ed40",""],["ed80",""],["ee40",""],["ee80",""],["eeef","",9,""],["f040","",62],["f080","",124],["f140","",62],["f180","",124],["f240","",62],["f280","",124],["f340","",62],["f380","",124],["f440","",62],["f480","",124],["f540","",62],["f580","",124],["f640","",62],["f680","",124],["f740","",62],["f780","",124],["f840","",62],["f880","",124],["f940",""],["fa40","",9,"",9,""],["fa80",""],["fb40",""],["fb80",""],["fc40",""]]')},function(module){module.exports=JSON.parse('[["0","\\u0000",127],["8ea1","",62],["a1a1","",9,""],["a2a1",""],["a2ba",""],["a2ca",""],["a2dc",""],["a2f2",""],["a2fe",""],["a3b0","",9],["a3c1","",25],["a3e1","",25],["a4a1","",82],["a5a1","",85],["a6a1","",16,"",6],["a6c1","",16,"",6],["a7a1","",5,"",25],["a7d1","",5,"",25],["a8a1",""],["ada1","",19,"",9],["adc0",""],["addf","",4,""],["b0a1",""],["b1a1",""],["b2a1",""],["b3a1",""],["b4a1",""],["b5a1",""],["b6a1",""],["b7a1",""],["b8a1",""],["b9a1",""],["baa1",""],["bba1",""],["bca1",""],["bda1",""],["bea1",""],["bfa1",""],["c0a1",""],["c1a1",""],["c2a1",""],["c3a1",""],["c4a1",""],["c5a1",""],["c6a1",""],["c7a1",""],["c8a1",""],["c9a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1",""],["d2a1",""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fcf1","",9,""],["8fa2af",""],["8fa2c2",""],["8fa2eb",""],["8fa6e1",""],["8fa6e7",""],["8fa6e9",""],["8fa6ec",""],["8fa6f1",""],["8fa7c2","",10,""],["8fa7f2","",10,""],["8fa9a1",""],["8fa9a4",""],["8fa9a6",""],["8fa9a8",""],["8fa9ab",""],["8fa9af",""],["8fa9c1",""],["8faaa1",""],["8faaba",""],["8faba1",""],["8fabbd",""],["8fabc5",""],["8fb0a1",""],["8fb1a1",""],["8fb2a1","",4,""],["8fb3a1",""],["8fb4a1",""],["8fb5a1",""],["8fb6a1","",5,"",4,""],["8fb7a1","",4,""],["8fb8a1",""],["8fb9a1",""],["8fbaa1","",4,""],["8fbba1",""],["8fbca1","",4,""],["8fbda1","",4,""],["8fbea1","",4,""],["8fbfa1",""],["8fc0a1",""],["8fc1a1",""],["8fc2a1",""],["8fc3a1","",4,""],["8fc4a1",""],["8fc5a1",""],["8fc6a1",""],["8fc7a1",""],["8fc8a1",""],["8fc9a1","",4,"",4,""],["8fcaa1",""],["8fcba1",""],["8fcca1","",9,""],["8fcda1","",5,""],["8fcea1","",6,""],["8fcfa1",""],["8fd0a1",""],["8fd1a1",""],["8fd2a1","",5],["8fd3a1",""],["8fd4a1","",4,""],["8fd5a1",""],["8fd6a1",""],["8fd7a1",""],["8fd8a1",""],["8fd9a1","",4,"",6,""],["8fdaa1","",4,""],["8fdba1","",6,""],["8fdca1","",4,""],["8fdda1","",4,""],["8fdea1","",4,""],["8fdfa1",""],["8fe0a1",""],["8fe1a1","",4,""],["8fe2a1",""],["8fe3a1","",5,"",4,""],["8fe4a1","",4,""],["8fe5a1","",4,""],["8fe6a1",""],["8fe7a1",""],["8fe8a1","",4,""],["8fe9a1","",4],["8feaa1","",4,""],["8feba1","",4,""],["8feca1",""],["8feda1","",4,"",4,""]]')},function(module){module.exports=JSON.parse('{"uChars":[128,165,169,178,184,216,226,235,238,244,248,251,253,258,276,284,300,325,329,334,364,463,465,467,469,471,473,475,477,506,594,610,712,716,730,930,938,962,970,1026,1104,1106,8209,8215,8218,8222,8231,8241,8244,8246,8252,8365,8452,8454,8458,8471,8482,8556,8570,8596,8602,8713,8720,8722,8726,8731,8737,8740,8742,8748,8751,8760,8766,8777,8781,8787,8802,8808,8816,8854,8858,8870,8896,8979,9322,9372,9548,9588,9616,9622,9634,9652,9662,9672,9676,9680,9702,9735,9738,9793,9795,11906,11909,11913,11917,11928,11944,11947,11951,11956,11960,11964,11979,12284,12292,12312,12319,12330,12351,12436,12447,12535,12543,12586,12842,12850,12964,13200,13215,13218,13253,13263,13267,13270,13384,13428,13727,13839,13851,14617,14703,14801,14816,14964,15183,15471,15585,16471,16736,17208,17325,17330,17374,17623,17997,18018,18212,18218,18301,18318,18760,18811,18814,18820,18823,18844,18848,18872,19576,19620,19738,19887,40870,59244,59336,59367,59413,59417,59423,59431,59437,59443,59452,59460,59478,59493,63789,63866,63894,63976,63986,64016,64018,64021,64025,64034,64037,64042,65074,65093,65107,65112,65127,65132,65375,65510,65536],"gbChars":[0,36,38,45,50,81,89,95,96,100,103,104,105,109,126,133,148,172,175,179,208,306,307,308,309,310,311,312,313,341,428,443,544,545,558,741,742,749,750,805,819,820,7922,7924,7925,7927,7934,7943,7944,7945,7950,8062,8148,8149,8152,8164,8174,8236,8240,8262,8264,8374,8380,8381,8384,8388,8390,8392,8393,8394,8396,8401,8406,8416,8419,8424,8437,8439,8445,8482,8485,8496,8521,8603,8936,8946,9046,9050,9063,9066,9076,9092,9100,9108,9111,9113,9131,9162,9164,9218,9219,11329,11331,11334,11336,11346,11361,11363,11366,11370,11372,11375,11389,11682,11686,11687,11692,11694,11714,11716,11723,11725,11730,11736,11982,11989,12102,12336,12348,12350,12384,12393,12395,12397,12510,12553,12851,12962,12973,13738,13823,13919,13933,14080,14298,14585,14698,15583,15847,16318,16434,16438,16481,16729,17102,17122,17315,17320,17402,17418,17859,17909,17911,17915,17916,17936,17939,17961,18664,18703,18814,18962,19043,33469,33470,33471,33484,33485,33490,33497,33501,33505,33513,33520,33536,33550,37845,37921,37948,38029,38038,38064,38065,38066,38069,38075,38076,38078,39108,39109,39113,39114,39115,39116,39265,39394,189000]}')},function(module){module.exports=JSON.parse('[["0","\\u0000",127],["8141","",4,"",6,""],["8161","",9,"",5,""],["8181","",18,"",4,"",6,"",5,"",6,"",7,"",7,"",4,"",4,""],["8241","",7,"",5],["8261","",6,"",5,""],["8281","",7,"",7,"",4,"",10,"",5,"",17,"",7,"",6,"",7,"",18],["8341","",5,"",5,"",7],["8361","",18,""],["8381","",4,"",6,"",5,"",5,"",46,"",6,"",5,"",8],["8441","",5,"",8],["8461","",18],["8481","",7,"",6,"",5,"",10,"",5,"",18,"",5,"",6,"",5,"",26,""],["8541","",5,"",4,"",6,"",4],["8561","",5,"",5,"",6,""],["8581","",6,"",6,"",9,"",26,"",29,"",6,"",5,""],["8641","",6,"",5,""],["8661","",6,"",10],["8681","",22,"",4,"",6,"",5,"",6,"",22,"",4,""],["8741","",9,"",15],["8761","",18,""],["8781","",5,"",7,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",4],["8841","",4,"",5,"",6,"",4],["8861","",4,""],["8881","",15,"",4,"",6,"",5,"",54,""],["8941","",6,"",5,""],["8961","",10,"",5,""],["8981","",21,"",18,"",18,"",6,"",6,"",7,"",15],["8a41","",10,"",6,""],["8a61","",4,"",18,""],["8a81","",4,"",19,"",5,"",7,"",5,"",6,"",5,"",4,"",5,"",26,""],["8b41","",5,"",4,"",6,""],["8b61","",6,"",8],["8b81","",52,"",4,"",6,"",5,"",18,"",18],["8c41","",15,"",4],["8c61","",6,"",5,"",6,"",5],["8c81","",12,"",26,"",50,"",5,"",16],["8d41","",16,"",8],["8d61","",17,""],["8d81","",4,"",33,"",6,"",7,"",6,"",9,"",6,"",5,"",6,""],["8e41","",6,"",5,"",8],["8e61","",4,"",19],["8e81","",13,"",6,"",4,"",6,"",5,"",6,"",5,"",11,"",7,"",6,"",5,"",7],["8f41","",7,"",17],["8f61","",7,"",6,"",4],["8f81","",5,"",7,"",5,"",6,"",5,"",18,"",6,"",26,"",6,"",5],["9041","",6,"",5,""],["9061","",5,"",15],["9081","",12,"",6,"",5,"",4,"",6,"",4,"",5,"",11,"",33,""],["9141","",6,"",5],["9161","",9,"",5],["9181","",20,"",4,"",5,"",14,"",33,"",7,"",5,"",6],["9241","",7,"",4,""],["9261","",7,"",7,"",4],["9281","",21,"",18,"",6,"",7,"",6,"",35,""],["9341","",4,""],["9361","",6,"",8],["9381","",37,"",4,"",4,"",6,"",5,"",7,"",22,""],["9441","",5,"",5,"",8],["9461","",5,"",6,"",12],["9481","",5,"",6,"",6,"",9,"",22,"",4,"",6,"",10,"",6,"",24],["9541","",11,"",5,""],["9561","",6,"",5,""],["9581","",6,"",35,"",4,"",4,"",4,"",6,"",5,"",13,"",14],["9641","",23,""],["9661","",6,"",5,"",8],["9681","",10,"",5,"",13,"",33,"",6,"",44],["9741","",16,"",8],["9761","",17,"",7],["9781","",11,"",5,"",6,"",89,""],["9841","",16,"",5,""],["9861","",6,"",15],["9881","",21,"",6,"",5,"",4,"",6,"",5,"",6,"",5,"",6,"",5,""],["9941","",6,"",5,""],["9961","",6,"",5,""],["9981","",8,"",5,"",4,"",11,"",5,"",6,"",6,"",6,"",7,"",6,"",5,""],["9a41","",16],["9a61","",6,"",6,""],["9a81","",4,"",6,"",5,"",5,"",6,"",5,"",5,"",33,"",5,"",6,""],["9b41","",6,"",8],["9b61","",17,"",7],["9b81","",25,"",4,"",5,"",50,"",22,""],["9c41","",4,"",5,"",5],["9c61","",8,"",6,"",9],["9c81","",8,"",6,"",6,"",9,"",26,"",6,"",5,"",18,"",6,"",12],["9d41","",13,"",8],["9d61","",25],["9d81","",8,"",5,"",9,"",6,"",10,"",6,"",5,"",6,"",5,""],["9e41","",7,"",9,""],["9e61","",4,"",6,""],["9e81","",6,"",6,"",6,"",5,"",10,"",5,"",6,"",5,"",6,""],["9f41","",5,"",4,"",5,""],["9f61","",6,"",5,""],["9f81","",4,"",5,"",6,"",5,"",6,"",4,"",6,"",7,"",4,"",4,""],["a041","",5,"",6,""],["a061","",5,"",13],["a081","",4,"",4,"",4,"",6,"",5,"",6,"",5,"",26,"",4,"",5,"",7,""],["a141","",18,""],["a161","",6,"",5,""],["a181","",14,"",5,"",4,"",9,""],["a241","",5,"",18],["a261","",6,"",18],["a281","",7,"",6,"",7,""],["a341","",6,"",10,""],["a361","",6,"",16],["a381","",16,"",4,"",58,"",32,""],["a441","",5,""],["a461","",5,"",12],["a481","",28,"",93],["a541","",4,"",6,"",5,""],["a561","",17,"",5,""],["a581","",16,"",14,"",9],["a5b0","",9],["a5c1","",16,"",6],["a5e1","",16,"",6],["a641","",19,""],["a661","",5,"",5,"",6],["a681","",6,"",18,"",7],["a741","",4,"",6,"",7],["a761","",22,""],["a781","",6,"",5,"",7,"",9,"",9,"",4,"",5,"",4,""],["a841","",10,"",14],["a861","",18,"",6],["a881","",19,"",11,""],["a8a6",""],["a8a8",""],["a8b1","",27,"",25,"",14,""],["a941","",14,"",10],["a961","",18],["a981","",14,"",6,"",27,"",25,"",14,""],["aa41","",6,"",4,""],["aa61","",4,"",5,"",6,""],["aa81","",29,"",82],["ab41","",6,"",5,""],["ab61","",6,"",5,"",5],["ab81","",8,"",6,"",12,"",85],["ac41","",5,"",6,""],["ac61","",11,"",4],["ac81","",28,"",5,"",25],["acd1","",5,"",25],["ad41","",6,"",5,"",7],["ad61","",6,"",10,""],["ad81","",5,"",18,""],["ae41","",5,"",16],["ae61","",5,"",6,"",4],["ae81","",6,"",5,""],["af41","",19],["af61","",13,"",5,""],["af81","",5,"",6,"",5,""],["b041","",5,"",5,"",12],["b061","",5,"",19],["b081","",13,"",6,"",5,"",7,"",4,""],["b141","",6,"",5,""],["b161","",6,"",5,"",11],["b181","",14,"",6,""],["b241","",6,"",5,""],["b261","",18,"",5,""],["b281","",5,"",18,"",6,""],["b341","",19,""],["b361","",5,"",5,"",5],["b381","",5,"",5,"",19,"",4,""],["b441","",5,"",6,"",5],["b461","",6,"",10,""],["b481","",6,"",18,"",4,"",4,""],["b541","",14,"",5],["b561","",5,"",5,"",4],["b581","",6,"",5,"",11,""],["b641","",7,"",17],["b661","",15,""],["b681","",5,"",6,"",5,""],["b741","",13,"",6,""],["b761","",20,""],["b781","",6,"",14,""],["b841","",7,"",17],["b861","",8,"",13],["b881","",5,"",24,"",4,""],["b941","",6,"",5,""],["b961","",14,"",6,""],["b981","",22,"",4,"",4,""],["ba41","",5,"",6,""],["ba61","",5,"",4,"",5],["ba81","",6,"",9,""],["bb41","",4,"",5,"",4,""],["bb61","",6,"",5,""],["bb81","",31,""],["bc41","",17,""],["bc61","",5,"",6,""],["bc81","",4,"",6,"",5,"",5,"",4,""],["bd41","",7,"",7,""],["bd61","",5,"",13],["bd81","",5,"",25,""],["be41","",7,"",14],["be61","",7,"",7,""],["be81","",4,"",4,"",5,"",8,"",6,""],["bf41","",10,"",14],["bf61","",18,""],["bf81","",5,"",7,"",6,"",5,""],["c041","",5,"",6,"",5],["c061","",25],["c081","",6,"",5,"",7,""],["c141","",5,"",6,""],["c161","",19,""],["c181","",31,""],["c241","",4,"",5,""],["c261","",4,"",5,"",6,""],["c281","",5,"",7,"",9,""],["c341","",4],["c361","",4,"",5,"",11],["c381","",5,"",7,"",5,""],["c441","",7,"",7,""],["c461","",5,"",4],["c481","",5,"",11,""],["c541","",6,"",5,""],["c561","",6,"",5,"",4],["c581","",6,"",5,""],["c641","",6,"",5],["c6a1",""],["c7a1",""],["c8a1",""],["caa1",""],["cba1",""],["cca1",""],["cda1",""],["cea1",""],["cfa1",""],["d0a1",""],["d1a1","",5,"",4,""],["d2a1","",4,"",5,"",10,"",7,"",5,""],["d3a1",""],["d4a1",""],["d5a1",""],["d6a1",""],["d7a1",""],["d8a1",""],["d9a1",""],["daa1",""],["dba1",""],["dca1",""],["dda1",""],["dea1",""],["dfa1",""],["e0a1",""],["e1a1",""],["e2a1",""],["e3a1",""],["e4a1",""],["e5a1",""],["e6a1",""],["e7a1",""],["e8a1",""],["e9a1",""],["eaa1",""],["eba1",""],["eca1",""],["eda1",""],["eea1",""],["efa1",""],["f0a1",""],["f1a1",""],["f2a1",""],["f3a1",""],["f4a1",""],["f5a1",""],["f6a1",""],["f7a1",""],["f8a1",""],["f9a1",""],["faa1",""],["fba1",""],["fca1",""],["fda1",""]]')},function(module){module.exports=JSON.parse('[["8740",""],["8767",""],["87a1",""],["8840","",4,""],["88a1",""],["8940",""],["8943",""],["8946",""],["894c",""],["89a1",""],["89ab",""],["89b0",""],["89b5",""],["89c1",""],["89c5",""],["8a40",""],["8a43",""],["8a64",""],["8a76",""],["8aa1",""],["8aac",""],["8ab2",""],["8abb",""],["8ac9",""],["8ace",""],["8adf",""],["8af6",""],["8b40",""],["8b55",""],["8ba1",""],["8bde",""],["8c40",""],["8ca1",""],["8ca7",""],["8cc9",""],["8cce",""],["8ce6",""],["8d40",""],["8d42",""],["8da1",""],["8e40",""],["8ea1",""],["8f40",""],["8fa1",""],["9040",""],["90a1",""],["9140",""],["91a1",""],["9240",""],["92a1",""],["9340",""],["93a1",""],["9440",""],["94a1",""],["9540",""],["95a1",""],["9640",""],["96a1",""],["9740",""],["97a1",""],["9840",""],["98a1",""],["9940",""],["99a1",""],["9a40",""],["9aa1",""],["9b40",""],["9b62",""],["9ba1",""],["9c40",""],["9ca1",""],["9d40",""],["9da1",""],["9e40",""],["9ea1",""],["9ead",""],["9ec5",""],["9ef5",""],["9f40",""],["9f4f",""],["9fa1",""],["9fae",""],["9fb2",""],["9fc1",""],["9fc9",""],["9fdb",""],["9fe7",""],["9feb",""],["9ff0",""],["a040",""],["a055",""],["a058",""],["a05b",""],["a063",""],["a073",""],["a0a1",""],["a0a6",""],["a0ae",""],["a0b0",""],["a0d4",""],["a0e2",""],["a3c0","",31,""],["c6a1","",9,"",9,"",9,"",23],["c740","",58,""],["c7a1","",81,"",5,"",4],["c840","",26,"",25,""],["c8a1",""],["c8cd",""],["c8f5",""],["f9fe",""],["fa40",""],["faa1",""],["fb40",""],["fba1",""],["fc40",""],["fca1",""],["fd40",""],["fda1",""],["fe40",""],["fea1",""]]')},function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(60).Buffer,Transform=__webpack_require__(11).Transform;function IconvLiteEncoderStream(conv,options){this.conv=conv,(options=options||{}).decodeStrings=!1,Transform.call(this,options)}function IconvLiteDecoderStream(conv,options){this.conv=conv,(options=options||{}).encoding=this.encoding="utf8",Transform.call(this,options)}module.exports=function(iconv){iconv.encodeStream=function(encoding,options){return new IconvLiteEncoderStream(iconv.getEncoder(encoding,options),options)},iconv.decodeStream=function(encoding,options){return new IconvLiteDecoderStream(iconv.getDecoder(encoding,options),options)},iconv.supportsStreams=!0,iconv.IconvLiteEncoderStream=IconvLiteEncoderStream,iconv.IconvLiteDecoderStream=IconvLiteDecoderStream,iconv._collect=IconvLiteDecoderStream.prototype.collect},IconvLiteEncoderStream.prototype=Object.create(Transform.prototype,{constructor:{value:IconvLiteEncoderStream}}),IconvLiteEncoderStream.prototype._transform=function(chunk,encoding,done){if("string"!=typeof chunk)return done(new Error("Iconv encoding stream needs strings as its input."));try{var res=this.conv.write(chunk);res&&res.length&&this.push(res),done()}catch(e){done(e)}},IconvLiteEncoderStream.prototype._flush=function(done){try{var res=this.conv.end();res&&res.length&&this.push(res),done()}catch(e){done(e)}},IconvLiteEncoderStream.prototype.collect=function(cb){var chunks=[];return this.on("error",cb),this.on("data",function(chunk){chunks.push(chunk)}),this.on("end",function(){cb(null,Buffer.concat(chunks))}),this},IconvLiteDecoderStream.prototype=Object.create(Transform.prototype,{constructor:{value:IconvLiteDecoderStream}}),IconvLiteDecoderStream.prototype._transform=function(chunk,encoding,done){if(!Buffer.isBuffer(chunk))return done(new Error("Iconv decoding stream needs buffers as its input."));try{var res=this.conv.write(chunk);res&&res.length&&this.push(res,this.encoding),done()}catch(e){done(e)}},IconvLiteDecoderStream.prototype._flush=function(done){try{var res=this.conv.end();res&&res.length&&this.push(res,this.encoding),done()}catch(e){done(e)}},IconvLiteDecoderStream.prototype.collect=function(cb){var res="";return this.on("error",cb),this.on("data",function(chunk){res+=chunk}),this.on("end",function(){cb(null,res)}),this}},function(module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(60).Buffer;module.exports=function(iconv){var original=void 0;iconv.supportsNodeEncodingsExtension=!(Buffer.from||new Buffer(0)instanceof Uint8Array),iconv.extendNodeEncodings=function(){if(!original){if(original={},!iconv.supportsNodeEncodingsExtension)return console.error("ACTION NEEDED: require('iconv-lite').extendNodeEncodings() is not supported in your version of Node"),void console.error("See more info at https://github.com/ashtuchkin/iconv-lite/wiki/Node-v4-compatibility");var nodeNativeEncodings={hex:!0,utf8:!0,"utf-8":!0,ascii:!0,binary:!0,base64:!0,ucs2:!0,"ucs-2":!0,utf16le:!0,"utf-16le":!0};Buffer.isNativeEncoding=function(enc){return enc&&nodeNativeEncodings[enc.toLowerCase()]};var SlowBuffer=__webpack_require__(60).SlowBuffer;if(original.SlowBufferToString=SlowBuffer.prototype.toString,SlowBuffer.prototype.toString=function(encoding,start,end){return encoding=String(encoding||"utf8").toLowerCase(),Buffer.isNativeEncoding(encoding)?original.SlowBufferToString.call(this,encoding,start,end):(void 0===start&&(start=0),void 0===end&&(end=this.length),iconv.decode(this.slice(start,end),encoding))},original.SlowBufferWrite=SlowBuffer.prototype.write,SlowBuffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset))isFinite(length)||(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=length,length=swap}offset=+offset||0;var remaining=this.length-offset;if(length?(length=+length)>remaining&&(length=remaining):length=remaining,encoding=String(encoding||"utf8").toLowerCase(),Buffer.isNativeEncoding(encoding))return original.SlowBufferWrite.call(this,string,offset,length,encoding);if(string.length>0&&(length<0||offset<0))throw new RangeError("attempt to write beyond buffer bounds");var buf=iconv.encode(string,encoding);return buf.length<length&&(length=buf.length),buf.copy(this,offset,0,length),length},original.BufferIsEncoding=Buffer.isEncoding,Buffer.isEncoding=function(encoding){return Buffer.isNativeEncoding(encoding)||iconv.encodingExists(encoding)},original.BufferByteLength=Buffer.byteLength,Buffer.byteLength=SlowBuffer.byteLength=function(str,encoding){return encoding=String(encoding||"utf8").toLowerCase(),Buffer.isNativeEncoding(encoding)?original.BufferByteLength.call(this,str,encoding):iconv.encode(str,encoding).length},original.BufferToString=Buffer.prototype.toString,Buffer.prototype.toString=function(encoding,start,end){return encoding=String(encoding||"utf8").toLowerCase(),Buffer.isNativeEncoding(encoding)?original.BufferToString.call(this,encoding,start,end):(void 0===start&&(start=0),void 0===end&&(end=this.length),iconv.decode(this.slice(start,end),encoding))},original.BufferWrite=Buffer.prototype.write,Buffer.prototype.write=function(string,offset,length,encoding){var _offset=offset,_length=length,_encoding=encoding;if(isFinite(offset))isFinite(length)||(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=length,length=swap}if(encoding=String(encoding||"utf8").toLowerCase(),Buffer.isNativeEncoding(encoding))return original.BufferWrite.call(this,string,_offset,_length,_encoding);offset=+offset||0;var remaining=this.length-offset;if(length?(length=+length)>remaining&&(length=remaining):length=remaining,string.length>0&&(length<0||offset<0))throw new RangeError("attempt to write beyond buffer bounds");var buf=iconv.encode(string,encoding);return buf.length<length&&(length=buf.length),buf.copy(this,offset,0,length),length},iconv.supportsStreams){var Readable=__webpack_require__(11).Readable;original.ReadableSetEncoding=Readable.prototype.setEncoding,Readable.prototype.setEncoding=function(enc,options){this._readableState.decoder=iconv.getDecoder(enc,options),this._readableState.encoding=enc},Readable.prototype.collect=iconv._collect}}},iconv.undoExtendNodeEncodings=function(){if(iconv.supportsNodeEncodingsExtension){if(!original)throw new Error("require('iconv-lite').undoExtendNodeEncodings(): Nothing to undo; extendNodeEncodings() is not called.");delete Buffer.isNativeEncoding;var SlowBuffer=__webpack_require__(60).SlowBuffer;if(SlowBuffer.prototype.toString=original.SlowBufferToString,SlowBuffer.prototype.write=original.SlowBufferWrite,Buffer.isEncoding=original.BufferIsEncoding,Buffer.byteLength=original.BufferByteLength,Buffer.prototype.toString=original.BufferToString,Buffer.prototype.write=original.BufferWrite,iconv.supportsStreams){var Readable=__webpack_require__(11).Readable;Readable.prototype.setEncoding=original.ReadableSetEncoding,delete Readable.prototype.collect}original=void 0}}}},function(module,exports,__webpack_require__){"use strict";var Iconv;try{"iconv",Iconv=__webpack_require__(578)("iconv").Iconv}catch(E){}module.exports=Iconv},function(module,exports){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,module.exports=webpackEmptyContext,webpackEmptyContext.id=578},,,function(module,exports){module.exports=function(array,setter,iteratee,accumulator){for(var index=-1,length=null==array?0:array.length;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}},function(module,exports,__webpack_require__){var baseEach=__webpack_require__(134);module.exports=function(collection,setter,iteratee,accumulator){return baseEach(collection,function(value,key,collection){setter(accumulator,value,iteratee(value),collection)}),accumulator}},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(35),baseIteratee=__webpack_require__(18),baseMap=__webpack_require__(322),baseSortBy=__webpack_require__(584),baseUnary=__webpack_require__(88),compareMultiple=__webpack_require__(585),identity=__webpack_require__(99);module.exports=function(collection,iteratees,orders){var index=-1;iteratees=arrayMap(iteratees.length?iteratees:[identity],baseUnary(baseIteratee));var result=baseMap(collection,function(value,key,collection){return{criteria:arrayMap(iteratees,function(iteratee){return iteratee(value)}),index:++index,value:value}});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders)})}},function(module,exports){module.exports=function(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}},function(module,exports,__webpack_require__){var compareAscending=__webpack_require__(586);module.exports=function(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=compareAscending(objCriteria[index],othCriteria[index]);if(result)return index>=ordersLength?result:result*("desc"==orders[index]?-1:1)}return object.index-other.index}},function(module,exports,__webpack_require__){var isSymbol=__webpack_require__(91);module.exports=function(value,other){if(value!==other){var valIsDefined=void 0!==value,valIsNull=null===value,valIsReflexive=value==value,valIsSymbol=isSymbol(value),othIsDefined=void 0!==other,othIsNull=null===other,othIsReflexive=other==other,othIsSymbol=isSymbol(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&value>other||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive)return 1;if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive)return-1}return 0}},function(module,exports){module.exports=function(dirtyDate){var date=new Date(dirtyDate.getTime()),baseTimezoneOffset=date.getTimezoneOffset();return date.setSeconds(0,0),6e4*baseTimezoneOffset+date.getTime()%6e4}},,function(module,exports,__webpack_require__){var copyObject=__webpack_require__(78),keysIn=__webpack_require__(117);module.exports=function(object,source){return object&&copyObject(source,keysIn(source),object)}},function(module,exports,__webpack_require__){var copyObject=__webpack_require__(78),getSymbols=__webpack_require__(204);module.exports=function(source,object){return copyObject(source,getSymbols(source),object)}},function(module,exports,__webpack_require__){var copyObject=__webpack_require__(78),getSymbolsIn=__webpack_require__(326);module.exports=function(source,object){return copyObject(source,getSymbolsIn(source),object)}},function(module,exports){var hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}},function(module,exports,__webpack_require__){var cloneArrayBuffer=__webpack_require__(202),cloneDataView=__webpack_require__(594),cloneRegExp=__webpack_require__(595),cloneSymbol=__webpack_require__(596),cloneTypedArray=__webpack_require__(307),boolTag="[object Boolean]",dateTag="[object Date]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";module.exports=function(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return cloneArrayBuffer(object);case boolTag:case dateTag:return new Ctor(+object);case dataViewTag:return cloneDataView(object,isDeep);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:return cloneTypedArray(object,isDeep);case mapTag:return new Ctor;case numberTag:case stringTag:return new Ctor(object);case regexpTag:return cloneRegExp(object);case setTag:return new Ctor;case symbolTag:return cloneSymbol(object)}}},function(module,exports,__webpack_require__){var cloneArrayBuffer=__webpack_require__(202);module.exports=function(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}},function(module,exports){var reFlags=/\w*$/;module.exports=function(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));return result.lastIndex=regexp.lastIndex,result}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(97),symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;module.exports=function(symbol){return symbolValueOf?Object(symbolValueOf.call(symbol)):{}}},function(module,exports,__webpack_require__){var baseIsMap=__webpack_require__(598),baseUnary=__webpack_require__(88),nodeUtil=__webpack_require__(196),nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;module.exports=isMap},function(module,exports,__webpack_require__){var getTag=__webpack_require__(109),isObjectLike=__webpack_require__(29),mapTag="[object Map]";module.exports=function(value){return isObjectLike(value)&&getTag(value)==mapTag}},function(module,exports,__webpack_require__){var baseIsSet=__webpack_require__(600),baseUnary=__webpack_require__(88),nodeUtil=__webpack_require__(196),nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;module.exports=isSet},function(module,exports,__webpack_require__){var getTag=__webpack_require__(109),isObjectLike=__webpack_require__(29),setTag="[object Set]";module.exports=function(value){return isObjectLike(value)&&getTag(value)==setTag}},function(module,exports,__webpack_require__){var castPath=__webpack_require__(100),last=__webpack_require__(271),parent=__webpack_require__(602),toKey=__webpack_require__(92);module.exports=function(object,path){return path=castPath(path,object),null==(object=parent(object,path))||delete object[toKey(last(path))]}},function(module,exports,__webpack_require__){var baseGet=__webpack_require__(154),baseSlice=__webpack_require__(276);module.exports=function(object,path){return path.length<2?object:baseGet(object,baseSlice(path,0,-1))}},function(module,exports,__webpack_require__){var isPlainObject=__webpack_require__(183);module.exports=function(value){return isPlainObject(value)?void 0:value}},function(module,exports,__webpack_require__){var asciiSize=__webpack_require__(605),hasUnicode=__webpack_require__(212),unicodeSize=__webpack_require__(606);module.exports=function(string){return hasUnicode(string)?unicodeSize(string):asciiSize(string)}},function(module,exports,__webpack_require__){var asciiSize=__webpack_require__(208)("length");module.exports=asciiSize},function(module,exports){var rsAstral="[\\ud800-\\udfff]",rsCombo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsNonAstral="[^\\ud800-\\udfff]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",reOptMod="(?:"+rsCombo+"|"+rsFitz+")"+"?",rsSeq="[\\ufe0e\\ufe0f]?"+reOptMod+("(?:\\u200d(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")[\\ufe0e\\ufe0f]?"+reOptMod+")*"),rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");module.exports=function(string){for(var result=reUnicode.lastIndex=0;reUnicode.test(string);)++result;return result}},,function(module,exports){module.exports=function(array,iteratee){for(var result,index=-1,length=array.length;++index<length;){var current=iteratee(array[index]);void 0!==current&&(result=void 0===result?current:result+current)}return result}},function(module,exports){function _typeof2(obj){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _typeof(obj){return"function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?module.exports=_typeof=function(obj){return _typeof2(obj)}:module.exports=_typeof=function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}module.exports=_typeof},function(module,exports){function _setPrototypeOf(o,p){return module.exports=_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}module.exports=_setPrototypeOf},function(module,exports){module.exports=function(arr){if(Array.isArray(arr))return arr}},function(module,exports){module.exports=function(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}},function(module,exports){module.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(module,exports,__webpack_require__){const levels={secret:0,debug:10,info:20,warn:30,error:40,ok:50,critical:50},Secret=__webpack_require__(328);module.exports={filterSecrets:function(level,type,message){if("secret"!==type&&message instanceof Secret)throw new Error("You should log a secret with log.secret")},filterLevel:function(level,type){return levels[type]>=levels[level]}}},function(module,exports,__webpack_require__){const prodFormat=__webpack_require__(616);__webpack_require__(617);module.exports=prodFormat},function(module,exports,__webpack_require__){const stringify=__webpack_require__(387),LOG_LENGTH_LIMIT=65535;module.exports=function(type,message,label,namespace){const log={time:new Date,type:type,label:label,namespace:namespace};"object"==typeof message?(message&&message.no_retry&&(log.no_retry=message.no_retry),message&&message.message&&(log.message=message.message)):log.message=message,log.message&&log.message.stack&&(log.message=log.message.stack);let result=log;try{result=stringify(log).substr(0,LOG_LENGTH_LIMIT)}catch(err){console.log(err.message,"cozy-logger: Failed to convert message to JSON")}return result}},function(module,exports,__webpack_require__){const util=__webpack_require__(8),chalk=__webpack_require__(425);util&&util.inspect&&util.inspect.defaultOptions&&(util.inspect.defaultOptions.maxArrayLength=null,util.inspect.defaultOptions.depth=2,util.inspect.defaultOptions.colors=!0);const type2color={debug:"cyan",warn:"yellow",info:"blue",error:"red",ok:"green",secret:"red",critical:"red"};module.exports=function(type,message,label,namespace){let formatmessage=message;"string"!=typeof formatmessage&&(formatmessage=util.inspect(formatmessage));let formatlabel=label?` : "${label}" `:"",formatnamespace=namespace?chalk.magenta(`${namespace}: `):"",color=type2color[type];return`${formatnamespace}${color?chalk[color](type):type}${formatlabel} : ${formatmessage}`}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.getKey=exports.prefix=void 0;exports.prefix="flag__";var getKey=function(name){return"flag__"+name};exports.getKey=getKey;var listFlagLocalStorage=function(){return Object.keys(localStorage).filter(function(x){return 0===x.indexOf("flag__")}).map(function(x){return x.replace("flag__","")})},getItem=function(flag){var val=localStorage.getItem(getKey(flag));return val?JSON.parse(val):val},removeItem=function(flag){return localStorage.removeItem(getKey(flag))},_default={getAll:function(){var res={},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=listFlagLocalStorage()[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var flag=_step.value;res[flag]=getItem(flag)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return res},getItem:getItem,setItem:function(flag,value){var str=JSON.stringify(value);return localStorage.setItem(getKey(flag),str)},clearAll:function(){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=listFlagLocalStorage()[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var flag=_step2.value;removeItem(flag)}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}},removeItem:removeItem};exports.default=_default},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(49);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _classCallCheck2=_interopRequireDefault(__webpack_require__(21)),_createClass2=_interopRequireDefault(__webpack_require__(30)),_possibleConstructorReturn2=_interopRequireDefault(__webpack_require__(39)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(37)),_assertThisInitialized2=_interopRequireDefault(__webpack_require__(272)),_inherits2=_interopRequireDefault(__webpack_require__(40)),_react=_interopRequireDefault(__webpack_require__(250)),_flag=_interopRequireDefault(__webpack_require__(213)),_default=function(Component){var Wrapped=function(_React$Component){function Wrapped(props){var _this;return(0,_classCallCheck2.default)(this,Wrapped),(_this=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(Wrapped).call(this,props))).handleChange=_this.handleChange.bind((0,_assertThisInitialized2.default)(_this)),_this}return(0,_inherits2.default)(Wrapped,_React$Component),(0,_createClass2.default)(Wrapped,[{key:"componentDidMount",value:function(){_flag.default.store.on("change",this.handleChange)}},{key:"componentWillUnmount",value:function(){_flag.default.store.removeListener("change",this.handleChange)}},{key:"handleChange",value:function(){this.forceUpdate()}},{key:"render",value:function(){return _react.default.createElement(Component,this.props)}}]),Wrapped}(_react.default.Component);return Wrapped.displayName="flag_"+Component.displayName,Wrapped};exports.default=_default},function(module,exports,__webpack_require__){"use strict";
/** @license React v16.9.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h=__webpack_require__(621),n="function"==typeof Symbol&&Symbol.for,p=n?Symbol.for("react.element"):60103,q=n?Symbol.for("react.portal"):60106,r=n?Symbol.for("react.fragment"):60107,t=n?Symbol.for("react.strict_mode"):60108,u=n?Symbol.for("react.profiler"):60114,v=n?Symbol.for("react.provider"):60109,w=n?Symbol.for("react.context"):60110,x=n?Symbol.for("react.forward_ref"):60112,y=n?Symbol.for("react.suspense"):60113,aa=n?Symbol.for("react.suspense_list"):60120,ba=n?Symbol.for("react.memo"):60115,ca=n?Symbol.for("react.lazy"):60116;n&&Symbol.for("react.fundamental"),n&&Symbol.for("react.responder");var z="function"==typeof Symbol&&Symbol.iterator;function A(a){for(var b=a.message,d="https://reactjs.org/docs/error-decoder.html?invariant="+b,c=1;c<arguments.length;c++)d+="&args[]="+encodeURIComponent(arguments[c]);return a.message="Minified React error #"+b+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",a}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C={};function D(a,b,d){this.props=a,this.context=b,this.refs=C,this.updater=d||B}function E(){}function F(a,b,d){this.props=a,this.context=b,this.refs=C,this.updater=d||B}D.prototype.isReactComponent={},D.prototype.setState=function(a,b){if("object"!=typeof a&&"function"!=typeof a&&null!=a)throw A(Error(85));this.updater.enqueueSetState(this,a,b,"setState")},D.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")},E.prototype=D.prototype;var G=F.prototype=new E;G.constructor=F,h(G,D.prototype),G.isPureReactComponent=!0;var H={current:null},I={suspense:null},J={current:null},K=Object.prototype.hasOwnProperty,L={key:!0,ref:!0,__self:!0,__source:!0};function M(a,b,d){var c=void 0,e={},g=null,k=null;if(null!=b)for(c in void 0!==b.ref&&(k=b.ref),void 0!==b.key&&(g=""+b.key),b)K.call(b,c)&&!L.hasOwnProperty(c)&&(e[c]=b[c]);var f=arguments.length-2;if(1===f)e.children=d;else if(1<f){for(var l=Array(f),m=0;m<f;m++)l[m]=arguments[m+2];e.children=l}if(a&&a.defaultProps)for(c in f=a.defaultProps)void 0===e[c]&&(e[c]=f[c]);return{$$typeof:p,type:a,key:g,ref:k,props:e,_owner:J.current}}function N(a){return"object"==typeof a&&null!==a&&a.$$typeof===p}var O=/\/+/g,P=[];function Q(a,b,d,c){if(P.length){var e=P.pop();return e.result=a,e.keyPrefix=b,e.func=d,e.context=c,e.count=0,e}return{result:a,keyPrefix:b,func:d,context:c,count:0}}function R(a){a.result=null,a.keyPrefix=null,a.func=null,a.context=null,a.count=0,10>P.length&&P.push(a)}function U(a,b,d){return null==a?0:function S(a,b,d,c){var e=typeof a;"undefined"!==e&&"boolean"!==e||(a=null);var g=!1;if(null===a)g=!0;else switch(e){case"string":case"number":g=!0;break;case"object":switch(a.$$typeof){case p:case q:g=!0}}if(g)return d(c,a,""===b?"."+T(a,0):b),1;if(g=0,b=""===b?".":b+":",Array.isArray(a))for(var k=0;k<a.length;k++){var f=b+T(e=a[k],k);g+=S(e,f,d,c)}else if(f=null===a||"object"!=typeof a?null:"function"==typeof(f=z&&a[z]||a["@@iterator"])?f:null,"function"==typeof f)for(a=f.call(a),k=0;!(e=a.next()).done;)g+=S(e=e.value,f=b+T(e,k++),d,c);else if("object"===e)throw d=""+a,A(Error(31),"[object Object]"===d?"object with keys {"+Object.keys(a).join(", ")+"}":d,"");return g}(a,"",b,d)}function T(a,b){return"object"==typeof a&&null!==a&&null!=a.key?function(a){var b={"=":"=0",":":"=2"};return"$"+(""+a).replace(/[=:]/g,function(a){return b[a]})}(a.key):b.toString(36)}function ea(a,b){a.func.call(a.context,b,a.count++)}function fa(a,b,d){var c=a.result,e=a.keyPrefix;a=a.func.call(a.context,b,a.count++),Array.isArray(a)?V(a,c,d,function(a){return a}):null!=a&&(N(a)&&(a=function(a,b){return{$$typeof:p,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}(a,e+(!a.key||b&&b.key===a.key?"":(""+a.key).replace(O,"$&/")+"/")+d)),c.push(a))}function V(a,b,d,c,e){var g="";null!=d&&(g=(""+d).replace(O,"$&/")+"/"),U(a,fa,b=Q(b,g,c,e)),R(b)}function W(){var a=H.current;if(null===a)throw A(Error(321));return a}var X={Children:{map:function(a,b,d){if(null==a)return a;var c=[];return V(a,c,null,b,d),c},forEach:function(a,b,d){if(null==a)return a;U(a,ea,b=Q(null,null,b,d)),R(b)},count:function(a){return U(a,function(){return null},null)},toArray:function(a){var b=[];return V(a,b,null,function(a){return a}),b},only:function(a){if(!N(a))throw A(Error(143));return a}},createRef:function(){return{current:null}},Component:D,PureComponent:F,createContext:function(a,b){return void 0===b&&(b=null),(a={$$typeof:w,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:v,_context:a},a.Consumer=a},forwardRef:function(a){return{$$typeof:x,render:a}},lazy:function(a){return{$$typeof:ca,_ctor:a,_status:-1,_result:null}},memo:function(a,b){return{$$typeof:ba,type:a,compare:void 0===b?null:b}},useCallback:function(a,b){return W().useCallback(a,b)},useContext:function(a,b){return W().useContext(a,b)},useEffect:function(a,b){return W().useEffect(a,b)},useImperativeHandle:function(a,b,d){return W().useImperativeHandle(a,b,d)},useDebugValue:function(){},useLayoutEffect:function(a,b){return W().useLayoutEffect(a,b)},useMemo:function(a,b){return W().useMemo(a,b)},useReducer:function(a,b,d){return W().useReducer(a,b,d)},useRef:function(a){return W().useRef(a)},useState:function(a){return W().useState(a)},Fragment:r,Profiler:u,StrictMode:t,Suspense:y,unstable_SuspenseList:aa,createElement:M,cloneElement:function(a,b,d){if(null==a)throw A(Error(267),a);var c=void 0,e=h({},a.props),g=a.key,k=a.ref,f=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,f=J.current),void 0!==b.key&&(g=""+b.key);var l=void 0;for(c in a.type&&a.type.defaultProps&&(l=a.type.defaultProps),b)K.call(b,c)&&!L.hasOwnProperty(c)&&(e[c]=void 0===b[c]&&void 0!==l?l[c]:b[c])}if(1===(c=arguments.length-2))e.children=d;else if(1<c){l=Array(c);for(var m=0;m<c;m++)l[m]=arguments[m+2];e.children=l}return{$$typeof:p,type:a.type,key:g,ref:k,props:e,_owner:f}},createFactory:function(a){var b=M.bind(null,a);return b.type=a,b},isValidElement:N,version:"16.9.0",unstable_withSuspenseConfig:function(a,b){var d=I.suspense;I.suspense=void 0===b?null:b;try{a()}finally{I.suspense=d}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:H,ReactCurrentBatchConfig:I,ReactCurrentOwner:J,IsSomeRendererActing:{current:!1},assign:h}},Y={default:X},Z=Y&&X||Y;module.exports=Z.default||Z},function(module,exports,__webpack_require__){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(val){if(null==val)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(val)}module.exports=function(){try{if(!Object.assign)return!1;var test1=new String("abc");if(test1[5]="de","5"===Object.getOwnPropertyNames(test1)[0])return!1;for(var test2={},i=0;i<10;i++)test2["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(test2).map(function(n){return test2[n]}).join(""))return!1;var test3={};return"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},test3)).join("")}catch(err){return!1}}()?Object.assign:function(target,source){for(var from,symbols,to=toObject(target),s=1;s<arguments.length;s++){for(var key in from=Object(arguments[s]))hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to}},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(49);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _classCallCheck2=_interopRequireDefault(__webpack_require__(21)),_createClass2=_interopRequireDefault(__webpack_require__(30)),_possibleConstructorReturn2=_interopRequireDefault(__webpack_require__(39)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(37)),_inherits2=_interopRequireDefault(__webpack_require__(40)),_react=_interopRequireDefault(__webpack_require__(250)),_flag=_interopRequireDefault(__webpack_require__(213)),FlagInput=function(_ref){var name=_ref.name,_onChange=_ref.onChange;return _react.default.createElement("input",{type:"checkbox",checked:(0,_flag.default)(name),onChange:function(ev){return(0,_flag.default)(name,JSON.parse(ev.target.checked))&&_onChange&&_onChange()}})},FoldButton=function(_ref2){var children=_ref2.children,onClick=_ref2.onClick;return _react.default.createElement("button",{type:"button",onClick:onClick,style:{position:"absolute",top:"100%",left:"0"}},children)},FlagList=_flag.default.connect(function(){var allFlags=_flag.default.list();return _react.default.createElement("div",null,allFlags.map(function(name){return _react.default.createElement("div",{key:name},function(name){return name.replace(/[a-z][A-Z]/g,function(str){return str[0]+" "+str[1].toLowerCase()})}(name)," : ",_react.default.createElement(FlagInput,{onChange:function(){},name:name}))}))}),FlagSwitcher=function(_React$Component){function FlagSwitcher(props){var _this;return(0,_classCallCheck2.default)(this,FlagSwitcher),(_this=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(FlagSwitcher).call(this,props))).state={folded:!0},_this}return(0,_inherits2.default)(FlagSwitcher,_React$Component),(0,_createClass2.default)(FlagSwitcher,[{key:"render",value:function(){var state,_this2=this;return(0,_flag.default)("switcher")&&_react.default.createElement("div",{className:"flag-switcher",style:(state=this.state,{borderBottomLeftRadius:".5rem",padding:".5rem",position:"absolute",zIndex:1e3,color:"white",background:"rgba(74,68,90,0.85)",top:0,right:0,transform:"translateY(".concat(state.folded?"-100%":"0",")")})},_react.default.createElement(FoldButton,{onClick:function(){return _this2.setState(function(prevState){return{folded:!prevState.folded}})}},this.state.folded?"Show":"Hide"," flags"),_react.default.createElement("button",{onClick:function(){return _this2.setState({date:Date.now()})}},"refresh"),"",_react.default.createElement("button",{onClick:function(){return _flag.default.reset()&&(0,_flag.default)("switcher",!0)&&_this2.forceUpdate()}},"reset"),_react.default.createElement(FlagList,null))}}]),FlagSwitcher}(_react.default.Component);exports.default=FlagSwitcher,FlagSwitcher.List=FlagList},function(module,exports,__webpack_require__){__webpack_require__(79),__webpack_require__(628),module.exports=__webpack_require__(9).Array.from},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(215),defined=__webpack_require__(216);module.exports=function(TO_STRING){return function(that,pos){var a,b,s=String(defined(that)),i=toInteger(pos),l=s.length;return i<0||i>=l?TO_STRING?"":void 0:(a=s.charCodeAt(i))<55296||a>56319||i+1===l||(b=s.charCodeAt(i+1))<56320||b>57343?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):b-56320+(a-55296<<10)+65536}}},function(module,exports,__webpack_require__){"use strict";var create=__webpack_require__(156),descriptor=__webpack_require__(122),setToStringTag=__webpack_require__(124),IteratorPrototype={};__webpack_require__(64)(IteratorPrototype,__webpack_require__(20)("iterator"),function(){return this}),module.exports=function(Constructor,NAME,next){Constructor.prototype=create(IteratorPrototype,{next:descriptor(1,next)}),setToStringTag(Constructor,NAME+" Iterator")}},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(65),toLength=__webpack_require__(157),toAbsoluteIndex=__webpack_require__(627);module.exports=function(IS_INCLUDES){return function($this,el,fromIndex){var value,O=toIObject($this),length=toLength(O.length),index=toAbsoluteIndex(fromIndex,length);if(IS_INCLUDES&&el!=el){for(;length>index;)if((value=O[index++])!=value)return!0}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(215),max=Math.max,min=Math.min;module.exports=function(index,length){return(index=toInteger(index))<0?max(index+length,0):min(index,length)}},function(module,exports,__webpack_require__){"use strict";var ctx=__webpack_require__(51),$export=__webpack_require__(14),toObject=__webpack_require__(82),call=__webpack_require__(336),isArrayIter=__webpack_require__(337),toLength=__webpack_require__(157),createProperty=__webpack_require__(629),getIterFn=__webpack_require__(224);$export($export.S+$export.F*!__webpack_require__(338)(function(iter){Array.from(iter)}),"Array",{from:function(arrayLike){var length,result,step,iterator,O=toObject(arrayLike),C="function"==typeof this?this:Array,aLen=arguments.length,mapfn=aLen>1?arguments[1]:void 0,mapping=void 0!==mapfn,index=0,iterFn=getIterFn(O);if(mapping&&(mapfn=ctx(mapfn,aLen>2?arguments[2]:void 0,2)),null==iterFn||C==Array&&isArrayIter(iterFn))for(result=new C(length=toLength(O.length));length>index;index++)createProperty(result,index,mapping?mapfn(O[index],index):O[index]);else for(iterator=iterFn.call(O),result=new C;!(step=iterator.next()).done;index++)createProperty(result,index,mapping?call(iterator,mapfn,[step.value,index],!0):step.value);return result.length=index,result}})},function(module,exports,__webpack_require__){"use strict";var $defineProperty=__webpack_require__(38),createDesc=__webpack_require__(122);module.exports=function(object,index,value){index in object?$defineProperty.f(object,index,createDesc(0,value)):object[index]=value}},function(module,exports,__webpack_require__){__webpack_require__(631),module.exports=__webpack_require__(9).Object.assign},function(module,exports,__webpack_require__){var $export=__webpack_require__(14);$export($export.S+$export.F,"Object",{assign:__webpack_require__(632)})},function(module,exports,__webpack_require__){"use strict";var DESCRIPTORS=__webpack_require__(24),getKeys=__webpack_require__(102),gOPS=__webpack_require__(225),pIE=__webpack_require__(125),toObject=__webpack_require__(82),IObject=__webpack_require__(220),$assign=Object.assign;module.exports=!$assign||__webpack_require__(80)(function(){var A={},B={},S=Symbol(),K="abcdefghijklmnopqrst";return A[S]=7,K.split("").forEach(function(k){B[k]=k}),7!=$assign({},A)[S]||Object.keys($assign({},B)).join("")!=K})?function(target,source){for(var T=toObject(target),aLen=arguments.length,index=1,getSymbols=gOPS.f,isEnum=pIE.f;aLen>index;)for(var key,S=IObject(arguments[index++]),keys=getSymbols?getKeys(S).concat(getSymbols(S)):getKeys(S),length=keys.length,j=0;length>j;)key=keys[j++],DESCRIPTORS&&!isEnum.call(S,key)||(T[key]=S[key]);return T}:$assign},function(module,exports,__webpack_require__){__webpack_require__(634),module.exports=__webpack_require__(9).Object.getPrototypeOf},function(module,exports,__webpack_require__){var toObject=__webpack_require__(82),$getPrototypeOf=__webpack_require__(335);__webpack_require__(160)("getPrototypeOf",function(){return function(it){return $getPrototypeOf(toObject(it))}})},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(636),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(79),__webpack_require__(103),module.exports=__webpack_require__(226).f("iterator")},function(module,exports,__webpack_require__){"use strict";var addToUnscopables=__webpack_require__(638),step=__webpack_require__(340),Iterators=__webpack_require__(101),toIObject=__webpack_require__(65);module.exports=__webpack_require__(217)(Array,"Array",function(iterated,kind){this._t=toIObject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,step(1)):step(0,"keys"==kind?index:"values"==kind?O[index]:[index,O[index]])},"values"),Iterators.Arguments=Iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries")},function(module,exports){module.exports=function(){}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(640),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(641),__webpack_require__(162),__webpack_require__(644),__webpack_require__(645),module.exports=__webpack_require__(9).Symbol},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(19),has=__webpack_require__(81),DESCRIPTORS=__webpack_require__(24),$export=__webpack_require__(14),redefine=__webpack_require__(331),META=__webpack_require__(161).KEY,$fails=__webpack_require__(80),shared=__webpack_require__(222),setToStringTag=__webpack_require__(124),uid=__webpack_require__(158),wks=__webpack_require__(20),wksExt=__webpack_require__(226),wksDefine=__webpack_require__(227),enumKeys=__webpack_require__(642),isArray=__webpack_require__(341),anObject=__webpack_require__(45),isObject=__webpack_require__(32),toObject=__webpack_require__(82),toIObject=__webpack_require__(65),toPrimitive=__webpack_require__(219),createDesc=__webpack_require__(122),_create=__webpack_require__(156),gOPNExt=__webpack_require__(643),$GOPD=__webpack_require__(228),$GOPS=__webpack_require__(225),$DP=__webpack_require__(38),$keys=__webpack_require__(102),gOPD=$GOPD.f,dP=$DP.f,gOPN=gOPNExt.f,$Symbol=global.Symbol,$JSON=global.JSON,_stringify=$JSON&&$JSON.stringify,HIDDEN=wks("_hidden"),TO_PRIMITIVE=wks("toPrimitive"),isEnum={}.propertyIsEnumerable,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),OPSymbols=shared("op-symbols"),ObjectProto=Object.prototype,USE_NATIVE="function"==typeof $Symbol&&!!$GOPS.f,QObject=global.QObject,setter=!QObject||!QObject.prototype||!QObject.prototype.findChild,setSymbolDesc=DESCRIPTORS&&$fails(function(){return 7!=_create(dP({},"a",{get:function(){return dP(this,"a",{value:7}).a}})).a})?function(it,key,D){var protoDesc=gOPD(ObjectProto,key);protoDesc&&delete ObjectProto[key],dP(it,key,D),protoDesc&&it!==ObjectProto&&dP(ObjectProto,key,protoDesc)}:dP,wrap=function(tag){var sym=AllSymbols[tag]=_create($Symbol.prototype);return sym._k=tag,sym},isSymbol=USE_NATIVE&&"symbol"==typeof $Symbol.iterator?function(it){return"symbol"==typeof it}:function(it){return it instanceof $Symbol},$defineProperty=function(it,key,D){return it===ObjectProto&&$defineProperty(OPSymbols,key,D),anObject(it),key=toPrimitive(key,!0),anObject(D),has(AllSymbols,key)?(D.enumerable?(has(it,HIDDEN)&&it[HIDDEN][key]&&(it[HIDDEN][key]=!1),D=_create(D,{enumerable:createDesc(0,!1)})):(has(it,HIDDEN)||dP(it,HIDDEN,createDesc(1,{})),it[HIDDEN][key]=!0),setSymbolDesc(it,key,D)):dP(it,key,D)},$defineProperties=function(it,P){anObject(it);for(var key,keys=enumKeys(P=toIObject(P)),i=0,l=keys.length;l>i;)$defineProperty(it,key=keys[i++],P[key]);return it},$propertyIsEnumerable=function(key){var E=isEnum.call(this,key=toPrimitive(key,!0));return!(this===ObjectProto&&has(AllSymbols,key)&&!has(OPSymbols,key))&&(!(E||!has(this,key)||!has(AllSymbols,key)||has(this,HIDDEN)&&this[HIDDEN][key])||E)},$getOwnPropertyDescriptor=function(it,key){if(it=toIObject(it),key=toPrimitive(key,!0),it!==ObjectProto||!has(AllSymbols,key)||has(OPSymbols,key)){var D=gOPD(it,key);return!D||!has(AllSymbols,key)||has(it,HIDDEN)&&it[HIDDEN][key]||(D.enumerable=!0),D}},$getOwnPropertyNames=function(it){for(var key,names=gOPN(toIObject(it)),result=[],i=0;names.length>i;)has(AllSymbols,key=names[i++])||key==HIDDEN||key==META||result.push(key);return result},$getOwnPropertySymbols=function(it){for(var key,IS_OP=it===ObjectProto,names=gOPN(IS_OP?OPSymbols:toIObject(it)),result=[],i=0;names.length>i;)!has(AllSymbols,key=names[i++])||IS_OP&&!has(ObjectProto,key)||result.push(AllSymbols[key]);return result};USE_NATIVE||(redefine(($Symbol=function(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var tag=uid(arguments.length>0?arguments[0]:void 0),$set=function(value){this===ObjectProto&&$set.call(OPSymbols,value),has(this,HIDDEN)&&has(this[HIDDEN],tag)&&(this[HIDDEN][tag]=!1),setSymbolDesc(this,tag,createDesc(1,value))};return DESCRIPTORS&&setter&&setSymbolDesc(ObjectProto,tag,{configurable:!0,set:$set}),wrap(tag)}).prototype,"toString",function(){return this._k}),$GOPD.f=$getOwnPropertyDescriptor,$DP.f=$defineProperty,__webpack_require__(342).f=gOPNExt.f=$getOwnPropertyNames,__webpack_require__(125).f=$propertyIsEnumerable,$GOPS.f=$getOwnPropertySymbols,DESCRIPTORS&&!__webpack_require__(120)&&redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,!0),wksExt.f=function(name){return wrap(wks(name))}),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),j=0;es6Symbols.length>j;)wks(es6Symbols[j++]);for(var wellKnownSymbols=$keys(wks.store),k=0;wellKnownSymbols.length>k;)wksDefine(wellKnownSymbols[k++]);$export($export.S+$export.F*!USE_NATIVE,"Symbol",{for:function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function(sym){if(!isSymbol(sym))throw TypeError(sym+" is not a symbol!");for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),$export($export.S+$export.F*!USE_NATIVE,"Object",{create:function(it,P){return void 0===P?_create(it):$defineProperties(_create(it),P)},defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});var FAILS_ON_PRIMITIVES=$fails(function(){$GOPS.f(1)});$export($export.S+$export.F*FAILS_ON_PRIMITIVES,"Object",{getOwnPropertySymbols:function(it){return $GOPS.f(toObject(it))}}),$JSON&&$export($export.S+$export.F*(!USE_NATIVE||$fails(function(){var S=$Symbol();return"[null]"!=_stringify([S])||"{}"!=_stringify({a:S})||"{}"!=_stringify(Object(S))})),"JSON",{stringify:function(it){for(var replacer,$replacer,args=[it],i=1;arguments.length>i;)args.push(arguments[i++]);if($replacer=replacer=args[1],(isObject(replacer)||void 0!==it)&&!isSymbol(it))return isArray(replacer)||(replacer=function(key,value){if("function"==typeof $replacer&&(value=$replacer.call(this,key,value)),!isSymbol(value))return value}),args[1]=replacer,_stringify.apply($JSON,args)}}),$Symbol.prototype[TO_PRIMITIVE]||__webpack_require__(64)($Symbol.prototype,TO_PRIMITIVE,$Symbol.prototype.valueOf),setToStringTag($Symbol,"Symbol"),setToStringTag(Math,"Math",!0),setToStringTag(global.JSON,"JSON",!0)},function(module,exports,__webpack_require__){var getKeys=__webpack_require__(102),gOPS=__webpack_require__(225),pIE=__webpack_require__(125);module.exports=function(it){var result=getKeys(it),getSymbols=gOPS.f;if(getSymbols)for(var key,symbols=getSymbols(it),isEnum=pIE.f,i=0;symbols.length>i;)isEnum.call(it,key=symbols[i++])&&result.push(key);return result}},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(65),gOPN=__webpack_require__(342).f,toString={}.toString,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];module.exports.f=function(it){return windowNames&&"[object Window]"==toString.call(it)?function(it){try{return gOPN(it)}catch(e){return windowNames.slice()}}(it):gOPN(toIObject(it))}},function(module,exports,__webpack_require__){__webpack_require__(227)("asyncIterator")},function(module,exports,__webpack_require__){__webpack_require__(227)("observable")},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(647),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(648),module.exports=__webpack_require__(9).Object.setPrototypeOf},function(module,exports,__webpack_require__){var $export=__webpack_require__(14);$export($export.S,"Object",{setPrototypeOf:__webpack_require__(649).set})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(32),anObject=__webpack_require__(45),check=function(O,proto){if(anObject(O),!isObject(proto)&&null!==proto)throw TypeError(proto+": can't set as prototype!")};module.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(test,buggy,set){try{(set=__webpack_require__(51)(Function.call,__webpack_require__(228).f(Object.prototype,"__proto__").set,2))(test,[]),buggy=!(test instanceof Array)}catch(e){buggy=!0}return function(O,proto){return check(O,proto),buggy?O.__proto__=proto:set(O,proto),O}}({},!1):void 0),check:check}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(651),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(652);var $Object=__webpack_require__(9).Object;module.exports=function(P,D){return $Object.create(P,D)}},function(module,exports,__webpack_require__){var $export=__webpack_require__(14);$export($export.S,"Object",{create:__webpack_require__(156)})},function(module,exports,__webpack_require__){__webpack_require__(654);var $Object=__webpack_require__(9).Object;module.exports=function(it,key,desc){return $Object.defineProperty(it,key,desc)}},function(module,exports,__webpack_require__){var $export=__webpack_require__(14);$export($export.S+$export.F*!__webpack_require__(24),"Object",{defineProperty:__webpack_require__(38).f})},function(module,exports,__webpack_require__){var baseIteratee=__webpack_require__(18),isArrayLike=__webpack_require__(55),keys=__webpack_require__(69);module.exports=function(findIndexFunc){return function(collection,predicate,fromIndex){var iterable=Object(collection);if(!isArrayLike(collection)){var iteratee=baseIteratee(predicate,3);collection=keys(collection),predicate=function(key){return iteratee(iterable[key],key,iterable)}}var index=findIndexFunc(collection,predicate,fromIndex);return index>-1?iterable[iteratee?collection[index]:index]:void 0}}},function(module,exports,__webpack_require__){__webpack_require__(657),module.exports=__webpack_require__(9).Object.keys},function(module,exports,__webpack_require__){var toObject=__webpack_require__(82),$keys=__webpack_require__(102);__webpack_require__(160)("keys",function(){return function(it){return $keys(toObject(it))}})},,,,,,function(module,exports,__webpack_require__){const Document=__webpack_require__(33),probableLoginFieldNames=["login","identifier","new_identifier","email"];class Account extends Document{static getAccountName(account){return account?account.auth&&(account.auth.accountName||this.getAccountLogin(account))||account._id:null}static getAccountLogin(account){if(account&&account.auth)for(const fieldName of probableLoginFieldNames)if(account.auth[fieldName])return account.auth[fieldName]}}Account.schema={doctype:"io.cozy.accounts",attributes:{},relationships:{master:{type:"has-one",doctype:"io.cozy.accounts"}}},Account.probableLoginFieldNames=probableLoginFieldNames,module.exports=Account},function(module,exports,__webpack_require__){const PromisePool=__webpack_require__(435);module.exports={parallelMap:(iterable,fn,concurrency)=>{const res=[];return new PromisePool(function*(){for(let item of iterable)yield fn(item).then(x=>res.push(x))},concurrency=concurrency||30).start().then(()=>res)}}},function(module,exports,__webpack_require__){__webpack_require__(666),module.exports=__webpack_require__(9).Object.entries},function(module,exports,__webpack_require__){var $export=__webpack_require__(14),$entries=__webpack_require__(346)(!0);$export($export.S,"Object",{entries:function(it){return $entries(it)}})},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var obj,_from=__webpack_require__(214),_from2=(obj=_from)&&obj.__esModule?obj:{default:obj};exports.default=function(arr){return Array.isArray(arr)?arr:(0,_from2.default)(arr)}},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(669),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(103),__webpack_require__(79),module.exports=__webpack_require__(670)},function(module,exports,__webpack_require__){var classof=__webpack_require__(159),ITERATOR=__webpack_require__(20)("iterator"),Iterators=__webpack_require__(101);module.exports=__webpack_require__(9).isIterable=function(it){var O=Object(it);return void 0!==O[ITERATOR]||"@@iterator"in O||Iterators.hasOwnProperty(classof(O))}},function(module,exports,__webpack_require__){__webpack_require__(103),__webpack_require__(79),module.exports=__webpack_require__(672)},function(module,exports,__webpack_require__){var anObject=__webpack_require__(45),get=__webpack_require__(224);module.exports=__webpack_require__(9).getIterator=function(it){var iterFn=get(it);if("function"!=typeof iterFn)throw TypeError(it+" is not iterable!");return anObject(iterFn.call(it))}},function(module,exports,__webpack_require__){__webpack_require__(162),__webpack_require__(79),__webpack_require__(103),__webpack_require__(674),__webpack_require__(678),__webpack_require__(679),module.exports=__webpack_require__(9).Promise},function(module,exports,__webpack_require__){"use strict";var Internal,newGenericPromiseCapability,OwnPromiseCapability,Wrapper,LIBRARY=__webpack_require__(120),global=__webpack_require__(19),ctx=__webpack_require__(51),classof=__webpack_require__(159),$export=__webpack_require__(14),isObject=__webpack_require__(32),aFunction=__webpack_require__(121),anInstance=__webpack_require__(229),forOf=__webpack_require__(126),speciesConstructor=__webpack_require__(347),task=__webpack_require__(348).set,microtask=__webpack_require__(676)(),newPromiseCapabilityModule=__webpack_require__(230),perform=__webpack_require__(349),userAgent=__webpack_require__(677),promiseResolve=__webpack_require__(350),TypeError=global.TypeError,process=global.process,versions=process&&process.versions,v8=versions&&versions.v8||"",$Promise=global.Promise,isNode="process"==classof(process),empty=function(){},newPromiseCapability=newGenericPromiseCapability=newPromiseCapabilityModule.f,USE_NATIVE=!!function(){try{var promise=$Promise.resolve(1),FakePromise=(promise.constructor={})[__webpack_require__(20)("species")]=function(exec){exec(empty,empty)};return(isNode||"function"==typeof PromiseRejectionEvent)&&promise.then(empty)instanceof FakePromise&&0!==v8.indexOf("6.6")&&-1===userAgent.indexOf("Chrome/66")}catch(e){}}(),isThenable=function(it){var then;return!(!isObject(it)||"function"!=typeof(then=it.then))&&then},notify=function(promise,isReject){if(!promise._n){promise._n=!0;var chain=promise._c;microtask(function(){for(var value=promise._v,ok=1==promise._s,i=0,run=function(reaction){var result,then,exited,handler=ok?reaction.ok:reaction.fail,resolve=reaction.resolve,reject=reaction.reject,domain=reaction.domain;try{handler?(ok||(2==promise._h&&onHandleUnhandled(promise),promise._h=1),!0===handler?result=value:(domain&&domain.enter(),result=handler(value),domain&&(domain.exit(),exited=!0)),result===reaction.promise?reject(TypeError("Promise-chain cycle")):(then=isThenable(result))?then.call(result,resolve,reject):resolve(result)):reject(value)}catch(e){domain&&!exited&&domain.exit(),reject(e)}};chain.length>i;)run(chain[i++]);promise._c=[],promise._n=!1,isReject&&!promise._h&&onUnhandled(promise)})}},onUnhandled=function(promise){task.call(global,function(){var result,handler,console,value=promise._v,unhandled=isUnhandled(promise);if(unhandled&&(result=perform(function(){isNode?process.emit("unhandledRejection",value,promise):(handler=global.onunhandledrejection)?handler({promise:promise,reason:value}):(console=global.console)&&console.error&&console.error("Unhandled promise rejection",value)}),promise._h=isNode||isUnhandled(promise)?2:1),promise._a=void 0,unhandled&&result.e)throw result.v})},isUnhandled=function(promise){return 1!==promise._h&&0===(promise._a||promise._c).length},onHandleUnhandled=function(promise){task.call(global,function(){var handler;isNode?process.emit("rejectionHandled",promise):(handler=global.onrejectionhandled)&&handler({promise:promise,reason:promise._v})})},$reject=function(value){var promise=this;promise._d||(promise._d=!0,(promise=promise._w||promise)._v=value,promise._s=2,promise._a||(promise._a=promise._c.slice()),notify(promise,!0))},$resolve=function(value){var then,promise=this;if(!promise._d){promise._d=!0,promise=promise._w||promise;try{if(promise===value)throw TypeError("Promise can't be resolved itself");(then=isThenable(value))?microtask(function(){var wrapper={_w:promise,_d:!1};try{then.call(value,ctx($resolve,wrapper,1),ctx($reject,wrapper,1))}catch(e){$reject.call(wrapper,e)}}):(promise._v=value,promise._s=1,notify(promise,!1))}catch(e){$reject.call({_w:promise,_d:!1},e)}}};USE_NATIVE||($Promise=function(executor){anInstance(this,$Promise,"Promise","_h"),aFunction(executor),Internal.call(this);try{executor(ctx($resolve,this,1),ctx($reject,this,1))}catch(err){$reject.call(this,err)}},(Internal=function(executor){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=__webpack_require__(231)($Promise.prototype,{then:function(onFulfilled,onRejected){var reaction=newPromiseCapability(speciesConstructor(this,$Promise));return reaction.ok="function"!=typeof onFulfilled||onFulfilled,reaction.fail="function"==typeof onRejected&&onRejected,reaction.domain=isNode?process.domain:void 0,this._c.push(reaction),this._a&&this._a.push(reaction),this._s&&notify(this,!1),reaction.promise},catch:function(onRejected){return this.then(void 0,onRejected)}}),OwnPromiseCapability=function(){var promise=new Internal;this.promise=promise,this.resolve=ctx($resolve,promise,1),this.reject=ctx($reject,promise,1)},newPromiseCapabilityModule.f=newPromiseCapability=function(C){return C===$Promise||C===Wrapper?new OwnPromiseCapability(C):newGenericPromiseCapability(C)}),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Promise:$Promise}),__webpack_require__(124)($Promise,"Promise"),__webpack_require__(351)("Promise"),Wrapper=__webpack_require__(9).Promise,$export($export.S+$export.F*!USE_NATIVE,"Promise",{reject:function(r){var capability=newPromiseCapability(this);return(0,capability.reject)(r),capability.promise}}),$export($export.S+$export.F*(LIBRARY||!USE_NATIVE),"Promise",{resolve:function(x){return promiseResolve(LIBRARY&&this===Wrapper?$Promise:this,x)}}),$export($export.S+$export.F*!(USE_NATIVE&&__webpack_require__(338)(function(iter){$Promise.all(iter).catch(empty)})),"Promise",{all:function(iterable){var C=this,capability=newPromiseCapability(C),resolve=capability.resolve,reject=capability.reject,result=perform(function(){var values=[],index=0,remaining=1;forOf(iterable,!1,function(promise){var $index=index++,alreadyCalled=!1;values.push(void 0),remaining++,C.resolve(promise).then(function(value){alreadyCalled||(alreadyCalled=!0,values[$index]=value,--remaining||resolve(values))},reject)}),--remaining||resolve(values)});return result.e&&reject(result.v),capability.promise},race:function(iterable){var C=this,capability=newPromiseCapability(C),reject=capability.reject,result=perform(function(){forOf(iterable,!1,function(promise){C.resolve(promise).then(capability.resolve,reject)})});return result.e&&reject(result.v),capability.promise}})},function(module,exports){module.exports=function(fn,args,that){var un=void 0===that;switch(args.length){case 0:return un?fn():fn.call(that);case 1:return un?fn(args[0]):fn.call(that,args[0]);case 2:return un?fn(args[0],args[1]):fn.call(that,args[0],args[1]);case 3:return un?fn(args[0],args[1],args[2]):fn.call(that,args[0],args[1],args[2]);case 4:return un?fn(args[0],args[1],args[2],args[3]):fn.call(that,args[0],args[1],args[2],args[3])}return fn.apply(that,args)}},function(module,exports,__webpack_require__){var global=__webpack_require__(19),macrotask=__webpack_require__(348).set,Observer=global.MutationObserver||global.WebKitMutationObserver,process=global.process,Promise=global.Promise,isNode="process"==__webpack_require__(123)(process);module.exports=function(){var head,last,notify,flush=function(){var parent,fn;for(isNode&&(parent=process.domain)&&parent.exit();head;){fn=head.fn,head=head.next;try{fn()}catch(e){throw head?notify():last=void 0,e}}last=void 0,parent&&parent.enter()};if(isNode)notify=function(){process.nextTick(flush)};else if(!Observer||global.navigator&&global.navigator.standalone)if(Promise&&Promise.resolve){var promise=Promise.resolve(void 0);notify=function(){promise.then(flush)}}else notify=function(){macrotask.call(global,flush)};else{var toggle=!0,node=document.createTextNode("");new Observer(flush).observe(node,{characterData:!0}),notify=function(){node.data=toggle=!toggle}}return function(fn){var task={fn:fn,next:void 0};last&&(last.next=task),head||(head=task,notify()),last=task}}},function(module,exports,__webpack_require__){var navigator=__webpack_require__(19).navigator;module.exports=navigator&&navigator.userAgent||""},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(14),core=__webpack_require__(9),global=__webpack_require__(19),speciesConstructor=__webpack_require__(347),promiseResolve=__webpack_require__(350);$export($export.P+$export.R,"Promise",{finally:function(onFinally){var C=speciesConstructor(this,core.Promise||global.Promise),isFunction="function"==typeof onFinally;return this.then(isFunction?function(x){return promiseResolve(C,onFinally()).then(function(){return x})}:onFinally,isFunction?function(e){return promiseResolve(C,onFinally()).then(function(){throw e})}:onFinally)}})},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(14),newPromiseCapability=__webpack_require__(230),perform=__webpack_require__(349);$export($export.S,"Promise",{try:function(callbackfn){var promiseCapability=newPromiseCapability.f(this),result=perform(callbackfn);return(result.e?promiseCapability.reject:promiseCapability.resolve)(result.v),promiseCapability.promise}})},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(681),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(162),__webpack_require__(79),__webpack_require__(103),__webpack_require__(682),__webpack_require__(686),__webpack_require__(688),__webpack_require__(689),module.exports=__webpack_require__(9).Map},function(module,exports,__webpack_require__){"use strict";var strong=__webpack_require__(352),validate=__webpack_require__(232);module.exports=__webpack_require__(353)("Map",function(get){return function(){return get(this,arguments.length>0?arguments[0]:void 0)}},{get:function(key){var entry=strong.getEntry(validate(this,"Map"),key);return entry&&entry.v},set:function(key,value){return strong.def(validate(this,"Map"),0===key?0:key,value)}},strong,!0)},function(module,exports,__webpack_require__){var ctx=__webpack_require__(51),IObject=__webpack_require__(220),toObject=__webpack_require__(82),toLength=__webpack_require__(157),asc=__webpack_require__(684);module.exports=function(TYPE,$create){var IS_MAP=1==TYPE,IS_FILTER=2==TYPE,IS_SOME=3==TYPE,IS_EVERY=4==TYPE,IS_FIND_INDEX=6==TYPE,NO_HOLES=5==TYPE||IS_FIND_INDEX,create=$create||asc;return function($this,callbackfn,that){for(var val,res,O=toObject($this),self=IObject(O),f=ctx(callbackfn,that,3),length=toLength(self.length),index=0,result=IS_MAP?create($this,length):IS_FILTER?create($this,0):void 0;length>index;index++)if((NO_HOLES||index in self)&&(res=f(val=self[index],index,O),TYPE))if(IS_MAP)result[index]=res;else if(res)switch(TYPE){case 3:return!0;case 5:return val;case 6:return index;case 2:result.push(val)}else if(IS_EVERY)return!1;return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:result}}},function(module,exports,__webpack_require__){var speciesConstructor=__webpack_require__(685);module.exports=function(original,length){return new(speciesConstructor(original))(length)}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(32),isArray=__webpack_require__(341),SPECIES=__webpack_require__(20)("species");module.exports=function(original){var C;return isArray(original)&&("function"!=typeof(C=original.constructor)||C!==Array&&!isArray(C.prototype)||(C=void 0),isObject(C)&&null===(C=C[SPECIES])&&(C=void 0)),void 0===C?Array:C}},function(module,exports,__webpack_require__){var $export=__webpack_require__(14);$export($export.P+$export.R,"Map",{toJSON:__webpack_require__(354)("Map")})},function(module,exports,__webpack_require__){var forOf=__webpack_require__(126);module.exports=function(iter,ITERATOR){var result=[];return forOf(iter,!1,result.push,result,ITERATOR),result}},function(module,exports,__webpack_require__){__webpack_require__(355)("Map")},function(module,exports,__webpack_require__){__webpack_require__(356)("Map")},function(module,exports,__webpack_require__){__webpack_require__(691),module.exports=__webpack_require__(9).Object.values},function(module,exports,__webpack_require__){var $export=__webpack_require__(14),$values=__webpack_require__(346)(!1);$export($export.S,"Object",{values:function(it){return $values(it)}})},function(module,exports,__webpack_require__){var core=__webpack_require__(9),$JSON=core.JSON||(core.JSON={stringify:JSON.stringify});module.exports=function(it){return $JSON.stringify.apply($JSON,arguments)}},function(module,exports,__webpack_require__){var baseFlatten=__webpack_require__(114),baseRest=__webpack_require__(54),baseUniq=__webpack_require__(155),isArrayLikeObject=__webpack_require__(118),union=baseRest(function(arrays){return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0))});module.exports=union},function(module,exports,__webpack_require__){var SetCache=__webpack_require__(152),arrayIncludes=__webpack_require__(180),arrayIncludesWith=__webpack_require__(209),arrayMap=__webpack_require__(35),baseUnary=__webpack_require__(88),cacheHas=__webpack_require__(153),LARGE_ARRAY_SIZE=200;module.exports=function(array,values,iteratee,comparator){var index=-1,includes=arrayIncludes,isCommon=!0,length=array.length,result=[],valuesLength=values.length;if(!length)return result;iteratee&&(values=arrayMap(values,baseUnary(iteratee))),comparator?(includes=arrayIncludesWith,isCommon=!1):values.length>=LARGE_ARRAY_SIZE&&(includes=cacheHas,isCommon=!1,values=new SetCache(values));outer:for(;++index<length;){var value=array[index],computed=null==iteratee?value:iteratee(value);if(value=comparator||0!==value?value:0,isCommon&&computed==computed){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===computed)continue outer;result.push(value)}else includes(values,computed,comparator)||result.push(value)}return result}},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(35),baseIntersection=__webpack_require__(362),baseRest=__webpack_require__(54),castArrayLikeObject=__webpack_require__(363),intersection=baseRest(function(arrays){var mapped=arrayMap(arrays,castArrayLikeObject);return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped):[]});module.exports=intersection},function(module,exports,__webpack_require__){!function(){"use strict";function isFunction(value){return"function"==typeof value}function isArray(value){return"[object Array]"===Object.prototype.toString.call(value)}function comparable(value){return value instanceof Date?value.getTime():isArray(value)?value.map(comparable):value&&"function"==typeof value.toJSON?value.toJSON():value}function get(obj,key){return isFunction(obj.get)?obj.get(key):obj[key]}function or(validator){return function(a,b){if(!isArray(b)||!b.length)return validator(a,b);for(var i=0,n=b.length;i<n;i++)if(validator(a,get(b,i)))return!0;return!1}}function validate(validator,b,k,o){return validator.v(validator.a,b,k,o)}var validator,OPERATORS={$eq:or(function(a,b){return a(b)}),$ne:(validator=function(a,b){return!a(b)},function(a,b){if(!isArray(b)||!b.length)return validator(a,b);for(var i=0,n=b.length;i<n;i++)if(!validator(a,get(b,i)))return!1;return!0}),$gt:or(function(a,b){return sift.compare(comparable(b),a)>0}),$gte:or(function(a,b){return sift.compare(comparable(b),a)>=0}),$lt:or(function(a,b){return sift.compare(comparable(b),a)<0}),$lte:or(function(a,b){return sift.compare(comparable(b),a)<=0}),$mod:or(function(a,b){return b%a[0]==a[1]}),$in:function(a,b){if(!(b instanceof Array)){var comparableB=comparable(b);if(comparableB===b&&"object"==typeof b)for(i=a.length;i--;)if(String(a[i])===String(b)&&"[object Object]"!==String(b))return!0;if(void 0===comparableB)for(i=a.length;i--;)if(null==a[i])return!0;for(i=a.length;i--;){var result=validate(createRootValidator(get(a,i),void 0),b,i,a);if(result&&"[object Object]"!==String(result)&&"[object Object]"!==String(b))return!0}return!!~a.indexOf(comparableB)}for(var i=b.length;i--;)if(~a.indexOf(comparable(get(b,i))))return!0;return!1},$nin:function(a,b,k,o){return!OPERATORS.$in(a,b,k,o)},$not:function(a,b,k,o){return!validate(a,b,k,o)},$type:function(a,b){return null!=b&&(b instanceof a||b.constructor==a)},$all:function(a,b,k,o){return OPERATORS.$and(a,b,k,o)},$size:function(a,b){return!!b&&a===b.length},$or:function(a,b,k,o){for(var i=0,n=a.length;i<n;i++)if(validate(get(a,i),b,k,o))return!0;return!1},$nor:function(a,b,k,o){return!OPERATORS.$or(a,b,k,o)},$and:function(a,b,k,o){for(var i=0,n=a.length;i<n;i++)if(!validate(get(a,i),b,k,o))return!1;return!0},$regex:or(function(a,b){return"string"==typeof b&&a.test(b)}),$where:function(a,b,k,o){return a.call(b,b,k,o)},$elemMatch:function(a,b,k,o){return isArray(b)?!!~search(b,a):validate(a,b,k,o)},$exists:function(a,b,k,o){return o.hasOwnProperty(k)===a}},prepare={$eq:function(a){return a instanceof RegExp?function(b){return"string"==typeof b&&a.test(b)}:a instanceof Function?a:isArray(a)&&!a.length?function(b){return isArray(b)&&!b.length}:null===a?function(b){return null==b}:function(b){return 0===sift.compare(comparable(b),a)}},$ne:function(a){return prepare.$eq(a)},$and:function(a){return a.map(parse)},$all:function(a){return prepare.$and(a)},$or:function(a){return a.map(parse)},$nor:function(a){return a.map(parse)},$not:function(a){return parse(a)},$regex:function(a,query){return new RegExp(a,query.$options)},$where:function(a){return"string"==typeof a?new Function("obj","return "+a):a},$elemMatch:function(a){return parse(a)},$exists:function(a){return!!a}};function search(array,validator){for(var i=0;i<array.length;i++){get(array,i);if(validate(validator,get(array,i)))return i}return-1}function createValidator(a,validate){return{a:a,v:validate}}function nestedValidator(a,b){var values=[];if(function findValues(current,keypath,index,object,values){if(index===keypath.length||null==current)return void values.push([current,keypath[index-1],object]);var k=get(keypath,index);if(isArray(current)&&isNaN(Number(k)))for(var i=0,n=current.length;i<n;i++)findValues(get(current,i),keypath,index,current,values);else findValues(get(current,k),keypath,index+1,current,values)}(b,a.k,0,b,values),1===values.length){var first=values[0];return validate(a.nv,first[0],first[1],first[2])}for(var inclusive=a&&a.q&&void 0!==a.q.$ne,allValid=inclusive,i=0;i<values.length;i++){var result=values[i],isValid=validate(a.nv,result[0],result[1],result[2]);inclusive?allValid&=isValid:allValid|=isValid}return allValid}function createNestedValidator(keypath,a,q){return{a:{k:keypath,nv:a,q:q},v:nestedValidator}}function parse(query){var value;(query=comparable(query))&&((value=query)&&value.constructor===Object)||(query={$eq:query});var validators=[];for(var key in query){var a=query[key];if("$options"!==key)if(OPERATORS[key])prepare[key]&&(a=prepare[key](a,query)),validators.push(createValidator(comparable(a),OPERATORS[key]));else{if(36===key.charCodeAt(0))throw new Error("Unknown operation "+key);validators.push(createNestedValidator(key.split("."),parse(a),a))}}return 1===validators.length?validators[0]:createValidator(validators,OPERATORS.$and)}function createRootValidator(query,getter){var validator=parse(query);return getter&&(validator={a:validator,v:function(a,b,k,o){return validate(a,getter(b),k,o)}}),validator}function sift(query,array,getter){isFunction(array)&&(getter=array,array=void 0);var validator=createRootValidator(query,getter);function filter(b,k,o){return validate(validator,b,k,o)}return array?array.filter(filter):filter}sift.use=function(plugin){if(isFunction(plugin))return plugin(sift);for(var key in plugin)36===key.charCodeAt(0)&&(OPERATORS[key]=plugin[key])},sift.indexOf=function(query,array,getter){return search(array,createRootValidator(query,getter))},sift.compare=function(a,b){if(a===b)return 0;if(typeof a==typeof b){if(a>b)return 1;if(a<b)return-1}},void 0!==module.exports&&(Object.defineProperty(exports,"__esModule",{value:!0}),module.exports=sift,exports.default=module.exports.default=sift),"undefined"!=typeof window&&(window.sift=sift)}()},function(module,exports){module.exports=function(originalModule){if(!originalModule.webpackPolyfill){var module=Object.create(originalModule);module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),Object.defineProperty(module,"exports",{enumerable:!0}),module.webpackPolyfill=1}return module}},function(module,__webpack_exports__,__webpack_require__){"use strict";function createThunkMiddleware(extraArgument){return function(_ref){var dispatch=_ref.dispatch,getState=_ref.getState;return function(next){return function(action){return"function"==typeof action?action(dispatch,getState,extraArgument):next(action)}}}}__webpack_require__.r(__webpack_exports__);var thunk=createThunkMiddleware();thunk.withExtraArgument=createThunkMiddleware,__webpack_exports__.default=thunk},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(700),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(701);var $Object=__webpack_require__(9).Object;module.exports=function(it,key){return $Object.getOwnPropertyDescriptor(it,key)}},function(module,exports,__webpack_require__){var toIObject=__webpack_require__(65),$getOwnPropertyDescriptor=__webpack_require__(228).f;__webpack_require__(160)("getOwnPropertyDescriptor",function(){return function(it,key){return $getOwnPropertyDescriptor(toIObject(it),key)}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_get3=_interopRequireDefault(__webpack_require__(167)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_HasMany3=_interopRequireDefault(__webpack_require__(166));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HasManyTriggers=function(_HasMany){function HasManyTriggers(){return(0,_classCallCheck3.default)(this,HasManyTriggers),(0,_possibleConstructorReturn3.default)(this,(HasManyTriggers.__proto__||(0,_getPrototypeOf2.default)(HasManyTriggers)).apply(this,arguments))}return(0,_inherits3.default)(HasManyTriggers,_HasMany),(0,_createClass3.default)(HasManyTriggers,[{key:"data",get:function(){var _this2=this;return(0,_get3.default)(HasManyTriggers.prototype.__proto__||(0,_getPrototypeOf2.default)(HasManyTriggers.prototype),"data",this).filter(function(_ref){return _ref.slug===_this2.target.slug})}}],[{key:"query",value:function(doc,client){return client.all("io.cozy.triggers").where({worker:"konnector"})}}]),HasManyTriggers}(_HasMany3.default);exports.default=HasManyTriggers},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _CozyStackClient=__webpack_require__(368);Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return _interopRequireDefault(_CozyStackClient).default}});var _OAuthClient=__webpack_require__(732);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"OAuthClient",{enumerable:!0,get:function(){return _interopRequireDefault(_OAuthClient).default}})},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(705),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(162),__webpack_require__(79),__webpack_require__(103),__webpack_require__(706),__webpack_require__(707),__webpack_require__(708),__webpack_require__(709),module.exports=__webpack_require__(9).Set},function(module,exports,__webpack_require__){"use strict";var strong=__webpack_require__(352),validate=__webpack_require__(232);module.exports=__webpack_require__(353)("Set",function(get){return function(){return get(this,arguments.length>0?arguments[0]:void 0)}},{add:function(value){return strong.def(validate(this,"Set"),value=0===value?0:value,value)}},strong)},function(module,exports,__webpack_require__){var $export=__webpack_require__(14);$export($export.P+$export.R,"Set",{toJSON:__webpack_require__(354)("Set")})},function(module,exports,__webpack_require__){__webpack_require__(355)("Set")},function(module,exports,__webpack_require__){__webpack_require__(356)("Set")},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(711),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(712);var $Object=__webpack_require__(9).Object;module.exports=function(T,D){return $Object.defineProperties(T,D)}},function(module,exports,__webpack_require__){var $export=__webpack_require__(14);$export($export.S+$export.F*!__webpack_require__(24),"Object",{defineProperties:__webpack_require__(332)})},function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(714),__esModule:!0}},function(module,exports,__webpack_require__){__webpack_require__(715),module.exports=__webpack_require__(9).Object.freeze},function(module,exports,__webpack_require__){var isObject=__webpack_require__(32),meta=__webpack_require__(161).onFreeze;__webpack_require__(160)("freeze",function($freeze){return function(it){return $freeze&&isObject(it)?$freeze(meta(it)):it}})},function(module,exports,__webpack_require__){var arrayEach=__webpack_require__(168),baseCreate=__webpack_require__(133),baseForOwn=__webpack_require__(199),baseIteratee=__webpack_require__(18),getPrototype=__webpack_require__(151),isArray=__webpack_require__(12),isBuffer=__webpack_require__(116),isFunction=__webpack_require__(115),isObject=__webpack_require__(26),isTypedArray=__webpack_require__(144);module.exports=function(object,iteratee,accumulator){var isArr=isArray(object),isArrLike=isArr||isBuffer(object)||isTypedArray(object);if(iteratee=baseIteratee(iteratee,4),null==accumulator){var Ctor=object&&object.constructor;accumulator=isArrLike?isArr?new Ctor:[]:isObject(object)&&isFunction(Ctor)?baseCreate(getPrototype(object)):{}}return(isArrLike?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator}},function(module,exports,__webpack_require__){var baseClamp=__webpack_require__(718),baseToString=__webpack_require__(207),toInteger=__webpack_require__(139),toString=__webpack_require__(85);module.exports=function(string,target,position){return string=toString(string),position=null==position?0:baseClamp(toInteger(position),0,string.length),target=baseToString(target),string.slice(position,position+target.length)==target}},function(module,exports){module.exports=function(number,lower,upper){return number==number&&(void 0!==upper&&(number=number<=upper?number:upper),void 0!==lower&&(number=number>=lower?number:lower)),number}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AppToken=function(){function AppToken(token){(0,_classCallCheck3.default)(this,AppToken),this.token=token||""}return(0,_createClass3.default)(AppToken,[{key:"toAuthHeader",value:function(){return"Bearer "+this.token}},{key:"toBasicAuth",value:function(){return"user:"+this.token+"@"}},{key:"getAccessToken",value:function(){return this.token}}]),AppToken}();exports.default=AppToken},function(module,exports,__webpack_require__){"use strict";var Mime=__webpack_require__(721);module.exports=new Mime(__webpack_require__(722))},function(module,exports,__webpack_require__){"use strict";function Mime(){this._types=Object.create(null),this._extensions=Object.create(null);for(var i=0;i<arguments.length;i++)this.define(arguments[i]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Mime.prototype.define=function(typeMap,force){for(var type in typeMap){var extensions=typeMap[type].map(function(t){return t.toLowerCase()});type=type.toLowerCase();for(var i=0;i<extensions.length;i++){if("*"!=(ext=extensions[i])[0]){if(!force&&ext in this._types)throw new Error('Attempt to change mapping for "'+ext+'" extension from "'+this._types[ext]+'" to "'+type+'". Pass `force=true` to allow this, otherwise remove "'+ext+'" from the list of extensions for "'+type+'".');this._types[ext]=type}}if(force||!this._extensions[type]){var ext=extensions[0];this._extensions[type]="*"!=ext[0]?ext:ext.substr(1)}}},Mime.prototype.getType=function(path){var last=(path=String(path)).replace(/^.*[\/\\]/,"").toLowerCase(),ext=last.replace(/^.*\./,"").toLowerCase(),hasPath=last.length<path.length;return(ext.length<last.length-1||!hasPath)&&this._types[ext]||null},Mime.prototype.getExtension=function(type){return(type=/^\s*([^;\s]*)/.test(type)&&RegExp.$1)&&this._extensions[type.toLowerCase()]||null},module.exports=Mime},function(module,exports){module.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomsvc+xml":["atomsvc"],"application/bdoc":["bdoc"],"application/ccxml+xml":["ccxml"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma","es"],"application/emma+xml":["emma"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-diff+xml":["xdf"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/ktx":["ktx"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},function(module,exports,__webpack_require__){var baseHas=__webpack_require__(724),hasPath=__webpack_require__(319);module.exports=function(object,path){return null!=object&&hasPath(object,path,baseHas)}},function(module,exports){var hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,key){return null!=object&&hasOwnProperty.call(object,key)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KONNECTORS_DOCTYPE=void 0;var _stringify2=_interopRequireDefault(__webpack_require__(165)),_regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_AppCollection3=_interopRequireDefault(__webpack_require__(369)),_TriggerCollection=__webpack_require__(372),_TriggerCollection2=_interopRequireDefault(_TriggerCollection),_DocumentCollection=__webpack_require__(52),_pick2=_interopRequireDefault(__webpack_require__(169));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KONNECTORS_DOCTYPE=exports.KONNECTORS_DOCTYPE="io.cozy.konnectors",KonnectorCollection=function(_AppCollection){function KonnectorCollection(stackClient){(0,_classCallCheck3.default)(this,KonnectorCollection);var _this=(0,_possibleConstructorReturn3.default)(this,(KonnectorCollection.__proto__||(0,_getPrototypeOf2.default)(KonnectorCollection)).call(this,stackClient));return _this.doctype=KONNECTORS_DOCTYPE,_this.endpoint="/konnectors/",_this}var _ref6,_ref5,_ref3,_ref2,_ref;return(0,_inherits3.default)(KonnectorCollection,_AppCollection),(0,_createClass3.default)(KonnectorCollection,[{key:"create",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(){return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:throw new Error("create() method is not available for konnectors");case 1:case"end":return _context.stop()}},_callee,this)})),function(){return _ref.apply(this,arguments)})},{key:"destroy",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(){return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:throw new Error("destroy() method is not available for konnectors");case 1:case"end":return _context2.stop()}},_callee2,this)})),function(){return _ref2.apply(this,arguments)})},{key:"findTriggersBySlug",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(slug){var triggerCol,_ref4,rawTriggers;return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return triggerCol=new _TriggerCollection2.default(this.stackClient),_context3.next=3,triggerCol.all({limit:null});case 3:return _ref4=_context3.sent,rawTriggers=_ref4.data,_context3.abrupt("return",rawTriggers.map(function(x){return x.attributes}).filter(function(triggerAttrs){return(0,_TriggerCollection.isForKonnector)(triggerAttrs,slug)}));case 6:case"end":return _context3.stop()}},_callee3,this)})),function(_x){return _ref3.apply(this,arguments)})},{key:"launch",value:(_ref5=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(slug){var triggerCol,konnTriggers,filteredTriggers,filterAttrs,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return triggerCol=new _TriggerCollection2.default(this.stackClient),_context4.next=3,this.findTriggersBySlug(slug);case 3:if(konnTriggers=_context4.sent,1!==(filteredTriggers=options.accountId?konnTriggers.filter(function(triggerAttrs){return(0,_TriggerCollection.isForAccount)(triggerAttrs,options.accountId)}):konnTriggers).length){_context4.next=9;break}return _context4.abrupt("return",triggerCol.launch(konnTriggers[0]));case 9:if(filterAttrs=(0,_stringify2.default)((0,_pick2.default)({slug:slug,accountId:options.accountId})),0!==filteredTriggers.length){_context4.next=14;break}throw new Error("No trigger found for "+filterAttrs);case 14:if(!(filteredTriggers.length>1)){_context4.next=16;break}throw new Error("More than 1 trigger found for "+filterAttrs);case 16:case"end":return _context4.stop()}},_callee4,this)})),function(_x3){return _ref5.apply(this,arguments)})},{key:"update",value:(_ref6=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee5(slug){var source,sync,reqOptions,rawKonnector,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2.default.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(slug){_context5.next=2;break}throw new Error("Cannot call update with no slug");case 2:return source=options.source||null,sync=options.sync||!1,reqOptions=sync?{headers:{Accept:"text/event-stream"}}:{},_context5.next=7,this.stackClient.fetchJSON("PUT","/konnectors/"+slug+(source?"?Source="+source:""),reqOptions);case 7:return rawKonnector=_context5.sent,_context5.abrupt("return",(0,_DocumentCollection.normalizeDoc)(rawKonnector));case 9:case"end":return _context5.stop()}},_callee5,this)})),function(_x5){return _ref6.apply(this,arguments)})}]),KonnectorCollection}(_AppCollection3.default);exports.default=KonnectorCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_extends3=_interopRequireDefault(__webpack_require__(3)),_taggedTemplateLiteral3=_interopRequireDefault(__webpack_require__(106)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_templateObject=(0,_taggedTemplateLiteral3.default)(["/sharings/doctype/",""],["/sharings/doctype/",""]),_templateObject2=(0,_taggedTemplateLiteral3.default)(["/sharings/","/recipients"],["/sharings/","/recipients"]),_templateObject3=(0,_taggedTemplateLiteral3.default)(["/sharings/","/recipients/",""],["/sharings/","/recipients/",""]),_templateObject4=(0,_taggedTemplateLiteral3.default)(["/sharings/","/recipients/self"],["/sharings/","/recipients/self"]),_DocumentCollection2=__webpack_require__(52),_DocumentCollection3=_interopRequireDefault(_DocumentCollection2),_FileCollection=__webpack_require__(235),_utils=__webpack_require__(107);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var normalizeSharing=function(sharing){return(0,_DocumentCollection2.normalizeDoc)(sharing,"io.cozy.sharings")},SharingCollection=function(_DocumentCollection){function SharingCollection(){return(0,_classCallCheck3.default)(this,SharingCollection),(0,_possibleConstructorReturn3.default)(this,(SharingCollection.__proto__||(0,_getPrototypeOf2.default)(SharingCollection)).apply(this,arguments))}var _ref4,_ref2,_ref;return(0,_inherits3.default)(SharingCollection,_DocumentCollection),(0,_createClass3.default)(SharingCollection,[{key:"findByDoctype",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(doctype){var resp;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.stackClient.fetchJSON("GET",(0,_utils.uri)(_templateObject,doctype));case 2:return resp=_context.sent,_context.abrupt("return",(0,_extends3.default)({},resp,{data:resp.data.map(normalizeSharing)}));case 4:case"end":return _context.stop()}},_callee,this)})),function(_x){return _ref.apply(this,arguments)})},{key:"share",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(document,recipients,sharingType,description){var resp,previewPath=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.stackClient.fetchJSON("POST","/sharings/",{data:{type:"io.cozy.sharings",attributes:{description:description,preview_path:previewPath,open_sharing:"two-way"===sharingType,rules:getSharingRules(document,sharingType)},relationships:{recipients:{data:recipients.map(function(_ref3){return{id:_ref3._id,type:_ref3._type}})}}}});case 2:return resp=_context2.sent,_context2.abrupt("return",{data:normalizeSharing(resp.data)});case 4:case"end":return _context2.stop()}},_callee2,this)})),function(_x3,_x4,_x5,_x6){return _ref2.apply(this,arguments)})},{key:"getDiscoveryLink",value:function(sharingId,sharecode){return this.stackClient.fullpath("/sharings/"+sharingId+"/discovery?sharecode="+sharecode)}},{key:"addRecipients",value:(_ref4=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(sharing,recipients,sharingType){var recipientsPayload,resp;return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return recipientsPayload={data:recipients.map(function(_ref5){return{id:_ref5._id,type:_ref5._type}})},_context3.next=3,this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject2,sharing._id),{data:{type:"io.cozy.sharings",id:sharing._id,relationships:"two-way"===sharingType?{recipients:recipientsPayload}:{read_only_recipients:recipientsPayload}}});case 3:return resp=_context3.sent,_context3.abrupt("return",{data:normalizeSharing(resp.data)});case 5:case"end":return _context3.stop()}},_callee3,this)})),function(_x7,_x8,_x9){return _ref4.apply(this,arguments)})},{key:"revokeRecipient",value:function(sharing,recipientIndex){return this.stackClient.fetchJSON("DELETE",(0,_utils.uri)(_templateObject3,sharing._id,recipientIndex))}},{key:"revokeSelf",value:function(sharing){return this.stackClient.fetchJSON("DELETE",(0,_utils.uri)(_templateObject4,sharing._id))}}]),SharingCollection}(_DocumentCollection3.default);SharingCollection.normalizeDoctype=_DocumentCollection3.default.normalizeDoctypeJsonApi;var getSharingRules=function(document,sharingType){var _id=document._id,_type=document._type;return(0,_FileCollection.isFile)(document)?[(0,_extends3.default)({title:document.name,doctype:"io.cozy.files",values:[_id]},getSharingPolicy(document,sharingType))]:[(0,_extends3.default)({title:"collection",doctype:_type,values:[_id]},getSharingPolicy(document,sharingType)),(0,_extends3.default)({title:"items",doctype:"io.cozy.files",values:[_type+"/"+_id],selector:"referenced_by"},"two-way"===sharingType?{add:"sync",update:"sync",remove:"sync"}:{add:"push",update:"none",remove:"push"})]},getSharingPolicy=function(document,sharingType){return(0,_FileCollection.isFile)(document)&&(0,_FileCollection.isDirectory)(document)?"two-way"===sharingType?{add:"sync",update:"sync",remove:"sync"}:{add:"push",update:"push",remove:"push"}:"two-way"===sharingType?{update:"sync",remove:"revoke"}:{update:"push",remove:"revoke"}};exports.default=SharingCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _getIterator3=_interopRequireDefault(__webpack_require__(66)),_extends3=_interopRequireDefault(__webpack_require__(3)),_objectWithoutProperties3=_interopRequireDefault(__webpack_require__(86)),_regenerator2=_interopRequireDefault(__webpack_require__(13)),_taggedTemplateLiteral3=_interopRequireDefault(__webpack_require__(106)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_templateObject=(0,_taggedTemplateLiteral3.default)(["/permissions/",""],["/permissions/",""]),_templateObject2=(0,_taggedTemplateLiteral3.default)(["/permissions"],["/permissions"]),_templateObject3=(0,_taggedTemplateLiteral3.default)(["/permissions/doctype/","/shared-by-link"],["/permissions/doctype/","/shared-by-link"]),_DocumentCollection2=__webpack_require__(52),_DocumentCollection3=_interopRequireDefault(_DocumentCollection2),_FileCollection=__webpack_require__(235),_utils=__webpack_require__(107);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var normalizePermission=function(perm){return(0,_DocumentCollection2.normalizeDoc)(perm,"io.cozy.permissions")},PermissionCollection=function(_DocumentCollection){function PermissionCollection(){return(0,_classCallCheck3.default)(this,PermissionCollection),(0,_possibleConstructorReturn3.default)(this,(PermissionCollection.__proto__||(0,_getPrototypeOf2.default)(PermissionCollection)).apply(this,arguments))}var _ref9,_ref8,_ref7,_ref6,_ref5,_ref4,_ref3,_ref;return(0,_inherits3.default)(PermissionCollection,_DocumentCollection),(0,_createClass3.default)(PermissionCollection,[{key:"get",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(id){var resp;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.stackClient.fetchJSON("GET",(0,_utils.uri)(_templateObject,id));case 2:return resp=_context.sent,_context.abrupt("return",{data:normalizePermission(resp.data)});case 4:case"end":return _context.stop()}},_callee,this)})),function(_x){return _ref.apply(this,arguments)})},{key:"create",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(_ref2){_ref2._id,_ref2._type;var resp,attributes=(0,_objectWithoutProperties3.default)(_ref2,["_id","_type"]);return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.stackClient.fetchJSON("POST",(0,_utils.uri)(_templateObject2),{data:{type:"io.cozy.permissions",attributes:attributes}});case 2:return resp=_context2.sent,_context2.abrupt("return",{data:normalizePermission(resp.data)});case 4:case"end":return _context2.stop()}},_callee2,this)})),function(_x2){return _ref3.apply(this,arguments)})},{key:"add",value:(_ref4=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(document,permission){var endpoint,resp;return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:endpoint=void 0,_context3.t0=document._type,_context3.next="io.cozy.apps"===_context3.t0?4:"io.cozy.konnectors"===_context3.t0?6:"io.cozy.permissions"===_context3.t0?8:10;break;case 4:return endpoint="/permissions/apps/"+document.slug,_context3.abrupt("break",11);case 6:return endpoint="/permissions/konnectors/"+document.slug,_context3.abrupt("break",11);case 8:return endpoint="/permissions/"+document._id,_context3.abrupt("break",11);case 10:throw new Error("Permissions can only be added on existing permissions, apps and konnectors.");case 11:return _context3.next=13,this.stackClient.fetchJSON("PATCH",endpoint,{data:{type:"io.cozy.permissions",attributes:{permissions:permission}}});case 13:return resp=_context3.sent,_context3.abrupt("return",resp.data);case 15:case"end":return _context3.stop()}},_callee3,this)})),function(_x3,_x4){return _ref4.apply(this,arguments)})},{key:"destroy",value:function(permission){return this.stackClient.fetchJSON("DELETE",(0,_utils.uri)(_templateObject,permission.id))}},{key:"findLinksByDoctype",value:(_ref5=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(doctype){var resp;return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,this.stackClient.fetchJSON("GET",(0,_utils.uri)(_templateObject3,doctype));case 2:return resp=_context4.sent,_context4.abrupt("return",(0,_extends3.default)({},resp,{data:resp.data.map(normalizePermission)}));case 4:case"end":return _context4.stop()}},_callee4,this)})),function(_x5){return _ref5.apply(this,arguments)})},{key:"findApps",value:(_ref6=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee5(){var resp;return _regenerator2.default.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,this.stackClient.fetchJSON("GET","/apps/");case 2:return resp=_context5.sent,_context5.abrupt("return",(0,_extends3.default)({},resp,{data:resp.data.map(function(a){return(0,_extends3.default)({_id:a.id},a)})}));case 4:case"end":return _context5.stop()}},_callee5,this)})),function(){return _ref6.apply(this,arguments)})},{key:"createSharingLink",value:(_ref7=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee6(document){var resp;return _regenerator2.default.wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,this.stackClient.fetchJSON("POST","/permissions?codes=email",{data:{type:"io.cozy.permissions",attributes:{permissions:getPermissionsFor(document,!0)}}});case 2:return resp=_context6.sent,_context6.abrupt("return",{data:normalizePermission(resp.data)});case 4:case"end":return _context6.stop()}},_callee6,this)})),function(_x6){return _ref7.apply(this,arguments)})},{key:"revokeSharingLink",value:(_ref8=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee7(document){var allLinks,links,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,perm;return _regenerator2.default.wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,this.findLinksByDoctype(document._type);case 2:allLinks=_context7.sent,links=allLinks.data.filter(function(perm){return isPermissionRelatedTo(perm,document)}),_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_context7.prev=7,_iterator=(0,_getIterator3.default)(links);case 9:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context7.next=16;break}return perm=_step.value,_context7.next=13,this.destroy(perm);case 13:_iteratorNormalCompletion=!0,_context7.next=9;break;case 16:_context7.next=22;break;case 18:_context7.prev=18,_context7.t0=_context7.catch(7),_didIteratorError=!0,_iteratorError=_context7.t0;case 22:_context7.prev=22,_context7.prev=23,!_iteratorNormalCompletion&&_iterator.return&&_iterator.return();case 25:if(_context7.prev=25,!_didIteratorError){_context7.next=28;break}throw _iteratorError;case 28:return _context7.finish(25);case 29:return _context7.finish(22);case 30:case"end":return _context7.stop()}},_callee7,this,[[7,18,22,30],[23,,25,29]])})),function(_x7){return _ref8.apply(this,arguments)})},{key:"getOwnPermissions",value:(_ref9=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee8(){var resp;return _regenerator2.default.wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,this.stackClient.fetchJSON("GET","/permissions/self");case 2:return resp=_context8.sent,_context8.abrupt("return",{data:normalizePermission(resp.data)});case 4:case"end":return _context8.stop()}},_callee8,this)})),function(){return _ref9.apply(this,arguments)})}]),PermissionCollection}(_DocumentCollection3.default),getPermissionsFor=function(document){var publicLink=arguments.length>1&&void 0!==arguments[1]&&arguments[1],_id=document._id,_type=document._type,verbs=publicLink?["GET"]:["ALL"];return(0,_FileCollection.isFile)(document)?{files:{type:"io.cozy.files",verbs:verbs,values:[_id]}}:{collection:{type:_type,verbs:verbs,values:[_id]},files:{type:"io.cozy.files",verbs:verbs,values:[_type+"/"+_id],selector:"referenced_by"}}};PermissionCollection.normalizeDoctype=_DocumentCollection3.default.normalizeDoctypeJsonApi;var isPermissionRelatedTo=function(perm,document){var _id=document._id;return(0,_FileCollection.isFile)(document)?-1!==perm.attributes.permissions.files.values.indexOf(_id):-1!==perm.attributes.permissions.collection.values.indexOf(_id)};exports.default=PermissionCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SETTINGS_DOCTYPE=void 0;var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_DocumentCollection3=_interopRequireDefault(__webpack_require__(52));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SETTINGS_DOCTYPE=exports.SETTINGS_DOCTYPE="io.cozy.settings",SettingsCollection=function(_DocumentCollection){function SettingsCollection(stackClient){return(0,_classCallCheck3.default)(this,SettingsCollection),(0,_possibleConstructorReturn3.default)(this,(SettingsCollection.__proto__||(0,_getPrototypeOf2.default)(SettingsCollection)).call(this,SETTINGS_DOCTYPE,stackClient))}var _ref;return(0,_inherits3.default)(SettingsCollection,_DocumentCollection),(0,_createClass3.default)(SettingsCollection,[{key:"get",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(path){var resp;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.stackClient.fetchJSON("GET","/settings/"+path);case 2:return resp=_context.sent,_context.abrupt("return",_DocumentCollection3.default.normalizeDoctypeJsonApi(SETTINGS_DOCTYPE)(resp.data,resp));case 4:case"end":return _context.stop()}},_callee,this)})),function(_x){return _ref.apply(this,arguments)})}]),SettingsCollection}(_DocumentCollection3.default);SettingsCollection.normalizeDoctype=_DocumentCollection3.default.normalizeDoctypeJsonApi,exports.default=SettingsCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getIconURL=void 0;var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_getIterator3=_interopRequireDefault(__webpack_require__(66)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_memoize2=_interopRequireDefault(__webpack_require__(730));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _ref,_ref2,mimeTypes={gif:"image/gif",ico:"image/vnd.microsoft.icon",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml"},getIconExtensionFromApp=function(app){if(!app.icon)throw new Error(app.name+": Cannot detect icon mime type since app has no icon");var extension=app.icon.split(".").pop();if(!extension)throw new Error(app.name+": Unable to detect icon mime type from extension ("+app.icon+")");return extension},fallbacks=(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(tries,check){var err,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,_try,res;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:err=void 0,_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_context.prev=4,_iterator=(0,_getIterator3.default)(tries);case 6:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context.next=22;break}return _try=_step.value,_context.prev=8,_context.next=11,_try();case 11:return res=_context.sent,check&&check(res),_context.abrupt("return",res);case 16:_context.prev=16,_context.t0=_context.catch(8),err=_context.t0;case 19:_iteratorNormalCompletion=!0,_context.next=6;break;case 22:_context.next=28;break;case 24:_context.prev=24,_context.t1=_context.catch(4),_didIteratorError=!0,_iteratorError=_context.t1;case 28:_context.prev=28,_context.prev=29,!_iteratorNormalCompletion&&_iterator.return&&_iterator.return();case 31:if(_context.prev=31,!_didIteratorError){_context.next=34;break}throw _iteratorError;case 34:return _context.finish(31);case 35:return _context.finish(28);case 36:throw err;case 37:case"end":return _context.stop()}},_callee,void 0,[[4,24,28,36],[8,16],[29,,31,35]])})),function(_x,_x2){return _ref.apply(this,arguments)}),fetchAppOrKonnector=function(stackClient,type,slug){return stackClient.fetchJSON("GET","/"+type+"s/"+slug).then(function(x){return x.data.attributes})},fetchAppOrKonnectorViaRegistry=function(stackClient,type,slug){return stackClient.fetchJSON("GET","/registry/"+slug).then(function(x){return x.latest_version.manifest})},_getIconURL=(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(stackClient,opts){var type,slug,appData,_opts$priority,priority,iconDataFetchers,resp,icon,app,appDataFetchers,ext;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return type=opts.type,slug=opts.slug,appData=opts.appData,_opts$priority=opts.priority,iconDataFetchers=[function(){return stackClient.fetch("GET","/"+type+"s/"+slug+"/icon")},function(){return stackClient.fetch("GET","/registry/"+slug+"/icon")}],"registry"===(priority=void 0===_opts$priority?"stack":_opts$priority)&&iconDataFetchers.reverse(),_context2.next=5,fallbacks(iconDataFetchers,function(resp){if(!resp.ok)throw new Error("Error while fetching icon "+resp.statusText)});case 5:return resp=_context2.sent,_context2.next=8,resp.blob();case 8:if(icon=_context2.sent,app=void 0,icon.type){_context2.next=26;break}if(appDataFetchers=[function(){return fetchAppOrKonnector(stackClient,type,slug)},function(){return fetchAppOrKonnectorViaRegistry(stackClient,0,slug)}],"registry"===priority&&appDataFetchers.reverse(),_context2.t1=appData,_context2.t1){_context2.next=18;break}return _context2.next=17,fallbacks(appDataFetchers);case 17:_context2.t1=_context2.sent;case 18:if(_context2.t0=_context2.t1,_context2.t0){_context2.next=21;break}_context2.t0={};case 21:if(app=_context2.t0,ext=getIconExtensionFromApp(app),mimeTypes[ext]){_context2.next=25;break}throw new Error('Unknown image extension "'+ext+'" for app '+app.name);case 25:icon=new Blob([icon],{type:mimeTypes[ext]});case 26:return _context2.abrupt("return",URL.createObjectURL(icon));case 27:case"end":return _context2.stop()}},_callee2,void 0)})),function(_x3,_x4){return _ref2.apply(this,arguments)}),getIconURL=function(){return _getIconURL.apply(this,arguments).catch(function(e){return console.warn(e),""})};exports.default=(0,_memoize2.default)(getIconURL,{maxDuration:3e5,key:function(stackClient,opts){var type=opts.type,slug=opts.slug,priority=opts.priority;return stackClient.uri+NaN+type+":"+slug+":"+priority}}),exports.getIconURL=getIconURL},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _keys2=_interopRequireDefault(__webpack_require__(61)),_getIterator3=_interopRequireDefault(__webpack_require__(66));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var garbageCollect=function(cache,maxDuration){var now=Date.now(),_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=(0,_getIterator3.default)((0,_keys2.default)(cache));!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var key=_step.value;now-cache[key].date>maxDuration&&delete cache[key]}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}};exports.default=function(fn,options){var cache={};return function(){var key=options.key.apply(null,arguments);garbageCollect(cache,options.maxDuration);var existing=cache[key];if(existing)return existing.result;var result=fn.apply(this,arguments);return cache[key]={result:result,date:Date.now()},result}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default={EXPIRED_TOKEN:/Expired token/,CLIENT_NOT_FOUND:/Client not found/}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_keys2=_interopRequireDefault(__webpack_require__(61)),_extends3=_interopRequireDefault(__webpack_require__(3)),_getPrototypeOf2=_interopRequireDefault(__webpack_require__(5)),_objectWithoutProperties3=_interopRequireDefault(__webpack_require__(86)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(6)),_get3=_interopRequireDefault(__webpack_require__(167)),_inherits3=_interopRequireDefault(__webpack_require__(7)),_CozyStackClient3=_interopRequireDefault(__webpack_require__(368)),_AccessToken2=_interopRequireDefault(__webpack_require__(733)),_logDeprecate2=_interopRequireDefault(__webpack_require__(373));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var defaultoauthOptions={clientID:"",clientName:"",clientKind:"",clientSecret:"",clientURI:"",registrationAccessToken:"",redirectURI:"",softwareID:"",softwareVersion:"",logoURI:"",policyURI:"",notificationPlatform:"",notificationDeviceToken:""},OAuthClient=function(_CozyStackClient){function OAuthClient(_ref){var oauth=_ref.oauth,_ref$scope=_ref.scope,scope=void 0===_ref$scope?[]:_ref$scope,onTokenRefresh=_ref.onTokenRefresh,options=(0,_objectWithoutProperties3.default)(_ref,["oauth","scope","onTokenRefresh"]);(0,_classCallCheck3.default)(this,OAuthClient);var _this=(0,_possibleConstructorReturn3.default)(this,(OAuthClient.__proto__||(0,_getPrototypeOf2.default)(OAuthClient)).call(this,options));return _this.setOAuthOptions((0,_extends3.default)({},defaultoauthOptions,oauth)),oauth.token&&_this.setToken(oauth.token),_this.scope=scope,_this.onTokenRefresh=onTokenRefresh,_this}var _ref7,_ref6,_ref5,_ref4,_ref3,_ref2;return(0,_inherits3.default)(OAuthClient,_CozyStackClient),(0,_createClass3.default)(OAuthClient,[{key:"isRegistered",value:function(){return""!==this.oauthOptions.clientID}},{key:"snakeCaseOAuthData",value:function(data){var mappedFields={softwareID:"software_id",softwareVersion:"software_version",clientID:"client_id",clientName:"client_name",clientKind:"client_kind",clientURI:"client_uri",logoURI:"logo_uri",policyURI:"policy_uri",notificationPlatform:"notification_platform",notificationDeviceToken:"notification_device_token",redirectURI:"redirect_uris"},result={};return(0,_keys2.default)(data).forEach(function(fieldName){var key=mappedFields[fieldName]||fieldName,value=data[fieldName];result[key]=value}),result.redirect_uris&&result.redirect_uris instanceof Array==!1&&(result.redirect_uris=[result.redirect_uris]),result}},{key:"camelCaseOAuthData",value:function(data){var mappedFields={client_id:"clientID",client_name:"clientName",client_secret:"clientSecret",registration_access_token:"registrationAccessToken",software_id:"softwareID",redirect_uris:"redirectURI"},result={};return(0,_keys2.default)(data).forEach(function(fieldName){var key=mappedFields[fieldName]||fieldName,value=data[fieldName];result[key]=value}),result}},{key:"register",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(){var mandatoryFields,fields,missingMandatoryFields,data;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!this.isRegistered()){_context.next=2;break}throw new Error("Client already registered");case 2:if(mandatoryFields=["redirectURI"],fields=(0,_keys2.default)(this.oauthOptions),!((missingMandatoryFields=mandatoryFields.filter(function(fieldName){return fields[fieldName]})).length>0)){_context.next=7;break}throw new Error("Can't register client : missing "+missingMandatoryFields+" fields");case 7:return _context.next=9,this.fetchJSON("POST","/auth/register",this.snakeCaseOAuthData({redirectURI:this.oauthOptions.redirectURI,clientName:this.oauthOptions.clientName,softwareID:this.oauthOptions.softwareID,clientKind:this.oauthOptions.clientKind,clientURI:this.oauthOptions.clientURI,logoURI:this.oauthOptions.logoURI,policyURI:this.oauthOptions.policyURI,softwareVersion:this.oauthOptions.softwareVersion,notificationPlatform:this.oauthOptions.notificationPlatform,notificationDeviceToken:this.oauthOptions.notificationDeviceToken}));case 9:return data=_context.sent,this.setOAuthOptions((0,_extends3.default)({},this.oauthOptions,{client_id:data.client_id,client_name:data.client_name,client_secret:data.client_secret,registration_access_token:data.registration_access_token,software_id:data.software_id})),_context.abrupt("return",this.oauthOptions);case 12:case"end":return _context.stop()}},_callee,this)})),function(){return _ref2.apply(this,arguments)})},{key:"unregister",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(){var clientID;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(this.isRegistered()){_context2.next=2;break}throw new NotRegisteredException;case 2:return clientID=this.oauthOptions.clientID,this.oauthOptions.clientID="",_context2.abrupt("return",this.fetchJSON("DELETE","/auth/register/"+clientID,null,{headers:{Authorization:this.registrationAccessTokenToAuthHeader()}}));case 5:case"end":return _context2.stop()}},_callee2,this)})),function(){return _ref3.apply(this,arguments)})},{key:"fetchInformation",value:(_ref4=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(){return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(this.isRegistered()){_context3.next=2;break}throw new NotRegisteredException;case 2:return _context3.abrupt("return",this.fetchJSON("GET","/auth/register/"+this.oauthOptions.clientID,null,{headers:{Authorization:this.registrationAccessTokenToAuthHeader()}}));case 3:case"end":return _context3.stop()}},_callee3,this)})),function(){return _ref4.apply(this,arguments)})},{key:"updateInformation",value:(_ref5=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(information){var mandatoryFields,data,result,resetSecret=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _regenerator2.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(this.isRegistered()){_context4.next=2;break}throw new NotRegisteredException;case 2:return mandatoryFields={clientID:this.oauthOptions.clientID,clientName:this.oauthOptions.clientName,redirectURI:this.oauthOptions.redirectURI,softwareID:this.oauthOptions.softwareID},data=this.snakeCaseOAuthData((0,_extends3.default)({},mandatoryFields,information)),resetSecret&&(data.client_secret=this.oauthOptions.clientSecret),_context4.next=7,this.fetchJSON("PUT","/auth/register/"+this.oauthOptions.clientID,data,{headers:{Authorization:this.registrationAccessTokenToAuthHeader()}});case 7:return result=_context4.sent,this.setOAuthOptions((0,_extends3.default)({},data,result)),_context4.abrupt("return",this.oauthOptions);case 10:case"end":return _context4.stop()}},_callee4,this)})),function(_x2){return _ref5.apply(this,arguments)})},{key:"generateStateCode",value:function(){var buffer=void 0;if("undefined"!=typeof window&&void 0!==window.crypto&&"function"==typeof window.crypto.getRandomValues)buffer=new Uint8Array(16),window.crypto.getRandomValues(buffer);else{buffer=new Array(16);for(var i=0;i<buffer.length;i++)buffer[i]=Math.floor(255*Math.random())}return btoa(String.fromCharCode.apply(null,buffer)).replace(/=+$/,"").replace(/\//g,"_").replace(/\+/g,"-")}},{key:"getAuthCodeURL",value:function(stateCode){var scopes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scope;if(!this.isRegistered())throw new NotRegisteredException;var query={client_id:this.oauthOptions.clientID,redirect_uri:this.oauthOptions.redirectURI,state:stateCode,response_type:"code",scope:scopes.join(" ")};return this.uri+"/auth/authorize?"+this.dataToQueryString(query)}},{key:"dataToQueryString",value:function(data){return(0,_keys2.default)(data).map(function(param){return param+"="+encodeURIComponent(data[param])}).join("&")}},{key:"getAccessCodeFromURL",value:function(pageURL,stateCode){if(!stateCode)throw new Error("Missing state code");var params=new URL(pageURL).searchParams,urlStateCode=params.get("state"),urlAccessCode=params.get("access_code");if(stateCode!==urlStateCode)throw new Error("Given state does not match url query state");return urlAccessCode}},{key:"fetchAccessToken",value:(_ref6=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee5(accessCode,oauthOptions,uri){var data,result;return _regenerator2.default.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(this.isRegistered()||oauthOptions){_context5.next=2;break}throw new NotRegisteredException;case 2:return oauthOptions=oauthOptions||this.oauthOptions,data={grant_type:"authorization_code",code:accessCode,client_id:oauthOptions.clientID,client_secret:oauthOptions.clientSecret},_context5.next=6,this.fetchJSON("POST",(uri||"")+"/auth/access_token",this.dataToQueryString(data),{headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 6:return result=_context5.sent,_context5.abrupt("return",new _AccessToken2.default(result));case 8:case"end":return _context5.stop()}},_callee5,this)})),function(_x4,_x5,_x6){return _ref6.apply(this,arguments)})},{key:"refreshToken",value:(_ref7=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee6(){var data,result,newToken;return _regenerator2.default.wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(this.isRegistered()){_context6.next=2;break}throw new NotRegisteredException;case 2:if(this.token){_context6.next=4;break}throw new Error("No token to refresh");case 4:return data={grant_type:"refresh_token",refresh_token:this.token.refreshToken,client_id:this.oauthOptions.clientID,client_secret:this.oauthOptions.clientSecret},_context6.next=7,(0,_get3.default)(OAuthClient.prototype.__proto__||(0,_getPrototypeOf2.default)(OAuthClient.prototype),"fetchJSON",this).call(this,"POST","/auth/access_token",this.dataToQueryString(data),{headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 7:return result=_context6.sent,newToken=new _AccessToken2.default((0,_extends3.default)({refresh_token:this.token.refreshToken},result)),this.onTokenRefresh&&"function"==typeof this.onTokenRefresh&&this.onTokenRefresh(newToken),_context6.abrupt("return",newToken);case 11:case"end":return _context6.stop()}},_callee6,this)})),function(){return _ref7.apply(this,arguments)})},{key:"exchangeOAuthSecret",value:function(uri,secret){return this.fetchJSON("POST",uri+"/auth/secret_exchange",{secret:secret})}},{key:"setToken",value:function(token){this.token=token?token instanceof _AccessToken2.default?token:new _AccessToken2.default(token):null}},{key:"setCredentials",value:function(token){return(0,_logDeprecate2.default)("setCredentials is deprecated, please replace by setToken"),this.setToken(token)}},{key:"setOAuthOptions",value:function(options){this.oauthOptions=this.camelCaseOAuthData(options)}},{key:"resetClientId",value:function(){this.oauthOptions.clientID=""}},{key:"resetClient",value:function(){this.resetClientId(),this.setUri(null),this.setToken(null)}},{key:"registrationAccessTokenToAuthHeader",value:function(){if(!this.oauthOptions.registrationAccessToken)throw new Error("No registration access token");return"Bearer "+this.oauthOptions.registrationAccessToken}}]),OAuthClient}(_CozyStackClient3.default),NotRegisteredException=function(_Error){function NotRegisteredException(){var message=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Client not registered or missing OAuth information";(0,_classCallCheck3.default)(this,NotRegisteredException);var _this2=(0,_possibleConstructorReturn3.default)(this,(NotRegisteredException.__proto__||(0,_getPrototypeOf2.default)(NotRegisteredException)).call(this,message));return _this2.message=message,_this2.name="NotRegisteredException",_this2}return(0,_inherits3.default)(NotRegisteredException,_Error),NotRegisteredException}(Error);exports.default=OAuthClient},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _stringify2=_interopRequireDefault(__webpack_require__(165)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AccessToken=function(){function AccessToken(data){(0,_classCallCheck3.default)(this,AccessToken),"string"==typeof data&&(data=JSON.parse(data)),this.tokenType=data.token_type||data.tokenType,this.accessToken=data.access_token||data.accessToken,this.refreshToken=data.refresh_token||data.refreshToken,this.scope=data.scope}return(0,_createClass3.default)(AccessToken,[{key:"toAuthHeader",value:function(){return"Bearer "+this.accessToken}},{key:"toBasicAuth",value:function(){return"user:"+this.accessToken+"@"}},{key:"toJSON",value:function(){return{tokenType:this.tokenType,accessToken:this.accessToken,refreshToken:this.refreshToken,scope:this.scope}}},{key:"toString",value:function(){return(0,_stringify2.default)(this.toJSON())}},{key:"getAccessToken",value:function(){return this.accessToken}}]),AccessToken}();exports.default=AccessToken},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.authenticateWithCordova=void 0;var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_promise2=_interopRequireDefault(__webpack_require__(67)),_const=__webpack_require__(357),_cozyDeviceHelper=__webpack_require__(405);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _ref2,authenticateWithSafari=function(url){return new _promise2.default(function(resolve,reject){window.SafariViewController.show({url:url,transition:"curl"},function(result){"closed"===result.event&&reject(new Error(_const.REGISTRATION_ABORT))},function(error){console.log("KO: "+error),reject(new Error(_const.REGISTRATION_ABORT))});var handle=window.handleOpenURL;window.handleOpenURL=function(url){window.SafariViewController.hide(),resolve(url),handle&&(window.handleOpenURL=handle)}})},authenticateWithInAppBrowser=function(url){return new _promise2.default(function(resolve,reject){var inAppBrowser=window.cordova.InAppBrowser.open(url,"_blank","clearcache=yes,zoom=no"),removeListener=function(){inAppBrowser.removeEventListener("loadstart",onLoadStart),inAppBrowser.removeEventListener("exit",onExit)},onLoadStart=function(_ref){var url=_ref.url,accessCode=/\?access_code=(.+)$/.test(url),state=/\?state=(.+)$/.test(url);(accessCode||state)&&(resolve(url),removeListener(),inAppBrowser.close())},onExit=function(){reject(new Error(_const.REGISTRATION_ABORT)),removeListener(),inAppBrowser.close()};inAppBrowser.addEventListener("loadstart",onLoadStart),inAppBrowser.addEventListener("exit",onExit)})};exports.authenticateWithCordova=(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(url){return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_context.t0=(0,_cozyDeviceHelper.isIOSApp)(),!_context.t0){_context.next=5;break}return _context.next=4,(0,_cozyDeviceHelper.hasSafariPlugin)();case 4:_context.t0=_context.sent;case 5:if(!_context.t0){_context.next=9;break}return _context.abrupt("return",authenticateWithSafari(url));case 9:if(!(0,_cozyDeviceHelper.hasInAppBrowserPlugin)()){_context.next=13;break}return _context.abrupt("return",authenticateWithInAppBrowser(url));case 13:return console.log(url),_context.abrupt("return",new _promise2.default(function(resolve){setTimeout(function(){var token=prompt("Paste the url here:");resolve(token)},5e3)}));case 15:case"end":return _context.stop()}},_callee,void 0)})),function(_x){return _ref2.apply(this,arguments)})},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(49);Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDeviceName=void 0;var _capitalize=_interopRequireDefault(__webpack_require__(736)),_cordova=__webpack_require__(237),_plugins=__webpack_require__(238),_platform=__webpack_require__(236);exports.getDeviceName=function(){if(!(0,_plugins.hasDevicePlugin)())return(0,_cordova.isCordova)()&&console.warn("You should install `cordova-plugin-device`."),"Device";var _window$device=window.device,manufacturer=_window$device.manufacturer,originalModel=_window$device.model,model=(0,_platform.isIOSApp)()?function(identifier){for(var devices=["iPhone","iPad","Watch","AppleTV"],_i=0;_i<devices.length;_i++){var device=devices[_i];if(identifier.match(new RegExp(device)))return device}return"Device"}(originalModel):originalModel;return"".concat((0,_capitalize.default)(manufacturer)," ").concat(model)}},function(module,exports,__webpack_require__){var toString=__webpack_require__(85),upperFirst=__webpack_require__(737);module.exports=function(string){return upperFirst(toString(string).toLowerCase())}},function(module,exports,__webpack_require__){var upperFirst=__webpack_require__(738)("toUpperCase");module.exports=upperFirst},function(module,exports,__webpack_require__){var castSlice=__webpack_require__(374),hasUnicode=__webpack_require__(212),stringToArray=__webpack_require__(375),toString=__webpack_require__(85);module.exports=function(methodName){return function(string){string=toString(string);var strSymbols=hasUnicode(string)?stringToArray(string):void 0,chr=strSymbols?strSymbols[0]:string.charAt(0),trailing=strSymbols?castSlice(strSymbols,1).join(""):string.slice(1);return chr[methodName]()+trailing}}},function(module,exports){module.exports=function(string){return string.split("")}},function(module,exports){var rsAstral="[\\ud800-\\udfff]",rsCombo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsNonAstral="[^\\ud800-\\udfff]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",reOptMod="(?:"+rsCombo+"|"+rsFitz+")"+"?",rsSeq="[\\ufe0e\\ufe0f]?"+reOptMod+("(?:\\u200d(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")[\\ufe0e\\ufe0f]?"+reOptMod+")*"),rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");module.exports=function(string){return string.match(reUnicode)||[]}},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(49);Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.startApp=exports.checkApp=void 0;var _regenerator=_interopRequireDefault(__webpack_require__(0)),_asyncToGenerator2=_interopRequireDefault(__webpack_require__(4)),_platform=__webpack_require__(236),cordovaPluginIsInstalled=function(){return window.startApp},getParams=function(_ref){var appId=_ref.appId,uri=_ref.uri;return(0,_platform.isAndroidApp)()?{package:appId}:uri},exported={},startApp=exported.startApp=function(){var _ref2=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee(appInfo){var startAppPlugin,params;return _regenerator.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return startAppPlugin=window.startApp,_context.next=3,exported.checkApp(appInfo);case 3:if(!_context.sent){_context.next=9;break}return params=getParams(appInfo),_context.abrupt("return",new Promise(function(resolve,reject){cordovaPluginIsInstalled()?startAppPlugin.set(params).start(resolve,reject):reject(new Error("Cordova plugin 'com.lampa.startapp' is not installed. This plugin is needed to start a native app. Required by cozy-bar"))}));case 9:return _context.abrupt("return",!1);case 10:case"end":return _context.stop()}},_callee)}));return function(_x){return _ref2.apply(this,arguments)}}();exports.startApp=startApp;var checkApp=exported.checkApp=function(){var _ref3=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee2(appInfo){var startAppPlugin,params;return _regenerator.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return startAppPlugin=window.startApp,params=getParams(appInfo),_context2.abrupt("return",new Promise(function(resolve,reject){cordovaPluginIsInstalled()?startAppPlugin.set(params).check(function(infos){resolve("OK"===infos||infos)},function(error){!1===error||0===error.indexOf("NameNotFoundException")?resolve(!1):reject(error)}):reject(new Error("Cordova plugin 'com.lampa.startapp' is not installed."))}));case 3:case"end":return _context2.stop()}},_callee2)}));return function(_x2){return _ref3.apply(this,arguments)}}();exports.checkApp=checkApp;var _default=exported;exports.default=_default},function(module,exports,__webpack_require__){"use strict";var _interopRequireDefault=__webpack_require__(49);Object.defineProperty(exports,"__esModule",{value:!0}),exports.nativeLinkOpen=void 0;var _regenerator=_interopRequireDefault(__webpack_require__(0)),_asyncToGenerator2=_interopRequireDefault(__webpack_require__(4)),_plugins=__webpack_require__(238),nativeLinkOpen=function(){var _ref2=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee(_ref){var url;return _regenerator.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return url=_ref.url,_context.next=3,(0,_plugins.hasSafariPlugin)();case 3:if(_context.t0=_context.sent,!_context.t0){_context.next=6;break}_context.t0=window.SafariViewController;case 6:if(!_context.t0){_context.next=10;break}window.SafariViewController.show({url:url,transition:"curl"},function(result){"closed"===result.event&&window.SafariViewController.hide()},function(){window.SafariViewController.hide()}),_context.next=11;break;case 10:(0,_plugins.hasInAppBrowserPlugin)()?("_blank","clearcache=yes,zoom=no",window.cordova.InAppBrowser.open(url,"_blank","clearcache=yes,zoom=no")):window.location=url;case 11:case"end":return _context.stop()}},_callee)}));return function(_x){return _ref2.apply(this,arguments)}}();exports.nativeLinkOpen=nativeLinkOpen},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.openDeeplinkOrRedirect=void 0;var openUriWithHiddenFrame=function(uri,failCb){var randomId=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);window.addEventListener("blur",onBlur);var iframe=function(target,uri,randomId){var iframe=document.createElement("iframe");return iframe.src=uri,iframe.id="hiddenIframe_".concat(randomId),iframe.style.display="none",target.appendChild(iframe),iframe}(document.body,"about:blank",randomId),timeout=setTimeout(function(){failCb(),window.removeEventListener("blur",onBlur),iframe.parentElement.removeChild(iframe)},500);function onBlur(){clearTimeout(timeout),window.removeEventListener("blur",onBlur),iframe.parentElement.removeChild(iframe)}iframe.contentWindow.location.href=uri};exports.openDeeplinkOrRedirect=function(deeplink,failCb){if(navigator.msLaunchUri)!function(uri,failCb){navigator.msLaunchUri(uri,void 0,failCb)}(deeplink,failCb);else{var browser=(isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,ua=navigator.userAgent.toLowerCase(),isSafari=ua.includes("safari")&&!ua.includes("chrome")||Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,isIOS122=isIOS&&(ua.includes("os 12_2")||ua.includes("os 12_3")),{isOpera:isOpera,isFirefox:"undefined"!=typeof InstallTrigger,isSafari:isSafari,isChrome:!!window.chrome&&!isOpera,isIOS122:isIOS122,isIOS:isIOS});browser.isChrome||browser.isIOS&&!browser.isIOS122?function(uri,failCb){for(var timeout=setTimeout(function(){failCb(),target.removeEventListener("blur",onBlur)},500),target=window;target!=target.parent;)target=target.parent;function onBlur(){clearTimeout(timeout),target.removeEventListener("blur",onBlur)}target.addEventListener("blur",onBlur),window.location=uri}(deeplink,failCb):browser.isSafari&&!browser.isIOS122||browser.isFirefox?openUriWithHiddenFrame(deeplink,failCb):failCb()}var isOpera,ua,isSafari,isIOS,isIOS122}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _values2=_interopRequireDefault(__webpack_require__(127)),_mapValues2=_interopRequireDefault(__webpack_require__(119)),_groupBy3=_interopRequireDefault(__webpack_require__(42)),_flatten2=_interopRequireDefault(__webpack_require__(89)),_isEqual2=_interopRequireDefault(__webpack_require__(273)),_uniq2=_interopRequireDefault(__webpack_require__(173)),_uniqWith2=_interopRequireDefault(__webpack_require__(745)),_dsl=__webpack_require__(87);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var optimizeDoctypeQueries=function(queries){var _groupBy=(0,_groupBy3.default)(queries,function(q){return(query=q).id||query.ids?"idQueries":"others";var query}),_groupBy$idQueries=_groupBy.idQueries,idQueries=void 0===_groupBy$idQueries?[]:_groupBy$idQueries,_groupBy$others=_groupBy.others,others=void 0===_groupBy$others?[]:_groupBy$others,groupedIdQueries=idQueries.length>0?new _dsl.QueryDefinition({doctype:queries[0].doctype,ids:(0,_uniq2.default)((0,_flatten2.default)(idQueries.map(function(q){return q.id||q.ids})))}):[];return(0,_uniqWith2.default)(others,_isEqual2.default).concat(groupedIdQueries)};exports.default=function(queries){var byDoctype=(0,_groupBy3.default)(queries,function(q){return q.doctype});return(0,_flatten2.default)((0,_values2.default)((0,_mapValues2.default)(byDoctype,optimizeDoctypeQueries)))}},function(module,exports,__webpack_require__){var baseUniq=__webpack_require__(155);module.exports=function(array,comparator){return comparator="function"==typeof comparator?comparator:void 0,array&&array.length?baseUniq(array,void 0,comparator):[]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var fetchPolicies={olderThan:function(delay){return function(queryState){return!queryState||!queryState.lastUpdate||Date.now()-queryState.lastUpdate>delay}},noFetch:function(){return!1}};exports.default=fetchPolicies},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_keys2=_interopRequireDefault(__webpack_require__(61)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_values2=_interopRequireDefault(__webpack_require__(127)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_extends3=_interopRequireDefault(__webpack_require__(3)),_keyBy2=_interopRequireDefault(__webpack_require__(94)),_mapValues2=_interopRequireDefault(__webpack_require__(119)),_merge2=_interopRequireDefault(__webpack_require__(192)),_size2=_interopRequireDefault(__webpack_require__(268)),_intersectionBy2=_interopRequireDefault(__webpack_require__(748)),_associations=__webpack_require__(171);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var normalizeDoctypeSchema=function(doctypeSchema){var relationships=(0,_mapValues2.default)(doctypeSchema.relationships||{},function(v,k){return(0,_extends3.default)({},v,{name:k,type:(0,_associations.resolveClass)(v.doctype,v.type)})});return(0,_extends3.default)({},doctypeSchema,{relationships:(0,_size2.default)(relationships)>0?(0,_keyBy2.default)(relationships,"name"):null})},assert=function(predicate,errorMessage){if(!predicate)throw new Error(errorMessage)},ensureCanBeAdded=function(newSchemas,existingSchemas){var sameNames=(0,_intersectionBy2.default)(newSchemas,existingSchemas,function(x){return x.name});assert(0===sameNames.length,"Duplicated names in schemas being added: "+sameNames.map(function(x){return x.name}).join(", "));var sameDoctypes=(0,_intersectionBy2.default)(newSchemas,existingSchemas,function(x){return x.doctype});assert(0===sameDoctypes.length,"Duplicated doctypes in schemas being added: "+sameDoctypes.map(function(x){return x.name}).join(", "))},Schema=function(){function Schema(){var schemaDefinition=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},client=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,_classCallCheck3.default)(this,Schema),this.byDoctype={},this.add(schemaDefinition),this.client=client}var _ref2,_ref;return(0,_createClass3.default)(Schema,[{key:"add",value:function(){var schemaDefinition=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},normalizedSchemaDefinition=(0,_mapValues2.default)(schemaDefinition,function(obj,name){return(0,_extends3.default)({name:name},normalizeDoctypeSchema(obj))});ensureCanBeAdded((0,_values2.default)(normalizedSchemaDefinition),(0,_values2.default)(this.byDoctype)),(0,_merge2.default)(this.byDoctype,(0,_keyBy2.default)(normalizedSchemaDefinition,function(x){return x.doctype}))}},{key:"getDoctypeSchema",value:function(doctype){var schema=this.byDoctype[doctype];return schema||(schema=normalizeDoctypeSchema({name:doctype,doctype:doctype}),this.byDoctype[doctype]=schema),schema}},{key:"getRelationship",value:function(doctype,relationshipName){return this.getDoctypeSchema(doctype).relationships[relationshipName]}},{key:"validate",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(document){var errors,schema,n,ret;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(errors={},schema=this.byDoctype[document._type]){_context.next=4;break}return _context.abrupt("return",!0);case 4:if(schema.attributes){_context.next=6;break}return _context.abrupt("return",!0);case 6:_context.t0=_regenerator2.default.keys(schema.attributes);case 7:if((_context.t1=_context.t0()).done){_context.next=15;break}return n=_context.t1.value,_context.next=11,this.validateAttribute(document,n,schema.attributes[n]);case 11:!0!==(ret=_context.sent)&&(errors[n]=ret),_context.next=7;break;case 15:if(0!==(0,_keys2.default)(errors).length){_context.next=17;break}return _context.abrupt("return",!0);case 17:return _context.abrupt("return",errors);case 18:case"end":return _context.stop()}},_callee,this)})),function(_x4){return _ref.apply(this,arguments)})},{key:"validateAttribute",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(document,attrName,attrProps){return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!attrProps.unique||!this.client){_context2.next=6;break}return _context2.next=3,this.client.collection(document._type).checkUniquenessOf(attrName,document[attrName]);case 3:if(!0===_context2.sent){_context2.next=6;break}return _context2.abrupt("return","must be unique");case 6:return _context2.abrupt("return",!0);case 7:case"end":return _context2.stop()}},_callee2,this)})),function(_x5,_x6,_x7){return _ref2.apply(this,arguments)})}]),Schema}();exports.default=Schema},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(35),baseIntersection=__webpack_require__(362),baseIteratee=__webpack_require__(18),baseRest=__webpack_require__(54),castArrayLikeObject=__webpack_require__(363),last=__webpack_require__(271),intersectionBy=baseRest(function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);return iteratee===last(mapped)?iteratee=void 0:mapped.pop(),mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,baseIteratee(iteratee,2)):[]});module.exports=intersectionBy},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof3=_interopRequireDefault(__webpack_require__(96)),_keys2=_interopRequireDefault(__webpack_require__(61)),_extends3=_interopRequireDefault(__webpack_require__(3)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2)),_store=__webpack_require__(128);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var hasOwn=Object.prototype.hasOwnProperty,ObservableQuery=function(){function ObservableQuery(queryId,definition,client){var _this=this;if((0,_classCallCheck3.default)(this,ObservableQuery),this.handleStoreChange=function(){var nextResult=_this.currentRawResult();(function(objA,objB){if(is(objA,objB))return!0;if("object"!==(void 0===objA?"undefined":(0,_typeof3.default)(objA))||null===objA||"object"!==(void 0===objB?"undefined":(0,_typeof3.default)(objB))||null===objB)return!1;var keysA=(0,_keys2.default)(objA),keysB=(0,_keys2.default)(objB);if(keysA.length!==keysB.length)return!1;for(var i=0;i<keysA.length;i++)if(!hasOwn.call(objB,keysA[i])||!is(objA[keysA[i]],objB[keysA[i]]))return!1;return!0})(nextResult,_this.lastResult)||(_this.lastResult=nextResult,_this.notifyObservers())},!queryId||!definition||!client)throw new Error("ObservableQuery takes 3 arguments: queryId, definition and client");this.queryId=queryId,this.definition=definition,this.client=client,this.observers={},this.idCounter=1,this.lastResult=this.currentRawResult()}return(0,_createClass3.default)(ObservableQuery,[{key:"currentResult",value:function(){var result=this.client.getQueryFromState(this.queryId,{hydrated:!0});return result.lastFetch?(0,_extends3.default)({},result,{data:this.definition.id?result.data[0]:result.data}):result}},{key:"fetch",value:function(){return this.client.query(this.definition,{as:this.queryId})}},{key:"fetchMore",value:function(){return this.client.query(this.definition.offset(this.currentRawResult().data.length),{as:this.queryId})}},{key:"currentRawResult",value:function(){return(0,_store.getRawQueryFromState)(this.getStore().getState(),this.queryId)}},{key:"notifyObservers",value:function(){var _this2=this;(0,_keys2.default)(this.observers).forEach(function(id){return _this2.observers[id]()})}},{key:"subscribeToStore",value:function(){if(this._unsubscribeStore)throw new Error("ObservableQuery instance is already subscribed to store.");this._unsubscribeStore=this.getStore().subscribe(this.handleStoreChange)}},{key:"unsubscribeFromStore",value:function(){if(!this._unsubscribeStore)throw new Error("ObservableQuery instance is not subscribed to store");this._unsubscribeStore()}},{key:"subscribe",value:function(callback){var _this3=this,callbackId=this.idCounter;return this.idCounter++,this.observers[callbackId]=callback,1===(0,_keys2.default)(this.observers).length&&this.subscribeToStore(),function(){return _this3.unsubscribe(callbackId)}}},{key:"unsubscribe",value:function(callbackId){if(!this.observers[callbackId])throw new Error("Cannot unsubscribe unknown callbackId "+callbackId);delete this.observers[callbackId],0===(0,_keys2.default)(this.observers).length&&(this.unsubscribeFromStore(),this._unsubscribeStore=null)}},{key:"getStore",value:function(){return this.client.store}}]),ObservableQuery}();function is(x,y){return x===y?0!==x||0!==y||1/x==1/y:x!=x&&y!=y}exports.default=ObservableQuery},function(module,exports,__webpack_require__){var zip=__webpack_require__(54)(__webpack_require__(751));module.exports=zip},function(module,exports,__webpack_require__){var arrayFilter=__webpack_require__(205),arrayMap=__webpack_require__(35),baseProperty=__webpack_require__(208),baseTimes=__webpack_require__(298),isArrayLikeObject=__webpack_require__(118),nativeMax=Math.max;module.exports=function(array){if(!array||!array.length)return[];var length=0;return array=arrayFilter(array,function(group){if(isArrayLikeObject(group))return length=nativeMax(group.length,length),!0}),baseTimes(length,function(index){return arrayMap(array,baseProperty(index))})}},function(module,exports,__webpack_require__){const get=__webpack_require__(10),flatten=__webpack_require__(89),Contact=__webpack_require__(376),Document=__webpack_require__(33);class AdministrativeProcedure extends Document{static getPersonalData(contact,fields){const mapping={firstname:{path:"name.givenName"},lastname:{path:"name.familyName"},address:{getter:Contact.getPrimaryAddress},email:{getter:Contact.getPrimaryEmail},phone:{getter:Contact.getPrimaryPhone}};let personalData={};return fields.forEach(field=>{const contactField=get(mapping,field,field);let value;if(contactField.getter)value=contactField.getter(contact);else{const path=get(contactField,"path",field);value=get(contact,path)}void 0!==value&&(personalData[field]=value)}),personalData}static async getFilesByRules(docRules){const{rules:rules,count:count}=docRules,cozyRules={trashed:!1,type:"file",...rules};return await this.cozyClient.collection("io.cozy.files").createIndex(["metadata.datetime","metadata.classification"]),await this.cozyClient.collection("io.cozy.files").find(cozyRules,{indexedFields:["metadata.datetime","metadata.classification"],sort:[{"metadata.datetime":"desc"},{"metadata.classification":"desc"}],limit:count||1})}static create(data,template){const{documentsData:documentsData,personalData:personalData,procedureData:procedureData}=data,files=Object.keys(documentsData).map(identifier=>documentsData[identifier].files.map(file=>{if(file)return{_id:file.id,_type:"io.cozy.files",templateDocumentId:identifier}}));return{personalData:personalData,procedureData:procedureData,submissionDate:new Date,templateId:template.type,templateVersion:template.version,relationships:{files:{data:flatten(files)}}}}static createJson(administrativeProcedure){return JSON.stringify(administrativeProcedure)}}AdministrativeProcedure.doctype="io.cozy.procedures.administratives",module.exports=AdministrativeProcedure},function(module,exports,__webpack_require__){"use strict";var ReactPropTypesSecret=__webpack_require__(754);function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction,module.exports=function(){function shim(props,propName,componentName,location,propFullName,secret){if(secret!==ReactPropTypesSecret){var err=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw err.name="Invariant Violation",err}}function getShim(){return shim}shim.isRequired=shim;var ReactPropTypes={array:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return ReactPropTypes.PropTypes=ReactPropTypes,ReactPropTypes}},function(module,exports,__webpack_require__){"use strict";module.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(module,exports,__webpack_require__){const Document=__webpack_require__(33),BankAccount=__webpack_require__(239);class BalanceHistory extends Document{static async getByYearAndAccount(year,accountId){const index=await Document.getIndex(this.doctype,this.idAttributes),options={selector:{year:year,"relationships.account.data._id":accountId},limit:1},[balance]=await Document.query(index,options);return balance||this.getEmptyDocument(year,accountId)}static getEmptyDocument(year,accountId){return{year:year,balances:{},metadata:{version:this.version},relationships:{account:{data:{_id:accountId,_type:BankAccount.doctype}}}}}}BalanceHistory.doctype="io.cozy.bank.balancehistories",BalanceHistory.idAttributes=["year","relationships.account.data._id"],BalanceHistory.version=1,BalanceHistory.checkedAttributes=["balances"],module.exports=BalanceHistory},function(module,exports,__webpack_require__){const sortBy=__webpack_require__(83),{eitherIncludes:eitherIncludes}=__webpack_require__(379),{getSlugFromInstitutionLabel:getSlugFromInstitutionLabel}=__webpack_require__(380),findExactMatch=(attr,account,existingAccounts)=>{const sameAttr=existingAccounts.filter(existingAccount=>existingAccount[attr]===account[attr]);return 1===sameAttr.length?{match:sameAttr[0],method:attr+"-exact"}:sameAttr.length>1?{matches:sameAttr,method:attr+"-exact"}:null},untrimmedAccountNumber=/^(?:[A-Za-z]+)?-?([0-9]+)-?(?:[A-Za-z]+)?$/,redactedCreditCard=/xxxx xxxx xxxx (\d{4})/,normalizeAccountNumber=(number,iban)=>{let match;return iban=iban&&iban.replace(/\s/g,""),number=number&&!number.match(redactedCreditCard)?number.replace(/\s/g,""):number,iban&&27==iban.length?iban.substr(14,11):number?23==number.length?number.substr(10,11):16==number.length?number.substr(5,11):number.length>11&&(match=number.match(untrimmedAccountNumber))?match[1]:number:number},score=(account,existingAccount)=>{const methods=[],res={account:existingAccount,methods:methods};let points=0;if(((account,existingAccount)=>{const possibleSlug=getSlugFromInstitutionLabel(account.institutionLabel),possibleSlugExisting=getSlugFromInstitutionLabel(existingAccount.institutionLabel);return!possibleSlug||!possibleSlugExisting||possibleSlug===possibleSlugExisting})(account,existingAccount)||(points-=1e3),((account,existingAccount)=>existingAccount.number&&account.number&&(11===existingAccount.number.length||11===account.number.length)&&eitherIncludes(existingAccount.number,account.number))(account,existingAccount)?(points+=50,methods.push("approx-number")):points-=50,account.type===existingAccount.type&&(points+=50,methods.push("same-type")),"CreditCard"!==account.type&&"CreditCard"!==existingAccount.type||!((account,existingAccount)=>{let ccAccount,lastDigits;for(let acc of[account,existingAccount]){const match=acc.number&&acc.number.match(redactedCreditCard);match&&(ccAccount=acc,lastDigits=match[1])}if((ccAccount===account?existingAccount:account).number.slice(-4)===lastDigits)return!0})(account,existingAccount)||(points+=150,methods.push("credit-card-number")),account.currency){(existingAccount.rawNumber&&existingAccount.rawNumber.includes(account.currency)||existingAccount.label&&existingAccount.label.includes(account.currency)||existingAccount.originalBankLabel&&existingAccount.originalBankLabel.includes(account.currency))&&(points+=50,methods.push("currency"))}return res.points=points,res},normalizeAccount=account=>{const normalizedAccountNumber=normalizeAccountNumber(account.number,account.iban);return{...account,rawNumber:account.number,number:normalizedAccountNumber}},exactMatchAttributes=["iban","number"],eqNotUndefined=(attr1,attr2)=>attr1&&attr1===attr2,findMatch=(account,existingAccounts)=>{for(const exactAttribute of exactMatchAttributes)if(account[exactAttribute]){const result=findExactMatch(exactAttribute,account,existingAccounts);if(result&&result.match)return result}const matchOriginalNumber=existingAccounts.find(otherAccount=>eqNotUndefined(account.originalNumber,otherAccount.number)||eqNotUndefined(account.number,otherAccount.originalNumber));if(matchOriginalNumber)return{match:matchOriginalNumber,method:"originalNumber-exact"};const matchRawNumberCurrencyType=existingAccounts.find(otherAccount=>(eqNotUndefined(account.rawNumber,otherAccount.number)||eqNotUndefined(account.number,otherAccount.rawNumber))&&otherAccount.type==account.type&&otherAccount.currency==account.currency);if(matchRawNumberCurrencyType)return{match:matchRawNumberCurrencyType,method:"rawNumber-exact-currency-type"};const candidates=sortBy(existingAccounts.map(existingAccount=>score(account,existingAccount)),x=>-x.points).filter(x=>x.points>0);return candidates.length>0?{match:candidates[0].account,method:candidates[0].methods.join("-")}:void 0};module.exports={matchAccounts:(fetchedAccounts,existingAccounts)=>{fetchedAccounts=fetchedAccounts.map(normalizeAccount);const toMatch=[...existingAccounts].map(normalizeAccount),results=[];for(let fetchedAccount of fetchedAccounts){const matchResult=findMatch(fetchedAccount,toMatch);if(matchResult){const i=toMatch.indexOf(matchResult.match);toMatch.splice(i,1),results.push({account:fetchedAccount,...matchResult})}else results.push({account:fetchedAccount})}return results},normalizeAccountNumber:normalizeAccountNumber,score:score}},function(module,exports){module.exports={"AXA Banque":"axabanque102","/Banque Populaire.*/":"banquepopulaire",BforBank:"bforbank97","BNP Paribas":"bnpparibas82",BNPP:"bnpparibas82","/Boursorama.*/":"boursorama83",casden:"casden173","/Hello bank!.*/":"hellobank145",Bred:"bred",CA:"caatlantica3","Carrefour Banque":"carrefour159","/Caisse d'pargne.*/":"caissedepargne1","Compte Nickel":"comptenickel168","/^CIC.*/":"cic63","Crdit Agricole":"caatlantica3","Crdit Coopratif":"creditcooperatif148","/Crdit du Nord.*/":"cdngroup88","/Crdit Maritime.*/":"creditmaritime","/Crdit Mutuel.*/":"cic45",Fortuneo:"fortuneo84","Hello bank!":"hellobank145","HSBC France":"hsbc119",HSBC:"hsbc119","/^ING.*/":"ingdirect95","/La Banque Postale.*/":"labanquepostale44","/LCL.*/":"lcl-linxo",Milleis:"barclays136",Monabanq:"monabanq96","Socit Gnrale":"societegenerale","Socit marseillaise de crdit":"cdngroup109"}},function(module,exports,__webpack_require__){const fromPairs=__webpack_require__(93),log=__webpack_require__(34).namespace("BankingReconciliator");module.exports=class{constructor(options){this.options=options}async saveAccounts(fetchedAccounts,options){const{BankAccount:BankAccount}=this.options,stackAccounts=await BankAccount.fetchAll(),reconciliatedAccounts=BankAccount.reconciliate(fetchedAccounts,stackAccounts);log("info","Saving accounts...");const savedAccounts=await BankAccount.bulkSave(reconciliatedAccounts,{handleDuplicates:"remove"});return options.onAccountsSaved&&options.onAccountsSaved(savedAccounts),{savedAccounts:savedAccounts,reconciliatedAccounts:reconciliatedAccounts}}async save(fetchedAccounts,fetchedTransactions,options={}){const{BankAccount:BankAccount,BankTransaction:BankTransaction}=this.options,{reconciliatedAccounts:reconciliatedAccounts,savedAccounts:savedAccounts}=await this.saveAccounts(fetchedAccounts,options),vendorIdToCozyId=fromPairs(savedAccounts.map(acc=>[acc[BankAccount.vendorIdAttr],acc._id]));log("info","Linking transactions to accounts..."),log("info",JSON.stringify(vendorIdToCozyId)),fetchedTransactions.forEach(tr=>{if(tr.account=vendorIdToCozyId[tr[BankTransaction.vendorAccountIdAttr]],void 0===tr.account)throw log("warn",`Transaction without account, vendorAccountIdAttr: ${BankTransaction.vendorAccountIdAttr}`),log("warn","transaction: "+JSON.stringify(tr)),new Error("Transaction without account.")});const reconciliatedAccountIds=new Set(reconciliatedAccounts.filter(acc=>acc._id).map(acc=>acc._id)),stackTransactions=(await BankTransaction.fetchAll()).filter(transaction=>reconciliatedAccountIds.has(transaction.account)),transactions=BankTransaction.reconciliate(fetchedTransactions,stackTransactions,options);log("info","Saving transactions...");let i=1;return{accounts:savedAccounts,transactions:await BankTransaction.bulkSave(transactions,{concurrency:30,logProgress:doc=>{log("debug",`[bulkSave] ${i++} Saving ${doc.date} ${doc.label}`)},handleDuplicates:"remove"})}}}},function(module,exports,__webpack_require__){const keyBy=__webpack_require__(94),groupBy=__webpack_require__(42),maxBy=__webpack_require__(270),addDays=__webpack_require__(260),isAfter=__webpack_require__(436),Document=__webpack_require__(33),log=__webpack_require__(377),BankAccount=__webpack_require__(239),{matchTransactions:matchTransactions}=__webpack_require__(760),maxValue=(iterable,fn)=>{const res=maxBy(iterable,fn);return res?fn(res):null},getDate=transaction=>{return(transaction.realisationDate||transaction.date).slice(0,10)},getSplitDate=stackTransactions=>{const now=new Date,notFutureTransactions=stackTransactions.filter(transaction=>{const date=getDate(transaction);return!isAfter(date,now)});return maxValue(notFutureTransactions,getDate)},ensureISOString=date=>date instanceof Date?date.toISOString():date;class Transaction extends Document{static getDate(transaction){return transaction}isAfter(minDate){if(minDate){const day=ensureISOString(this.date).slice(0,10);return"NaN"!==day?day>minDate:(log("warn","transaction date could not be parsed. transaction: "+JSON.stringify(this)),!1)}return!0}isBeforeOrSame(maxDate){if(maxDate){const day=ensureISOString(this.date).slice(0,10);return"NaN"!==day?day<=maxDate:(log("warn","transaction date could not be parsed. transaction: "+JSON.stringify(this)),!1)}return!0}getIdentifier(){return`${this.amount}-${this.originalBankLabel}-${this.date}`}static getMissedTransactions(newTransactions,stackTransactions,options={}){const oldestDate=maxValue(stackTransactions,getDate),frontierDate=addDays(oldestDate,-7),recentNewTransactions=newTransactions.filter(tr=>isAfter(getDate(tr),frontierDate)),missedTransactions=Array.from(matchTransactions(recentNewTransactions,stackTransactions)).filter(result=>!result.match).map(result=>result.transaction),trackEvent=options.trackEvent;if("function"==typeof trackEvent)try{const nbMissed=missedTransactions.length,nbExisting=stackTransactions.length;trackEvent({e_a:"ReconciliateMissing",e_n:"MissedTransactionPct",e_v:parseFloat((nbMissed/nbExisting).toFixed(2),10)}),trackEvent({e_a:"ReconciliateMissing",e_n:"MissedTransactionAbs",e_v:nbMissed})}catch(e){log("warn",`Could not send MissedTransaction event: ${e.message}`)}return missedTransactions}static reconciliate(remoteTransactions,localTransactions,options={}){const groups=groupBy(remoteTransactions,transaction=>(transaction=>localTransactions.find(t=>t.vendorId===transaction.vendorId))(transaction)?"updatedTransactions":"newTransactions");let newTransactions=groups.newTransactions||[];const updatedTransactions=groups.updatedTransactions||[],splitDate=getSplitDate(localTransactions);if(splitDate){"function"==typeof options.trackEvent&&options.trackEvent({e_a:"ReconciliateSplitDate"});const isAfterSplit=x=>Transaction.prototype.isAfter.call(x,splitDate),isBeforeSplit=x=>Transaction.prototype.isBeforeOrSame.call(x,splitDate),transactionsAfterSplit=newTransactions.filter(isAfterSplit);transactionsAfterSplit.length>0?log("info",`Found ${transactionsAfterSplit.length} transactions after ${splitDate}`):log("info",`No transaction after ${splitDate}`);const transactionsBeforeSplit=newTransactions.filter(isBeforeSplit);log("info",`Found ${transactionsBeforeSplit.length} transactions before ${splitDate}`);const missedTransactions=Transaction.getMissedTransactions(transactionsBeforeSplit,localTransactions,options);missedTransactions.length>0?log("info",`Found ${missedTransactions.length} missed transactions before ${splitDate}`):log("info",`No missed transactions before ${splitDate}`),newTransactions=[...transactionsAfterSplit,...missedTransactions]}else log("info","Can't find a split date, saving all new transactions");return log("info",`Transaction reconciliation: new ${newTransactions.length}, updated ${updatedTransactions.length}, split date ${splitDate} `),[].concat(newTransactions).concat(updatedTransactions)}static async getMostRecentForAccounts(accountIds){try{log("debug","Transaction.getLast");const index=await Document.getIndex(this.doctype,["date","account"]),options={selector:{date:{$gte:null},account:{$in:accountIds}},sort:[{date:"desc"}]},transactions=await Document.query(index,options);return log("info","last transactions length: "+transactions.length),transactions}catch(e){return log("error",e),[]}}static async deleteOrphans(){log("info","Deleting up orphan operations");const accounts=keyBy(await BankAccount.fetchAll(),"_id"),operations=await this.fetchAll(),orphanOperations=operations.filter(x=>!accounts[x.account]);if(log("info",`Total number of operations: ${operations.length}`),log("info",`Total number of orphan operations: ${orphanOperations.length}`),log("info",`Deleting ${orphanOperations.length} orphan operations...`),orphanOperations.length>0)return this.deleteAll(orphanOperations)}getVendorAccountId(){return this[this.constructor.vendorAccountIdAttr]}static getCategoryId(transaction,options){const opts={localModelOverride:!1,localModelUsageThreshold:this.LOCAL_MODEL_USAGE_THRESHOLD,globalModelUsageThreshold:this.GLOBAL_MODEL_USAGE_THRESHOLD,...options};return transaction.manualCategoryId?transaction.manualCategoryId:opts.localModelOverride&&transaction.localCategoryId&&transaction.localCategoryProba&&transaction.localCategoryProba>opts.localModelUsageThreshold?transaction.localCategoryId:transaction.cozyCategoryId&&transaction.cozyCategoryProba&&transaction.cozyCategoryProba>opts.globalModelUsageThreshold?transaction.cozyCategoryId:transaction.localCategoryId||transaction.cozyCategoryId?transaction.automaticCategoryId:null}}Transaction.doctype="io.cozy.bank.operations",Transaction.version=1,Transaction.vendorAccountIdAttr="vendorAccountId",Transaction.vendorIdAttr="vendorId",Transaction.idAttributes=["vendorId"],Transaction.checkedAttributes=["label","originalBankLabel","automaticCategoryId","account"],Transaction.LOCAL_MODEL_USAGE_THRESHOLD=.8,Transaction.GLOBAL_MODEL_USAGE_THRESHOLD=.15,Transaction.getSplitDate=getSplitDate,module.exports=Transaction},function(module,exports,__webpack_require__){const groupBy=__webpack_require__(42),sortBy=__webpack_require__(83),{eitherIncludes:eitherIncludes}=__webpack_require__(379),getDateTransaction=op=>op.date.substr(0,10),squash=(str,char)=>{const rx=new RegExp(String.raw`${char}{2,}`,"gi");return str&&str.replace(rx,char)},redactedNumber=/\b[0-9X]+\b/gi,dateRx=/\b\d{2}\/\d{2}\/\d{4}\b/g,cleanLabel=label=>label&&label.replace(redactedNumber,""),withoutDate=str=>str&&str.replace(dateRx,""),compacted=str=>str&&str.replace(/\s/g,"").replace(/-/g,""),scoreMatching=(newTr,existingTr,options={})=>{const methods=[],res={op:existingTr,methods:methods};if(options.maxDateDelta){if(((newTr,existingTr)=>{const nDate1=new Date(newTr.date.substr(0,10)),eDate1=new Date(existingTr.date.substr(0,10)),delta=Math.abs(eDate1-nDate1);if(newTr.realisationDate){const nDate2=new Date(newTr.realisationDate.substr(0,10)),delta2=Math.abs(eDate1-nDate2);return Math.min(delta,delta2)}return delta})(newTr,existingTr)>options.maxDateDelta)return res.points=-1e3,res;methods.push("approx-date")}const[labelPoints,labelMethod]=((newTr,existingTr)=>squash(existingTr.originalBankLabel," ")===squash(newTr.originalBankLabel," ")?[200,"originalBankLabel"]:compacted(existingTr.originalBankLabel)===compacted(newTr.originalBankLabel)?[120,"originalBankLabelCompacted"]:withoutDate(existingTr.originalBankLabel)===withoutDate(newTr.originalBankLabel)?[150,"originalBankLabelWithoutDate"]:existingTr.label===newTr.label?[100,"label"]:eitherIncludes(existingTr.label.toLowerCase(),newTr.label.toLowerCase())?[70,"eitherIncludes"]:eitherIncludes(cleanLabel(existingTr.label.toLowerCase()),cleanLabel(newTr.label.toLowerCase()))?[50,"fuzzy-eitherIncludes"]:[-1e3,"label-penalty"])(newTr,existingTr);methods.push(labelMethod);const points=(0===Math.abs(existingTr.amount-newTr.amount)?methods.push("amount")&&100:-1e3)+labelPoints;return res.points=points,res},matchTransaction=(newTr,existingTrs,options={})=>{const exactVendorId=existingTrs.find(existingTr=>existingTr.vendorId&&newTr.vendorId&&existingTr.vendorId===newTr.vendorId);if(exactVendorId)return{match:exactVendorId,method:"vendorId"};const withPoints=existingTrs.map(existingTr=>scoreMatching(newTr,existingTr,options)),candidates=sortBy(withPoints,x=>-x.points).filter(x=>x.points>0);return candidates.length>0?{match:candidates[0].op,method:candidates[0].methods.join("-")}:{candidates:candidates}},matchTransactionToGroup=function*(newTrs,existingTrs,options={}){const toMatch=Array.isArray(existingTrs)?[...existingTrs]:[];for(let newTr of newTrs){const res={transaction:newTr},result=toMatch.length>0?matchTransaction(newTr,toMatch,options):null;if(result){Object.assign(res,result);const matchIdx=toMatch.indexOf(result.match);matchIdx>-1&&toMatch.splice(matchIdx,1)}yield res}};module.exports={matchTransactions:function*(newTrs,existingTrs){const unmatchedNew=new Set(newTrs),unmatchedExisting=new Set(existingTrs);for(let[date,[newGroup,existingGroup]]of function*(iterables,grouper){const grouped=iterables.map(items=>groupBy(items,grouper));for(const key of Object.keys(grouped[0]).sort()){const groups=grouped.map(keyedGroups=>keyedGroups[key]||[]);yield[key,groups]}}([newTrs,existingTrs],getDateTransaction))for(let result of matchTransactionToGroup(newGroup,existingGroup))result.match&&(unmatchedExisting.delete(result.match),unmatchedNew.delete(result.transaction),yield result);const deltas=[3,4,5];for(let delta of deltas)for(let result of matchTransactionToGroup(Array.from(unmatchedNew),Array.from(unmatchedExisting),{maxDateDelta:864e5*delta}))result.method&&(result.method+=`-delta${delta}`),result.match&&(unmatchedExisting.delete(result.match),unmatchedNew.delete(result.transaction)),(result.match||delta===deltas[deltas.length-1])&&(yield result)},scoreMatching:scoreMatching}},function(module,exports,__webpack_require__){const Document=__webpack_require__(33),sumBy=__webpack_require__(95);class BankAccountStats extends Document{static checkCurrencies(accountsStats){const currency=accountsStats[0].currency;for(const accountStats of accountsStats)if(accountStats.currency!==currency)return!1;return!0}static sum(accountsStats){if(0===accountsStats.length)throw new Error("You must give at least one stats object");if(!this.checkCurrencies(accountsStats))throw new Error("Currency of all stats object must be the same.");const summedStats=["income","additionalIncome","mortgage","loans","fixedCharges"].reduce((sums,property)=>(sums[property]=sumBy(accountsStats,accountStats=>accountStats[property]||0),sums),{});return summedStats.currency=accountsStats[0].currency,summedStats}}BankAccountStats.doctype="io.cozy.bank.accounts.stats",BankAccountStats.idAttributes=["_id"],BankAccountStats.version=1,BankAccountStats.checkedAttributes=null,module.exports=BankAccountStats},function(module,exports,__webpack_require__){var baseToString=__webpack_require__(207),castSlice=__webpack_require__(374),charsEndIndex=__webpack_require__(763),stringToArray=__webpack_require__(375),toString=__webpack_require__(85),reTrimEnd=/\s+$/;module.exports=function(string,chars,guard){if((string=toString(string))&&(guard||void 0===chars))return string.replace(reTrimEnd,"");if(!string||!(chars=baseToString(chars)))return string;var strSymbols=stringToArray(string),end=charsEndIndex(strSymbols,stringToArray(chars))+1;return castSlice(strSymbols,0,end).join("")}},function(module,exports,__webpack_require__){var baseIndexOf=__webpack_require__(259);module.exports=function(strSymbols,chrSymbols){for(var index=strSymbols.length;index--&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}},function(module,exports,__webpack_require__){const Application=__webpack_require__(378),CozyFile=__webpack_require__(381);class CozyFolder extends CozyFile{static async createFolderWithReference(path,document){const collection=this.cozyClient.collection(CozyFile.doctype),dirId=await collection.ensureDirectoryExists(path);await collection.addReferencesTo(document,[{_id:dirId}]);const{data:dirInfos}=await collection.get(dirId);return dirInfos}static async ensureMagicFolder(id,path){const magicFolderDocument={_type:Application.doctype,_id:id},folders=await this.getReferencedFolders(magicFolderDocument),existingMagicFolder=folders.length?folders[0]:null;if(existingMagicFolder)return existingMagicFolder;const magicFoldersValues=Object.values(this.magicFolders);if(!magicFoldersValues.includes(id))throw new Error(`Cannot create Magic folder with id ${id}. Allowed values are ${magicFoldersValues.join(", ")}.`);if(!path)throw new Error("Magic folder default path must be defined");return this.createFolderWithReference(path,magicFolderDocument)}static async getReferencedFolders(document){const{included:included}=await this.cozyClient.collection(CozyFile.doctype).findReferencedBy(document);return included.filter(folder=>!this.isTrashed(folder))}static async ensureFolderWithReference(path,document){const existingFolders=await this.getReferencedFolders(document);if(existingFolders.length)return existingFolders[0];const collection=this.cozyClient.collection(CozyFile.doctype),dirId=await collection.ensureDirectoryExists(path);await collection.addReferencesTo(document,[{_id:dirId}]);const{data:dirInfos}=await collection.get(dirId);return dirInfos}static isTrashed(folder){return/^\/\.cozy_trash/.test(folder.attributes.path)}}CozyFolder.magicFolders={ADMINISTRATIVE:`${Application.doctype}/administrative`,PHOTOS:`${Application.doctype}/photos`,PHOTOS_BACKUP:`${Application.doctype}/photos/mobile`,PHOTOS_UPLOAD:`${Application.doctype}/photos/upload`},module.exports=CozyFolder},function(module,exports,__webpack_require__){const PropTypes=__webpack_require__(181),Document=__webpack_require__(33);class Group extends Document{}const GroupShape=PropTypes.shape({_id:PropTypes.string.isRequired,_type:PropTypes.string.isRequired,name:PropTypes.string.isRequired,trashed:PropTypes.bool});Group.doctype="io.cozy.contacts.groups",Group.propType=GroupShape,module.exports=Group},function(module,exports,__webpack_require__){const Document=__webpack_require__(33);class Permission extends Document{}Permission.schema={doctype:"io.cozy.permissions",attributes:{}},module.exports=Permission},function(module,exports,__webpack_require__){"use strict";function has(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}exports.repeat=function(str,num){for(var result="",i=0;i<num;i++)result+=str;return result},exports.arrayEqual=function(a,b){if(a.length!==b.length)return!1;for(var i=0;i<a.length;i++)if(a[i]!==b[i])return!1;return!0},exports.trimChars=function(str,chars){for(var start=0,end=str.length-1;chars.indexOf(str.charAt(start))>=0;)start++;for(;chars.indexOf(str.charAt(end))>=0;)end--;return str.slice(start,end+1)},exports.capitalize=function(str){return str.charAt(0).toUpperCase()+str.slice(1)},exports.arrayUnion=function(){for(var result=[],i=0,values={};i<arguments.length;i++)for(var arr=arguments[i],j=0;j<arr.length;j++)values[arr[j]]||(values[arr[j]]=!0,result.push(arr[j]));return result},exports.has=has,exports.extend=function(dest,src){for(var i in src)has(src,i)&&(dest[i]=src[i])},exports.trimEnd=function(str){return str.replace(/\s+$/g,"")}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,_Symbol=(_freeGlobal||freeSelf||Function("return this")()).Symbol,objectProto=Object.prototype,_getRawTag_hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;var _getRawTag=function(value){var isOwn=_getRawTag_hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result},_objectToString_nativeObjectToString=Object.prototype.toString;var _objectToString=function(value){return _objectToString_nativeObjectToString.call(value)},nullTag="[object Null]",undefinedTag="[object Undefined]",_baseGetTag_symToStringTag=_Symbol?_Symbol.toStringTag:void 0;var _baseGetTag=function(value){return null==value?void 0===value?undefinedTag:nullTag:_baseGetTag_symToStringTag&&_baseGetTag_symToStringTag in Object(value)?_getRawTag(value):_objectToString(value)};var _getPrototype=function(func,transform){return function(arg){return func(transform(arg))}}(Object.getPrototypeOf,Object);var lodash_es_isObjectLike=function(value){return null!=value&&"object"==typeof value},objectTag="[object Object]",funcProto=Function.prototype,isPlainObject_objectProto=Object.prototype,funcToString=funcProto.toString,isPlainObject_hasOwnProperty=isPlainObject_objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object);var lodash_es_isPlainObject=function(value){if(!lodash_es_isObjectLike(value)||_baseGetTag(value)!=objectTag)return!1;var proto=_getPrototype(value);if(null===proto)return!0;var Ctor=isPlainObject_hasOwnProperty.call(proto,"constructor")&&proto.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString},es=__webpack_require__(242),ActionTypes={INIT:"@@redux/INIT"};function createStore_createStore(reducer,preloadedState,enhancer){var _ref2;if("function"==typeof preloadedState&&void 0===enhancer&&(enhancer=preloadedState,preloadedState=void 0),void 0!==enhancer){if("function"!=typeof enhancer)throw new Error("Expected the enhancer to be a function.");return enhancer(createStore_createStore)(reducer,preloadedState)}if("function"!=typeof reducer)throw new Error("Expected the reducer to be a function.");var currentReducer=reducer,currentState=preloadedState,currentListeners=[],nextListeners=currentListeners,isDispatching=!1;function ensureCanMutateNextListeners(){nextListeners===currentListeners&&(nextListeners=currentListeners.slice())}function getState(){return currentState}function subscribe(listener){if("function"!=typeof listener)throw new Error("Expected listener to be a function.");var isSubscribed=!0;return ensureCanMutateNextListeners(),nextListeners.push(listener),function(){if(isSubscribed){isSubscribed=!1,ensureCanMutateNextListeners();var index=nextListeners.indexOf(listener);nextListeners.splice(index,1)}}}function dispatch(action){if(!lodash_es_isPlainObject(action))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===action.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(isDispatching)throw new Error("Reducers may not dispatch actions.");try{isDispatching=!0,currentState=currentReducer(currentState,action)}finally{isDispatching=!1}for(var listeners=currentListeners=nextListeners,i=0;i<listeners.length;i++){(0,listeners[i])()}return action}return dispatch({type:ActionTypes.INIT}),(_ref2={dispatch:dispatch,subscribe:subscribe,getState:getState,replaceReducer:function(nextReducer){if("function"!=typeof nextReducer)throw new Error("Expected the nextReducer to be a function.");currentReducer=nextReducer,dispatch({type:ActionTypes.INIT})}})[es.a]=function(){var _ref,outerSubscribe=subscribe;return(_ref={subscribe:function(observer){if("object"!=typeof observer)throw new TypeError("Expected the observer to be an object.");function observeState(){observer.next&&observer.next(getState())}return observeState(),{unsubscribe:outerSubscribe(observeState)}}})[es.a]=function(){return this},_ref},_ref2}function getUndefinedStateErrorMessage(key,action){var actionType=action&&action.type;return"Given action "+(actionType&&'"'+actionType.toString()+'"'||"an action")+', reducer "'+key+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function combineReducers(reducers){for(var reducerKeys=Object.keys(reducers),finalReducers={},i=0;i<reducerKeys.length;i++){var key=reducerKeys[i];0,"function"==typeof reducers[key]&&(finalReducers[key]=reducers[key])}var finalReducerKeys=Object.keys(finalReducers);var shapeAssertionError=void 0;try{!function(reducers){Object.keys(reducers).forEach(function(key){var reducer=reducers[key];if(void 0===reducer(void 0,{type:ActionTypes.INIT}))throw new Error('Reducer "'+key+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===reducer(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+key+"\" returned undefined when probed with a random type. Don't try to handle "+ActionTypes.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(finalReducers)}catch(e){shapeAssertionError=e}return function(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},action=arguments[1];if(shapeAssertionError)throw shapeAssertionError;for(var hasChanged=!1,nextState={},_i=0;_i<finalReducerKeys.length;_i++){var _key=finalReducerKeys[_i],reducer=finalReducers[_key],previousStateForKey=state[_key],nextStateForKey=reducer(previousStateForKey,action);if(void 0===nextStateForKey){var errorMessage=getUndefinedStateErrorMessage(_key,action);throw new Error(errorMessage)}nextState[_key]=nextStateForKey,hasChanged=hasChanged||nextStateForKey!==previousStateForKey}return hasChanged?nextState:state}}function bindActionCreator(actionCreator,dispatch){return function(){return dispatch(actionCreator.apply(void 0,arguments))}}function bindActionCreators(actionCreators,dispatch){if("function"==typeof actionCreators)return bindActionCreator(actionCreators,dispatch);if("object"!=typeof actionCreators||null===actionCreators)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===actionCreators?"null":typeof actionCreators)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var keys=Object.keys(actionCreators),boundActionCreators={},i=0;i<keys.length;i++){var key=keys[i],actionCreator=actionCreators[key];"function"==typeof actionCreator&&(boundActionCreators[key]=bindActionCreator(actionCreator,dispatch))}return boundActionCreators}function compose(){for(var _len=arguments.length,funcs=Array(_len),_key=0;_key<_len;_key++)funcs[_key]=arguments[_key];return 0===funcs.length?function(arg){return arg}:1===funcs.length?funcs[0]:funcs.reduce(function(a,b){return function(){return a(b.apply(void 0,arguments))}})}var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function applyMiddleware(){for(var _len=arguments.length,middlewares=Array(_len),_key=0;_key<_len;_key++)middlewares[_key]=arguments[_key];return function(createStore){return function(reducer,preloadedState,enhancer){var chain,store=createStore(reducer,preloadedState,enhancer),_dispatch=store.dispatch,middlewareAPI={getState:store.getState,dispatch:function(action){return _dispatch(action)}};return chain=middlewares.map(function(middleware){return middleware(middlewareAPI)}),_dispatch=compose.apply(void 0,chain)(store.dispatch),_extends({},store,{dispatch:_dispatch})}}}__webpack_require__.d(__webpack_exports__,"createStore",function(){return createStore_createStore}),__webpack_require__.d(__webpack_exports__,"combineReducers",function(){return combineReducers}),__webpack_require__.d(__webpack_exports__,"bindActionCreators",function(){return bindActionCreators}),__webpack_require__.d(__webpack_exports__,"applyMiddleware",function(){return applyMiddleware}),__webpack_require__.d(__webpack_exports__,"compose",function(){return compose})},,function(module,exports,__webpack_require__){var flowRight=__webpack_require__(443)(!0);module.exports=flowRight},function(module,exports,__webpack_require__){var findLast=__webpack_require__(655)(__webpack_require__(789));module.exports=findLast},function(module,exports,__webpack_require__){var isSameYear=__webpack_require__(939);module.exports=function(dirtyDate){return isSameYear(new Date,dirtyDate)}},,,,,,,,,,function(module,exports,__webpack_require__){var parse=__webpack_require__(36);module.exports=function(dirtyDate){var date=parse(dirtyDate);return date.setHours(0,0,0,0),date}},,,function(module,exports,__webpack_require__){var parse=__webpack_require__(36);module.exports=function(dirtyDateLeft,dirtyDateRight){var timeLeft=parse(dirtyDateLeft).getTime(),timeRight=parse(dirtyDateRight).getTime();return timeLeft<timeRight?-1:timeLeft>timeRight?1:0}},,,,function(module,exports,__webpack_require__){var baseFindIndex=__webpack_require__(266),baseIteratee=__webpack_require__(18),toInteger=__webpack_require__(139),nativeMax=Math.max,nativeMin=Math.min;module.exports=function(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=length-1;return void 0!==fromIndex&&(index=toInteger(fromIndex),index=fromIndex<0?nativeMax(length+index,0):nativeMin(index,length-1)),baseFindIndex(array,baseIteratee(predicate,3),index,!0)}},,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.cancelable=void 0;var obj,_promise=__webpack_require__(67),_promise2=(obj=_promise)&&obj.__esModule?obj:{default:obj};exports.cancelable=function(promise){var _reject=void 0,wrapped=new _promise2.default(function(resolve,reject){_reject=reject,promise.then(resolve),promise.catch(reject)});return wrapped.cancel=function(){_reject({canceled:!0})},wrapped}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator2=_interopRequireDefault(__webpack_require__(13)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),_classCallCheck3=_interopRequireDefault(__webpack_require__(1)),_createClass3=_interopRequireDefault(__webpack_require__(2));__webpack_require__(803);var _terms2=_interopRequireDefault(__webpack_require__(804)),_constants=__webpack_require__(805);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var getBaseRoute=function(app){var type=app.type;return"/"+(type===_constants.APP_TYPE.KONNECTOR||"node"===type?"konnectors":"apps")},Registry=function(){function Registry(options){if((0,_classCallCheck3.default)(this,Registry),!options.client)throw new Error("Need to pass a client to instantiate a Registry API.");this.client=options.client}var _ref3,_ref2,_ref;return(0,_createClass3.default)(Registry,[{key:"installApp",value:(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(app,source){var slug,terms,searchParams,isUpdate,querypart,verb,baseRoute;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(slug=app.slug,terms=app.terms,searchParams={},(isUpdate=app.installed)&&(searchParams.PermissionsAcked=isUpdate),source&&(searchParams.Source=source),query=void 0,query=new URLSearchParams(searchParams).toString(),querypart=query?"?"+query:"",!terms){_context.next=9;break}return _context.next=9,_terms2.default.save(this.client,terms);case 9:return verb=app.installed?"PUT":"POST",baseRoute=getBaseRoute(app),_context.abrupt("return",this.client.stackClient.fetchJSON(verb,baseRoute+"/"+slug+querypart));case 12:case"end":return _context.stop()}var query},_callee,this)})),function(_x,_x2){return _ref.apply(this,arguments)})},{key:"uninstallApp",value:(_ref2=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(app){var slug,baseRoute;return _regenerator2.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return slug=app.slug,baseRoute=getBaseRoute(app),_context2.abrupt("return",this.client.stackClient.fetchJSON("DELETE",baseRoute+"/"+slug));case 3:case"end":return _context2.stop()}},_callee2,this)})),function(_x3){return _ref2.apply(this,arguments)})},{key:"fetchApps",value:(_ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(options){var channel,type,querypart,_ref4,apps;return _regenerator2.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return channel=options.channel,type=options.type,querypart=new URLSearchParams({limit:200,versionsChannel:channel,latestChannelVersion:channel}).toString(),type&&(querypart=querypart+"&filter[type]="+type),_context3.next=6,this.client.stackClient.fetchJSON("GET","/registry?"+querypart);case 6:return _ref4=_context3.sent,apps=_ref4.data,_context3.abrupt("return",apps);case 9:case"end":return _context3.stop()}},_callee3,this)})),function(_x4){return _ref3.apply(this,arguments)})},{key:"fetchAppsInMaintenance",value:function(){return this.client.stackClient.fetchJSON("GET","/registry/maintenance")}},{key:"fetchApp",value:function(slug){return this.client.stackClient.fetchJSON("GET","/registry/"+slug)}}]),Registry}();exports.default=Registry},function(module,exports){!function(self){"use strict";var ampersandTest,nativeURLSearchParams=self.URLSearchParams&&self.URLSearchParams.prototype.get?self.URLSearchParams:null,isSupportObjectConstructor=nativeURLSearchParams&&"a=1"===new nativeURLSearchParams({a:1}).toString(),decodesPlusesCorrectly=nativeURLSearchParams&&"+"===new nativeURLSearchParams("s=%2B").get("s"),__URLSearchParams__="__URLSearchParams__",encodesAmpersandsCorrectly=!nativeURLSearchParams||((ampersandTest=new nativeURLSearchParams).append("s"," &"),"s=+%26"===ampersandTest.toString()),prototype=URLSearchParamsPolyfill.prototype,iterable=!(!self.Symbol||!self.Symbol.iterator);if(!(nativeURLSearchParams&&isSupportObjectConstructor&&decodesPlusesCorrectly&&encodesAmpersandsCorrectly)){prototype.append=function(name,value){appendTo(this[__URLSearchParams__],name,value)},prototype.delete=function(name){delete this[__URLSearchParams__][name]},prototype.get=function(name){var dict=this[__URLSearchParams__];return name in dict?dict[name][0]:null},prototype.getAll=function(name){var dict=this[__URLSearchParams__];return name in dict?dict[name].slice(0):[]},prototype.has=function(name){return name in this[__URLSearchParams__]},prototype.set=function(name,value){this[__URLSearchParams__][name]=[""+value]},prototype.toString=function(){var i,key,name,value,dict=this[__URLSearchParams__],query=[];for(key in dict)for(name=encode(key),i=0,value=dict[key];i<value.length;i++)query.push(name+"="+encode(value[i]));return query.join("&")};var useProxy=!!decodesPlusesCorrectly&&nativeURLSearchParams&&!isSupportObjectConstructor&&self.Proxy;Object.defineProperty(self,"URLSearchParams",{value:useProxy?new Proxy(nativeURLSearchParams,{construct:function(target,args){return new target(new URLSearchParamsPolyfill(args[0]).toString())}}):URLSearchParamsPolyfill});var USPProto=self.URLSearchParams.prototype;USPProto.polyfill=!0,USPProto.forEach=USPProto.forEach||function(callback,thisArg){var dict=parseToDict(this.toString());Object.getOwnPropertyNames(dict).forEach(function(name){dict[name].forEach(function(value){callback.call(thisArg,value,name,this)},this)},this)},USPProto.sort=USPProto.sort||function(){var k,i,j,dict=parseToDict(this.toString()),keys=[];for(k in dict)keys.push(k);for(keys.sort(),i=0;i<keys.length;i++)this.delete(keys[i]);for(i=0;i<keys.length;i++){var key=keys[i],values=dict[key];for(j=0;j<values.length;j++)this.append(key,values[j])}},USPProto.keys=USPProto.keys||function(){var items=[];return this.forEach(function(item,name){items.push(name)}),makeIterator(items)},USPProto.values=USPProto.values||function(){var items=[];return this.forEach(function(item){items.push(item)}),makeIterator(items)},USPProto.entries=USPProto.entries||function(){var items=[];return this.forEach(function(item,name){items.push([name,item])}),makeIterator(items)},iterable&&(USPProto[self.Symbol.iterator]=USPProto[self.Symbol.iterator]||USPProto.entries)}function URLSearchParamsPolyfill(search){((search=search||"")instanceof URLSearchParams||search instanceof URLSearchParamsPolyfill)&&(search=search.toString()),this[__URLSearchParams__]=parseToDict(search)}function encode(str){var replace={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(str).replace(/[!'\(\)~]|%20|%00/g,function(match){return replace[match]})}function decode(str){return str.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,function(match){return decodeURIComponent(match)})}function makeIterator(arr){var iterator={next:function(){var value=arr.shift();return{done:void 0===value,value:value}}};return iterable&&(iterator[self.Symbol.iterator]=function(){return iterator}),iterator}function parseToDict(search){var dict={};if("object"==typeof search)if(isArray(search))for(var i=0;i<search.length;i++){var item=search[i];if(!isArray(item)||2!==item.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");appendTo(dict,item[0],item[1])}else for(var key in search)search.hasOwnProperty(key)&&appendTo(dict,key,search[key]);else{0===search.indexOf("?")&&(search=search.slice(1));for(var pairs=search.split("&"),j=0;j<pairs.length;j++){var value=pairs[j],index=value.indexOf("=");-1<index?appendTo(dict,decode(value.slice(0,index)),decode(value.slice(index+1))):value&&appendTo(dict,decode(value),"")}}return dict}function appendTo(dict,name,value){var val="string"==typeof value?value:null!=value&&"function"==typeof value.toString?value.toString():JSON.stringify(value);name in dict?dict[name].push(val):dict[name]=[val]}function isArray(val){return!!val&&"[object Array]"===Object.prototype.toString.call(val)}}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _ref,_regenerator2=_interopRequireDefault(__webpack_require__(13)),_extends3=_interopRequireDefault(__webpack_require__(3)),_objectWithoutProperties3=_interopRequireDefault(__webpack_require__(86)),_asyncToGenerator3=_interopRequireDefault(__webpack_require__(16)),save=(_ref=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(client,terms){var id,termsAttributes,_ref2,savedTermsDocs,savedTerms,termsToSave,_termsToSave;return _regenerator2.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return id=terms.id,termsAttributes=(0,_objectWithoutProperties3.default)(terms,["id"]),_context.next=3,client.query({doctype:TERMS_DOCTYPE,selector:{termsId:id,version:termsAttributes.version},limit:1});case 3:if(_ref2=_context.sent,!(savedTermsDocs=_ref2.data)||!savedTermsDocs.length){_context.next=13;break}if((savedTerms=savedTermsDocs[0]).termsId!=id||savedTerms.version!=termsAttributes.version||savedTerms.url==termsAttributes.url){_context.next=11;break}return termsToSave=(0,_extends3.default)({_type:TERMS_DOCTYPE},savedTerms,{url:termsAttributes.url}),_context.next=11,client.save(termsToSave);case 11:_context.next=16;break;case 13:return _termsToSave=(0,_extends3.default)({_type:TERMS_DOCTYPE},termsAttributes,{termsId:id,accepted:!0,acceptedAt:new Date}),_context.next=16,client.save(_termsToSave);case 16:case"end":return _context.stop()}},_callee,this)})),function(_x,_x2){return _ref.apply(this,arguments)});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TERMS_DOCTYPE="io.cozy.terms";exports.default={save:save}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.APP_TYPE={KONNECTOR:"konnector",WEBAPP:"webapp"}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof3=_interopRequireDefault(__webpack_require__(96)),_extends3=_interopRequireDefault(__webpack_require__(3));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.sanitizeCategories=sanitizeCategories,exports.areTermsValid=areTermsValid,exports.isPartnershipValid=isPartnershipValid,exports.sanitize=function(manifest){var sanitized=(0,_extends3.default)({},manifest);!manifest.categories&&manifest.category&&"string"==typeof manifest.category&&(sanitized.categories=[manifest.category],delete sanitized.category);sanitized.categories=sanitizeCategories(sanitized.categories),"object"===(0,_typeof3.default)(manifest.name)&&(sanitized.name=manifest.name.en);manifest.available_version&&(sanitized.availableVersion=manifest.available_version,delete sanitized.available_version);manifest.latest_version&&(sanitized.latestVersion=manifest.latestVersion,delete sanitized.latest_version);sanitized.terms&&!areTermsValid(sanitized.terms)&&delete sanitized.terms;sanitized.partnership&&!isPartnershipValid(sanitized.partnership)&&delete sanitized.partnership;return sanitized};var APP_CATEGORIES=["banking","cozy","energy","health","host_provider","insurance","isp","mes_infos","online_services","others","partners","press","productivity","ptnb","public_service","shopping","social","telecom","transport"];function sanitizeCategories(categories){if(!categories)return["others"];var filteredList=categories.filter(function(c){return APP_CATEGORIES.includes(c)});return filteredList.length?filteredList:["others"]}function areTermsValid(terms){return Boolean(terms&&terms.id&&terms.url&&terms.version)}function isPartnershipValid(partnership){return Boolean(partnership&&partnership.description)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}},function(module,exports,__webpack_require__){var apply=__webpack_require__(249),arrayMap=__webpack_require__(35),baseIteratee=__webpack_require__(18),baseRest=__webpack_require__(54),baseUnary=__webpack_require__(88),flatRest=__webpack_require__(170);module.exports=function(arrayFunc){return flatRest(function(iteratees){return iteratees=arrayMap(iteratees,baseUnary(baseIteratee)),baseRest(function(args){var thisArg=this;return arrayFunc(iteratees,function(iteratee){return apply(iteratee,thisArg,args)})})})}},,function(module,exports,__webpack_require__){var baseFindIndex=__webpack_require__(266),baseIteratee=__webpack_require__(18),toInteger=__webpack_require__(139),nativeMax=Math.max;module.exports=function(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=null==fromIndex?0:toInteger(fromIndex);return index<0&&(index=nativeMax(length+index,0)),baseFindIndex(array,baseIteratee(predicate,3),index)}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){var parse=__webpack_require__(36);module.exports=function(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft),dateRight=parse(dirtyDateRight);return dateLeft.getFullYear()===dateRight.getFullYear()}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),Action=__webpack_require__(269),ActionStoreConstant=module.exports=function(options){if((options=options||{}).nargs=0,void 0===options.constant)throw new Error("constant option is required for storeAction");Action.call(this,options)};util.inherits(ActionStoreConstant,Action),ActionStoreConstant.prototype.call=function(parser,namespace){namespace.set(this.dest,this.constant)}},function(module,exports,__webpack_require__){"use strict";var format=__webpack_require__(8).format;module.exports=function(argument,message){var errMessage,err,argumentName=null;return errMessage=(argumentName=argument.getName?argument.getName():""+argument)?format('argument "%s": %s',argumentName,message):message,(err=new TypeError(errMessage)).code="ARGError",err}},function(module,exports,__webpack_require__){"use strict";var sprintf=__webpack_require__(1235).sprintf,c=__webpack_require__(240),$$=__webpack_require__(767);function Section(parent,heading){this._parent=parent,this._heading=heading,this._items=[]}Section.prototype.addItem=function(callback){this._items.push(callback)},Section.prototype.formatHelp=function(formatter){var itemHelp,heading;if(this._parent&&formatter._indent(),itemHelp=this._items.map(function(item){var obj,func,args;return obj=formatter,func=item[0],args=item[1],func.apply(obj,args)}),itemHelp=formatter._joinParts(itemHelp),this._parent&&formatter._dedent(),!itemHelp)return"";if(heading="",this._heading&&this._heading!==c.SUPPRESS){var currentIndent=formatter.currentIndent;heading=$$.repeat(" ",currentIndent)+this._heading+":"+c.EOL}return formatter._joinParts([c.EOL,heading,itemHelp,c.EOL])};var HelpFormatter=module.exports=function(options){options=options||{},this._prog=options.prog,this._maxHelpPosition=options.maxHelpPosition||24,this._width=options.width||(process.env.COLUMNS||80)-2,this._currentIndent=0,this._indentIncriment=options.indentIncriment||2,this._level=0,this._actionMaxLength=0,this._rootSection=new Section(null),this._currentSection=this._rootSection,this._whitespaceMatcher=new RegExp("\\s+","g"),this._longBreakMatcher=new RegExp(c.EOL+c.EOL+c.EOL+"+","g")};HelpFormatter.prototype._indent=function(){this._currentIndent+=this._indentIncriment,this._level+=1},HelpFormatter.prototype._dedent=function(){if(this._currentIndent-=this._indentIncriment,this._level-=1,this._currentIndent<0)throw new Error("Indent decreased below 0.")},HelpFormatter.prototype._addItem=function(func,args){this._currentSection.addItem([func,args])},HelpFormatter.prototype.startSection=function(heading){this._indent();var section=new Section(this._currentSection,heading),func=section.formatHelp.bind(section);this._addItem(func,[this]),this._currentSection=section},HelpFormatter.prototype.endSection=function(){this._currentSection=this._currentSection._parent,this._dedent()},HelpFormatter.prototype.addText=function(text){text&&text!==c.SUPPRESS&&this._addItem(this._formatText,[text])},HelpFormatter.prototype.addUsage=function(usage,actions,groups,prefix){usage!==c.SUPPRESS&&this._addItem(this._formatUsage,[usage,actions,groups,prefix])},HelpFormatter.prototype.addArgument=function(action){if(action.help!==c.SUPPRESS){var actionLength,self=this,invocations=[this._formatActionInvocation(action)],invocationLength=invocations[0].length;action._getSubactions&&(this._indent(),action._getSubactions().forEach(function(subaction){var invocationNew=self._formatActionInvocation(subaction);invocations.push(invocationNew),invocationLength=Math.max(invocationLength,invocationNew.length)}),this._dedent()),actionLength=invocationLength+this._currentIndent,this._actionMaxLength=Math.max(this._actionMaxLength,actionLength),this._addItem(this._formatAction,[action])}},HelpFormatter.prototype.addArguments=function(actions){var self=this;actions.forEach(function(action){self.addArgument(action)})},HelpFormatter.prototype.formatHelp=function(){var help=this._rootSection.formatHelp(this);return help&&(help=help.replace(this._longBreakMatcher,c.EOL+c.EOL),help=$$.trimChars(help,c.EOL)+c.EOL),help},HelpFormatter.prototype._joinParts=function(partStrings){return partStrings.filter(function(part){return part&&part!==c.SUPPRESS}).join("")},HelpFormatter.prototype._formatUsage=function(usage,actions,groups,prefix){if(prefix||"string"==typeof prefix||(prefix="usage: "),actions=actions||[],groups=groups||[],usage)usage=sprintf(usage,{prog:this._prog});else if(usage||0!==actions.length){if(!usage){var textWidth,prog=this._prog,optionals=[],positionals=[];if(actions.forEach(function(action){action.isOptional()?optionals.push(action):positionals.push(action)}),usage=[prog,this._formatActionsUsage([].concat(optionals,positionals),groups)].join(" "),textWidth=this._width-this._currentIndent,prefix.length+usage.length>textWidth){var regexpPart=new RegExp("\\(.*?\\)+|\\[.*?\\]+|\\S+","g"),optionalUsage=this._formatActionsUsage(optionals,groups),positionalUsage=this._formatActionsUsage(positionals,groups),optionalParts=optionalUsage.match(regexpPart),positionalParts=positionalUsage.match(regexpPart)||[];if(optionalParts.join(" ")!==optionalUsage)throw new Error("assert \"optionalParts.join(' ') === optionalUsage\"");if(positionalParts.join(" ")!==positionalUsage)throw new Error("assert \"positionalParts.join(' ') === positionalUsage\"");var lines,indent,_getLines=function(parts,indent,prefix){var lines=[],line=[],lineLength=prefix?prefix.length-1:indent.length-1;return parts.forEach(function(part){lineLength+1+part.length>textWidth&&(lines.push(indent+line.join(" ")),line=[],lineLength=indent.length-1),line.push(part),lineLength+=part.length+1}),line&&lines.push(indent+line.join(" ")),prefix&&(lines[0]=lines[0].substr(indent.length)),lines};prefix.length+prog.length<=.75*textWidth?(indent=$$.repeat(" ",prefix.length+prog.length+1),lines=optionalParts?[].concat(_getLines([prog].concat(optionalParts),indent,prefix),_getLines(positionalParts,indent)):positionalParts?_getLines([prog].concat(positionalParts),indent,prefix):[prog]):(indent=$$.repeat(" ",prefix.length),(lines=_getLines(optionalParts.concat(positionalParts),indent)).length>1&&(lines=[].concat(_getLines(optionalParts,indent),_getLines(positionalParts,indent))),lines=[prog].concat(lines)),usage=lines.join(c.EOL)}}}else usage=this._prog;return prefix+usage+c.EOL+c.EOL},HelpFormatter.prototype._formatActionsUsage=function(actions,groups){var groupActions=[],inserts=[],self=this;groups.forEach(function(group){var end,i,start=actions.indexOf(group._groupActions[0]);if(start>=0&&(end=start+group._groupActions.length,$$.arrayEqual(actions.slice(start,end),group._groupActions)))for(group._groupActions.forEach(function(action){groupActions.push(action)}),group.required?(inserts[start]?inserts[start]+=" (":inserts[start]="(",inserts[end]=")"):(inserts[start]?inserts[start]+=" [":inserts[start]="[",inserts[end]="]"),i=start+1;i<end;i+=1)inserts[i]="|"});var parts=[];actions.forEach(function(action,actionIndex){var part,optionString,argsDefault;action.help===c.SUPPRESS?(parts.push(null),"|"===inserts[actionIndex]?inserts.splice(actionIndex,actionIndex):"|"===inserts[actionIndex+1]&&inserts.splice(actionIndex+1,actionIndex+1)):action.isOptional()?(optionString=action.optionStrings[0],0===action.nargs?part=""+optionString:(argsDefault=action.dest.toUpperCase(),part=optionString+" "+self._formatArgs(action,argsDefault)),!action.required&&groupActions.indexOf(action)<0&&(part="["+part+"]"),parts.push(part)):(part=self._formatArgs(action,action.dest),groupActions.indexOf(action)>=0&&"["===part[0]&&"]"===part[part.length-1]&&(part=part.slice(1,-1)),parts.push(part))});for(var i=inserts.length-1;i>=0;--i)null!==inserts[i]&&parts.splice(i,0,inserts[i]);var text=parts.filter(function(part){return!!part}).join(" ");return text=(text=(text=(text=(text=(text=text.replace(/([\[(]) /g,"$1")).replace(/ ([\])])/g,"$1")).replace(/\[ *\]/g,"")).replace(/\( *\)/g,"")).replace(/\(([^|]*)\)/g,"$1")).trim()},HelpFormatter.prototype._formatText=function(text){text=sprintf(text,{prog:this._prog});var textWidth=this._width-this._currentIndent,indentIncriment=$$.repeat(" ",this._currentIndent);return this._fillText(text,textWidth,indentIncriment)+c.EOL+c.EOL},HelpFormatter.prototype._formatAction=function(action){var helpText,helpLines,parts,indentFirst,self=this,helpPosition=Math.min(this._actionMaxLength+2,this._maxHelpPosition),helpWidth=this._width-helpPosition,actionWidth=helpPosition-this._currentIndent-2,actionHeader=this._formatActionInvocation(action);return action.help?actionHeader.length<=actionWidth?(actionHeader=$$.repeat(" ",this._currentIndent)+actionHeader+"  "+$$.repeat(" ",actionWidth-actionHeader.length),indentFirst=0):(actionHeader=$$.repeat(" ",this._currentIndent)+actionHeader+c.EOL,indentFirst=helpPosition):actionHeader=$$.repeat(" ",this._currentIndent)+actionHeader+c.EOL,parts=[actionHeader],action.help?(helpText=this._expandHelp(action),helpLines=this._splitLines(helpText,helpWidth),parts.push($$.repeat(" ",indentFirst)+helpLines[0]+c.EOL),helpLines.slice(1).forEach(function(line){parts.push($$.repeat(" ",helpPosition)+line+c.EOL)})):actionHeader.charAt(actionHeader.length-1)!==c.EOL&&parts.push(c.EOL),action._getSubactions&&(this._indent(),action._getSubactions().forEach(function(subaction){parts.push(self._formatAction(subaction))}),this._dedent()),this._joinParts(parts)},HelpFormatter.prototype._formatActionInvocation=function(action){if(!action.isOptional())return this._metavarFormatter(action,action.dest)(1)[0];var argsDefault,argsString,parts=[];return 0===action.nargs?parts=parts.concat(action.optionStrings):(argsDefault=action.dest.toUpperCase(),argsString=this._formatArgs(action,argsDefault),action.optionStrings.forEach(function(optionString){parts.push(optionString+" "+argsString)})),parts.join(", ")},HelpFormatter.prototype._metavarFormatter=function(action,metavarDefault){var result;if(action.metavar||""===action.metavar)result=action.metavar;else if(action.choices){var choices=action.choices;choices="string"==typeof choices?choices.split("").join(", "):Array.isArray(choices)?choices.join(","):Object.keys(choices).join(","),result="{"+choices+"}"}else result=metavarDefault;return function(size){if(Array.isArray(result))return result;for(var metavars=[],i=0;i<size;i+=1)metavars.push(result);return metavars}},HelpFormatter.prototype._formatArgs=function(action,metavarDefault){var result,metavars,buildMetavar=this._metavarFormatter(action,metavarDefault);switch(action.nargs){case void 0:case null:result=""+(metavars=buildMetavar(1))[0];break;case c.OPTIONAL:result="["+(metavars=buildMetavar(1))[0]+"]";break;case c.ZERO_OR_MORE:result="["+(metavars=buildMetavar(2))[0]+" ["+metavars[1]+" ...]]";break;case c.ONE_OR_MORE:result=(metavars=buildMetavar(2))[0]+" ["+metavars[1]+" ...]";break;case c.REMAINDER:result="...";break;case c.PARSER:result=(metavars=buildMetavar(1))[0]+" ...";break;default:result=(metavars=buildMetavar(action.nargs)).join(" ")}return result},HelpFormatter.prototype._expandHelp=function(action){var params={prog:this._prog};return Object.keys(action).forEach(function(actionProperty){var actionValue=action[actionProperty];actionValue!==c.SUPPRESS&&(params[actionProperty]=actionValue)}),params.choices&&("string"==typeof params.choices?params.choices=params.choices.split("").join(", "):Array.isArray(params.choices)?params.choices=params.choices.join(", "):params.choices=Object.keys(params.choices).join(", ")),sprintf(this._getHelpString(action),params)},HelpFormatter.prototype._splitLines=function(text,width){var lines=[],delimiters=[" ",".",",","!","?"],re=new RegExp("["+delimiters.join("")+"][^"+delimiters.join("")+"]*$");return(text=(text=(text=text.replace(/[\n\|\t]/g," ")).trim()).replace(this._whitespaceMatcher," ")).split(c.EOL).forEach(function(line){if(width>=line.length)lines.push(line);else{for(var wrapStart=0,wrapEnd=width;wrapEnd<=line.length;)wrapEnd!==line.length&&delimiters.indexOf(line[wrapEnd]<-1)&&(wrapEnd=wrapStart+(re.exec(line.substring(wrapStart,wrapEnd))||{}).index+1),lines.push(line.substring(wrapStart,wrapEnd)),wrapStart=wrapEnd,wrapEnd+=width;wrapStart<line.length&&lines.push(line.substring(wrapStart,wrapEnd))}}),lines},HelpFormatter.prototype._fillText=function(text,width,indent){var lines=this._splitLines(text,width);return(lines=lines.map(function(line){return indent+line})).join(c.EOL)},HelpFormatter.prototype._getHelpString=function(action){return action.help}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),c=__webpack_require__(240),$$=__webpack_require__(767),HelpFormatter=__webpack_require__(942);function ArgumentDefaultsHelpFormatter(options){HelpFormatter.call(this,options)}function RawDescriptionHelpFormatter(options){HelpFormatter.call(this,options)}function RawTextHelpFormatter(options){RawDescriptionHelpFormatter.call(this,options)}util.inherits(ArgumentDefaultsHelpFormatter,HelpFormatter),ArgumentDefaultsHelpFormatter.prototype._getHelpString=function(action){var help=action.help;if(-1===action.help.indexOf("%(defaultValue)s")&&action.defaultValue!==c.SUPPRESS){var defaulting_nargs=[c.OPTIONAL,c.ZERO_OR_MORE];(action.isOptional()||defaulting_nargs.indexOf(action.nargs)>=0)&&(help+=" (default: %(defaultValue)s)")}return help},module.exports.ArgumentDefaultsHelpFormatter=ArgumentDefaultsHelpFormatter,util.inherits(RawDescriptionHelpFormatter,HelpFormatter),RawDescriptionHelpFormatter.prototype._fillText=function(text,width,indent){var lines=text.split("\n");return(lines=lines.map(function(line){return $$.trimEnd(indent+line)})).join("\n")},module.exports.RawDescriptionHelpFormatter=RawDescriptionHelpFormatter,util.inherits(RawTextHelpFormatter,RawDescriptionHelpFormatter),RawTextHelpFormatter.prototype._splitLines=function(text){return text.split("\n")},module.exports.RawTextHelpFormatter=RawTextHelpFormatter},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){!function(window){var re={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function sprintf(){var key=arguments[0],cache=sprintf.cache;return cache[key]&&cache.hasOwnProperty(key)||(cache[key]=sprintf.parse(key)),sprintf.format.call(null,cache[key],arguments)}sprintf.format=function(parse_tree,argv){var arg,i,k,match,pad,pad_character,pad_length,input,cursor=1,tree_length=parse_tree.length,node_type="",output=[],is_positive=!0,sign="";for(i=0;i<tree_length;i++)if("string"===(node_type=get_type(parse_tree[i])))output[output.length]=parse_tree[i];else if("array"===node_type){if((match=parse_tree[i])[2])for(arg=argv[cursor],k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k]))throw new Error(sprintf("[sprintf] property '%s' does not exist",match[2][k]));arg=arg[match[2][k]]}else arg=match[1]?argv[match[1]]:argv[cursor++];if("function"==get_type(arg)&&(arg=arg()),re.not_string.test(match[8])&&re.not_json.test(match[8])&&"number"!=get_type(arg)&&isNaN(arg))throw new TypeError(sprintf("[sprintf] expecting number but found %s",get_type(arg)));switch(re.number.test(match[8])&&(is_positive=arg>=0),match[8]){case"b":arg=arg.toString(2);break;case"c":arg=String.fromCharCode(arg);break;case"d":case"i":arg=parseInt(arg,10);break;case"j":arg=JSON.stringify(arg,null,match[6]?parseInt(match[6]):0);break;case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential();break;case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg);break;case"g":arg=match[7]?parseFloat(arg).toPrecision(match[7]):parseFloat(arg);break;case"o":arg=arg.toString(8);break;case"s":arg=(arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg;break;case"u":arg>>>=0;break;case"x":arg=arg.toString(16);break;case"X":arg=arg.toString(16).toUpperCase()}re.json.test(match[8])?output[output.length]=arg:(!re.number.test(match[8])||is_positive&&!match[3]?sign="":(sign=is_positive?"+":"-",arg=arg.toString().replace(re.sign,"")),pad_character=match[4]?"0"===match[4]?"0":match[4].charAt(1):" ",pad_length=match[6]-(sign+arg).length,pad=match[6]&&pad_length>0?(input=pad_character,Array(pad_length+1).join(input)):"",output[output.length]=match[5]?sign+arg+pad:"0"===pad_character?sign+pad+arg:pad+sign+arg)}return output.join("")},sprintf.cache={},sprintf.parse=function(fmt){for(var _fmt=fmt,match=[],parse_tree=[],arg_names=0;_fmt;){if(null!==(match=re.text.exec(_fmt)))parse_tree[parse_tree.length]=match[0];else if(null!==(match=re.modulo.exec(_fmt)))parse_tree[parse_tree.length]="%";else{if(null===(match=re.placeholder.exec(_fmt)))throw new SyntaxError("[sprintf] unexpected placeholder");if(match[2]){arg_names|=1;var field_list=[],replacement_field=match[2],field_match=[];if(null===(field_match=re.key.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(field_list[field_list.length]=field_match[1];""!==(replacement_field=replacement_field.substring(field_match[0].length));)if(null!==(field_match=re.key_access.exec(replacement_field)))field_list[field_list.length]=field_match[1];else{if(null===(field_match=re.index_access.exec(replacement_field)))throw new SyntaxError("[sprintf] failed to parse named argument key");field_list[field_list.length]=field_match[1]}match[2]=field_list}else arg_names|=2;if(3===arg_names)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");parse_tree[parse_tree.length]=match}_fmt=_fmt.substring(match[0].length)}return parse_tree};function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}exports.sprintf=sprintf,exports.vsprintf=function(fmt,argv,_argv){return(_argv=(argv||[]).slice(0)).splice(0,0,fmt),sprintf.apply(null,_argv)}}("undefined"==typeof window||window)},function(module,exports,__webpack_require__){"use strict";var format=__webpack_require__(8).format,c=__webpack_require__(240),$$=__webpack_require__(767),ActionHelp=__webpack_require__(1719),ActionAppend=__webpack_require__(1720),ActionAppendConstant=__webpack_require__(1721),ActionCount=__webpack_require__(1722),ActionStore=__webpack_require__(1723),ActionStoreConstant=__webpack_require__(940),ActionStoreTrue=__webpack_require__(1724),ActionStoreFalse=__webpack_require__(1725),ActionVersion=__webpack_require__(1726),ActionSubparsers=__webpack_require__(1727),argumentErrorHelper=__webpack_require__(941),ActionContainer=module.exports=function(options){options=options||{},this.description=options.description,this.argumentDefault=options.argumentDefault,this.prefixChars=options.prefixChars||"",this.conflictHandler=options.conflictHandler,this._registries={},this.register("action",null,ActionStore),this.register("action","store",ActionStore),this.register("action","storeConst",ActionStoreConstant),this.register("action","storeTrue",ActionStoreTrue),this.register("action","storeFalse",ActionStoreFalse),this.register("action","append",ActionAppend),this.register("action","appendConst",ActionAppendConstant),this.register("action","count",ActionCount),this.register("action","help",ActionHelp),this.register("action","version",ActionVersion),this.register("action","parsers",ActionSubparsers),this._getHandler(),this._actions=[],this._optionStringActions={},this._actionGroups=[],this._mutuallyExclusiveGroups=[],this._defaults={},this._regexpNegativeNumber=new RegExp("^[-]?[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?$"),this._hasNegativeNumberOptionals=[]},ArgumentGroup=__webpack_require__(1237),MutuallyExclusiveGroup=__webpack_require__(1728);ActionContainer.prototype.register=function(registryName,value,object){this._registries[registryName]=this._registries[registryName]||{},this._registries[registryName][value]=object},ActionContainer.prototype._registryGet=function(registryName,value,defaultValue){return arguments.length<3&&(defaultValue=null),this._registries[registryName][value]||defaultValue},ActionContainer.prototype.setDefaults=function(options){for(var property in options=options||{})$$.has(options,property)&&(this._defaults[property]=options[property]);this._actions.forEach(function(action){$$.has(options,action.dest)&&(action.defaultValue=options[action.dest])})},ActionContainer.prototype.getDefault=function(dest){var result=$$.has(this._defaults,dest)?this._defaults[dest]:null;return this._actions.forEach(function(action){action.dest===dest&&$$.has(action,"defaultValue")&&(result=action.defaultValue)}),result},ActionContainer.prototype.addArgument=function(args,options){if(options=options||{},"string"==typeof(args=args)&&(args=[args]),!Array.isArray(args))throw new TypeError("addArgument first argument should be a string or an array");if("object"!=typeof options||Array.isArray(options))throw new TypeError("addArgument second argument should be a hash");if(!args||1===args.length&&this.prefixChars.indexOf(args[0][0])<0){if(args&&options.dest)throw new Error("dest supplied twice for positional argument");options=this._getPositional(args,options)}else options=this._getOptional(args,options);if(void 0===options.defaultValue){var dest=options.dest;$$.has(this._defaults,dest)?options.defaultValue=this._defaults[dest]:void 0!==this.argumentDefault&&(options.defaultValue=this.argumentDefault)}var ActionClass=this._popActionClass(options);if("function"!=typeof ActionClass)throw new Error(format('Unknown action "%s".',ActionClass));var action=new ActionClass(options),typeFunction=this._registryGet("type",action.type,action.type);if("function"!=typeof typeFunction)throw new Error(format('"%s" is not callable',typeFunction));return this._addAction(action)},ActionContainer.prototype.addArgumentGroup=function(options){var group=new ArgumentGroup(this,options);return this._actionGroups.push(group),group},ActionContainer.prototype.addMutuallyExclusiveGroup=function(options){var group=new MutuallyExclusiveGroup(this,options);return this._mutuallyExclusiveGroups.push(group),group},ActionContainer.prototype._addAction=function(action){var self=this;return this._checkConflict(action),this._actions.push(action),action.container=this,action.optionStrings.forEach(function(optionString){self._optionStringActions[optionString]=action}),action.optionStrings.forEach(function(optionString){optionString.match(self._regexpNegativeNumber)&&(self._hasNegativeNumberOptionals.some(Boolean)||self._hasNegativeNumberOptionals.push(!0))}),action},ActionContainer.prototype._removeAction=function(action){var actionIndex=this._actions.indexOf(action);actionIndex>=0&&this._actions.splice(actionIndex,1)},ActionContainer.prototype._addContainerActions=function(container){var titleGroupMap={};this._actionGroups.forEach(function(group){if(titleGroupMap[group.title])throw new Error(format('Cannot merge actions - two groups are named "%s".',group.title));titleGroupMap[group.title]=group});var mutexGroup,groupMap={};function actionHash(action){return action.getName()}container._actionGroups.forEach(function(group){titleGroupMap[group.title]||(titleGroupMap[group.title]=this.addArgumentGroup({title:group.title,description:group.description})),group._groupActions.forEach(function(action){groupMap[actionHash(action)]=titleGroupMap[group.title]})},this),container._mutuallyExclusiveGroups.forEach(function(group){mutexGroup=this.addMutuallyExclusiveGroup({required:group.required}),group._groupActions.forEach(function(action){groupMap[actionHash(action)]=mutexGroup})},this),container._actions.forEach(function(action){var key=actionHash(action);groupMap[key]?groupMap[key]._addAction(action):this._addAction(action)})},ActionContainer.prototype._getPositional=function(dest,options){if(Array.isArray(dest)&&(dest=dest[0]),options.required)throw new Error('"required" is an invalid argument for positionals.');return options.nargs!==c.OPTIONAL&&options.nargs!==c.ZERO_OR_MORE&&(options.required=!0),options.nargs===c.ZERO_OR_MORE&&void 0===options.defaultValue&&(options.required=!0),options.dest=dest,options.optionStrings=[],options},ActionContainer.prototype._getOptional=function(args,options){var prefixChars=this.prefixChars,optionStrings=[],optionStringsLong=[];args.forEach(function(optionString){if(prefixChars.indexOf(optionString[0])<0)throw new Error(format('Invalid option string "%s": must start with a "%s".',optionString,prefixChars));optionStrings.push(optionString),optionString.length>1&&prefixChars.indexOf(optionString[1])>=0&&optionStringsLong.push(optionString)});var dest=options.dest||null;if(delete options.dest,!dest){var optionStringDest=optionStringsLong.length?optionStringsLong[0]:optionStrings[0];if(0===(dest=$$.trimChars(optionStringDest,this.prefixChars)).length)throw new Error(format('dest= is required for options like "%s"',optionStrings.join(", ")));dest=dest.replace(/-/g,"_")}return options.dest=dest,options.optionStrings=optionStrings,options},ActionContainer.prototype._popActionClass=function(options,defaultValue){defaultValue=defaultValue||null;var action=options.action||defaultValue;return delete options.action,this._registryGet("action",action,action)},ActionContainer.prototype._getHandler=function(){var handlerString=this.conflictHandler,func=this["_handleConflict"+$$.capitalize(handlerString)];if(void 0===func)throw new Error("invalid conflict resolution value: "+handlerString);return func},ActionContainer.prototype._checkConflict=function(action){var optionStringActions=this._optionStringActions,conflictOptionals=[];(action.optionStrings.forEach(function(optionString){var conflOptional=optionStringActions[optionString];void 0!==conflOptional&&conflictOptionals.push([optionString,conflOptional])}),conflictOptionals.length>0)&&this._getHandler().call(this,action,conflictOptionals)},ActionContainer.prototype._handleConflictError=function(action,conflOptionals){var conflicts=conflOptionals.map(function(pair){return pair[0]});throw conflicts=conflicts.join(", "),argumentErrorHelper(action,format("Conflicting option string(s): %s",conflicts))},ActionContainer.prototype._handleConflictResolve=function(action,conflOptionals){var self=this;conflOptionals.forEach(function(pair){var optionString=pair[0],conflictingAction=pair[1],i=conflictingAction.optionStrings.indexOf(optionString);i>=0&&conflictingAction.optionStrings.splice(i,1),delete self._optionStringActions[optionString],0===conflictingAction.optionStrings.length&&conflictingAction.container._removeAction(conflictingAction)})}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),ActionContainer=__webpack_require__(1236),ArgumentGroup=module.exports=function(container,options){(options=options||{}).conflictHandler=options.conflictHandler||container.conflictHandler,options.prefixChars=options.prefixChars||container.prefixChars,options.argumentDefault=options.argumentDefault||container.argumentDefault,ActionContainer.call(this,options),this.title=options.title,this._groupActions=[],this._container=container,this._registries=container._registries,this._actions=container._actions,this._optionStringActions=container._optionStringActions,this._defaults=container._defaults,this._hasNegativeNumberOptionals=container._hasNegativeNumberOptionals,this._mutuallyExclusiveGroups=container._mutuallyExclusiveGroups};util.inherits(ArgumentGroup,ActionContainer),ArgumentGroup.prototype._addAction=function(action){return action=ActionContainer.prototype._addAction.call(this,action),this._groupActions.push(action),action},ArgumentGroup.prototype._removeAction=function(action){ActionContainer.prototype._removeAction.call(this,action);var actionIndex=this._groupActions.indexOf(action);actionIndex>=0&&this._groupActions.splice(actionIndex,1)}},function(module,exports,__webpack_require__){"use strict";var $$=__webpack_require__(767),Namespace=module.exports=function(options){$$.extend(this,options)};Namespace.prototype.isset=function(key){return $$.has(this,key)},Namespace.prototype.set=function(key,value){return"object"==typeof key?$$.extend(this,key):this[key]=value,this},Namespace.prototype.get=function(key,defaultValue){return this[key]?this[key]:defaultValue},Namespace.prototype.unset=function(key,defaultValue){var value=this[key];return null!==value?(delete this[key],value):defaultValue}},,,,,,,,function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(1717)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function(s1,s2){var s3=new Set;return s1.forEach(function(item){return s3.add(item)}),s2.forEach(function(item){return s3.add(item)}),s3}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";module.exports.ArgumentParser=__webpack_require__(1718),module.exports.Namespace=__webpack_require__(1238),module.exports.Action=__webpack_require__(269),module.exports.HelpFormatter=__webpack_require__(942),module.exports.Const=__webpack_require__(240),module.exports.ArgumentDefaultsHelpFormatter=__webpack_require__(943).ArgumentDefaultsHelpFormatter,module.exports.RawDescriptionHelpFormatter=__webpack_require__(943).RawDescriptionHelpFormatter,module.exports.RawTextHelpFormatter=__webpack_require__(943).RawTextHelpFormatter},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),format=__webpack_require__(8).format,Path=__webpack_require__(53),sprintf=__webpack_require__(1235).sprintf,c=__webpack_require__(240),$$=__webpack_require__(767),ActionContainer=__webpack_require__(1236),argumentErrorHelper=__webpack_require__(941),HelpFormatter=__webpack_require__(942),Namespace=__webpack_require__(1238);function ArgumentParser(options){if(!(this instanceof ArgumentParser))return new ArgumentParser(options);var self=this;function FUNCTION_IDENTITY(o){return o}(options=options||{}).description=options.description||null,options.argumentDefault=options.argumentDefault||null,options.prefixChars=options.prefixChars||"-",options.conflictHandler=options.conflictHandler||"error",ActionContainer.call(this,options),options.addHelp=void 0===options.addHelp||!!options.addHelp,options.parents=options.parents||[],options.prog=options.prog||Path.basename(process.argv[1]),this.prog=options.prog,this.usage=options.usage,this.epilog=options.epilog,this.version=options.version,this.debug=!0===options.debug,this.formatterClass=options.formatterClass||HelpFormatter,this.fromfilePrefixChars=options.fromfilePrefixChars||null,this._positionals=this.addArgumentGroup({title:"Positional arguments"}),this._optionals=this.addArgumentGroup({title:"Optional arguments"}),this._subparsers=null,this.register("type","auto",FUNCTION_IDENTITY),this.register("type",null,FUNCTION_IDENTITY),this.register("type","int",function(x){var result=parseInt(x,10);if(isNaN(result))throw new Error(x+" is not a valid integer.");return result}),this.register("type","float",function(x){var result=parseFloat(x);if(isNaN(result))throw new Error(x+" is not a valid float.");return result}),this.register("type","string",function(x){return""+x});var defaultPrefix=this.prefixChars.indexOf("-")>-1?"-":this.prefixChars[0];options.addHelp&&this.addArgument([defaultPrefix+"h",defaultPrefix+defaultPrefix+"help"],{action:"help",defaultValue:c.SUPPRESS,help:"Show this help message and exit."}),void 0!==this.version&&this.addArgument([defaultPrefix+"v",defaultPrefix+defaultPrefix+"version"],{action:"version",version:this.version,defaultValue:c.SUPPRESS,help:"Show program's version number and exit."}),options.parents.forEach(function(parent){if(self._addContainerActions(parent),void 0!==parent._defaults)for(var defaultKey in parent._defaults)parent._defaults.hasOwnProperty(defaultKey)&&(self._defaults[defaultKey]=parent._defaults[defaultKey])})}util.inherits(ArgumentParser,ActionContainer),ArgumentParser.prototype.addSubparsers=function(options){if(this._subparsers&&this.error("Cannot have multiple subparser arguments."),(options=options||{}).debug=!0===this.debug,options.optionStrings=[],options.parserClass=options.parserClass||ArgumentParser,options.title||options.description?(this._subparsers=this.addArgumentGroup({title:options.title||"subcommands",description:options.description}),delete options.title,delete options.description):this._subparsers=this._positionals,!options.prog){var formatter=this._getFormatter(),positionals=this._getPositionalActions(),groups=this._mutuallyExclusiveGroups;formatter.addUsage(this.usage,positionals,groups,""),options.prog=formatter.formatHelp().trim()}var action=new(this._popActionClass(options,"parsers"))(options);return this._subparsers._addAction(action),action},ArgumentParser.prototype._addAction=function(action){return action.isOptional()?this._optionals._addAction(action):this._positionals._addAction(action),action},ArgumentParser.prototype._getOptionalActions=function(){return this._actions.filter(function(action){return action.isOptional()})},ArgumentParser.prototype._getPositionalActions=function(){return this._actions.filter(function(action){return action.isPositional()})},ArgumentParser.prototype.parseArgs=function(args,namespace){var argv,result=this.parseKnownArgs(args,namespace);return args=result[0],(argv=result[1])&&argv.length>0&&this.error(format("Unrecognized arguments: %s.",argv.join(" "))),args},ArgumentParser.prototype.parseKnownArgs=function(args,namespace){var self=this;args=args||process.argv.slice(2),namespace=namespace||new Namespace,self._actions.forEach(function(action){if(action.dest!==c.SUPPRESS&&!$$.has(namespace,action.dest)&&action.defaultValue!==c.SUPPRESS){var defaultValue=action.defaultValue;"string"==typeof action.defaultValue&&(defaultValue=self._getValue(action,defaultValue)),namespace[action.dest]=defaultValue}}),Object.keys(self._defaults).forEach(function(dest){namespace[dest]=self._defaults[dest]});try{var res=this._parseKnownArgs(args,namespace);return namespace=res[0],args=res[1],$$.has(namespace,c._UNRECOGNIZED_ARGS_ATTR)&&(args=$$.arrayUnion(args,namespace[c._UNRECOGNIZED_ARGS_ATTR]),delete namespace[c._UNRECOGNIZED_ARGS_ATTR]),[namespace,args]}catch(e){this.error(e)}},ArgumentParser.prototype._parseKnownArgs=function(argStrings,namespace){var conflicts,key,self=this,extras=[];function actionHash(action){return action.getName()}null!==this.fromfilePrefixChars&&(argStrings=this._readArgsFromFiles(argStrings));var actionConflicts={};this._mutuallyExclusiveGroups.forEach(function(mutexGroup){mutexGroup._groupActions.forEach(function(mutexAction,i,groupActions){key=actionHash(mutexAction),$$.has(actionConflicts,key)||(actionConflicts[key]=[]),(conflicts=actionConflicts[key]).push.apply(conflicts,groupActions.slice(0,i)),conflicts.push.apply(conflicts,groupActions.slice(i+1))})});var optionStringIndices={},argStringPatternParts=[];argStrings.forEach(function(argString,argStringIndex){if("--"===argString)for(argStringPatternParts.push("-");argStringIndex<argStrings.length;)argStringPatternParts.push("A"),argStringIndex++;else{var pattern,optionTuple=self._parseOptional(argString);optionTuple?(optionStringIndices[argStringIndex]=optionTuple,pattern="O"):pattern="A",argStringPatternParts.push(pattern)}});var argStringsPattern=argStringPatternParts.join(""),seenActions=[],seenNonDefaultActions=[];function takeAction(action,argumentStrings,optionString){seenActions.push(action);var argumentValues=self._getValues(action,argumentStrings);argumentValues!==action.defaultValue&&(seenNonDefaultActions.push(action),actionConflicts[actionHash(action)]&&actionConflicts[actionHash(action)].forEach(function(actionConflict){if(seenNonDefaultActions.indexOf(actionConflict)>=0)throw argumentErrorHelper(action,format('Not allowed with argument "%s".',actionConflict.getName()))})),argumentValues!==c.SUPPRESS&&action.call(self,namespace,argumentValues,optionString)}function consumeOptional(startIndex){for(var args,argCount,start,stop,optionTuple=optionStringIndices[startIndex],action=optionTuple[0],optionString=optionTuple[1],explicitArg=optionTuple[2],actionTuples=[];;){if(!action)return extras.push(argStrings[startIndex]),startIndex+1;if(!explicitArg){start=startIndex+1;var selectedPatterns=argStringsPattern.substr(start);stop=start+(argCount=self._matchArgument(action,selectedPatterns)),args=argStrings.slice(start,stop),actionTuples.push([action,args,optionString]);break}argCount=self._matchArgument(action,"A");var chars=self.prefixChars;if(!(0===argCount&&chars.indexOf(optionString[1])<0)){if(1===argCount){stop=startIndex+1,args=[explicitArg],actionTuples.push([action,args,optionString]);break}throw argumentErrorHelper(action,sprintf("ignored explicit argument %r",explicitArg))}actionTuples.push([action,[],optionString]),optionString=optionString[0]+explicitArg[0];var newExplicitArg=explicitArg.slice(1)||null,optionalsMap=self._optionStringActions;if(!(Object.keys(optionalsMap).indexOf(optionString)>=0))throw argumentErrorHelper(action,sprintf("ignored explicit argument %r",explicitArg));action=optionalsMap[optionString],explicitArg=newExplicitArg}if(actionTuples.length<1)throw new Error("length should be > 0");for(var i=0;i<actionTuples.length;i++)takeAction.apply(self,actionTuples[i]);return stop}var positionals=self._getPositionalActions();function consumePositionals(startIndex){for(var selectedPattern=argStringsPattern.substr(startIndex),argCounts=self._matchArgumentsPartial(positionals,selectedPattern),i=0;i<positionals.length;i++){var action=positionals[i],argCount=argCounts[i];if(void 0!==argCount){var args=argStrings.slice(startIndex,startIndex+argCount);startIndex+=argCount,takeAction(action,args)}}return positionals=positionals.slice(argCounts.length),startIndex}var position,positionalsEndIndex,nextOptionStringIndex,startIndex=0,maxOptionStringIndex=-1;for(Object.keys(optionStringIndices).forEach(function(position){maxOptionStringIndex=Math.max(maxOptionStringIndex,parseInt(position,10))});startIndex<=maxOptionStringIndex;){for(position in nextOptionStringIndex=null,optionStringIndices)optionStringIndices.hasOwnProperty(position)&&(position=parseInt(position,10))>=startIndex&&(nextOptionStringIndex=null!==nextOptionStringIndex?Math.min(nextOptionStringIndex,position):position);if(startIndex!==nextOptionStringIndex){if((positionalsEndIndex=consumePositionals(startIndex))>startIndex){startIndex=positionalsEndIndex;continue}startIndex=positionalsEndIndex}if(!optionStringIndices[startIndex]){var strings=argStrings.slice(startIndex,nextOptionStringIndex);extras=extras.concat(strings),startIndex=nextOptionStringIndex}startIndex=consumeOptional(startIndex)}var stopIndex=consumePositionals(startIndex);extras=extras.concat(argStrings.slice(stopIndex)),positionals.length>0&&self.error("too few arguments"),self._actions.forEach(function(action){action.required&&seenActions.indexOf(action)<0&&self.error(format('Argument "%s" is required',action.getName()))});return self._mutuallyExclusiveGroups.forEach(function(group){if(group.required&&!group._groupActions.some(function(action){return-1!==seenNonDefaultActions.indexOf(action)})){var names=[];group._groupActions.forEach(function(action){action.help!==c.SUPPRESS&&names.push(action.getName())});var msg="one of the arguments "+(names=names.join(" "))+" is required";self.error(msg)}}),[namespace,extras]},ArgumentParser.prototype._readArgsFromFiles=function(argStrings){var self=this,fs=__webpack_require__(76),newArgStrings=[];return argStrings.forEach(function(argString){if(self.fromfilePrefixChars.indexOf(argString[0])<0)newArgStrings.push(argString);else try{var argstrs=[],filename=argString.slice(1),content=fs.readFileSync(filename,"utf8");(content=content.trim().split("\n")).forEach(function(argLine){self.convertArgLineToArgs(argLine).forEach(function(arg){argstrs.push(arg)}),argstrs=self._readArgsFromFiles(argstrs)}),newArgStrings.push.apply(newArgStrings,argstrs)}catch(error){return self.error(error.message)}}),newArgStrings},ArgumentParser.prototype.convertArgLineToArgs=function(argLine){return[argLine]},ArgumentParser.prototype._matchArgument=function(action,regexpArgStrings){var message,regexpNargs=new RegExp("^"+this._getNargsPattern(action)),matches=regexpArgStrings.match(regexpNargs);if(!matches){switch(action.nargs){case void 0:case null:message="Expected one argument.";break;case c.OPTIONAL:message="Expected at most one argument.";break;case c.ONE_OR_MORE:message="Expected at least one argument.";break;default:message="Expected %s argument(s)"}throw argumentErrorHelper(action,format(message,action.nargs))}return matches[1].length},ArgumentParser.prototype._matchArgumentsPartial=function(actions,regexpArgStrings){var actionSlice,pattern,matches,i,j,result=[];function getLength(string){return string.length}for(i=actions.length;i>0;i--){for(pattern="",actionSlice=actions.slice(0,i),j=0;j<actionSlice.length;j++)pattern+=this._getNargsPattern(actionSlice[j]);if(pattern=new RegExp("^"+pattern),(matches=regexpArgStrings.match(pattern))&&matches.length>0){matches=matches.splice(1),result=result.concat(matches.map(getLength));break}}return result},ArgumentParser.prototype._parseOptional=function(argString){var optionString,argExplicit,optionTuples;if(!argString)return null;if(this.prefixChars.indexOf(argString[0])<0)return null;if(this._optionStringActions[argString])return[this._optionStringActions[argString],argString,null];if(1===argString.length)return null;if(argString.indexOf("=")>=0&&(optionString=argString.split("=",1)[0],argExplicit=argString.slice(optionString.length+1),this._optionStringActions[optionString]))return[this._optionStringActions[optionString],optionString,argExplicit];if((optionTuples=this._getOptionTuples(argString)).length>1){var optionStrings=optionTuples.map(function(optionTuple){return optionTuple[1]});this.error(format('Ambiguous option: "%s" could match %s.',argString,optionStrings.join(", ")))}else if(1===optionTuples.length)return optionTuples[0];return argString.match(this._regexpNegativeNumber)&&!this._hasNegativeNumberOptionals.some(Boolean)?null:argString.search(" ")>=0?null:[null,argString,null]},ArgumentParser.prototype._getOptionTuples=function(optionString){var optionPrefix,argExplicit,action,actionOptionString,result=[],chars=this.prefixChars;if(chars.indexOf(optionString[0])>=0&&chars.indexOf(optionString[1])>=0){if(optionString.indexOf("=")>=0){var optionStringSplit=optionString.split("=",1);optionPrefix=optionStringSplit[0],argExplicit=optionStringSplit[1]}else optionPrefix=optionString,argExplicit=null;for(actionOptionString in this._optionStringActions)actionOptionString.substr(0,optionPrefix.length)===optionPrefix&&(action=this._optionStringActions[actionOptionString],result.push([action,actionOptionString,argExplicit]))}else{if(!(chars.indexOf(optionString[0])>=0&&chars.indexOf(optionString[1])<0))throw new Error(format("Unexpected option string: %s.",optionString));optionPrefix=optionString,argExplicit=null;var optionPrefixShort=optionString.substr(0,2),argExplicitShort=optionString.substr(2);for(actionOptionString in this._optionStringActions)$$.has(this._optionStringActions,actionOptionString)&&(action=this._optionStringActions[actionOptionString],actionOptionString===optionPrefixShort?result.push([action,actionOptionString,argExplicitShort]):actionOptionString.substr(0,optionPrefix.length)===optionPrefix&&result.push([action,actionOptionString,argExplicit]))}return result},ArgumentParser.prototype._getNargsPattern=function(action){var regexpNargs;switch(action.nargs){case void 0:case null:regexpNargs="(-*A-*)";break;case c.OPTIONAL:regexpNargs="(-*A?-*)";break;case c.ZERO_OR_MORE:regexpNargs="(-*[A-]*)";break;case c.ONE_OR_MORE:regexpNargs="(-*A[A-]*)";break;case c.REMAINDER:regexpNargs="([-AO]*)";break;case c.PARSER:regexpNargs="(-*A[-AO]*)";break;default:regexpNargs="(-*"+$$.repeat("-*A",action.nargs)+"-*)"}return action.isOptional()&&(regexpNargs=(regexpNargs=regexpNargs.replace(/-\*/g,"")).replace(/-/g,"")),regexpNargs},ArgumentParser.prototype._getValues=function(action,argStrings){var value,argString,self=this;return action.nargs!==c.PARSER&&action.nargs!==c.REMAINDER&&(argStrings=argStrings.filter(function(arrayElement){return"--"!==arrayElement})),0===argStrings.length&&action.nargs===c.OPTIONAL?"string"==typeof(value=action.isOptional()?action.constant:action.defaultValue)&&(value=this._getValue(action,value),this._checkValue(action,value)):0===argStrings.length&&action.nargs===c.ZERO_OR_MORE&&0===action.optionStrings.length?(value=action.defaultValue||argStrings,this._checkValue(action,value)):1!==argStrings.length||action.nargs&&action.nargs!==c.OPTIONAL?action.nargs===c.REMAINDER?value=argStrings.map(function(v){return self._getValue(action,v)}):action.nargs===c.PARSER?(value=argStrings.map(function(v){return self._getValue(action,v)}),this._checkValue(action,value[0])):(value=argStrings.map(function(v){return self._getValue(action,v)})).forEach(function(v){self._checkValue(action,v)}):(argString=argStrings[0],value=this._getValue(action,argString),this._checkValue(action,value)),value},ArgumentParser.prototype._getValue=function(action,argString){var result,typeFunction=this._registryGet("type",action.type,action.type);if("function"!=typeof typeFunction){var message=format("%s is not callable",typeFunction);throw argumentErrorHelper(action,message)}try{result=typeFunction(argString)}catch(e){var name=null;name="string"==typeof action.type?action.type:action.type.name||action.type.displayName||"<function>";var msg=format("Invalid %s value: %s",name,argString);throw"<function>"===name&&(msg+="\n"+e.message),argumentErrorHelper(action,msg)}return result},ArgumentParser.prototype._checkValue=function(action,value){var choices=action.choices;if(choices){if(("string"==typeof choices||Array.isArray(choices))&&-1!==choices.indexOf(value))return;if("object"==typeof choices&&!Array.isArray(choices)&&choices[value])return;choices="string"==typeof choices?choices.split("").join(", "):Array.isArray(choices)?choices.join(", "):Object.keys(choices).join(", ");var message=format("Invalid choice: %s (choose from [%s])",value,choices);throw argumentErrorHelper(action,message)}},ArgumentParser.prototype.formatUsage=function(){var formatter=this._getFormatter();return formatter.addUsage(this.usage,this._actions,this._mutuallyExclusiveGroups),formatter.formatHelp()},ArgumentParser.prototype.formatHelp=function(){var formatter=this._getFormatter();return formatter.addUsage(this.usage,this._actions,this._mutuallyExclusiveGroups),formatter.addText(this.description),this._actionGroups.forEach(function(actionGroup){formatter.startSection(actionGroup.title),formatter.addText(actionGroup.description),formatter.addArguments(actionGroup._groupActions),formatter.endSection()}),formatter.addText(this.epilog),formatter.formatHelp()},ArgumentParser.prototype._getFormatter=function(){return new(0,this.formatterClass)({prog:this.prog})},ArgumentParser.prototype.printUsage=function(){this._printMessage(this.formatUsage())},ArgumentParser.prototype.printHelp=function(){this._printMessage(this.formatHelp())},ArgumentParser.prototype._printMessage=function(message,stream){stream||(stream=process.stdout),message&&stream.write(""+message)},ArgumentParser.prototype.exit=function(status,message){message&&(0===status?this._printMessage(message):this._printMessage(message,process.stderr)),process.exit(status)},ArgumentParser.prototype.error=function(err){var message;if(err instanceof Error){if(!0===this.debug)throw err;message=err.message}else message=err;var msg=format("%s: error: %s",this.prog,message)+c.EOL;if(!0===this.debug)throw new Error(msg);return this.printUsage(process.stderr),this.exit(2,msg)},module.exports=ArgumentParser},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),Action=__webpack_require__(269),c=__webpack_require__(240),ActionHelp=module.exports=function(options){null!==(options=options||{}).defaultValue?options.defaultValue=options.defaultValue:options.defaultValue=c.SUPPRESS,options.dest=null!==options.dest?options.dest:c.SUPPRESS,options.nargs=0,Action.call(this,options)};util.inherits(ActionHelp,Action),ActionHelp.prototype.call=function(parser){parser.printHelp(),parser.exit()}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),Action=__webpack_require__(269),c=__webpack_require__(240),ActionAppend=module.exports=function(options){if(options=options||{},this.nargs<=0)throw new Error("nargs for append actions must be > 0; if arg strings are not supplying the value to append, the append const action may be more appropriate");if(this.constant&&this.nargs!==c.OPTIONAL)throw new Error("nargs must be OPTIONAL to supply const");Action.call(this,options)};util.inherits(ActionAppend,Action),ActionAppend.prototype.call=function(parser,namespace,values){var items=(namespace[this.dest]||[]).slice();items.push(values),namespace.set(this.dest,items)}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),Action=__webpack_require__(269),ActionAppendConstant=module.exports=function(options){if((options=options||{}).nargs=0,void 0===options.constant)throw new Error("constant option is required for appendAction");Action.call(this,options)};util.inherits(ActionAppendConstant,Action),ActionAppendConstant.prototype.call=function(parser,namespace){var items=[].concat(namespace[this.dest]||[]);items.push(this.constant),namespace.set(this.dest,items)}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),Action=__webpack_require__(269),ActionCount=module.exports=function(options){(options=options||{}).nargs=0,Action.call(this,options)};util.inherits(ActionCount,Action),ActionCount.prototype.call=function(parser,namespace){namespace.set(this.dest,(namespace[this.dest]||0)+1)}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),Action=__webpack_require__(269),c=__webpack_require__(240),ActionStore=module.exports=function(options){if(options=options||{},this.nargs<=0)throw new Error("nargs for store actions must be > 0; if you have nothing to store, actions such as store true or store const may be more appropriate");if(void 0!==this.constant&&this.nargs!==c.OPTIONAL)throw new Error("nargs must be OPTIONAL to supply const");Action.call(this,options)};util.inherits(ActionStore,Action),ActionStore.prototype.call=function(parser,namespace,values){namespace.set(this.dest,values)}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),ActionStoreConstant=__webpack_require__(940),ActionStoreTrue=module.exports=function(options){(options=options||{}).constant=!0,options.defaultValue=null!==options.defaultValue&&options.defaultValue,ActionStoreConstant.call(this,options)};util.inherits(ActionStoreTrue,ActionStoreConstant)},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),ActionStoreConstant=__webpack_require__(940),ActionStoreFalse=module.exports=function(options){(options=options||{}).constant=!1,options.defaultValue=null===options.defaultValue||options.defaultValue,ActionStoreConstant.call(this,options)};util.inherits(ActionStoreFalse,ActionStoreConstant)},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),Action=__webpack_require__(269),c=__webpack_require__(240),ActionVersion=module.exports=function(options){(options=options||{}).defaultValue=options.defaultValue?options.defaultValue:c.SUPPRESS,options.dest=options.dest||c.SUPPRESS,options.nargs=0,this.version=options.version,Action.call(this,options)};util.inherits(ActionVersion,Action),ActionVersion.prototype.call=function(parser){var version=this.version||parser.version,formatter=parser._getFormatter();formatter.addText(version),parser.exit(0,formatter.formatHelp())}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),format=__webpack_require__(8).format,Action=__webpack_require__(269),c=__webpack_require__(240),argumentErrorHelper=__webpack_require__(941);function ChoicesPseudoAction(name,help){var options={optionStrings:[],dest:name,help:help};Action.call(this,options)}function ActionSubparsers(options){(options=options||{}).dest=options.dest||c.SUPPRESS,options.nargs=c.PARSER,this.debug=!0===options.debug,this._progPrefix=options.prog,this._parserClass=options.parserClass,this._nameParserMap={},this._choicesActions=[],options.choices=this._nameParserMap,Action.call(this,options)}util.inherits(ChoicesPseudoAction,Action),util.inherits(ActionSubparsers,Action),ActionSubparsers.prototype.addParser=function(name,options){var parser,self=this;(options=options||{}).debug=!0===this.debug,options.prog||(options.prog=this._progPrefix+" "+name);var aliases=options.aliases||[];if(options.help||"string"==typeof options.help){var help=options.help;delete options.help;var choiceAction=new ChoicesPseudoAction(name,help);this._choicesActions.push(choiceAction)}return parser=new this._parserClass(options),this._nameParserMap[name]=parser,aliases.forEach(function(alias){self._nameParserMap[alias]=parser}),parser},ActionSubparsers.prototype._getSubactions=function(){return this._choicesActions},ActionSubparsers.prototype.call=function(parser,namespace,values){var parserName=values[0],argStrings=values.slice(1);if(this.dest!==c.SUPPRESS&&(namespace[this.dest]=parserName),!this._nameParserMap[parserName])throw argumentErrorHelper(format('Unknown parser "%s" (choices: [%s]).',parserName,Object.keys(this._nameParserMap).join(", ")));this._nameParserMap[parserName].parseArgs(argStrings,namespace)},module.exports=ActionSubparsers},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(8),ArgumentGroup=__webpack_require__(1237),MutuallyExclusiveGroup=module.exports=function(container,options){var required;required=(options=options||{}).required||!1,ArgumentGroup.call(this,container),this.required=required};util.inherits(MutuallyExclusiveGroup,ArgumentGroup),MutuallyExclusiveGroup.prototype._addAction=function(action){if(action.required)throw"mutually exclusive arguments must be optional",new Error("mutually exclusive arguments must be optional");return action=this._container._addAction(action),this._groupActions.push(action),action},MutuallyExclusiveGroup.prototype._removeAction=function(action){this._container._removeAction(action),this._groupActions.remove(action)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var regenerator=__webpack_require__(0),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=__webpack_require__(4),asyncToGenerator_default=__webpack_require__.n(asyncToGenerator),argparse=__webpack_require__(1246),argparse_default=__webpack_require__.n(argparse),src=__webpack_require__(34),src_default=__webpack_require__.n(src),helpers=__webpack_require__(262),doctypes=__webpack_require__(43),get=__webpack_require__(10),get_default=__webpack_require__.n(get),set=__webpack_require__(252),set_default=__webpack_require__.n(set),mergeSets=__webpack_require__(1247),account_helpers=__webpack_require__(135),log=src_default.a.namespace("link-myself-to-accounts"),fetchMyself=function(){var _ref=asyncToGenerator_default()(regenerator_default.a.mark(function _callee(client){var response,myself;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,client.stackClient.fetchJSON("POST","/contacts/myself");case 2:return response=_context.sent,(myself=response.data)._id=myself.id,_context.abrupt("return",myself);case 6:case"end":return _context.stop()}},_callee)}));return function(_x){return _ref.apply(this,arguments)}}(),linkMyselfToAccounts=function(){var _ref3=asyncToGenerator_default()(regenerator_default.a.mark(function _callee2(_ref2){var client,settings,accounts,alreadyProcessed,accountsToProcess,myself,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,account,processedAccounts;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return client=_ref2.client,_context2.next=3,Object(helpers.b)(client);case 3:return settings=_context2.sent,_context2.next=6,client.queryAll(client.all(doctypes.a));case 6:if(accounts=_context2.sent,alreadyProcessed=new Set(settings.linkMyselfToAccounts.processedAccounts),0!==(accountsToProcess=accounts.filter(function(account){return!alreadyProcessed.has(account._id)})).length){_context2.next=12;break}return log("info","No accounts to process, bailing out."),_context2.abrupt("return");case 12:return _context2.prev=12,_context2.next=15,fetchMyself(client);case 15:myself=_context2.sent,_context2.next=23;break;case 18:return _context2.prev=18,_context2.t0=_context2.catch(12),log("error","Error while fetching myself contact"),log("error",_context2.t0),_context2.abrupt("return");case 23:_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_context2.prev=26,_iterator=accountsToProcess[Symbol.iterator]();case 28:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context2.next=36;break}return account=_step.value,Object(account_helpers.a)(account,myself),_context2.next=33,client.save(account);case 33:_iteratorNormalCompletion=!0,_context2.next=28;break;case 36:_context2.next=42;break;case 38:_context2.prev=38,_context2.t1=_context2.catch(26),_didIteratorError=!0,_iteratorError=_context2.t1;case 42:_context2.prev=42,_context2.prev=43,_iteratorNormalCompletion||null==_iterator.return||_iterator.return();case 45:if(_context2.prev=45,!_didIteratorError){_context2.next=48;break}throw _iteratorError;case 48:return _context2.finish(45);case 49:return _context2.finish(42);case 50:return processedAccounts=new Set(accountsToProcess.map(function(x){return x._id})),settings.linkMyselfToAccounts.processedAccounts=Array.from(Object(mergeSets.a)(alreadyProcessed,processedAccounts)),_context2.next=54,Object(helpers.e)(client,settings);case 54:log("info","Linked ".concat(accountsToProcess.length," accounts to myself"));case 55:case"end":return _context2.stop()}},_callee2,null,[[12,18],[26,38,42,50],[43,,45,49]])}));return function(_x2){return _ref3.apply(this,arguments)}}(),unlinkMyselfFromAccounts=function(){var _ref5=asyncToGenerator_default()(regenerator_default.a.mark(function _callee3(_ref4){var client,myself,accounts,_iteratorNormalCompletion2,_didIteratorError2,_iteratorError2,_iterator2,_step2,account,currentOwners,ownersWithoutMyself,settings;return regenerator_default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return client=_ref4.client,_context3.prev=1,_context3.next=4,fetchMyself(client);case 4:myself=_context3.sent,_context3.next=12;break;case 7:return _context3.prev=7,_context3.t0=_context3.catch(1),log("error","Error while fetching myself contact"),log("error",_context3.t0),_context3.abrupt("return");case 12:return _context3.next=14,client.queryAll(client.all(doctypes.a));case 14:accounts=_context3.sent,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0,_context3.prev=18,_iterator2=accounts[Symbol.iterator]();case 20:if(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done){_context3.next=30;break}return account=_step2.value,currentOwners=get_default()(account,"relationships.owners.data",[]),ownersWithoutMyself=currentOwners.filter(function(owner){return owner._id!==myself._id}),set_default()(account,"relationships.owners.data",ownersWithoutMyself),_context3.next=27,client.save(account);case 27:_iteratorNormalCompletion2=!0,_context3.next=20;break;case 30:_context3.next=36;break;case 32:_context3.prev=32,_context3.t1=_context3.catch(18),_didIteratorError2=!0,_iteratorError2=_context3.t1;case 36:_context3.prev=36,_context3.prev=37,_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return();case 39:if(_context3.prev=39,!_didIteratorError2){_context3.next=42;break}throw _iteratorError2;case 42:return _context3.finish(39);case 43:return _context3.finish(36);case 44:return _context3.next=46,Object(helpers.b)(client);case 46:return(settings=_context3.sent).linkMyselfToAccounts.processedAccounts=[],_context3.next=50,Object(helpers.e)(client,settings);case 50:log("info","Unlinked all accounts from myself");case 51:case"end":return _context3.stop()}},_callee3,null,[[1,7],[18,32,36,44],[37,,39,43]])}));return function(_x3){return _ref5.apply(this,arguments)}}(),service=__webpack_require__(424);(function(){var _ref=asyncToGenerator_default()(regenerator_default.a.mark(function _callee(){var parser,args;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if((parser=argparse_default.a.ArgumentParser({description:"Service to link myself contact to bank accounts"})).addArgument("mode",{optional:!0,nargs:"?",choices:["link","unlink"]}),"unlink"!==(args=parser.parseArgs()).mode){_context.next=8;break}return _context.next=6,Object(service.a)(unlinkMyselfFromAccounts);case 6:_context.next=11;break;case 8:if("link"!=args.mode&&args.mode){_context.next=11;break}return _context.next=11,Object(service.a)(linkMyselfToAccounts);case 11:case"end":return _context.stop()}},_callee)}));return function(){return _ref.apply(this,arguments)}})()()}]);